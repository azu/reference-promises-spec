<!-- http://www.w3.org/TR/xmlsec-generic-hybrid/ -->
<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <title>XML Security Generic Hybrid Ciphers</title>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8">
        
<!--      <script src='../../../dap-dev/ReSpec.js/js/respec.js' -->
<!--              class='remove'></script> -->
   
    
  <style>/*****************************************************************
 * ReSpec 3 CSS
 * Robin Berjon - http://berjon.com/
 *****************************************************************/

/* --- INLINES --- */
em.rfc2119 { 
    text-transform:     lowercase;
    font-variant:       small-caps;
    font-style:         normal;
    color:              #900;
}

h1 acronym, h2 acronym, h3 acronym, h4 acronym, h5 acronym, h6 acronym, a acronym,
h1 abbr, h2 abbr, h3 abbr, h4 abbr, h5 abbr, h6 abbr, a abbr {
    border: none;
}

dfn {
    font-weight:    bold;
}

a.internalDFN {
    color:  inherit;
    border-bottom:  1px solid #99c;
    text-decoration:    none;
}

a.externalDFN {
    color:  inherit;
    border-bottom:  1px dotted #ccc;
    text-decoration:    none;
}

a.bibref {
    text-decoration:    none;
}

cite .bibref {
    font-style: normal;
}

code {
    color:  #ff4500;
}


/* --- --- */
ol.algorithm { counter-reset:numsection; list-style-type: none; }
ol.algorithm li { margin: 0.5em 0; }
ol.algorithm li:before { font-weight: bold; counter-increment: numsection; content: counters(numsection, ".") ") "; }

/* --- TOC --- */
.toc a, .tof a {
    text-decoration:    none;
}

a .secno, a .figno {
    color:  #000;
}

ul.tof, ol.tof {
    list-style: none outside none;
}

.caption {
    margin-top: 0.5em;
    font-style:   italic;
}

/* --- TABLE --- */
table.simple {
    border-spacing: 0;
    border-collapse:    collapse;
    border-bottom:  3px solid #005a9c;
}

.simple th {
    background: #005a9c;
    color:  #fff;
    padding:    3px 5px;
    text-align: left;
}

.simple th[scope="row"] {
    background: inherit;
    color:  inherit;
    border-top: 1px solid #ddd;
}

.simple td {
    padding:    3px 10px;
    border-top: 1px solid #ddd;
}

.simple tr:nth-child(even) {
    background: #f0f6ff;
}

/* --- DL --- */
.section dd > p:first-child {
    margin-top: 0;
}

.section dd > p:last-child {
    margin-bottom: 0;
}

.section dd {
    margin-bottom:  1em;
}

.section dl.attrs dd, .section dl.eldef dd {
    margin-bottom:  0;
}
</style><style>/* --- EXAMPLES --- */
div.example-title {
    min-width: 7.5em;
    color: #b9ab2d;
}
div.example-title span {
    text-transform: uppercase;   
}
aside.example, div.example, div.illegal-example {
    padding: 0.5em;
    margin: 1em 0;
    position: relative;
    clear: both;
}
div.illegal-example { color: red }
div.illegal-example p { color: black }
aside.example, div.example {
    padding: .5em;
    border-left-width: .5em;
    border-left-style: solid;
    border-color: #e0cb52;
    background: #fcfaee;    
}

aside.example div.example {
    border-left-width: .1em;
    border-color: #999;
    background: #fff;
}
aside.example div.example div.example-title {
    color: #999;
}
</style><style>/* HIGHLIGHTS */
code.prettyprint {
    color:  inherit;
}

/* this from google-code-prettify */
.pln{color:#000}@media screen{.str{color:#080}.kwd{color:#008}.com{color:#800}.typ{color:#606}.lit{color:#066}.pun,.opn,.clo{color:#660}.tag{color:#008}.atn{color:#606}.atv{color:#080}.dec,.var{color:#606}.fun{color:red}}@media print,projection{.str{color:#060}.kwd{color:#006;font-weight:bold}.com{color:#600;font-style:italic}.typ{color:#404;font-weight:bold}.lit{color:#044}.pun,.opn,.clo{color:#440}.tag{color:#006;font-weight:bold}.atn{color:#404}.atv{color:#060}}ol.linenums{margin-top:0;margin-bottom:0}li.L0,li.L1,li.L2,li.L3,li.L5,li.L6,li.L7,li.L8{list-style-type:none}li.L1,li.L3,li.L5,li.L7,li.L9{background:#eee}
</style><link rel="stylesheet" href="http://www.w3.org/StyleSheets/TR/W3C-WG-NOTE"><!--[if lt IE 9]><script src='http://www.w3.org/2008/site/js/html5shiv.js'></script><![endif]--></head>
  <body><div class="head">
  <p>
    
      <a href="http://www.w3.org/"><img width="72" height="48" src="http://www.w3.org/Icons/w3c_home" alt="W3C"></a>
    
  </p>
  <h1 class="title" id="title">XML Security Generic Hybrid Ciphers</h1>
  
  <h2 id="w3c-working-group-note-11-april-2013"><abbr title="World Wide Web Consortium">W3C</abbr> Working Group Note 11 April 2013</h2>
  <dl>
    
      <dt>This version:</dt>
      <dd><a href="http://www.w3.org/TR/2013/NOTE-xmlsec-generic-hybrid-20130411/">http://www.w3.org/TR/2013/NOTE-xmlsec-generic-hybrid-20130411/</a></dd>
      <dt>Latest published version:</dt>
      <dd><a href="http://www.w3.org/TR/xmlsec-generic-hybrid/">http://www.w3.org/TR/xmlsec-generic-hybrid/</a></dd>
    
    
      <dt>Latest editor's draft:</dt>
      <dd><a href="http://www.w3.org/2008/xmlsec/Drafts/generic-hybrid-ciphers/">http://www.w3.org/2008/xmlsec/Drafts/generic-hybrid-ciphers/</a></dd>
    
    
    
    
    
      <dt>Previous version:</dt>
      <dd><a href="http://www.w3.org/TR/2013/NOTE-xmlsec-generic-hybrid-20130124/">http://www.w3.org/TR/2013/NOTE-xmlsec-generic-hybrid-20130124/</a></dd>
    
    
    <dt>Editors:</dt>
    <dd><span>Magnus Nyström</span>, Microsoft Corporation</dd>
<dd><span>Frederick Hirsch</span>, Nokia</dd>

    
  </dl>
  
  
  
  
    
      <p class="copyright">
        <a href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> © 
        2013
        
        <a href="http://www.w3.org/"><abbr title="World Wide Web Consortium">W3C</abbr></a><sup>®</sup> 
        (<a href="http://www.csail.mit.edu/"><abbr title="Massachusetts Institute of Technology">MIT</abbr></a>,
        <a href="http://www.ercim.eu/"><abbr title="European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>,
        <a href="http://www.keio.ac.jp/">Keio</a>, <a href="http://ev.buaa.edu.cn/">Beihang</a>), All Rights Reserved.
        <abbr title="World Wide Web Consortium">W3C</abbr> <a href="http://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>,
        <a href="http://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and
        <a href="http://www.w3.org/Consortium/Legal/copyright-documents">document use</a> rules apply.
      </p>
    
  
  <hr>
</div>
    <section id="abstract" class="introductory"><h2>Abstract</h2>
<p>Generic hybrid ciphers allow for a consistent treatment of asymmetric
ciphers when encrypting data and consist of a key encapsulation
algorithm with associated parameters and a data encapsulation
algorithm with associated parameters. Further, the key encapsulation
algorithms introduced in this specification have attractive security
properties.</p>
<p>
This informative document augments XML Encryption Version 1.1 [<cite><a class="bibref" href="#bib-XMLENC-CORE1">XMLENC-CORE1</a></cite>] by
defining algorithms, XML types and elements 
necessary to enable use of generic hybrid ciphers in XML Security
applications, and reserving identifiers for those algorithms.
There is no requirement for implementation of this informative
material and no interoperability
testing has been performed.
      </p>
    </section><section id="sotd" class="introductory"><h2>Status of This Document</h2>
  
    
      
        <p>
          <em>This section describes the status of this document at the time of its publication. Other
          documents may supersede this document. A list of current <abbr title="World Wide Web Consortium">W3C</abbr> publications and the latest revision
          of this technical report can be found in the <a href="http://www.w3.org/TR/"><abbr title="World Wide Web Consortium">W3C</abbr> technical reports
          index</a> at http://www.w3.org/TR/.</em>
        </p>
        
      <p>The XML Security Group has agreed 
        not to progress the Generic Hybrid Ciphers
        specification further as a Recommendation track document, electing
        to publish it as an informative Working Group Note.  The
        Working Group has not performed interop testing on the 
        material in this document. </p>
      <p>This Working Group Note publication includes updated
        references and minor corrections and formatting changes to the
        example       (<a href="Overview_diff.html">diff</a>). The
        associated
        schema         file referenced from this document  has had the
        ghc namespace URI corrected.</p>
    
        <p>
          This document was published by the <a href="http://www.w3.org/2008/xmlsec/">XML Security Working Group</a> as a Working Group Note.
          
          
          If you wish to make comments regarding this document, please send them to 
          <a href="mailto:public-xmlsec@w3.org">public-xmlsec@w3.org</a> 
          (<a href="mailto:public-xmlsec-request@w3.org?subject=subscribe">subscribe</a>,
          <a href="http://lists.w3.org/Archives/Public/public-xmlsec/">archives</a>).
          
          
          
          
        All comments are welcome.
        
        
          </p><p>
            Publication as a Working Group Note does not imply endorsement by the <abbr title="World Wide Web Consortium">W3C</abbr> Membership.
            This is a draft document and may be updated, replaced or obsoleted by other documents at 
            any time. It is inappropriate to cite this document as other than work in progress.
          </p>
        
        
        <p>
          
            This document was produced by a group operating under the 
            <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/">5 February 2004 <abbr title="World Wide Web Consortium">W3C</abbr> Patent Policy</a>.
          
          
          
            
              <abbr title="World Wide Web Consortium">W3C</abbr> maintains a <a href="http://www.w3.org/2004/01/pp-impl/42458/status" rel="disclosure">public list of any patent disclosures</a> 
            
            made in connection with the deliverables of the group; that page also includes instructions for 
            disclosing a patent. An individual who has actual knowledge of a patent which the individual believes contains
            <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#def-essential">Essential Claim(s)</a> must disclose the
            information in accordance with <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#sec-Disclosure">section
            6 of the <abbr title="World Wide Web Consortium">W3C</abbr> Patent Policy</a>.
          
          
        </p>
        
      
    
  
</section><section id="toc"><h2 class="introductory">Table of Contents</h2><ul class="toc"><li class="tocline"><a href="#sec-introduction" class="tocxref"><span class="secno">1. </span>Introduction</a><ul class="toc"><li class="tocline"><a href="#editorial" class="tocxref"><span class="secno">1.1 </span>Editorial</a></li></ul></li><li class="tocline"><a href="#sec-namespaces" class="tocxref"><span class="secno">2. </span>Versions, Namespaces and Identifiers</a></li><li class="tocline"><a href="#sec-background" class="tocxref"><span class="secno">3. </span>Generic Hybrid Ciphers Overview</a></li><li class="tocline"><a href="#sec-algorithms" class="tocxref"><span class="secno">4. </span>Algorithms</a><ul class="toc"><li class="tocline"><a href="#implementation-requirements" class="tocxref"><span class="secno">4.1 </span>Algorithm Identifiers and Implementation Requirements</a></li><li class="tocline"><a href="#sec-generic-hybrid-algorithms" class="tocxref"><span class="secno">4.2 </span>Generic Hybrid Encryption Algorithms</a><ul class="toc"><li class="tocline"><a href="#sec-generic-hybrid" class="tocxref"><span class="secno">4.2.1 </span>Generic-Hybrid</a></li></ul></li><li class="tocline"><a href="#sec-kem-algorithms" class="tocxref"><span class="secno">4.3 </span>Key Encapsulation Algorithms</a><ul class="toc"><li class="tocline"><a href="#sec-rsaes-kem" class="tocxref"><span class="secno">4.3.1 </span>RSAES-KEM</a></li><li class="tocline"><a href="#sec-ecies-kem" class="tocxref"><span class="secno">4.3.2 </span>ECIES-KEM</a></li></ul></li></ul></li><li class="tocline"><a href="#sec-key-transport-algorithms" class="tocxref"><span class="secno">5. </span>Using Key Encapsulation Algorithms for Key Transport</a></li><li class="tocline"><a href="#sec-examples" class="tocxref"><span class="secno">6. </span>Examples</a><ul class="toc"><li class="tocline"><a href="#sec-key-transport-example" class="tocxref"><span class="secno">6.1 </span>Key Transport Example</a></li></ul></li><li class="tocline"><a href="#sec-security-considerations" class="tocxref"><span class="secno">7. </span>Security Considerations</a></li><li class="tocline"><a href="#sec-conformance" class="tocxref"><span class="secno">8. </span>Conformance</a></li><li class="tocline"><a href="#sec-acknowledgements" class="tocxref"><span class="secno">9. </span>Acknowledgments</a></li><li class="tocline"><a href="#sec-schema" class="tocxref"><span class="secno">10. </span>Schema</a><ul class="toc"><li class="tocline"><a href="#sec-xsdSchema" class="tocxref"><span class="secno">10.1 </span>XSD Schema</a></li><li class="tocline"><a href="#sec-rngSchema" class="tocxref"><span class="secno">10.2 </span>RNG Schema</a></li></ul></li><li class="tocline"><a href="#references" class="tocxref"><span class="secno">A. </span>References</a><ul class="toc"><li class="tocline"><a href="#normative-references" class="tocxref"><span class="secno">A.1 </span>Normative references</a></li><li class="tocline"><a href="#informative-references" class="tocxref"><span class="secno">A.2 </span>Informative references</a></li></ul></li></ul></section>
    

    <section id="sec-introduction">
      <!--OddPage--><h2><span class="secno">1. </span>Introduction</h2>
      <p>
This informative document specifies an XML syntax and processing rules for
generic hybrid ciphers and key encapsulation mechanisms based on
[<cite><a class="bibref" href="#bib-ISO18033-2">ISO18033-2</a></cite>] and reserves identifiers for algorithms. The document augments XML Encryption
[<cite><a class="bibref" href="#bib-XMLENC-CORE1">XMLENC-CORE1</a></cite>].  There are 
no requirements for implementation of this material which has not been tested for
interoperability.
      </p>
      <p>
This document does not normatively specify when and how generic hybrid
ciphers and key encapsulation mechanisms are to be
used; rather it focuses on the basis for interoperability, namely the
fundamental data types required for use of these algorithms in
conjunction with XML Security applications and the meaning of those data types,
as well as identification of specific algorithms.
      </p>
<section id="editorial">
<h3><span class="secno">1.1 </span>Editorial</h3>
<p>
The key words "<em class="rfc2119" title="MUST">MUST</em>" and
"<em class="rfc2119" title="OPTIONAL">OPTIONAL</em>" in this specification are to be 
interpreted as described in RFC2119 [<cite><a class="bibref" href="#bib-RFC2119">RFC2119</a></cite>]:
</p>
<p>
</p><blockquote>
<p>"They <em class="rfc2119" title="MUST">MUST</em> only be used where it is actually required for
interoperation or to limit behavior which has potential for 
causing harm (e.g., limiting retransmissions)"</p>
</blockquote>
<p>
Consequently, these capitalized keywords are used to unambiguously
specify requirements over protocol and application features and
behavior that affect the interoperability and security of
implementations. These key words are not used (capitalized) to
describe XML grammar; schema definitions unambiguously describe such
requirements. For instance, an XML attribute might be described as
being "optional."
</p>
<p>
Note also that this entire specification is <em class="rfc2119" title="OPTIONAL">OPTIONAL</em>; hence the
keywords apply only when compliance with this specification is
claimed. 
</p>
</section>
    </section>
<section id="sec-namespaces">
      <!--OddPage--><h2><span class="secno">2. </span>Versions, Namespaces and Identifiers</h2>
<p>
No provision is made for an explicit version number in this syntax. If
a future version is needed, it will use a different namespace. The XML
namespace [<cite><a class="bibref" href="#bib-XML-NAMES">XML-NAMES</a></cite>] URI that <em class="rfc2119" title="MUST">MUST</em> be used by
implementations of this (dated) specification is:</p>
<pre class="xml-example">xmlns ghc="http://www.w3.org/2010/xmlsec-ghc#"</pre>
<p>
While applications <em class="rfc2119" title="MUST">MUST</em> support XML and XML namespaces, the use of internal entities or the <code>ghc</code> XML namespace prefix is <em class="rfc2119" title="OPTIONAL">OPTIONAL</em>; we use these facilities to provide compact and readable examples.
</p>
<p>
This specification uses Uniform Resource Identifiers [<cite><a class="bibref" href="#bib-URI">URI</a></cite>] to identify resources, algorithms, and semantics. Identifiers under the control of this specification are coined within the scope of the above namespace.
</p>
</section>
<section id="sec-background">
  <!--OddPage--><h2><span class="secno">3. </span>Generic Hybrid Ciphers Overview</h2>
  <p>
The term "generic hybrid cipher" is defined in [<cite><a class="bibref" href="#bib-ISO18033-2">ISO18033-2</a></cite>] as an
asymmetric cipher that combines both 
asymmetric and symmetric cryptographic techniques. Generic hybrid
ciphers that meet the requirements laid out in [<cite><a class="bibref" href="#bib-ISO18033-2">ISO18033-2</a></cite>]  have attractive security properties. They are
introduced in this document to enable applications to use
cryptographic algorithms with tight security proofs.
</p>
<p>
Generic hybrid ciphers allow for a consistent treatment of asymmetric
ciphers when encrypting data and consists of a key encapsulation
algorithm with associated parameters and a data encapsulation
algorithm with associated parameters. The key encapsulation algorithm
results in an encapsulated shared key that is then used with the data
encapsulation algorithm, e.g. for encryption.
</p>
</section>
<section id="sec-algorithms">
  <!--OddPage--><h2><span class="secno">4. </span>Algorithms</h2>
  <p>
This section discusses and identifies algorithms to be used with this
specification. Entries contain the identifier to be used as the value
of the <code>Algorithm</code> attribute of the
<code>EncryptionMethod</code> element or other element representing
the role of the algorithm, a reference to the formal specification,
definitions for the representation of keys and the results of
cryptographic operations where applicable, and general applicability
comments.
  </p>
  <section id="implementation-requirements">
    <h3><span class="secno">4.1 </span>Algorithm Identifiers and Implementation Requirements</h3>
    <p>
This specification defines a set of algorithms, their URIs, and
requirements for implementation. Levels of requirement specified, such
as <em class="rfc2119" title="MUST">MUST</em> or <em class="rfc2119" title="OPTIONAL">OPTIONAL</em>, refer
to implementation, not use.
    </p>
<dl>
<dt>Generic Hybrid Encryption</dt>
<dd>
<ol>
<li> <em class="rfc2119" title="MUST">MUST</em> Generic-Hybrid <a href="http://www.w3.org/2010/xmlsec-ghc#generic-hybrid">http://www.w3.org/2010/xmlsec-ghc#generic-hybrid</a>
</li>
</ol>
</dd>
<dt>Key Encapsulation</dt>
<dd>
<ol>
<li><em class="rfc2119" title="MUST">MUST</em> RSAES-KEM
<a href="http://www.w3.org/2010/xmlsec-ghc#rsaes-kem">http://www.w3.org/2010/xmlsec-ghc#rsaes-kem</a>
</li>
<li>
          <em class="rfc2119" title="MUST">MUST</em> ECIES-KEM
<a href="http://www.w3.org/2010/xmlsec-ghc#ecies-kem">http://www.w3.org/2010/xmlsec-ghc#ecies-kem</a>
</li>
</ol>
</dd>
</dl>
    </section>
    <section id="sec-generic-hybrid-algorithms">
      <h3><span class="secno">4.2 </span>Generic Hybrid Encryption Algorithms</h3>
      <p>
Generic-hybrid encryption algorithms combine both asymmetric and
symmetric cryptographic techniques. Schema definition:
      </p>
<pre class="xml-dtd">  &lt;element name="GenericHybridCipherMethod" type="ghc:GenericHybridCipherMethodType"/&gt;
  &lt;complexType name="GenericHybridCipherMethodType"&gt;
    &lt;sequence&gt;
      &lt;element name="KeyEncapsulationMethod" type="ghc:KeyEncapsulationMethodType"/&gt;
      &lt;element name="DataEncapsulationMethod" type="xenc:EncryptionMethodType"/&gt;
    &lt;/sequence&gt;
  &lt;/complexType&gt;
</pre>
<p>
The <code>KeyEncapsulationMethod</code> element identifies the key
encapsulation method as well as provides values for its parameters.
</p>
<p>
The <code>DataEncapsulationMethod</code> element identifies the data
encapsulation (encryption) method as well as provides any parameters
associated with the data encapsulation method.
</p>
<section id="sec-generic-hybrid">
  <h4><span class="secno">4.2.1 </span>Generic-Hybrid</h4>
<dl>
<dt>Identifier:</dt>
<dd><a href="http://www.w3.org/2010/xmlsec-ghc#generic-hybrid">http://www.w3.org/2010/xmlsec-ghc#generic-hybrid</a> (<em class="rfc2119" title="REQUIRED">REQUIRED</em>)
</dd>
</dl>
<p>
The Generic-Hybrid encryption algorithm may be used for a variety of
purposes; in particular, when used with a key encapsulation mechanism
such as those specified in <a href="#sec-kem-algorithms" class="sectionRef sec-ref">section 4.3 Key Encapsulation Algorithms</a>
and a suitable key wrap algorithm, it can be used for key transport
with tight security proofs.
</p>
<p>
The <code>GenericHybridCipherMethod</code> element shall appear
as a child element of the <code>xenc:EncryptionMethod</code> when
<code>generic-hybrid</code> is specified as the value of the <code>xenc:EncryptionMethod</code>
<code>Algorithm</code> attribute.
</p>
      </section>
    </section>
    <section id="sec-kem-algorithms">
      <h3><span class="secno">4.3 </span>Key Encapsulation Algorithms</h3>
<p>
This document specifies two key encapsulation algorithms, RSAES-KEM
and ECIES-KEM, for use with the Generic-Hybrid cipher in key
transport scenarios.
</p>
<pre class="xml-dtd">  &lt;complexType name="KeyEncapsulationMethodType"&gt;
    &lt;sequence&gt;
      &lt;element ref="xenc11:KeyDerivationMethod"/&gt;
      &lt;element name="KeyLen" type="positiveInteger"/&gt;
      &lt;any namespace="##other" minOccurs="0" maxOccurs="unbounded"/&gt;
    &lt;/sequence&gt;
    &lt;attribute name="Algorithm" type="anyURI" use="required"/&gt;
  &lt;/complexType&gt;
</pre>
<p>
The <code>xenc11:KeyDerivationMethod</code> element of the
<code>KeyEncapsulationMethodType</code> specifies a key derivation method
to use when deriving a key from key material generated in accordance
with the key encapsulation mechanism. The
<code>xenc11:KeyDerivationMethod</code> element is defined in
[<cite><a class="bibref" href="#bib-XMLENC-CORE1">XMLENC-CORE1</a></cite>]. The <code>KeyLen</code> element
specifies length of the derived key. The
<code>Algorithm</code> attribute identifies the actual key
encapsulation method used.
</p>
<section id="sec-rsaes-kem">
  <h4><span class="secno">4.3.1 </span>RSAES-KEM</h4>
<dl>
<dt>Identifier</dt>
<dd><a href="http://www.w3.org/2010/xmlsec-ghc#rsaes-kem">http://www.w3.org/2010/xmlsec-ghc#rsaes-kem</a> (<em class="rfc2119" title="REQUIRED">REQUIRED</em>)
</dd>
</dl>
<p>
RSAES-KEM is a key encapsulation algorithm based on the RSA
encryption scheme.
</p>
<p>
Given a recipient's public RSA key (n, e) where n is the RSA modulus
and e is the public exponent, the following steps shall be taken to
encapsulate a symmetric key when the RSAES-KEM key encapsulation
algorithm is used (these are the same steps as specified in Section
11.5.3 of [<cite><a class="bibref" href="#bib-ISO18033-2">ISO18033-2</a></cite>]):
</p>
<ol>
  <li>Generate a non-negative random number r less than the modulus n;
  </li>
  <li>Set R = I2OSP(r, len(n)) where I2OSP is the integer to octet
  string conversion specified in Section 4.1 of PKCS #1 
[<cite><a class="bibref" href="#bib-PKCS1">PKCS1</a></cite>] and len(n) is the length of the modulus
  n;
  </li>
  <li>Set c0 = RSAEP((n , e), r) where RSAEP is the RSA encryption
  primitive defined in Section 5.1.1 of PKCS #1 [<cite><a class="bibref" href="#bib-PKCS1">PKCS1</a></cite>] (i.e. no padding);
  </li>
  <li>Set C0 = I2OSP(c0, len(n));
  </li>
  <li>Compute K = KDF(R, KeyLen, OtherInfo) where KDF is the key
  derivation function, KeyLen is the length of the encapsulated key
  and OtherInfo is optional other info (subject to the input parameters
  for the key derivation function, see [<cite><a class="bibref" href="#bib-XMLENC-CORE1">XMLENC-CORE1</a></cite>]
  Section 5.4);
  </li>
  <li>Output the key K and ciphertext C0.
  </li>
</ol>
<p>
Given a recipient's private RSA key (n, d) where n is the RSA modulus
and d is the private exponent, the following steps shall be taken to
decrypt an encapsulated symmetric key from ciphertext C0 when the
RSAES-KEM key encapsulation algorithm is used (these are the same
steps as specified in Section 11.5.4 of [<cite><a class="bibref" href="#bib-ISO18033-2">ISO18033-2</a></cite>]:
</p><ol>
<li> Set c0 =
OS2IP(C0) where OS2IP is the octet string to integer 
  conversion specified in Section 4.2 of PKCS #1 [<cite><a class="bibref" href="#bib-PKCS1">PKCS1</a></cite>].
  </li>
  <li>Set r = RSADP((n , d), c0) where RSADP is the RSA decryption
  primitive defined in Section 5.1.2 of PKCS #1 [<cite><a class="bibref" href="#bib-PKCS1">PKCS1</a></cite>] (i.e. no padding);
  </li>
  <li>Set R = I2OSP(r, len(n));
  </li>
  <li>Compute K = KDF(R, KeyLen, OtherInfo) where KDF is the key
  derivation function, KeyLen is the length of the encapsulated key
  and OtherInfo is optional other info (subject to the input parameters
  for the key derivation function, see [<cite><a class="bibref" href="#bib-XMLENC-CORE1">XMLENC-CORE1</a></cite>]
  Section 5.4);
  </li>
  <li>Output the secret key K.
  </li>
</ol>
<p>
For use of the RSAES-KEM key encapsulation algorithm with Key
Transport, see <a href="#sec-key-transport-algorithms" class="sectionRef sec-ref">section 5. Using Key Encapsulation Algorithms for Key Transport</a>.
</p>
</section>
<section id="sec-ecies-kem">
  <h4><span class="secno">4.3.2 </span>ECIES-KEM</h4>
<dl>
<dt>Identifier</dt>
<dd><a href="http://www.w3.org/2010/xmlsec-ghc#ecies-kem">http://www.w3.org/2010/xmlsec-ghc#ecies-kem</a> (<em class="rfc2119" title="REQUIRED">REQUIRED</em>)
</dd>
</dl>
<p>
ECIES-KEM is a key encapsulation algorithm based on the Elliptic Curve
scheme.
</p>
<p>
Given a recipient's public EC key h and an elliptic curve E with base
point g and order (size) o, the following steps shall be taken to
encapsulate a symmetric key when the ECIES-KEM key encapsulation
algorithm is used (these are the same steps as specified in Section
10.2.3 of [<cite><a class="bibref" href="#bib-ISO18033-2">ISO18033-2</a></cite>]):
</p>
<ol>
  <li>Generate a positive random number r less than o;
  </li>
  <li>Compute the elliptic curve point G = r * g where * denotes
  scalar multiplication;
  </li>
  <li>Compute the elliptic curve point H = r * h;
  </li>
  <li>Set C0 = ENCODE ( G ) where ENCODE is the encoding of the
  elliptic curve point G as specified in Section 4.4.2 of 
[<cite><a class="bibref" href="#bib-XMLDSIG-CORE1">XMLDSIG-CORE1</a></cite>]. 
  </li>
  <li>Set P = ENCODE ( H ) where ENCODE is the encoding of the
  elliptic curve point H; since H is a point on the curve the encoding shall
  again be as specified in Section 4.4.2 of 
[<cite><a class="bibref" href="#bib-XMLDSIG-CORE1">XMLDSIG-CORE1</a></cite>];
  </li>
  <li>Set K = KDF( C0 | P, KeyLen, OtherInfo ) where KDF is the key
  derivation function, KeyLen is the length of the derived key and
  OtherInfo is optional other info (subject to the input parameters
  for the key derivation function, see 
[<cite><a class="bibref" href="#bib-XMLDSIG-CORE1">XMLDSIG-CORE1</a></cite>];
  Section 5.4);
  </li>
  <li>Output the key K and ciphertext C0.
  </li>
</ol>
<p>
Given a recipient's private EC key x and an elliptic curve E with base
point g and order (size) o, the following steps shall be taken to
decrypt an encapsulated symmetric key from ciphertext C0 when the
ECIES-KEM key encapsulation algorithm is used (these are the same
steps as specified in Section 10.2.4 of 
[<cite><a class="bibref" href="#bib-ISO18033-2">ISO18033-2</a></cite>]):
</p>
<ol>
  <li>Set G = DECODE ( C0 ) where DECODE is the decoding function
  which is the reverse of the ENCODE function previously described;
  </li>
  <li>Compute the elliptic curve point H = x * G where * denotes
  scalar multiplication;
  </li> 
  <li>If H = 0, then fail;
  </li>
  <li>Set P = ENCODE ( H ) where ENCODE is the encoding of the
  elliptic curve point H as specified in Section 4.4.2 of 
[<cite><a class="bibref" href="#bib-XMLDSIG-CORE1">XMLDSIG-CORE1</a></cite>].
  </li>
  <li>Set K = KDF( C0 | P, KeyLen, OtherInfo ) where KDF is the key
  derivation function, KeyLen is the length of the derived key and
  OtherInfo is optional other info (subject to the input parameters
  for the key derivation function, see 
[<cite><a class="bibref" href="#bib-XMLDSIG-CORE1">XMLDSIG-CORE1</a></cite>]
  Section 5.4);
  </li>
  <li>Output the secret key K.
  </li>
</ol>
<p>
For use of the ECIES-KEM key encapsulation algorithm with Key
Transport, see <a href="#sec-key-transport-algorithms" class="sectionRef sec-ref">section 5. Using Key Encapsulation Algorithms for Key Transport</a>.
</p>
</section>
</section>
</section>
<section id="sec-key-transport-algorithms">
  <!--OddPage--><h2><span class="secno">5. </span>Using Key Encapsulation Algorithms for Key Transport</h2>
<p>
When using a Key Encapsulation algorithm such as RSAES-KEM or
ECIES-KEM for key transport, the key K which is one of the outputs of
the KEM algorithm (see <a href="#sec-rsaes-kem">RSAES-KEM</a> and <a href="#sec-ecies-kem">ECIES-KEM</a>) is now used as a wrapping key,
encrypting a data-encryption key DEK: C1 = WRAP(K, DEK). The combined
ciphertext C0 | C1 (where C0 is the other output of the KEM algorithm)
is then placed in the <code>xenc:CipherValue</code> element of
the <code>xenc:CipherData</code> child element of the
<code>xenc:EncryptedKey</code> (the
<code>ds:KeyInfo</code> element will identify the recipient's
public key).
</p>
</section>
<section id="sec-examples" class="informative">
  <!--OddPage--><h2><span class="secno">6. </span>Examples</h2><p><em>This section is non-normative.</em></p>
<section id="sec-key-transport-example">
  <h3><span class="secno">6.1 </span>Key Transport Example</h3><p><em>This section is non-normative.</em></p>
<p>
The following is a syntactically correct example of an
<code>xenc:EncryptedKey</code> element using the Generic-Hybrid
method together with the ECIES-KEM algorithm for key encapsulation and
AES-128 KeyWrap for wrapping the content key using the encapsulated
key (the example would look precisely the same when using the
RSAES-KEM algorithm except for the identification of the Key
Encapsulation Algorithm which instead would have the value
"http://www.w3.org/2010/xmlsec-ghc#rsaes-kem" and the identification
of an RSA public key instead of an ECC key in the
<code>ds:KeyInfo</code> element.)
</p>
<div><div class="example"><div class="example-title"><span>Example 1</span></div><pre class="example highlight prettyprint"><span class="pun">&lt;?</span><span class="pln">xml version</span><span class="pun">=</span><span class="str">"1.0"</span><span class="pln"> encoding</span><span class="pun">=</span><span class="str">"utf-8"</span><span class="pun">?&gt;</span><span class="pln">

</span><span class="tag">&lt;xenc:EncryptedKey</span><span class="pln">
    </span><span class="atn">xmlns:xsi</span><span class="pun">=</span><span class="atv">"http://www.w3.org/2001/XMLSchema-instance"</span><span class="pln">
    </span><span class="atn">xmlns:xenc</span><span class="pun">=</span><span class="atv">"http://www.w3.org/2001/04/xmlenc#"</span><span class="pln">
    </span><span class="atn">xmlns:ds</span><span class="pun">=</span><span class="atv">"http://www.w3.org/2000/09/xmldsig#"</span><span class="pln">
    </span><span class="atn">xmlns:dsig11</span><span class="pun">=</span><span class="atv">"http://www.w3.org/2009/xmldsig11#"</span><span class="pln">
    </span><span class="atn">xmlns:xenc11</span><span class="pun">=</span><span class="atv">"http://www.w3.org/2009/xmlenc11#"</span><span class="pln">
    </span><span class="atn">xmlns:ghc</span><span class="pun">=</span><span class="atv">"http://www.w3.org/2010/xmlsec-ghc#"</span><span class="tag">&gt;</span><span class="pln">

  </span><span class="tag">&lt;xenc:EncryptionMethod</span><span class="pln">
      </span><span class="atn">Algorithm</span><span class="pun">=</span><span class="atv">"http://www.w3.org/2010/xmlsec-ghc#generic-hybrid"</span><span class="tag">&gt;</span><span class="pln">
    </span><span class="tag">&lt;ghc:GenericHybridCipherMethod&gt;</span><span class="pln">
      </span><span class="tag">&lt;ghc:KeyEncapsulationMethod</span><span class="pln">
          </span><span class="atn">Algorithm</span><span class="pun">=</span><span class="atv">"http://www.w3.org/2010/xmlsec-ghc#ecies-kem"</span><span class="tag">&gt;</span><span class="pln">
        </span><span class="tag">&lt;xenc11:KeyDerivationMethod</span><span class="pln"> </span><span class="atn">Algorithm</span><span class="pun">=</span><span class="atv">"http://www.w3.org/2009/xmlenc11#ConcatKDF"</span><span class="tag">&gt;</span><span class="pln">
          </span><span class="tag">&lt;xenc11:ConcatKDFParams</span><span class="pln"> </span><span class="atn">AlgorithmID</span><span class="pun">=</span><span class="atv">"0000"</span><span class="pln"> </span><span class="atn">PartyUInfo</span><span class="pun">=</span><span class="atv">"03D8"</span><span class="pln"> </span><span class="atn">PartyVInfo</span><span class="pun">=</span><span class="atv">""</span><span class="tag">&gt;</span><span class="pln">
            </span><span class="tag">&lt;ds:DigestMethod</span><span class="pln"> </span><span class="atn">Algorithm</span><span class="pun">=</span><span class="atv">"http://www.w3.org/2001/04/xmlenc#sha256"</span><span class="tag">/&gt;</span><span class="pln">
          </span><span class="tag">&lt;/xenc11:ConcatKDFParams&gt;</span><span class="pln">
        </span><span class="tag">&lt;/xenc11:KeyDerivationMethod&gt;</span><span class="pln">
        </span><span class="tag">&lt;ghc:KeyLen&gt;</span><span class="pln">16</span><span class="tag">&lt;/ghc:KeyLen&gt;</span><span class="pln">
      </span><span class="tag">&lt;/ghc:KeyEncapsulationMethod&gt;</span><span class="pln">
      </span><span class="tag">&lt;ghc:DataEncapsulationMethod</span><span class="pln">
          </span><span class="atn">Algorithm</span><span class="pun">=</span><span class="atv">"http://www.w3.org/2001/04/xmlenc#kw-aes128"</span><span class="tag">/&gt;</span><span class="pln">
    </span><span class="tag">&lt;/ghc:GenericHybridCipherMethod&gt;</span><span class="pln">
  </span><span class="tag">&lt;/xenc:EncryptionMethod&gt;</span><span class="pln">
  </span><span class="tag">&lt;ds:KeyInfo&gt;</span><span class="pln">
    </span><span class="tag">&lt;dsig11:ECKeyValue&gt;</span><span class="pln">
      </span><span class="tag">&lt;dsig11:NamedCurve</span><span class="pln"> </span><span class="atn">URI</span><span class="pun">=</span><span class="atv">"urn:oid:1.2.840.10045.3.1.7"</span><span class="tag">/&gt;</span><span class="pln">
      </span><span class="tag">&lt;dsig11:PublicKey&gt;</span><span class="pln">DEADBEEF</span><span class="tag">&lt;/dsig11:PublicKey&gt;</span><span class="pln">
    </span><span class="tag">&lt;/dsig11:ECKeyValue&gt;</span><span class="pln">
  </span><span class="tag">&lt;/ds:KeyInfo&gt;</span><span class="pln">
  </span><span class="tag">&lt;xenc:CipherData&gt;</span><span class="pln">
    </span><span class="tag">&lt;xenc:CipherValue&gt;</span><span class="pln">DEADBEEF</span><span class="tag">&lt;/xenc:CipherValue&gt;</span><span class="pln">
    </span><span class="com">&lt;!-- Is concatenation of originator's ephemeral key (expressed as
         an octet string) and the wrapped key --&gt;</span><span class="pln">
  </span><span class="tag">&lt;/xenc:CipherData&gt;</span><span class="pln">
</span><span class="tag">&lt;/xenc:EncryptedKey&gt;</span></pre></div></div>
</section>
</section>
<section id="sec-security-considerations">
<!--OddPage--><h2><span class="secno">7. </span>Security Considerations</h2>
<p>
Generic hybrid ciphers with key encapsulation mechanisms as specified
in this document provides a high security level assuming key
derivation algorithms and other security parameters have been properly
chosen.  See further [<cite><a class="bibref" href="#bib-ISO18033-2">ISO18033-2</a></cite>], Annex B for a deeper
security discussion on these constructions.
</p>
</section>
<section id="sec-conformance">
<!--OddPage--><h2><span class="secno">8. </span>Conformance</h2>
<p>
An implementation is conformant to this specification if it
successfully generates syntax according to the schema definitions and
satisfies any and all
<em class="rfc2119" title="MUST">MUST</em>/<em class="rfc2119" title="REQUIRED">REQUIRED</em>/<em class="rfc2119" title="SHALL">SHALL</em>
requirements. 
</p>
The full normative grammar is defined by the XSD schema and the
normative text in this specification. The standalone XSD schema file
is authoritative in case there is any disagreement between it and the
XSD schema portions in this specification. 
<p>

</p>
</section>
    <section id="sec-acknowledgements" class="informative">
      <!--OddPage--><h2><span class="secno">9. </span>Acknowledgments</h2><p><em>This section is non-normative.</em></p>
      <p>
The contributions of the following Working Group members to this
specification are gratefully acknowledged in accordance with the
contributor policies and the active WG roster: 
Scott Cantor, Pratik Datta,
Frederick Hirsch,
Meiko Jensen, 
Brian LaMacchia,
Hal Lockhart,
Cynthia Martin,
Magnus Nyström,
Bruce Rich,
Thomas Roessler, and
Ed Simon.
      </p><p>
Additionally, we thank Burt Kaliski of EMC for his comments during and
subsequent to Last Call. 
      </p>
    </section>

    <section id="sec-schema">
      <!--OddPage--><h2><span class="secno">10. </span>Schema</h2>
<section id="sec-xsdSchema">
      <h3><span class="secno">10.1 </span>XSD Schema</h3>
<dl>
<dt>XML Security Generic Hybrid Schema Instance</dt>
<dd><a href="xmlsec-ghc-schema.xsd">xmlsec-ghc-schema.xsd</a></dd>
<dd>Valid XML schema instance based on the XML Schema
            Second Edition [<cite><a class="bibref" href="#bib-XMLSCHEMA-1">XMLSCHEMA-1</a></cite>], [<cite><a class="bibref" href="#bib-XMLSCHEMA-2">XMLSCHEMA-2</a></cite>].</dd>
</dl>
</section>
<section id="sec-rngSchema">
<h3><span class="secno">10.2 </span>RNG Schema</h3>
<p>Non-normative RELAX NG schema [<cite><a class="bibref" href="#bib-RELAXNG-SCHEMA">RELAXNG-SCHEMA</a></cite>]
 information is
  available in a separate document
[<cite><a class="bibref" href="#bib-XMLSEC-RELAXNG">XMLSEC-RELAXNG</a></cite>].
</p>
</section>
    </section>
  


<section id="references" class="appendix"><!--OddPage--><h2><span class="secno">A. </span>References</h2><p>Dated references below are to the latest known or appropriate edition of the referenced work.  The referenced works may be subject to revision, and conformant implementations may follow, and are encouraged to investigate the appropriateness of following, some or all more recent editions or replacements of the works cited. It is in each case implementation-defined which  editions are supported.</p><section id="normative-references"><h3><span class="secno">A.1 </span>Normative references</h3><dl class="bibliography"><dt id="bib-ISO18033-2">[ISO18033-2]</dt><dd><cite>Information technology -- Security techniques -- Encryption algorithms -- Part 2: Asymmetric ciphers</cite>, International Organization for Standardization.  18033-2:2006. May 2006. URL: <a href="http://www.iso.org/iso/home.htm">http://www.iso.org/iso/home.htm</a>.
</dd><dt id="bib-PKCS1">[PKCS1]</dt><dd>J. Jonsson and B. Kaliski. <a href="http://www.ietf.org/rfc/rfc3447.txt"><cite>Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications  Version 2.1.</cite></a> RFC 3447 (Informational), February  2003. URL: <a href="http://www.ietf.org/rfc/rfc3447.txt">http://www.ietf.org/rfc/rfc3447.txt</a> 
</dd><dt id="bib-RFC2119">[RFC2119]</dt><dd>S. Bradner. <a href="http://www.ietf.org/rfc/rfc2119.txt"><cite>Key words for use in RFCs to Indicate Requirement Levels.</cite></a> March 1997. Internet RFC 2119.  URL: <a href="http://www.ietf.org/rfc/rfc2119.txt">http://www.ietf.org/rfc/rfc2119.txt</a> 
</dd><dt id="bib-XML-NAMES">[XML-NAMES]</dt><dd>Richard Tobin et al. <a href="http://www.w3.org/TR/2009/REC-xml-names-20091208/"><cite>Namespaces in XML 1.0 (Third Edition)</cite></a>. 8 December 2009. W3C Recommendation. URL: <a href="http://www.w3.org/TR/2009/REC-xml-names-20091208/">http://www.w3.org/TR/2009/REC-xml-names-20091208/</a>
</dd><dt id="bib-XMLDSIG-CORE1">[XMLDSIG-CORE1]</dt><dd>D. Eastlake; J. Reagle; D. Solo; F. Hirsch; T. Roessler; K. Yiu. <a href="http://www.w3.org/TR/2013/REC-xmldsig-core1-20130411/"><cite>XML Signature Syntax and Processing Version 1.1</cite></a>. 11 April 2013. W3C Recommendation. URL: <a href="http://www.w3.org/TR/2013/REC-xmldsig-core1-20130411/">http://www.w3.org/TR/2013/REC-xmldsig-core1-20130411/</a>
</dd><dt id="bib-XMLENC-CORE1">[XMLENC-CORE1]</dt><dd>J. Reagle; D. Eastlake; F. Hirsch; T. Roessler. <a href="http://www.w3.org/TR/2013/REC-xmlenc-core1-20130411/"><cite>XML Encryption Syntax and Processing Version 1.1</cite></a>. 11 April 2013. W3C Recommendation. URL: <a href="http://www.w3.org/TR/2013/REC-xmlenc-core1-20130411/">http://www.w3.org/TR/2013/REC-xmlenc-core1-20130411/</a>
</dd></dl></section><section id="informative-references"><h3><span class="secno">A.2 </span>Informative references</h3><dl class="bibliography"><dt id="bib-RELAXNG-SCHEMA">[RELAXNG-SCHEMA]</dt><dd><a href="http://standards.iso.org/ittf/PubliclyAvailableStandards/c052348_ISO_IEC_19757-2_2008(E).zip"><cite>Information technology -- Document Schema Definition Language (DSDL) -- Part 2: Regular-grammar-based validation -- RELAX NG</cite></a>. ISO/IEC 19757-2:2008. URL: <a href="http://standards.iso.org/ittf/PubliclyAvailableStandards/c052348_ISO_IEC_19757-2_2008(E).zip">http://standards.iso.org/ittf/PubliclyAvailableStandards/c052348_ISO_IEC_19757-2_2008(E).zip</a>
</dd><dt id="bib-URI">[URI]</dt><dd>T. Berners-Lee; R. Fielding; L. Masinter. <a href="http://www.ietf.org/rfc/rfc3986.txt"><cite>Uniform Resource Identifiers (URI): generic syntax</cite></a>. January 2005. RFC 3986. URL: <a href="http://www.ietf.org/rfc/rfc3986.txt">http://www.ietf.org/rfc/rfc3986.txt</a>
</dd><dt id="bib-XMLSCHEMA-1">[XMLSCHEMA-1]</dt><dd>Henry S. Thompson et al. <a href="http://www.w3.org/TR/2004/REC-xmlschema-1-20041028/"><cite>XML Schema Part 1: Structures Second Edition</cite></a>. 28 October 2004. W3C Recommendation. URL: <a href="http://www.w3.org/TR/2004/REC-xmlschema-1-20041028/">http://www.w3.org/TR/2004/REC-xmlschema-1-20041028/</a>
</dd><dt id="bib-XMLSCHEMA-2">[XMLSCHEMA-2]</dt><dd>Paul V. Biron; Ashok Malhotra. <a href="http://www.w3.org/TR/2004/REC-xmlschema-2-20041028/"><cite>XML Schema Part 2: Datatypes Second Edition</cite></a>. 28 October 2004. W3C Recommendation. URL: <a href="http://www.w3.org/TR/2004/REC-xmlschema-2-20041028/">http://www.w3.org/TR/2004/REC-xmlschema-2-20041028/</a>
</dd><dt id="bib-XMLSEC-RELAXNG">[XMLSEC-RELAXNG]</dt><dd>Makoto Murata; Frederick Hirsch. <a href="http://www.w3.org/TR/2013/NOTE-xmlsec-rngschema-20130411/"><cite>XML Security RELAX NG Schemas</cite></a>. 11 April 2013. W3C Working Group Note. URL: <a href="http://www.w3.org/TR/2013/NOTE-xmlsec-rngschema-20130411/">http://www.w3.org/TR/2013/NOTE-xmlsec-rngschema-20130411/</a>
</dd></dl></section></section></body></html>
