<!-- http://www.w3.org/TR/rif-xml-data/ -->
<!DOCTYPE html  PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN'  'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'><html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
  <title>RIF Combination with XML data (Second Edition)</title>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
  <style type="text/css">
   .editsection { display: none; }
</style>
<link href="tr.css" rel="stylesheet" type="text/css" />
<link href="http://www.w3.org/StyleSheets/TR/W3C-WG-NOTE" rel="stylesheet" type="text/css" />

  
</head>
<body>

<div class="head">
<a href="http://www.w3.org/"><img alt="W3C" height="48" src="http://www.w3.org/Icons/w3c_home" width="72" /></a><h1 id="title" style="clear:both"><span id="short-title">RIF Combination with XML data (Second Edition)</span></h1>

<h2 id="W3C-doctype">W3C Working Group Note 5 February 2013</h2>

<!-- no inplace warning -->
<dl>
<dt>This version:</dt>
<dd><a href="http://www.w3.org/TR/2013/NOTE-rif-xml-data-20130205/" id="this-version-url">http://www.w3.org/TR/2013/NOTE-rif-xml-data-20130205/</a></dd>

<dt>Latest version:</dt>
<dd><a href="http://www.w3.org/TR/rif-xml-data/">http://www.w3.org/TR/rif-xml-data/</a></dd>

<dt>Previous version:</dt>
<dd><a href="http://www.w3.org/TR/2012/NOTE-rif-xml-data-20121211/">http://www.w3.org/TR/2012/NOTE-rif-xml-data-20121211/</a></dd>
</dl>

<dl><dt>Editors:</dt><dd>Christian de Sainte Marie, IBM</dd>
</dl>



<p>A <a href="http://www.w3.org/TR/2013/NOTE-rif-xml-data-20130205/diff-from-20121211">color-coded version of this document showing changes made since the previous version</a> is also available.</p><p>This document is also available in these non-normative formats: <a href="http://www.w3.org/2013/pdf/NOTE-rif-xml-data-20130205.pdf">PDF version</a>.</p>



<p class="copyright"><a href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> &copy; 2013 <a href="http://www.w3.org/"><acronym title="World Wide Web Consortium">W3C</acronym></a><sup>&reg;</sup> (<a href="http://www.csail.mit.edu/"><acronym title="Massachusetts Institute of Technology">MIT</acronym></a>, <a href="http://www.ercim.eu/"><acronym title="European Research Consortium for Informatics and Mathematics">ERCIM</acronym></a>, <a href="http://www.keio.ac.jp/">Keio</a>, <a href="http://ev.buaa.edu.cn/">Beihang</a>), All Rights Reserved. W3C <a href="http://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>, <a href="http://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and <a href="http://www.w3.org/Consortium/Legal/copyright-documents">document use</a> rules apply.</p>

</div>
<hr />
<h2><a id="abstract" name="abstract">Abstract</a></h2>

<div>
<div><p></p> <p></p> <p></p> <p>This document, developed by the <a class="external text" href="http://www.w3.org/2005/rules/wiki/RIF_Working_Group" rel="nofollow" title="http://www.w3.org/2005/rules/wiki/RIF_Working_Group">Rule Interchange Format (RIF) Working Group</a>, specifies how a RIF document can be combined with XML data. </p> <p></p></div>
</div>

<h2 class="no-toc no-num">
<a id="w3c_status" name="w3c_status">Status of this Document</a>
</h2>
    
<h4 class="no-toc no-num" id="may-be">May Be Superseded</h4>
    
<p><em>This section describes the status of this document at the time of its publication. Other documents may supersede this document. A list of current W3C publications and the latest revision of this technical report can be found in the <a href="http://www.w3.org/TR/">W3C technical reports index</a> at http://www.w3.org/TR/.</em></p>


<h4 class="no-toc no-num" id="related">Set of Documents</h4>

<p>This document is being published as one of a set of 13 documents: </p>
<ol>
<li><a href="http://www.w3.org/TR/2013/NOTE-rif-overview-20130205/">RIF Overview (Second Edition)</a></li>
<li><a href="http://www.w3.org/TR/2013/NOTE-rif-ucr-20130205/">RIF Use Cases and Requirements (Second Edition)</a></li>
<li><a href="http://www.w3.org/TR/2013/REC-rif-core-20130205/">RIF Core Dialect (Second Edition)</a></li>
<li><a href="http://www.w3.org/TR/2013/REC-rif-bld-20130205/">RIF Basic Logic Dialect (Second Edition)</a></li>
<li><a href="http://www.w3.org/TR/2013/REC-rif-prd-20130205/">RIF Production Rule Dialect (Second Edition)</a></li>
<li><a href="http://www.w3.org/TR/2013/REC-rif-fld-20130205/">RIF Framework for Logic Dialects (Second Edition)</a></li>
<li><a href="http://www.w3.org/TR/2013/REC-rif-dtb-20130205/">RIF Datatypes and Built-Ins 1.0 (Second Edition)</a></li>
<li><a href="http://www.w3.org/TR/2013/REC-rif-rdf-owl-20130205/">RIF RDF and OWL Compatibility (Second Edition)</a></li>
<li><a href="http://www.w3.org/TR/2013/NOTE-rif-owl-rl-20130205/">OWL 2 RL in RIF (Second Edition)</a></li>
<li><a href="http://www.w3.org/TR/2013/NOTE-rif-xml-data-20130205/">RIF Combination with XML data (Second Edition)</a>  (this document)</li>
<li><a href="http://www.w3.org/TR/2013/NOTE-rif-in-rdf-20130205/">RIF In RDF (Second Edition)</a></li>
<li><a href="http://www.w3.org/TR/2013/NOTE-rif-test-20130205/">RIF Test Cases (Second Edition)</a></li>
<li><a href="http://www.w3.org/TR/2013/NOTE-rif-primer-20130205/">RIF Primer (Second Edition)</a></li>
</ol>

    

<!-- no eventStatusExtra -->

<!-- no statusExtra -->

<div></div>



           <h4 class="no-toc no-num" id="status-changes">Document Unchanged</h4>

<p>There have been no changes to the body of this document since the <a href="http://www.w3.org/TR/2012/NOTE-rif-xml-data-20121211/">previous version</a>.   For details on earlier changes, see the <a href="#changelog">change log</a>.</p>



<h4 class="no-toc no-num" id="please">Please Send Comments</h4><p>Please send any comments to <a class="mailto" href="mailto:public-rif-comments@w3.org">public-rif-comments@w3.org</a>
    (<a class="http" href="http://lists.w3.org/Archives/Public/public-rif-comments/">public
    archive</a>).  Although work on this document by the <a href="http://www.w3.org/2005/rules/wg.html">Rule Interchange Format (RIF) Working Group</a> is complete, comments may be addressed in the <a href="http://www.w3.org/2010/rif/errata">errata</a> or in future revisions.  Open discussion among developers is welcome at <a class="mailto" href="mailto:public-rif-dev@w3.org">public-rif-dev@w3.org</a> (<a class="http" href="http://lists.w3.org/Archives/Public/public-rif-dev/">public archive</a>).</p>
    
<h4 class="no-toc no-num" id="no-endorsement">No Endorsement</h4>
    
<p><em>Publication as a Working Group Note does not imply endorsement by the W3C Membership. This is a draft document and may be updated, replaced or obsoleted by other documents at any time. It is inappropriate to cite this document as other than work in progress.</em></p>


<h4 class="no-toc no-num" id="patents">Patents</h4>
    
<p><em>This document was produced by a group operating under the <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/">5 February 2004 W3C Patent Policy</a>. W3C maintains a <a href="http://www.w3.org/2004/01/pp-impl/38457/status" rel="disclosure">public list of any patent disclosures</a> made in connection with the deliverables of the group; that page also includes instructions for disclosing a patent. An individual who has actual knowledge of a patent which the individual believes contains <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#def-essential">Essential Claim(s)</a> must disclose the information in accordance with <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#sec-Disclosure"> section 6 of the W3C Patent Policy</a>.</em></p>

<hr title="Separator After Status Section" />


<p><span class="anchor" id="sec-overview"></span> 
</p>
<table class="toc" id="toc" summary="Contents"><tr><td><div id="toctitle"><h2>Table of Contents</h2></div>
<ul>
<li class="toclevel-1"><a href="#Overview"><span class="tocnumber">1</span> <span class="toctext">Overview</span></a></li>
<li class="toclevel-1"><a href="#RIF_combination_with_XML_data"><span class="tocnumber">2</span> <span class="toctext">RIF combination with XML data</span></a>
<ul>
<li class="toclevel-2"><a href="#Syntax"><span class="tocnumber">2.1</span> <span class="toctext">Syntax</span></a></li>
<li class="toclevel-2"><a href="#Model-theoretic_semantics_of_RIF_BLD.2BXML_data_combinations"><span class="tocnumber">2.2</span> <span class="toctext">Model-theoretic semantics of RIF BLD+XML data combinations</span></a>
<ul>
<li class="toclevel-3"><a href="#Semantic_structures"><span class="tocnumber">2.2.1</span> <span class="toctext">Semantic structures</span></a></li>
<li class="toclevel-3"><a href="#Combined_interpretation_of_RIF_BLD_non-document_formulas_and_XML_data"><span class="tocnumber">2.2.2</span> <span class="toctext">Combined interpretation of RIF BLD non-document formulas and XML data</span></a></li>
<li class="toclevel-3"><a href="#Combined_interpretation_of_RIF_BLD_documents_and_XML_data"><span class="tocnumber">2.2.3</span> <span class="toctext">Combined interpretation of RIF BLD documents and XML data</span></a></li>
</ul>
</li>
<li class="toclevel-2"><a href="#Operational_semantics_of_RIF_PRD.2BXML_data_combinations"><span class="tocnumber">2.3</span> <span class="toctext">Operational semantics of RIF PRD+XML data combinations</span></a></li>
<li class="toclevel-2"><a href="#Semantics_of_RIF_Core.2BXML_data_combinations"><span class="tocnumber">2.4</span> <span class="toctext">Semantics of RIF Core+XML data combinations</span></a></li>
</ul>
</li>
<li class="toclevel-1"><a href="#Importing_XML_data_and_XML_schemas_in_RIF"><span class="tocnumber">3</span> <span class="toctext">Importing XML data and XML schemas in RIF</span></a>
<ul>
<li class="toclevel-2"><a href="#The_extended_Import_directive"><span class="tocnumber">3.1</span> <span class="toctext">The extended Import directive</span></a></li>
<li class="toclevel-2"><a href="#Interpretation_of_Imports"><span class="tocnumber">3.2</span> <span class="toctext">Interpretation of Imports</span></a></li>
</ul>
</li>
<li class="toclevel-1"><a href="#References"><span class="tocnumber">4</span> <span class="toctext">References</span></a></li>
<li class="toclevel-1"><a href="#Appendix_A:_Glossary_.28non-normative.29"><span class="tocnumber">5</span> <span class="toctext">Appendix A: Glossary (non-normative)</span></a></li>
<li class="toclevel-1"><a href="#Appendix_B:_Change_Log_.28non-normative.29"><span class="tocnumber">6</span> <span class="toctext">Appendix B: Change Log (non-normative)</span></a></li>
</ul>
</td></tr></table><script type="text/javascript"> if (window.showTocToggle) { var tocShowText = "show"; var tocHideText = "hide"; showTocToggle(); } </script>
<a id="Overview" name="Overview"></a><h2> <span class="mw-headline">1  Overview </span></h2>
<p>The Rule Interchange Format (RIF) is a format for interchanging rules over the Web. Rules that are exchanged using RIF may refer to external data sources and may be based on data models that are represented using a language different from RIF. This document specifies how combinations of RIF documents and XML data, possibly associated with XML schemas, are interpreted.
</p><p>Extensible Markup Language (XML) is a simple, flexible text format derived from SGML (ISO 8879). Originally designed to meet the challenges of large-scale electronic publishing, XML is also playing an increasingly important role in the exchange of a wide variety of data on the Web and elsewhere. The XML Schema Definition Language offers facilities for describing the structure and constraining the contents of XML documents. The schema language, which is itself represented in an XML vocabulary, provides a way to describe and to share the data model that is associated with the data in an XML document.
</p><p>This document specifies a standard semantics for combinations of RIF documents and XML data, with or without an associated XML schema. The specification relies on the abstract XQuery 1.0 and XPath 2.0 Data Model [<a href="#ref-xdm" title="">XDM</a>] to specify what information is accessible in the data, and on XPath 2.0 expressions [<a href="#ref-xpath-20" title="">XPath 2.0</a>] to select pieces of that information. It relies on XML Schema Component Designators [<a href="#ref-xsd-cd" title="">XSD-CD</a>] expressions to provide unambiguous designators for XML schema types and schema elements in combinations where the XML data is associated with an XML schema.
</p><p><a href="#ref-xpath-20" title="">XPath 2.0</a> is a non-XML expression language that allows the processing of values conforming to the data model defined in [<a href="#ref-xdm" title="">XDM</a>]. The result of an XPath expression may be a selection of nodes from the input data model, or an atomic value, or more generally, any sequence allowed by the data model. The name of the language derives from its most distinctive feature, the path expression, which provides a means of hierarchic addressing of the nodes in an XML tree.
</p><p><a href="#ref-xsd-cd" title="">XML Schema Component Designators</a> (XSD-CD) is a non-XML expression language that provides reliable and unambiguous designators for XML schema components. The specification divides the problem of constructing schema component designators into two parts: defining a designator for an assembled schema, and defining a designator for a particular schema component or schema components, understood relative to a designated schema. This specification uses only a limited subset of the schema component path expression language, from the second part.
</p><p>According to this specification, XPath and component designator expressions are represented as string constants in RIF formulas. Although the semantics of RIF and XML data combinations is specified with respect to any valid <a href="#ref-xpath-20" title="">XPath 2.0</a> expression, conforming implementations are required to support only a limited subset. Future versions of this specification may extend that subset.
</p><p>The <a href="#ref-xdm" title="">XQuery 1.0 and XPath 2.0 Data Model</a> (XDM) is based on the <i>infoset</i> [<a href="#ref-infoset" title="">Infoset</a>], possibly augmented with information resulting from the validation of the XML data against an XML schema, or <i>post-schema validation infoset</i> (PSVI), according to the specification W3C XML Schema Definition Language (XSD) 1.1 Part 1: Structures [<a href="#ref-xsd11-1" title="">XSD 1.1 Part 1</a>]. An instance of the data model can also be constructed directly through application APIs, or from non-XML sources such as relational tables in a database. The semantics for the combination of RIF documents with XML data applies, therefore, to the combination of RIF documents with non-XML data as well, where the XML binding of the data is only used to refer to it in the interchanged rules. This is likely to be of particular interest when an XML schema is interchanged along with the RIF document. 
</p><p>Like the <a href="#ref-xdm" title="">XQuery 1.0 and XPath 2.0 Data Model</a>, the semantics of combinations of RIF documents and XML data that is specified in this document supports the following classes of XML data:
</p>
<ul><li> Well-formed documents conforming to [Namespaces in XML] or [Namespaces in XML 1.1].
</li><li> DTD-valid documents conforming to [Namespaces in XML] or [Namespaces in XML 1.1], and
</li><li> W3C XML Schema-validated documents.
</li></ul>
<p>Accordingly, this document specifies how a RIF document is combined with well-formed -- and, where an XML schema is specified, schema-valid --  XML documents. The semantics is independent on the provenance of the XML data in a combination: it can be imported explicitly in a RIF document, or combined on the consumer-side, or a combination of both. However, only XML schemas that are explicitly imported in the RIF document are taken into account for the interpretation of the combination. This provides a way to communicate the data model that is intended, in a RIF document, for the data source, without specifying an actual data source.
</p><p>Section 2 specifies a normative standard semantics for RIF combinations with XML data: first, an XPath 2.0 and XSD-CD based syntax is specified, that is used to relate RIF formulas to XML data items in a combinations (section 2.1). Then, a model-theoretics semantics is given to RIF BLD combination with XML data, with and without associated XML schema (section 2.2); the operational semantics of RIF PRD combinations with XML data is, then, defined, based on the definition of a RIF BLD+XML data combined interpretation (section 2.3); finally, the semantics of RIF Core combinations with XML data is defined with respect to the model-theoretic semantics of the combination of RIF BLD and XML data and the operational semantics of the combination of RIF PRD and XML data (section 2.4).
</p><p>Section 3 specifies how the <tt>rif:Import</tt> directive is extended to support the import of XML data and XML schemas in a RIF document.
</p><p><br />
Combination with XML data and/or schema constrains the interpretation of RIF formulas and give them special semantics. As a result, the semantics of RIF when XML data and schema is imported is not the same as the semantics of RIF alone, even if the imported XML data and schema are empty.
</p><p>Section 4 specifies the conformance criteria for this specification.
</p><p>Implementation of this specification requires a good understanding of <a href="#ref-xpath-20" title="">XPath 2.0</a> and the <a href="#ref-xdm" title="">XQuery 1.0 and XPath 2.0 Data Model</a>. However, this document can be read and understood without a deep knowledge of these two specifications. For the convenience of the reader, the definition of terms from the <a href="#ref-xpath-20" title="">XPath 2.0</a>, <a href="#ref-xsd-cd" title="">XSD-CD</a> and the <a href="#ref-xdm" title="">XDM</a> specifications, that are of particular importance for this document, are repeated in the <a href="#appendix-glossary" title="">Appendix A: Glossary</a>. However, the definition in the glossary are non-normative: the only normative definitions are as specified in the [<a href="#ref-xpath-20" title="">XPath 2.0</a>] and the [<a href="#ref-xdm" title="">XDM</a>] recommendations, and in the <a href="#ref-xsd-cd" title="">XSD-CD</a> specification.
Such terms are shown in square bracket, with a superscript indicating <i>XP</i> if the term is defined in <a href="#ref-xpath-20" title="">XPath 2.0</a>: [thus]<sup><small>XP</small></sup>; or with a superscript indicating <i>XDM</i> if the term is defined in <a href="#ref-xdm" title="">XDM</a>:  [thus]<sup><small>XDM</small></sup>; or with a superscript indicating <i>CD</i> if the term is defined in <a href="#ref-xsd-cd" title="">XSD-CD</a>:  [thus]<sup><small>CD</small></sup>.
</p><p>This document follows the convention used in other RIF specifications, to start definition with: <b>Definition</b> and end them with the symbol ☐. In the same way, examples start with: <b>Example</b> and end with ☐. The end symbol may be omitted if the definition or example ends with the section. 
</p><p>Several prefixes are used throughout this document for notational convenience. The following bindings are assumed.
</p>
<ol><li> <tt>rif</tt> bound to <tt>http://www.w3.org/2007/rif</tt>
</li><li> <tt>xs</tt> bound to <tt>http://www.w3.org/2001/XMLSchema</tt>
</li><li> <tt>xml</tt> bound to <tt>http://www.w3.org/XML/1998/namespace</tt>
</li><li> <tt>fn</tt> bound to <tt>http://www.w3.org/2005/xpath-functions</tt>
</li><li> <tt>pred</tt> bound to <tt>http://www.w3.org/2007/rif-builtin-predicate</tt>
</li><li> <tt>func</tt> bound to <tt>http://www.w3.org/2007/rif-builtin-function</tt>
</li><li> <tt>xscd</tt> bound to <tt>http://www.w3.org/2009/xmlschema-ref</tt>
</li></ol>
<p><span class="anchor" id="sec-combination"></span>
</p>
<a id="RIF_combination_with_XML_data" name="RIF_combination_with_XML_data"></a><h2> <span class="mw-headline">2  RIF combination with XML data </span></h2>
<p>This section specifies the normative semantics of the combination of RIF formulas and XML data, for RIF Core, RIF PRD and RIF BLD, where the XML data may be associated with an XML schema.
</p><p><span class="anchor" id="def-rif.2Bxml-data-combination"></span>
<b>Definition (RIF+XML data combination).</b> A <i><b>RIF+XML data combination</b></i> is a triple &lt;<i>R</i>, <i>E</i>, <i>S</i>&gt;, where <i>R</i> is a RIF formula (document or non-document), <i>E</i> is a, possibly empty, set of data model [nodes]<sup><small>XDM</small></sup> that contains the information that is represented in the XML data, and <i>S</i> is a, possibly empty, set of XML schema definitions.&nbsp;&nbsp;☐
</p><p>For the purpose of evaluating the XPath 2.0 expressions that are used, in <i>R</i>, to access the XML data that is represented in <i>E</i>, the [in-scope schema definitions]<sup><small>XP</small></sup> are the schema definitions in <i>S</i> and all their components.
</p><p>This specification does not describe or prescribe how the set of data model [nodes]<sup><small>XDM</small></sup>, in a RIF+XML data combination, is obtained: it may result from parsing one or more XML documents and/or validating them against one or more XML schemas, or it may be created by methods other than parsing and/or schema-validating XML documents.
</p><p>However, in a RIF+XML data combination &lt;<i>R, E, S</i>&gt;, any information item in <i>E</i> that represents an instance of a schema definition that is an element of <i>S</i> or a component in an element of <i>S</i>, must be valid with respect to that schema definition.
</p><p>This specification does not prescribe the behaviour of a conformant implementation when the set of data model [nodes]<sup><small>XDM</small></sup> in a RIF+XML data combination does not satisfy the above validity constraint, or any relevant constraint from the XPath 2.0, XDM or XSD-CD specifications.
</p>
<a id="Syntax" name="Syntax"></a><h3> <span class="mw-headline">2.1  Syntax </span></h3>
<p>This section addresses how a RIF formula interacts with the XML data, in a RIF+XML data combination; that is, this section specifies how the access to XML data, and to XML schema information, if available, is represented in RIF formulas, for the purpose of combining them.
</p><p>The basic idea is that the object-attribute-value semantics of RIF frame formulas is used, in the combination of RIF formulas and XML data, to exploit the intended semantics of the relation between a [context node]<sup><small>XP</small></sup>, an XPath 2.0 expression and the sequence that the expression matches in the context of the node: in the context of a RIF+XML data combination &lt;<i>R, E, S</i>&gt;, frame formulas of the form <tt>object["<i>some XPath expression</i>"-&gt;val]</tt>, where the <tt>object</tt> term is interpreted as an data model [node]<sup><small>XDM</small></sup> in <i>E</i>, mean that <tt>val</tt> can be derived, in a way to be specified in this document, from the sequence of items that the XPath expression matches in the context of the node denoted by <tt>object</tt>. 
</p><p>This document specifies the semantics of RIF+XML data combinations, in general terms, for any valid XPath 2.0 expression. But some of the details are specified normatively for a limited subset of XPath 2.0 expressions only. Namely, conforming implementations must support the XPath 2.0 expressions specified by the following EBNF grammar:
</p>
<pre>RIFexpr              &nbsp;::= StepExpr | ValueExpr | AbbreviatedExpr
AbbreviatedExpr      &nbsp;::= ElementName | '@' AttributeName
ValueExpr            &nbsp;::= 'fn:data(' ( StepExpr | '.' ) ')'
StepExpr             &nbsp;::= StepAxis ( NameTest | KindTest ) ('[' Position ']')?
StepAxis             &nbsp;::= 'self::' | 'child::' | 'attribute::'
NameTest             &nbsp;::= ElementName | AttributeName
KindTest             &nbsp;::= ElementTest
                          | AttributeTest
                          | SchemaElementTest
                          | SchemaAttributeTest
ElementTest          &nbsp;::= 'element' '(' (ElementNameOrWildcard (',' TypeName '?'?)?)? ')'
SchemaElementTest    &nbsp;::= 'schema-element' '(' ElementDeclaration ')'
ElementDeclaration   &nbsp;::= ElementName
AttributeTest        &nbsp;::= 'attribute' '(' (AttribNameOrWildcard (',' TypeName)?)? ')'
SchemaAttributeTest  &nbsp;::= 'schema-attribute' '(' AttributeDeclaration ')'
AttributeDeclaration &nbsp;::= AttributeName
ElementNameOrWildcard&nbsp;::= ElementName | '*'
ElementName          &nbsp;::= QName
AttribNameOrWildcard &nbsp;::= AttributeName | '*'
AttributeName        &nbsp;::= QName
TypeName             &nbsp;::= QName
Position             &nbsp;::= [1..9] [0..9]*
</pre>
<p>Future versions of this specification may extend that subset.
</p><p>XPath expressions are represented in RIF as <tt>xs:string</tt> constants.
</p>
<p class="ednote"><span class="ednotehead">Editor's Note:</span> Alternatively, an additional symbol space, <tt>rif:xpath</tt>, could be added to <a href="#ref-dtb" title="">RIF built-in data types</a>: in that case, XPath expressions would be represented as <tt>rif:xpath</tt> constants.</p>
<p>XPath 2.0 unabbreviated syntax must be used in the normative RIF/XML syntax, except when the expression is a simple <tt>StepExpr</tt> and the test is a <tt>NameTest</tt>: in that case, the abbreviated syntax must be used in the normative RIF/XML syntax.
</p><p>Both syntaxes, abbreviated and unabbreviated, are allowed in the non-normative RIF presentation syntax.
</p><p>When a string constant is evaluated as an XPath expression, the [statically known namespaces]<sup><small>XP</small></sup> are the in-scope namespaces for the containing element in the RIF formula.
</p><p>Likewise, the object-class and subclass-superclass semantics of RIF member and subclass formulas is used to exploit the intended semantics of the relation between an XML element and its XML schema type, and of the relation between two XML schema types, when information on classes and types definitions is available from imported XML schemas. RIF member formulas of the form: <tt>object&nbsp;#&nbsp; "<i>an XSD-CD component path expression</i>"</tt>, where the <tt>object</tt> term is interpreted as a element [node]<sup><small>XDM</small></sup> <i>e &isin; E</i>, mean that the XML fragment represented by <i>e</i> satisfies the XML schema definition designated by the XSD-CD component path expression.
</p><p>In the same way, subclass expressions of the form: <tt>"<i>sub</i>"&nbsp;##&nbsp;"<i>SUP</i>"</tt> where, both, <tt>"<i>sub</i>"</tt> and <tt>"<i>SUP</i>"</tt> are XSD-CD schema component path expressions, mean that the schema types <i>T<sub>sub</sub></i> and <i>T<sub>SUP</sub></i>, whose definitions are designated by the XSD-CD expressions <tt>"<i>sub</i>"</tt> and <tt>"<i>SUP</i>"</tt>, respectively, satisfy <i>[derived-from]<sup><small>XP</small></sup>(T<sub>sub</sub>, T<sub>SUP</sub>)</i>, where the pseudo-function <i>derives-from</i> is defined as in <a href="#ref-xpath-20" title="">XPath 2.0, section 2.5.4 - Sequence type matching</a>.
</p><p>This specification specifies the semantics of RIF+XML data combinations that contains such member or subclass formulas for a limited subset of XSD-CD expressions, only. Namely, conforming implementations must support absolute XSD-CD expressions that designate schema types, as specified by the following EBNF grammar:
</p><p><span class="anchor" id="def-RIFSchemaComponentPath"></span>
</p>
<pre>RIFSchemaComponentPath      &nbsp;::=  StepSepator RelativeSchemaComponentPath 
RelativeSchemaComponentPath &nbsp;::=  Step (StepSeparator RelativeSchemaComponentPath)?
StepSeparator               &nbsp;::=  '/'
Step                        &nbsp;::=  AbbrevStep
AbbrevStep                  &nbsp;::=  AbbrevElementStep | AbbrevTypeStep
AbbrevElementStep           &nbsp;::=  NameTest
AbbrevTypeStep              &nbsp;::=  '~' NameTest
NameTest                    &nbsp;::=  QName | '0'
</pre>
<p>XSD-CD component path expressions are represented in RIF as <tt>xs:string</tt> constants.
</p>
<p class="ednote"><span class="ednotehead">Editor's Note:</span> Alternatively, an additional symbol space, <tt>rif:xsd-cd</tt>, could be added to <a href="#ref-dtb" title="">RIF built-in data types</a>: in that case, XSD-CD expressions would be represented as <tt>rif:xsd-cd</tt> constants.</p>
<p>XSD-CD abbreviated syntax must be used in the normative RIF/XML syntax. Both abbreviated and unabbreviated syntaxes are allowed in the non-normative RIF presentation syntax.
</p><p><br />
For the purpose of expanding QNames in <tt>NameTest</tt>s, the in-scope namespace bindings are defined as all the namespace declaration in the scope of which the string is.
</p><p><br />
<span class="anchor" id="ex21"></span>
<b>Example 2.1.</b> Consider, for instance, the following rule, that says that an <i>EarlyCustomer</i> is a <i>Customer</i> whose <i>Account</i> number is lower than 1000 (using the RIF presentation syntax and XPath abbreviated syntax):
</p>
<pre>Forall&nbsp;?x,&nbsp;?y
   (_EarlyCustomer(?y)&nbsp;:-
   And(&nbsp;?x["ex:Name" -&gt;&nbsp;?y]
        Exists&nbsp;?z (And&nbsp;?x["ex:Account" -&gt;&nbsp;?z]
                       External(pred:numeric-less-or-equal(External(xs:integer(?z)) 1000)))))
</pre>
<p>Consider, further, the following XML fragment, representing data about customers:
</p>
<pre>&lt;CustomerTable xmlns="http://example.org/customertable"
               xmlns:xml="http://www.w3.org/XML/1998/namespace"&gt;
  &lt;Customer xml:lang="en"&gt;
    &lt;Name&gt; John &lt;/Name&gt;
    &lt;Account&gt; 111 &lt;/Account&gt;
  &lt;/Customer&gt;
  &lt;Customer xml:lang="fr"&gt;
    &lt;Name&gt; Jane &lt;/Name&gt;
    &lt;Account&gt; 222 &lt;/Account&gt;
    &lt;PIN&gt; 222 &lt;/PIN&gt;
  &lt;/Customer&gt;
&lt;/CustomerTable&gt;
</pre>
<p>Assuming, like in all further examples, that the pair <i>(<tt>ex</tt>, <tt>&lt;http://example.org/customertable&gt;</tt>)</i> belongs to the statically known namespaces when the XPath expressions are evaluated, the combination, under the semantics described below, of the above rule and XML data, with no associated XML schema, will entail two new facts, namely:
</p>
<pre> _EarlyCustomer("John")
 _EarlyCustomer("Jane")
</pre>
<p>This rule shows how an XPath expression is used, in the rule, as an <tt>xs:string</tt> constant, e.g.: <tt>"ex:Name"</tt> or <tt>"ex:Account"</tt>, to access the children of an element [node]<sup><small>XDM</small></sup> as frame slots.
</p><p>Notice that, in the absence of classes and types definitions as would be provided by an associated XML schema, <tt>NameTest</tt> are enough to exploit all the information that is avalable in the XML data, in the combination. Notice further that, with no typing information available, atomic values retrieved from the XML data can only be interpreted as strings. A consequence is that such values have to be cast into the required types when used as arguments to RIF buit-in functions and predicates.
</p><p>Notice, also, that, for the same reason, member (or subclass) formulas cannot be used in combination with the XML data: the only way (based only on the information that is available in the example) to ensure that only the <tt>ex:Name</tt> and <tt>ex:Account</tt> sub-elements of <tt>ex:Customer</tt> elements are taken into account would be to add a frame formula to the condition, to check that the variable <tt>?x</tt> is bound to an element that is, itself, named <tt>ex:Customer"</tt>:
</p>
<pre>Forall&nbsp;?x,&nbsp;?y
   (_EarlyCustomer(?y)&nbsp;:-
   And(&nbsp;?x["ex:Name" -&gt;&nbsp;?y]
       &nbsp;?x["self::ex:Customer"-&gt;?x]
        Exists&nbsp;?z (And&nbsp;?x["ex:Account" -&gt;&nbsp;?z]
                       External(pred:numeric-less-or-equal(External(xs:integer(?z)) 1000)))))
</pre>
<p>Notice that, in the absence of an XML schema against which the data must be valid, the fact <tt>?x["self::ex:Customer"-&gt;?x]</tt> does not entail anything with respect to other properties of <tt>?x</tt>.
</p><p>Now, assume that the following XML schema is associated with the above XML fragment:
</p>
<pre>&lt;xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema"
           xmlns:xml="http://www.w3.org/XML/1998/namespace"
           targetNamespace="&lt;nowiki&gt;http://example.org/customertable&lt;/nowiki&gt;"
           xmlns="&lt;nowiki&gt;http://example.org/customertable&lt;/nowiki&gt;"&gt;  

  &lt;xs:simpleType name="PIN"&gt;
    &lt;xs:restriction base="xs:integer"&gt;
      &lt;xs:minInclusive value="100"/&gt;
      &lt;xs:maxExclusive value="1000"/&gt;
    &lt;/xs:restriction&gt;
  &lt;/xs:simpleType&gt;

  &lt;xs:element name="Name" type="xs:string"/&gt;
  &lt;xs:element name="Account" type="xs:integer"/&gt;
  &lt;xs:element name="PIN" type="PIN"/&gt;
  
  &lt;xs:element name="Customer"&gt;
    &lt;xs:complexType&gt;
      &lt;xs:sequence&gt;
        &lt;xs:element ref="Name"/&gt;
        &lt;xs:element ref="Account"/&gt;
        &lt;xs:element ref="PIN" minOccurs="0"/&gt;
      &lt;/xs:sequence&gt;
    &lt;/xs:complexType&gt;
    &lt;xs:attribute ref="xml:lang"/&gt;
  &lt;/xs:element&gt;

  &lt;xs:element name="CustomerTable"&gt;
    &lt;xs:complexType&gt;
      &lt;xs:all&gt;
        &lt;xs:element ref="Customer" minOccurs="0"/&gt;
      &lt;/xs:all&gt;
    &lt;/xs:complexType&gt;
  &lt;/xs:element&gt;

&lt;/xs:schema&gt;
</pre>
<p>When the XML schema is associated with the data, in the RIF+XML data combination, typing information can be taken into account, both, to focus on the data that represent customer information (that is, information represented in <tt>ex:Customer</tt> elements), and to ensure that arguments to built-in functions and predicates are properly typed. The example rule could, then, be written as follows (notice that this version of the rule uses unabbreviated XPath syntax):
</p>
<pre>Forall&nbsp;?x,&nbsp;?y
    (_EarlyCustomer(?y)&nbsp;:-
    And(&nbsp;?x # "/ex:Customer"
        &nbsp;?x["child::schema-element(ex:Name)" -&gt;&nbsp;?y]
         Exists&nbsp;?z (And&nbsp;?x["child::schema-element(ex:Account)" -&gt;&nbsp;?z]
                        External(pred:numeric-less-or-equal(?z 1000)))))
</pre>
<p>In that case, the assertion of the class membership: <tt>?x # "/ex:Customer"</tt>, entails that <tt>?x</tt> has all the properties that are required to validate against the schema definition of the element <tt>ex:Customer</tt>.
</p><p>Another rule example, below, shows how another kind of XPath expression, used as an <tt>xs:string</tt> constant: <tt>"@xml:lang"</tt>, is used, in a RIF+XML data combination, to access an attribute [node]<sup><small>XDM</small></sup> as a frame slot:
</p>
<pre>Forall&nbsp;?x,&nbsp;?y
   (_SpeaksEnglish(?y)&nbsp;:-
   And(&nbsp;?x["@xml:lang" -&gt; "en"^^xs:language])
       &nbsp;?x["ex:Name" -&gt;&nbsp;?y])
</pre>
<p>Assuming that the pair <i>(<tt>xml</tt>, <tt>&lt;http://www.w3.org/XML/1998/namespace&gt;</tt>)</i> is also in the statically known namespaces, that rule, combined with the example XML data and XML schema, entails a single new fact:
</p>
<pre>_SpeaksEnglish("John")
</pre>
<p>Notice that all the rules, above, are well-formed RIF formulas, that can be validly consumed without being combined with any XML data and/or XML schemas. In that case, of course, this specification adds nothing to the specification of the <a href="#ref-core" title="">RIF Core Dialect</a>, as regards the semantics of the rules.
</p><p><span class="anchor" id="sec-model-theoretic-semantics-of-rif-bld.2Bxml-data-combinations"></span>
</p>
<a id="Model-theoretic_semantics_of_RIF_BLD.2BXML_data_combinations" name="Model-theoretic_semantics_of_RIF_BLD.2BXML_data_combinations"></a><h3> <span class="mw-headline">2.2  Model-theoretic semantics of RIF BLD+XML data combinations </span></h3>
<p>The specification of the model-theoretic semantics of a RIF BLD+XML data combination -- a <a href="#def-rif.2Bxml-data-combination" title="">RIF+XML data combination</a>, <i>&lt;R, E, S&gt;</i>  where <i>R</i> is a RIF-BLD (document or non-document) formula -- follows closely the specification of the semantics of a RIF BLD formula, except that the notion of semantic structures is replaced by the notion of <i>RIF BLD+XML data combined interpretations</i>: informally, RIF BLD+XML data combined interpretations are <a href="http://www.w3.org/TR/2013/REC-rif-bld-20130205/#Semantic_Structures" title="BLD">RIF BLD semantic structures</a>, extended with an additional mapping, <i><b>I</b></i><sub>DM</sub>, that interprets data model [nodes]<sup><small>XDM</small></sup>, and constrained with additional conditions, derived from the information in <i>E</i> and <i>S</i>.
</p><p><span class="anchor" id="sec-semantic-structures"></span>
</p>
<a id="Semantic_structures" name="Semantic_structures"></a><h4> <span class="mw-headline">2.2.1  Semantic structures </span></h4>
<p><span class="anchor" id="def-semantic-structure"></span>
<b>Definition (Semantic structure).</b> For the purpose of defining the model-theoretic semantics of a RIF BLD+XML data combination &lt;<i>R, E, S</i>&gt;, a semantic structure is as a tuple <i>I</i> =
&lt;<i><b>TV</b></i>, <i><b>DTS</b></i>, <i><b>D</b></i>, <i><b>D</b></i><sub>ind</sub>,
<i><b>D</b></i><sub>func</sub>, <i><b>I</b></i><sub>DM</sub>, <i><b>I</b></i><sub>C</sub>, <i><b>I</b></i><sub>V</sub>,
<i><b>I</b></i><sub>F</sub>, <i><b>I</b></i><sub>NF</sub>, <i><b>I</b></i><sub>list</sub>, <i><b>I</b></i><sub>tail</sub>, <i><b>I</b></i><sub>frame</sub>,
<i><b>I</b></i><sub>sub</sub>, <i><b>I</b></i><sub>isa</sub>, <i><b>I</b></i><sub>=</sub>,
<i><b>I</b></i><sub>external</sub>, <i><b>I</b></i><sub>truth</sub>&gt;, where <i><b>TV</b></i>, <i><b>DTS</b></i>, <i><b>D</b></i>, <i><b>D</b></i><sub>ind</sub>,
<i><b>D</b></i><sub>func</sub>, <i><b>I</b></i><sub>C</sub>, <i><b>I</b></i><sub>V</sub>,
<i><b>I</b></i><sub>F</sub>, <i><b>I</b></i><sub>NF</sub>, <i><b>I</b></i><sub>list</sub>, <i><b>I</b></i><sub>tail</sub>, <i><b>I</b></i><sub>frame</sub>,
<i><b>I</b></i><sub>sub</sub>, <i><b>I</b></i><sub>isa</sub>, <i><b>I</b></i><sub>=</sub>,
<i><b>I</b></i><sub>external</sub> and <i><b>I</b></i><sub>truth</sub> are defined as in RIF-BLD ([<a href="#ref-bld" title="">RIF-BLD</a>], section 3.2, Semantic structures), and where
</p>
<ul><li> <i><b>I</b></i><sub>DM</sub> is a total mapping from <i>E</i> to <i><b>D</b></i><sub>ind</sub>, that interprets data model [nodes]<sup><small>XDM</small></sup>.
</li></ul>
<p><span class="anchor" id="sec-combined-interpretation-of-rif-bld.2Bschemaless-xml-data"></span>
</p>
<a id="Combined_interpretation_of_RIF_BLD_non-document_formulas_and_XML_data" name="Combined_interpretation_of_RIF_BLD_non-document_formulas_and_XML_data"></a><h4> <span class="mw-headline">2.2.2  Combined interpretation of RIF BLD non-document formulas and XML data </span></h4>
<p>Let <i>Classifiers(S)</i> denote the set of all the well-formed <a href="#def-RIFSchemaComponentPath" title=""><tt>RIFSchemaComponentPath</tt></a> expressions, <i>expr</i>, such that one of the following holds, where <i>c</i> is the component selected by <i>expr</i> in the context of <i>S</i>:
</p>
<ul><li> either <i>c</i> defines a named complex type, that is, the [component-kind()]<sup><small>CD</small></sup> of <i>c</i> is <tt>xscd:complex-type-definition</tt> and its [component-name()]<sup><small>CD</small></sup> is a QName;
</li><li> or <i>c</i> is the declaration of or a reference to an element with an anonymous complex type, that is: the [component-kind()]<sup><small>CD</small></sup> of <i>c</i> is <tt>xscd:element-declaration</tt>, its [component-name()]<sup><small>CD</small></sup> is a QName, the [component-kind()]<sup><small>CD</small></sup> of the child component of <i>c</i> along the [type axis]<sup><small>CD</small></sup> is <tt>xscd:complex-type-declaration</tt> and its [component-name()]<sup><small>CD</small></sup> is '0' (indicating an anonymous component).
</li></ul>
<p>Let, further, <i>Classes(S) &sube; Classifiers(S)</i> denote the subset of classifier XSD-CD expressions that select the declarations of named complex types.
</p><p><span class="anchor" id="def-rif-bld.2Bxml-data.2Bschema-combined-interpretation"></span>
<b>Definition (RIF BLD+XML data combined interpretation).</b> A <i><b>RIF BLD+XML data combined interpretation</b></i> is a triple (<i>E</i>, <i>I</i>, <i>S</i>), where <i>E</i> is a set of data model [nodes]<sup><small>XDM</small></sup>, possibly empty; <i>S</i> is a set of XML schema definitions, possibly empty; and <i>I</i> is a <a href="#def-semantic-structure" title="">semantic structure</a>, such that all the following holds:
</p>
<ol><li> For all the [nodes]<sup><small>XDM</small></sup> <i>e &isin; E</i>, <i><b>I</b></i><sub>truth</sub>(<i>I</i><sub>frame</sub>(<i>I</i><sub>DM</sub>(<i>e</i>))(<i>I</i><sub>C</sub>(<tt>"</tt><i>expr</i><tt>"^^xs:string</tt>), <i>RIFValue(e, expr)</i>)) = <b>t</b> (true) for any well-formed XPath expression, <i>expr</i>, for which <i>RIFValue(e, expr)</i> is defined; and
</li><li> For all the individuals <i>o &isin; D<sub>Ind</sub></i>, there is an element [node]<sup><small>XDM</small></sup> with a complex type, <i>e &isin; E</i>, such that <i>I</i><sub>DM</sub>(<i>e</i>) = <i>o</i>, if and only if there is an XSD-CD component path expression, <i>expr &isin; Classifiers(S)</i>, such that <i><b>I</b></i><sub>truth</sub>(<i>I</i><sub>isa</sub>(<i>o</i>, <i>I</i><sub>C</sub>(<tt>"</tt><i>expr</i><tt>"^^xs:string</tt>))) = <b>t</b> (true) and
<ul><li> either <i>expr &isin; Classes(S)</i> and the expanded QName of the type in the selected definition is equal to the [declared type]<sup><small>XDM</small></sup> of <i>e</i>;
</li><li> or <i>e</i> represents an XML element that satisfies the element definition selected by <i>expr</i>;
</li></ul>
</li><li> <i><b>DTS</b></i> is extended to include all the named atomic types defined in the [in-scope schema definitions]<sup><small>XP</small></sup>;
</li><li> <i><b>I</b></i><sub>truth</sub>(<i>I</i><sub>sub</sub>(<i>I</i><sub>C</sub>(<tt>"</tt><i>T<sub>1</sub></i><tt>"^^xs:string</tt>), <i>I</i><sub>C</sub>(<tt>"</tt><i>T<sub>2</sub></i><tt>"^^xs:string</tt>)) = <b>t</b> (true) for all the pairs of XSD-CD component expressions, <i>(T<sub>1</sub>, T<sub>2</sub>) &isin; Classes(S) &times; Classes(S)</i>, that select two complex types, <i>t<sub>1</sub></i> and <i>t<sub>2</sub></i>, such that <i>[derives-from]<sup><small>XP</small></sup>(t<sub>1</sub>, t<sub>2</sub>)</i> is true;
</li></ol>
<p>☐
</p><p>Notice that clause 2, in the above definition, implies that, if the class membership of an object that interprets the [context node]<sup><small>XP</small></sup> <i>e</i>, in a classifier amongst the schema definitions in the combined interpretation is asserted, then the object must have all the properties that are mandated by the classifier, and no property that the definition of the classifier does not allow. This is a consequence of the constraint that all the schema element [node]<sup><small>XDM</small></sup>, in <i>E</i>, must be schema valid.
</p>
<p class="ednote"><span class="ednotehead">Editor's Note:</span> Another possibility, to resolve the issue of incomplete instances, would be to introduce one or more null values in the RIF vocabulary, e.g. <tt>rif:null</tt>.</p>
<p><i>RIFValue</i> is a total mapping from <i>E &times; EXPR</i> to <i>D</i><sub>ind</sub>, where <i>EXPR</i> is the set of all the well-formed XPath expressions. <i>RIFValue(e, expr)</i> associates a value in <i>D</i><sub>ind</sub> to the sequence of data model [nodes]<sup><small>XDM</small></sup>, in <i>E</i>, that are matched by the XPath expression <i>expr</i> when the [context node]<sup><small>XP</small></sup> is <i>e</i> and <i>S</i> contains the [in-scope schema definitions]<sup><small>XP</small></sup>.
</p><p><i>RIFValue</i> is defined as follows.
</p><p>Let <i>seq = (i<sub>1</sub>,...,i<sub>n</sub>)</i> be the sequence of items matched by <i>expr &isin; EXPR</i> in the context of <i>e &isin; E</i>, where <i>n &ge; 0</i> is the number of items in <i>seq</i>:
</p>
<ul><li> if <i>n &gt; 1</i>, <i>val</i> = <i>I</i><sub>list</sub>(<i>Val(i<sub>1</sub>)</i>,...,<i>Val(i<sub>n</sub>)</i>)
</li><li> if <i>n = 1</i>,
<ol><li> if <i>seq = (i)</i> is the [typed value]<sup><small>XDM</small></sup> of an element or attribute [node]<sup><small>XDM</small></sup> with a list type, then <i>val</i> = <i>I</i><sub>list</sub>(<i>Val(i)</i>);
</li><li> else, if <i>expr</i> selects an schema attribute or child element that is optional (that is, zero or one occurrence) in the context of <i>e</i>, then <i>val = Val(i)</i>;
</li><li> else, if <i>i</i> is a schema element [node]<sup><small>XDM</small></sup>, and the schema definition of <i>e</i> allows for multiple occurrences of that schema element, then <i>val</i> = <i>I</i><sub>list</sub>(<i>Val(i)</i>);
</li><li> otherwise, <i>val</i> = <i>I</i><sub>list</sub>(<i>Val(i)</i>) or <i>val = Val(i)</i>: according to the XPath 2.0 specification, an item is identical to a singleton sequence containing that item. Except for the multiple occurences and list type cases, that must be handled as specified above, the decision to handle a singleton as a single item or as a singleton sequence that contains that item is left to the implementation, but it must be consistent: that is, the sequence matched by the same XPath expression, <i>expr &isin; EXPR</i>, must be handled the same way, as a sequence or as an item, for all the [context nodes]<sup><small>XP</small></sup>, <i>e &isin; E</i>;
</li></ol>
</li><li> if <i>n = 0</i>, that is, if <i>expr</i> matches no item in the context of <i>e</i>,
<ol><li> if <i>expr</i> selects a schema element for which the schema allows zero to more than one occurences in the context of <i>e</i>, then <i>val</i> = <i>I</i><sub>list</sub>(<i>&empty;</i>);
</li><li> otherwise, <i>RIFValue(e, expr)</i> is undefined.
</li></ol>
</li></ul>
<p><br />
<i>Val</i> interprets items as follows:
</p>
<ul><li> if <i>i</i> is an atomic value with type <tt>xs:untypedAtomic</tt>, then <i>Val(i)</i> is the value of <i>i</i> as an <tt>xs:string</tt>;
</li><li> else, if <i>i</i> is an atomic value, <i>Val(i) = i</i>;
</li><li> else, if <i>i</i> is a [node]<sup><small>XDM</small></sup> without a type name, or whose type name is <tt>xs:untyped</tt> or <tt>xs:untypedAtomic</tt>, with no attributes and with no or only text [node]<sup><small>XDM</small></sup> children, then <i>Val(i)</i> is the [string value]<sup><small>XDM</small></sup> of <i>i</i>: <i>Val(i)</i> = <tt>fn:string(</tt><i>i</i><tt>)</tt>;
</li><li> else, if <i>i</i> is a [node]<sup><small>XDM</small></sup> with a simple type, then
<ul><li> if <i>i</i> is a [node]<sup><small>XDM</small></sup> with a list type, then <i>val</i> is the [typed value]<sup><small>XDM</small></sup> of <i>i</i> as a RIF list: <i>Val(i) = I</i><sub>list</sub>(<tt>fn:data(</tt><i>i</i><tt>)</tt>);
</li><li> otherwise <i>Val(i)</i> is the [typed value]<sup><small>XDM</small></sup> of <i>i</i>: <i>Val(i)</i> = <tt>fn:data(</tt><i>i</i><tt>)</tt>;
</li></ul>
</li><li> otherwise, that is, if <i>i</i> is a [node]<sup><small>XDM</small></sup> with a complex type, then <i>Val(i)</i> is the interpretation of <i>i</i> according to <i>I</i><sub>DM</sub>: <i>Val(i)</i> = <i>I</i><sub>DM</sub>(<i>i</i>).
</li></ul>
<p>In the above, <tt>fn:string</tt> and <tt>fn:data</tt> are the accessors defined in the <a href="#ref-xfo" title="">Xpath 2.0 and XQuery 1.0 Functions and Operators</a> recommendation [<a href="#ref-xfo" title="">XFO</a>], sections 2.3 and 2.4 (for the reader's convenience, the definitions are copied, non-normatively, in the <a href="#appendix-glossary" title="">Glossary</a>.)
</p><p>A RIF BLD+XML data combined interpretation (<i>E, I, S</i>) determines the truth value, <i>TVal<sub>(E,I,S)</sub>(&phi;)</i>, of a RIF-BLD non-document formula &phi; combined with the XML data in <i>E</i> and XML schema definitions in <i>S</i>, like a RIF BLD semantic structure, <i>I<sub>BLD</sub></i>, determines the truth value <i>TVal<sub>I<sub>BLD</sub></sub>(&phi;)</i>, of a RIF-BLD non-document formula &phi;. The mapping <i>TVal<sub>(E,I,S)</sub></i> is defined from the set of all non-document formulas to <b>TV</b>, the set of truth values in <i>I</i>, as follows.
</p><p><b>Definition (Truth valuation of RIF BLD non-document formulas combined with XML data).</b> <i><b>Truth valuation</b></i> of RIF BLD non-document formulas combined with XML data is determined using the function <i>TVal<sub>(E,I,S)</sub></i>, such that for all RIF BLD+XMl data combination, &lt;<i>&phi;, E, S</i>&gt;, where <i>&phi;</i> is a non-document RIF BLD formula, <i>TVal<sub>(E,I,S)</sub>(&phi;) = TVal<sub>I</sub>(&phi;)</i>, where <i>TVal<sub>I</sub></i> is as defined in [<a href="#ref-bld" title="">RIF-BLD</a>], section 3.4 - Interpretation of non-document formulas, with <i>I</i> being the semantic structure in the RIF BLD+XML data combined interpretation (<i>E, I, S</i>).&nbsp;&nbsp;☐
</p><p><span class="anchor" id="ex22"></span>
<b>Example 2.2.</b> Assuming that <i>E</i> contains all the data model [nodes]<sup><small>XDM</small></sup> in the data model instance that describes the XML sample fragment in <a href="#ex21" title="">example 2.1</a>; that <i>e<sub>table</sub></i> denotes the element node, in <i>E</i>, that represents the information that is serialized in the <tt>CustomerTable</tt> element, in the example XML fragment; and that <i>e<sub>John</sub></i> denotes the element node, in <i>E</i>, that represents the information that is serialized in the first <tt>Customer</tt> sub-element (the one whose <tt>Name</tt> sub-element contains <i>John</i>), the following ground frames must be true in all the RIF BLD+XML data combined interpretations, (<i>E, I, &empty;</i>), that is, where <i>E</i> is constructed from the infoset only, and where <i>I</i><sub>C</sub>(<tt>_John</tt>) = <i>I</i><sub>DM</sub>(<i>e<sub>John</sub></i>) and <i>I</i><sub>C</sub>(<tt>_Table</tt>) = <i>I</i><sub>DM</sub>(<i>e<sub>table</sub></i>):
</p>
<ol><li> <tt>_John ["@xml:lang" -&gt; "en"]</tt> 
</li><li> <tt>_John ["ex:Name" -&gt; "John"]</tt>
</li><li> <tt>_John ["ex:Account" -&gt; "111" ]</tt>
</li><li> <tt>_Table ["ex:Customer[1]" -&gt; _John ]</tt>
</li></ol>
<p>Assuming that <i>S</i> contains all the top-level schema definitions in the sample schema in <a href="#ex21" title="">example 2.1</a>, ground frames #1 and #3 above must be false in all the RIF BLD+XML data combined interpretations, (<i>E, I, S</i>), everything else being equal; instead, ground frames #1 and #2, below, must be true: 
</p>
<ol><li> <tt>_John ["@xml:lang" -&gt; "en"^^xs:language]</tt>
</li><li> <tt>_John ["ex:Account" -&gt; 111 ]</tt>
</li></ol>
<p>The class membership formula #1, below, may be true in a RIF BLD+XML data combined interpretation, (<i>E, I, &empty;</i>), but, in the absence of an associated schema definition, the string <tt>/ex:Customer</tt> does not represent a component designator, and the class membership formula has no meaning specific to the RIF BLD+XML data combined interpretation. However, that same class membership formula must be true in every RIF BLD+XML data combined interpretations, (<i>E, I, S</i>): 
</p>
<ol><li> <tt>_John # "/ex:Customer"</tt>
</li></ol>
<p>On the other hand, the class membership formula: <tt>_PIN_Jane # "/ex:PIN"</tt> must never be true as a consequence of being interpreted under a RIF BLD+XML data combined interpretations, (<i>E, I, S</i>). Indeed, <tt>ex:PIN</tt> is defined as a simple type: as such it is not in <i>Classes(S)</i> (nor in <i>Classifiers(S)</i>); but it is, instead, added to <i><b>DTS</b></i>.
</p><p><span class="anchor" id="ex23"></span>
<b>Example 2.3.</b> Consider the following element with mixed-content, where the prefix <tt>ex</tt> is associated with the IRI <i>http://example.org/</i>, and assume that an element [node]<sup><small>XDM</small></sup>, <i>e</i>, that represents it is included in <i>E</i>.
</p>
<pre>&lt;ex:letterBody&gt;
  Thank you for ordering the &lt;ex:item&gt;widget&lt;/ex:item&gt;.
  It should arrive by &lt;ex:arrivalDate&gt;09-09-09&lt;/ex:arrivalDate&gt;
&lt;/ex:letterBody&gt;
</pre>
<p>The following fact must be true in any RIF BLD+XML data combined interpretation, <i>(E, I, S)</i>, such that <i>I</i><sub>C</sub>(<tt>_myLetter</tt>) = <i>I</i><sub>DM</sub>(<i>e</i>):
</p>
<ul><li> <tt>_myLetter["fn:data(.)" -&gt; "Thank you for ordering the Widget. It should arrive by 09-09-09"]</tt>
</li></ul>
<p>Indeed, the element has a mixed content: per [<a href="#ref-xdm" title="">XDM</a>] (section 6.2), its [typed value]<sup><small>XDM</small></sup> is, therefore, its string value as an <tt>xs;untypedAtomic</tt>, which is represented, per the definition of <i>RIFValue</i>, above, by that same [string value]<sup><small>XDM</small></sup> as an <tt>xs:string</tt>.
</p><p><span class="anchor" id="sec-combined-interpretation-rif-bld-document.2Bxml-data"></span>
</p>
<a id="Combined_interpretation_of_RIF_BLD_documents_and_XML_data" name="Combined_interpretation_of_RIF_BLD_documents_and_XML_data"></a><h4> <span class="mw-headline">2.2.3  Combined interpretation of RIF BLD documents and XML data </span></h4>
<p>For the purpose of the interpretation of imported documents, RIF BLD defines the notion of semantic multi-structures, which are nonempty sets, {<i>J,I; I<sup>i<sub>1</sub></sup>, I<sup>i<sub>2</sub></sup>, ...</i>},  of semantic structures that differ only in interpretation of local constants.
</p><p>In the same way, a RIF-BLD+XML data combination &lt;<i>R, E, S</i>&gt;, is interpreted using a RIF BLD+XML data combined multi-interpretation (<i>E</i>, <i>&Icirc;</i>, <i>S</i>), where <i>&Icirc;</i> is a nonempty set, {<i>J,I; I<sup>i<sub>1</sub></sup>, I<sup>i<sub>2</sub></sup>, ...</i>}, of semantic structures that determine a non-empty set, {(<i>E, J, S</i>), (<i>E, I, S</i>); (<i>E, I<sup>i<sub>1</sub></sup>, S</i>), (<i>E, I<sup>i<sub>2</sub></sup>, S</i>), ...} of RIF BLD+XML data combined interpretations that differ only in the interpretation of local constants.
</p><p>To keep this document simple, and in the same way the definition of truth valuation of RIF BLD formulas combined with XML data, above, refers to the definition of truth valuation in the <a href="#ref-bld" title="">RIF-BLD recommendation</a>, the definition of a RIF BLD+XML data combined multi-interpretation refers to the definition of a semantic multi-structure in [<a href="#ref-bld" title="">RIF-BLD</a>]. 
</p><p><b>Definition (RIF BLD+XML data combined multi-interpretation).</b>
A <i><b>RIF BLD+XML data combined multi-interpretation</b></i> is a triple, (<i>E</i>, <i>&Icirc;</i>, <i>S</i>), where <i>&Icirc;</i> is a <a class="external text" href="http://www.w3.org/TR/rif-bld/#def-bld-semantic-multistruct" rel="nofollow" title="http://www.w3.org/TR/rif-bld/#def-bld-semantic-multistruct">semantic multi-structures</a> as defined in [<a href="#ref-bld" title="">RIF-BLD</a>] (section 3.5 - Interpretation of documents), with the additional condition that for each semantic suctrure, <i>i &isin; &Icirc;</i>, (<i>E, i, S</i>) is a RIF BLD+XML data combined interpretation.&nbsp;&nbsp;☐ 
</p><p>Similarly, the truth valuation of a RIF+XML data combination &lt;<i>R, E, S</i>&gt;, is specified with reference to the truth valuation of a RIF BLD document formulas, using the RIF BLD+XML data combined multi-interpretation (<i>E</i>, <i>&Icirc;</i>, <i>S</i>) in place of a RIF-BLD semantic multi-structure.
</p><p><b>Definition (Truth valuation of RIF BLD document formulas combined with XML data).</b> <i><b>Truth valuation</b></i> of RIF BLD document formulas combined with XML data is determined using the function <i>TVal<sub>(E,&Icirc;,S)</sub></i>, such that for all RIF BLD+XML data combination &lt;<i>&Rho;, E, S</i>&gt;, where <i>&Rho;</i> is a document RIF BLD formula, <i>TVal<sub>(E,&Icirc;,S)</sub>(&Rho;) = TVal<sub>&Icirc;</sub>(&Rho;)</i>, where <i>TVal<sub>&Icirc;</sub></i> is as defined in [<a href="#ref-bld" title="">RIF-BLD</a>], section 3.5 - Interpretation of documents, with <i>&Icirc;</i> being the semantic multi-structure in the RIF BLD+XML data combined multi-interpretation (<i>E, &Icirc;, S</i>).&nbsp;&nbsp;☐
</p><p>The notions of model and of logical entailment can be defined for a RIF BLD+XML data combination, based on the definitions of model and of logical entailment for RIF BLD (document and non-document) formulas: (<i>E, &Icirc;, S</i>) is a model of a RIF BLD+XML data combination &lt;<i>R, E, S</i>&gt;, if and only if <i>&Icirc;</i> is a model of <i>R</i>, in the sense defined in [<a href="#ref-bld" title="">RIF-BLD</a>] (section 3.6 - Logical entailment), and (<i>E, &Icirc;, S</i>) is a RIF BLD+Xml data combined multi-interpretation.
</p><p><b>Definition (Model of a RIF BLD+XML data combination).</b> A RIF BLD+XML data combined multi-interpretation (<i>E</i>, <i>&Icirc;</i>, <i>S</i>) is a <i><b>model</b></i> of a RIF BLD+XML data combination &lt;<i>R, E, S</i>&gt;, where <i>R</i> is a RIF BLD document or non-document formula, if and only if <i>TVal<sub>(E,&Icirc;,S)</sub>(R)</i> = <b>t</b> (true).&nbsp;&nbsp;☐
</p><p><b>Definition (Logical entailment of a RIF BLD+XML data combination).</b>
Let <tt>&phi;</tt> and <tt>&psi;</tt> be (document or non-document) formulas. We say that a RIF BLD+XML data combination &lt;<i>&phi;, E, S</i>&gt; <i><b>entails</b></i> the RIF BLD+XML data combination &lt;<i>&psi;, E, S</i>&gt;, denoted &lt;<i>&phi;,&nbsp;E,&nbsp;S</i>&gt;&nbsp;|=&nbsp;&lt;<i>&psi;,&nbsp;E,&nbsp;S</i>&gt;, if and only if every model of the RIF BLD+XML data combination &lt;<i>&phi;, E, S</i>&gt; is also a model of the RIF BLD+XML data combination &lt;<i>&psi;, E, S</i>&gt;.&nbsp;&nbsp;☐
</p><p>Notice that, in the case where <i>E</i> and <i>S</i> are empty, that is, if a RIF-BLD formula is combined with an empty XML data set and an empty set of XML schema definitions, the interpretation of that RIF BLD formula under a RIF BLD+XML data combined multi-interpretation (<i>&empty;</i>, <i>&Icirc;</i>, <i>&empty;</i>) is still different from its interpretation under the standard RIF BLD semantics as defined in [<a href="#ref-bld" title="">RIF BLD</a>].
</p><p><span class="anchor" id="ex24"></span>
<b>Example 2.4.</b> Let <i>expr</i> be a well-formed XPath 2.0 expression, and let
</p>
<ul><li> &phi; = <tt>Forall&nbsp;?x&nbsp;?y&nbsp;?z (?x["fn:data(expr)"-&gt;?z]&nbsp;:-&nbsp;?x["expr"-&gt;?y])</tt>
</li><li> &psi; = <tt>Forall&nbsp;?x&nbsp;?y&nbsp;?z (?y["fn:data(.)"-&gt;?z]&nbsp;:-&nbsp;?x["expr"-&gt;?y])</tt>
</li></ul>
<p>Notice that &lt;<i>&phi;,&nbsp;&empty;,&nbsp;&empty;</i>&gt;&nbsp;|=&nbsp;&lt;<i>&psi;,&nbsp;&empty;,&nbsp;&empty;</i>&gt;, provided that the pair <i>(<tt>fn</tt>, <tt>http://www.w3.org/2005/xpath-functions</tt>)</i> belongs to the statically known namespaces when the XPath expressions are evaluated; but <i>&phi;</i>&nbsp;|&ne;&nbsp;<i>&psi;</i>. This is because the <tt>xs:string</tt> constants <tt>"expr"</tt>, <tt>"fn:data(expr)"</tt> and <tt>"fn:data(.)"</tt> are interpreted as simple string constants under the standard RIF BLD semantics, whereas they are interpreted according to the XPath 2.0 semantics under the semantics of RIF+XML data combination.
</p>
<p class="ednote"><span class="ednotehead">Editor's Note:</span> An alternative, less conservative definition for logical entailment in a RIF BLD+XML data combination would be: <i>Let <tt>&phi;</tt> and <tt>&psi;</tt> be (document or non-document) formulas. We say that <tt>&phi;</tt> entails <tt>&psi;</tt> in a RIF BLD+XML data combination if and only if every model (</i>E, &Icirc;, S<i>) of any RIF BLD+XML data combination &lt;</i>&phi;, E, S<i>&gt; is also a model of the RIF BLD+XML data combination &lt;</i>&psi;, E, S<i>&gt;.</i>☐ The use cases for the broader definition remain to be examined.</p>
<p><br />
<span class="anchor" id="sec-semantics-of-rif-prd.2Bxml-data-combinations"></span>
</p>
<a id="Operational_semantics_of_RIF_PRD.2BXML_data_combinations" name="Operational_semantics_of_RIF_PRD.2BXML_data_combinations"></a><h3> <span class="mw-headline">2.3  Operational semantics of RIF PRD+XML data combinations </span></h3>
<p>The effect on the operational semantics of a RIF PRD formula of the combination with XML data, with or without an associated XML schema, is that all the ground facts that must be true under a <a href="#def-rif-bld.2Bxml-data.2Bschema-combined-interpretation" title="">RIF BLD+XML data combined interpretation</a>, must be added to the set of ground facts that represents the <a href="http://www.w3.org/TR/2013/REC-rif-prd-20130205/#def-state" title="PRD">state of the fact base</a>.
</p><p>Notice that, whereas the other clauses affect only the initial state of the fact base, clause 2 in the definition of a <a href="#def-rif-bld.2Bxml-data.2Bschema-combined-interpretation" title="">RIF BLD+XML data combined interpretation</a> modifies the semantics of the <tt>Assert</tt> action, when the action asserts the membership of a new object in a class that is interpreted as a schema classifier. Indeed, clause 2, in the definition, implies that the object in a membership relationship with an XML schema classifier (element or type) must interpret an instance of the class: that is, the new member object must validate against the schema definition associated to the class. As a consequence, in the context of a RIF PRD+XML data combination, &lt;<i>R, E, S</i>&gt;,
</p>
<pre>Assert( object # ClassExpr )
</pre>
<p>where <i><tt>ClassExpr</tt> &isin; Classifiers(S)</i>, requires, as a prerequisite, that, for all the XPath 2.0 expressions, <i><tt>expr</tt></i>, that select a mandatory sub-element or attribute of the class, the following fact be true:
</p>
<pre>object [ "expr" -&gt; value ]
</pre>
<p>where <tt>value</tt> has a value that is valid with respect to the schema definition of the selected sub-element or attribute.
</p><p>Formally, that means that the definition of the RIF-PRD transition relation, defined in [<a href="#ref-prd" title="">RIF-PRD</a>] (section 3.2, Operational semantics of atomic actions), is modified as follows.
</p><p>Let <i>W</i> denote the set of all the states of the fact base, and <i>L</i> denote the set of all the ground atomic actions in the RIF-PRD action language, as defined in [<a href="#ref-prd" title="">RIF-PRD</a>].
</p><p>Let, further, <i>expr</i>-valid<sub>&lt;<i>R,E,S</i>&gt;</sub>, denote a property of a constant, <i><tt>o</tt> &isin; <tt>Const</tt></i>, with respect to a state of the fact base, <i>w &isin; W</i>, in the context of a RIF PRD+XML data combination &lt;<i>R, E, S</i>&gt;. We say that <tt>o</tt> is <i>expr</i>-valid<sub>&lt;<i>R,E,S</i>&gt;</sub> in <i>w</i> if and only if <i>expr &isin; Classifiers(S)</i> and all the following are true, where <i>&Phi;</i> is a set of ground atomic formulas that represents <i>w</i>:
</p>
<ul><li> for each child element, <i>c</i>, with QName: <i><tt>name</tt></i>, that is required in the content model defined by the schema definition designated by <i>expr</i> in <i>S</i>, there is a frame: <i><tt>o["child::</tt></i><tt>name</tt><i><tt>"-&gt;value]</tt></i>, in <i>&Phi;</i>, such that <i><tt>value</tt></i> has a value that is valid for <i>c</i> according to the schema definition;
</li><li> for each attribute, <i>a</i>, with QName: <i><tt>name</tt></i>, that is required in the content model defined by the schema definition designated by <i>expr</i> in <i>S</i>, there is a frame: <i><tt>o["attribute::</tt></i><tt>name</tt><i><tt>"-&gt;value]</tt></i>, in <i>&Phi;</i>, such that <i><tt>value</tt></i> has a value that is valid for <i>a</i> according to the schema definition;
</li><li> there is no subset, <i>F = { <tt>o["e"-&gt;v<sub>1</sub>],..., o["e"-&gt;v<sub>n</sub>]</tt>} &sube; &Phi;, n &ge; 0</i>, of frames with object: <i><tt>o</tt></i>, and slot name: <i><tt>"e"</tt></i>, where <i>e</i> is an XPath 2.0 child or attribute step expression, such that
<ul><li> either the child element or attribute designated by <i>e</i> is not allowed by the schema definition;
</li><li> or the set of values, {<i>v<sub>i</sub></i>}, contains a value that is not valid, according to the schema definition, for the child element or attribute designated by <i>e</i>;
</li><li> or the number of facts in <i>F</i>, <i>n</i>, is not within the bounds set in the schema definition for the multiplicity of the child element or attribute designated by <i>e</i>.
</li></ul>
</li></ul>
<p><b>Definition (RIF-PRD transition relation in a RIF-PRD+XML data combination).</b> In a RIF-PRD+XML data combination &lt;<i>R, E, S</i>&gt;, the semantics of RIF-PRD atomic actions is specified by the transition relation &rarr;<sub>&lt;<i>R,E,S</i>&gt;</sub> &sube; <i>W &times; L &times; W</i>. A triple <i>(w, <tt>&alpha;</tt>, w')</i> &isin; &rarr;<sub>&lt;<i>R,E,S</i>&gt;</sub> if and only if <i>w &isin; W</i>, <i>w' &isin; W</i>, <tt>&alpha;</tt> is a ground atomic action, and  
</p>
<ul><li> if <tt>&alpha;</tt> is <tt>Assert(&phi;)</tt>, where  &phi; = <tt>o # "<i>expr</i>"</tt> and <i>expr &isin; Classifiers(S)</i>, then <tt>o</tt> is <i>expr</i>-valid<sub>&lt;<i>R,E,S</i>&gt;</sub> in <i>w</i> and <i>w'&nbsp;=&nbsp;w&nbsp;&cup;&nbsp;{&phi;};</i>
</li><li> Otherwise, that is, if <tt>&alpha;</tt> is an <tt>Assert</tt> whose target has a different form, or a <tt>Retract</tt>, <tt>Modify</tt> or <tt>Execute</tt> ground atomic action, then <i>(w, <tt>&alpha;</tt>, w')</i> &isin; &rarr;<sub>&lt;<i>R,E,S</i>&gt;</sub> if and only if <i>(w, <tt>&alpha;</tt>, w')</i> &isin; &rarr;<sub>RIF-PRD</sub>, where &rarr;<sub>RIF-PRD</sub> is the standard RIF-PRD transition relation as defined in [<a href="#ref-prd" title="">RIF-PRD</a>] (section 3.2, Operational semantics of atomic actions).
</li></ul>
<p>☐
</p><p>The operational semantics of a RIF PRD+XML data combination is, then, exactly as specified in [<a href="#ref-prd" title="">RIF-PRD</a>], except that &rarr;<sub>&lt;<i>R,E,S</i>&gt;</sub> replaces &rarr;<sub>RIF-PRD</sub> in the definition of the transition relation, &rarr;<sub>PRS</sub>, that is one of the components of a RIF-PRD production rule system, <i>PRS</i> (cf. [<a href="#ref-prd" title="">RIF-PRD</a>], Section 4.2.4, Operation semantics of a production rule system).
</p><p>Notice, further, that, since RIF-PRD, unlike RIF-BLD, allows class membership to be asserted for new objects only, the object in such an assertion cannot have some or all the required properties already. As a consequence, all the mandatory properties must be asserted in the same action block where the class membership is asserted.
</p><p>Formally, the consequence is that the combination with schema-valid XML data puts an additional well-formedness constraints on RIF-PRD action blocks.
</p><p><b>Definition (Well-formed action block in a RIF-PRD+XML data combination).</b> In a RIF-PRD+XML data combination &lt;<i>R, E, S</i>&gt;, an action block is <i><b>well-formed</b></i> if and only if it is a well-formed RIF-PRD action block, according to the definition in [<a href="#ref-prd" title="">RIF-PRD</a>] (section 3.1.3 - Well-formed action blocks) and it satisfies the following additional constraint:
</p>
<ul><li> if an action in the action block asserts a membership atomic formula, <tt>Assert(o # "expr")</tt>, where <i>expr &isin; Classifiers(S)</i>, then the other actions in the action block are sufficient to make <tt>o</tt> <i>expr</i>-valid<sub>&lt;<i>R,E,S</i>&gt;</sub> in any state of facts resulting from the execution of the action block, that is: all the ground frame formulas that are required to make <tt>o</tt> <i>expr</i>-valid<sub>&lt;<i>R,E,S</i>&gt;</sub> in a state of facts, are asserted in the action block.
</li></ul>
<p>☐
</p>
<p class="ednote"><span class="ednotehead">Editor's Note:</span> Strictly speaking, since actions are ordered in RIF-PRD action blocks, and since the operational semantics of atomic actions is defined with respect to a production rule system state, independently from the system state being a system cycle state or a system transitional state, the ground frame formulas that are required to make <tt>o</tt> <i>expr</i>-valid<sub>&lt;<i>R,E,S</i>&gt;</sub> in a state of facts should be asserted before the membership formula is. However, it is conjectured that the atomic actions in an action block that satisfies the weaker constraint can, always, be re-ordered to satisfy the stronger constraint, without otherwise affecting the semantics of the action block as a whole; whence the absence of the ordering constraint in the above definition.</p>
<p>See also the (non-normative) appendix on embedding XML data as RIF facts for an exhaustive description of the facts to be added to the initial state of the fact base that is to be combined with the XML data.
</p><p><b>Example 2.5.</b> In a RIF-PRD+XML data combination &lt;<i>R, E, S</i>&gt;, where <i>S</i> contains all the top-level definitions in the XML schema in <a href="#ex21" title="">example 2.1</a> (all the examples assume that the pair <i>(<tt>ex</tt>, <tt>&lt;http://example.org/customertable&gt;</tt>)</i> belongs to the [statically known namespaces]<sup>small&gt;XP&lt;/small&gt;</sup> when the XPath and XSD-CD expressions are evaluated):
</p>
<ul><li> the following action blocks are well-formed as the action part of rules in <i>R</i>
</li></ul>
<pre>Do ((?newPin New())
    Assert(?newPin["self::ex:PIN"-&gt;999]) )
</pre>
<pre>Do ((?newPin New())
    Assert(?newPin["self::ex:PIN"-&gt;"999"^^ex:PIN]) )
</pre>
<p><i>(<tt>ex:PIN</tt> is an atomic type defined in </i>S<i>. As a consequence, it is included, per clause 3 in the definition of a RIF BLD+XML data combined interpretation, in the set of data types that are taken into account to interpret RIF formulas.)</i>
</p>
<pre>Do ((?newPin New())
    Assert(?newPIN # "/ex:PIN") )
</pre>
<p><i>(Since <tt>ex:PIN</tt> is a simple type, the XSD-CD expression </i>/ex:PIN<i> is not in </i>Classifiers(S)<i>. As a consequence, the class membership assertion, in the example above, adds no well-formedness constraint that is specific to the RIF PRD+XML data combination: its semantics are standard.)</i>
</p>
<pre>Do ((?newCust New())
    Assert(?newCust # "/ex:Customer")
    Assert(?newCust["ex:Name"-&gt;"Jojo"])
    Assert(?newCust["ex:Account"-&gt;1111])
    Assert(?newPin["ex:PIN"-&gt;999])
    Assert(?newCust["@xml/lang"-&gt;"fr"^^xs:language]) )
</pre>
<pre>Do ((?newCust New())
    Assert(?newCust # "/ex:Customer")
    Assert(?newCust["ex:Name"-&gt;"Jojo"])
    Assert(?newCust["ex:Account"-&gt;1111])
    Assert(?newCust["@xml/lang"-&gt;"fr"^^xs:language]) )
</pre>
<ul><li> the following action blocks are not well-formed as the action part of rules in <i>R</i>
</li></ul>
<pre>Do ((?newCust New())
    Assert(?newCust # "/ex:Customer")
    Assert(?newCust["ex:Name"-&gt;"Jojo"])
    Assert(?newCust["ex:Account"-&gt;1111])
    Assert(?newPin["ex:PIN"-&gt;-5])
    Assert(?newCust["@xml/lang"-&gt;"fr"^^xs:language]) )
</pre>
<p><i>(-5 is out of range for an <tt>ex:PIN</tt> value)</i>
</p>
<pre>Do ((?newCust New())
    Assert(?newCust # "/ex:Customer")
    Assert(?newCust["ex:Name"-&gt;"Jojo"])
    Assert(?newCust["ex:Name"-&gt;"Le balafr&eacute;"])
    Assert(?newCust["ex:Account"-&gt;1111])
    Assert(?newCust["@xml/lang"-&gt;"fr"^^xs:language]) )
</pre>
<p><i>(The schema definition requires a single <tt>ex:Name</tt> value for each <tt>ex:Customer</tt> information item)</i>.
</p><p><span class="anchor" id="sec-semantics-of-rif-core.2Bxml-data-combinations"></span>
</p>
<a id="Semantics_of_RIF_Core.2BXML_data_combinations" name="Semantics_of_RIF_Core.2BXML_data_combinations"></a><h3> <span class="mw-headline">2.4  Semantics of RIF Core+XML data combinations </span></h3>
<p>RIF Core is a syntactic subset of RIF BLD, and the semantics of RIF Core+XML data combinations is identical to the semantics of RIF BLD+XML data combinations for that subset.
</p><p>RIF Core is also a syntactic subset of RIF PRD, and the semantics of RIF Core+XML data combinations is also identical to the semantics of RIF PRD+XML data combinations for that subset.
</p><p><span class="anchor" id="sec-importing"></span>
</p>
<a id="Importing_XML_data_and_XML_schemas_in_RIF" name="Importing_XML_data_and_XML_schemas_in_RIF"></a><h2> <span class="mw-headline">3  Importing XML data and XML schemas in RIF </span></h2>
<p>In RIF, the <tt>Import</tt> directive is used to communicate the location of an external document to be combined with the RIF document that contains the directive and, optionally, a profile that governs the combination.
</p><p>In [<a href="#ref-core" title="">RIF-Core</a>], [<a href="#ref-prd" title="">RIF-PRD</a>] and [<a href="#ref-bld" title="">RIF-BLD</a>], the use of the <tt>Import</tt> directive is limited to identifying an imported RIF document. [<a href="#ref-swc" title="">RIF-RDF-OWL</a>] extends it to permit the identification of an RDF graph or an OWL ontology to be combined with a RIF document. An optional profile that governs the combination of a RIF document with an RDF graph or an OWL ontology can also be provided, as specified in [<a href="#ref-swc" title="">RIF-RDF-OWL</a>]. 
</p><p>This specification extends the <tt>Import</tt> directive further to permit the identification of XML data and/or XML schemas to be combined with a RIF document. 
</p><p>One use case for the combination of RIF and XML data is when a RIF document imports explicitly the data with which the rules are to be combined: in that case, the combination is imposed by the producer of the RIF document, as well as the data to be combined with the rules that the RIF document contains. We call that case: <i>producer-side combination</i>, and the XML data to be combined with the RIF document: <i>imported XML data</i>.
</p><p>However, a significant use case for RIF is rules being published or shared as a RIF document for consumers to combine them with their own data: in that case, the consumer of a RIF document decides independently of the producer to combine the rules contained in the RIF document with the data of his choice. We refer to that case as: <i>consumer-side combination</i>, and to the data that is combined with a RIF document as: <i>consumer-side data</i>.
</p>
<a id="The_extended_Import_directive" name="The_extended_Import_directive"></a><h3> <span class="mw-headline">3.1  The extended <tt>Import</tt> directive </span></h3>
<p>Specifically, the <tt>Import</tt> directive is extended as follows:
</p>
<ul><li> The import of any XML document is allowed; that is, the IRI of any XML document is allowed in the <tt>location</tt> sub-element of the <tt>Import</tt> directive. The IRI identifies the imported data document);
</li><li> Two new profiles are defined:
<ol><li> the value <tt>http://www.w3.org/2007/rif-import-profile#xml-data</tt> is allowed in the <tt>profile</tt> sub-element of the <tt>import</tt> directive, to indicate that no XML schema is associated with the imported XML data;
</li><li> any IRI that identifies an XML schema is allowed in the <tt>profile</tt> sub-element of the <tt>import</tt> directive, to indicate that the schema definitions in the XML schema are part of the combination;
</li></ol>
</li><li> Finally, a new value: <tt>http://www.w3.org/2007/rif-import-location#consumer-side-data</tt>, is allowed for the location of an import. That value indicates that the <tt>profile</tt> in the <tt>Import</tt> directive applies to consumer-side data only.
</li></ul>
<p>The following constraints must be satisfied:
</p>
<ul><li> If the content of the <tt>location</tt> in an <tt>Import</tt> directive is <tt>http://www.w3.org/2007/rif-import-location#consumer-side-data</tt>, the <tt>profile</tt> must contain the IRI of an XML schema;
</li><li> Conversely, if the profile is <tt>rif:xml-data</tt>, the <tt>location</tt> must identify an XML document;
</li><li> If the <tt>profile</tt> of an <tt>Import</tt> directive contains the IRI of an XML Schema and if the XML document identified in the <tt>location</tt> sub-element of that <tt>Import</tt> directive provides a <tt>schema-location</tt>, the <tt>profile</tt> must identify the same XML schema as the <tt>schema-location</tt> IRI.
</li></ul>
<p>This specification does not prescribe the behaviour of a conformant implementation when one of the above constraints is not satisfied.
</p><p>This specification does not prescribe the behaviour of a conformant implementation when an <tt>Import</tt> directive contains a <tt>location</tt> that is neither <tt>http://www.w3.org/2007/rif-import-location#consumer-side-data</tt> nor an IRI that identifies an XML document. And this specification does not prescribe the behaviour of a conformant implementation when an <tt>Import</tt> directive contains a <tt>profile</tt> that is neither <tt>http://www.w3.org/2007/rif-import-profile#xml-data</tt> nor an IRI that identifies an XML schema.
</p><p><b>Example 3.1.</b> The first three import directives, below, are valid; the fourth is not:
</p>
<ol><li> <tt>Import(http://example.org/customertable.xml http://www.w3.org/2007/rif-import-profile#xml-data)</tt>
</li><li> <tt>Import(http://example.org/customertable.xml http://example.org/customertable.xsd)</tt>
</li><li> <tt>Import(http://www.w3.org/2007/rif-import-location#consumer-side-data http://example.org/customertable.xsd)</tt>
</li><li> <tt>Import(http://www.w3.org/2007/rif-import-location#consumer-side-data http://www.w3.org/2007/rif-import-profile#xml-data)</tt>
</li></ol>
<p>The first directive says that the rules in the importing RIF document are to be combined with the data in the XML document identified by the IRI: <tt>http://example.org/customertable.xml</tt> and that there is no data model associated with the imported data in the form of an XML schema.
</p><p>The second directive says that the rules in the importing RIF document are to be combined with the data in the XML document identified by the IRI: <tt>http://example.org/customertable.xml</tt> and that there is a data model associated with the imported data, in the form of the XML schema that is identified by the IRI: <tt>http://example.org/customertable.xsd</tt>.
</p><p>The third directive says the data that is combined with the rules is expected to be an instance of the data model that is imported as the XML schema identified by the IRI: <tt>http://example.org/customertable.xsd</tt>; but the directive does not say what data is to be combined with the rules.
</p><p>The fourth directive violates the first and second constraints: the dummy location <tt>consumer-side-data</tt>, that indicates that the profile is to be applied to consumer-side data, is incompatible with the profile <tt>xml-data</tt>. Therefore, the directive is out of the scope of this specification.
</p>
<a id="Interpretation_of_Imports" name="Interpretation_of_Imports"></a><h3> <span class="mw-headline">3.2  Interpretation of Imports </span></h3>
<p>For the purpose of interpreting the combination of a RIF document, <i>R</i>, and XML data, let <i>dataLocation(R)</i> denote the set of the URIs in the <tt>location</tt> sub-elements of the <tt>import</tt> directives, in <i>R</i> and in the RIF documents that are imported, directly or indirectly, in <i>R</i>, whose <tt>profile</tt> is either <tt>rif:xml-data</tt> or identifies an XML schema; and let <i>dataDocuments(R)</i> denote the set of the document [nodes]<sup><small>XDM</small></sup> in the instances of the data model that encapsulate the information in all the XML documents that are identified by an URI in <i>dataLocation(R)</i>. If <i>dataLocation(R)</i> contains the dummy URI <tt>http://www.w3.org/2007/rif-import-location#consumer-side-data</tt>, <i>dataDocuments(R)</i> includes, also, the document [node]<sup><small>XDM</small></sup> in an instance of the data model that encapsulates the consumer-side data. In the absence of consumer-side data, the document node bears no information.
</p><p>If an <tt>Import</tt> directive identifies an XML schema as its <tt>profile</tt>, the corresponding instance of the data model includes the information from the PSVI that results from validating the XML data referenced in the <tt>location</tt> against that schema. Otherwise, the instance of the data model is built from the infoset.
</p><p>If an <tt>Import</tt> directive has the value: <tt>http://www.w3.org/2007/rif-import-location#consumer-side-data</tt> as a locator, the instance of the data model that encapsulates the consumer-side data, if any, includes the information from the PSVI that results from validating the data against the XML schema identified in the profile of that directive.
</p><p>As a consequence, if different <tt>Import</tt> directives associate different XML schemas to the consumer-side data, the instance of the data model that encapsulates the consumer-side data, if any, includes the information from the PSVI that results from validating the data against the XML schema that results from importing or including, into an otherwise empty schema, all the XML schemas identified in the <tt>profile</tt> sub-elements of <tt>Import</tt> directives with the value: <tt>http://www.w3.org/2007/rif-import-location#consumer-side-data</tt> as a locator.
</p><p>Given a RIF document, <i>R</i>, the set of data model nodes, <i>E</i>, in the RIF+XML data combination &lt;<i>R, E, S</i>&gt; is the set of all the document nodes in <i>dataDocuments(R)</i>, and of all the data model nodes that can be reached from those document nodes.
</p><p>In the same way, <i>S</i>, the schema definitions component in the RIF+XML data combination &lt;<i>R, E, S</i>&gt;, includes all the top level schema definitions found in the XML schemas that are imported as the <tt>profile</tt> of an <tt>import</tt> directive in <i>R</i> or in a RIF document that is imported, directly or indirectly, in <i>R</i>.
</p><p>For the purpose of evaluating XPath 2.0 expressions, when interpreting a RIF+XML data combination &lt;<i>R, E, S</i>&gt;, the [in-scope schema definitions]<sup><small>XP</small></sup> include all the schema definitions in <i>S</i>, all the schema type, schema element and schema attribute definitions that are components of the top level definitions in <i>S</i>, and all the schema types defined in [XSD 1.1 Part2].
</p><p><b>Example 3.2.</b> Continuing example 3.1, above, notice that none of the three valid directives is incompatible with the other two, but that combining the first two is confusing and error-prone, since directive #2 supersedes directive #1. Including effectively useless directives should be avoided.
</p><p>Combining directive #2 and #3 says that the rules in the importing document are meant to be applied only to data that validates against the XML schema in example 2.1, where the data is imported or from the consumer-side.
</p>
<a id="References" name="References"></a><h2> <span class="mw-headline">4  References </span></h2>
<p><span class="anchor" id="ref-infoset"></span> 
</p>
<dl><dt> [Infoset]
</dt><dd> <i><a class="external text" href="http://www.w3.org/TR/xml-infoset/" rel="nofollow" title="http://www.w3.org/TR/xml-infoset/">XML Information Set (Second Edition)</a></i>, John Cowan and Richard Tobin, Editors. World Wide Web Consortium, 04 Feb 2004. This version is <a class="external free" href="http://www.w3.org/TR/2004/REC-xml-infoset-20040204/" rel="nofollow" title="http://www.w3.org/TR/2004/REC-xml-infoset-20040204/">http://www.w3.org/TR/2004/REC-xml-infoset-20040204/</a>. The latest version is available at <a class="external free" href="http://www.w3.org/TR/xml-infoset/" rel="nofollow" title="http://www.w3.org/TR/xml-infoset/">http://www.w3.org/TR/xml-infoset/</a>.
</dd></dl>
<p><span class="anchor" id="ref-uri"></span> 
</p>
<dl><dt> [<a class="external" href="http://tools.ietf.org/html/rfc3986" title="http://tools.ietf.org/html/rfc3986">RFC 3986</a>]
</dt><dd> <i><a class="external text" href="http://www.ietf.org/rfc/rfc3986.txt" rel="nofollow" title="http://www.ietf.org/rfc/rfc3986.txt">RFC 3986: Uniform Resource Identifier (URI): Generic Syntax</a></i>, T. Berners-Lee, R. Fielding, and L. Masinter. January 2005.  Available at: <a class="external free" href="http://www.ietf.org/rfc/rfc3986.txt" rel="nofollow" title="http://www.ietf.org/rfc/rfc3986.txt">http://www.ietf.org/rfc/rfc3986.txt</a>
</dd></dl>
<p><span class="anchor" id="ref-iri"></span> 
</p>
<dl><dt> [<a class="external" href="http://tools.ietf.org/html/rfc3987" title="http://tools.ietf.org/html/rfc3987">RFC 3987</a>]
</dt><dd> <i><a class="external text" href="http://www.ietf.org/rfc/rfc3987.txt" rel="nofollow" title="http://www.ietf.org/rfc/rfc3987.txt">RFC 3987: Internationalized Resource Identifiers (IRIs)</a></i>,  M. Duerst and M. Suignard. January 2005.  Available at: <a class="external free" href="http://www.ietf.org/rfc/rfc3987.txt" rel="nofollow" title="http://www.ietf.org/rfc/rfc3987.txt">http://www.ietf.org/rfc/rfc3987.txt</a>
</dd></dl>
<p><span class="anchor" id="ref-core"></span> 
</p>
<dl><dt> [RIF-Core]
</dt><dd><span><cite><a href="http://www.w3.org/TR/2013/REC-rif-core-20130205/"><span>RIF Core Dialect (Second Edition)</span></a></cite> Harold Boley, Gary Hallmark, Michael Kifer, Adrian Paschke, Axel Polleres, Dave Reynolds, eds. W3C Recommendation, 5 February 2013, <a href="http://www.w3.org/TR/2013/REC-rif-core-20130205/">http://www.w3.org/TR/2013/REC-rif-core-20130205/</a>.  Latest version available at <a href="http://www.w3.org/TR/rif-core/">http://www.w3.org/TR/rif-core/</a>.</span></dd></dl>
<p><span class="anchor" id="ref-bld"></span> 
</p>
<dl><dt> [RIF-BLD]
</dt><dd><span><cite><a href="http://www.w3.org/TR/2013/REC-rif-bld-20130205/"><span>RIF Basic Logic Dialect (Second Edition)</span></a></cite> Harold Boley, Michael Kifer, eds. W3C Recommendation, 5 February 2013, <a href="http://www.w3.org/TR/2013/REC-rif-bld-20130205/">http://www.w3.org/TR/2013/REC-rif-bld-20130205/</a>.  Latest version available at <a href="http://www.w3.org/TR/rif-bld/">http://www.w3.org/TR/rif-bld/</a>.</span></dd></dl>
<p><span class="anchor" id="ref-dtb"></span> 
</p>
<dl><dt> [RIF-DTB]
</dt><dd><span><cite><a href="http://www.w3.org/TR/2013/REC-rif-dtb-20130205/"><span>RIF Datatypes and Built-Ins 1.0 (Second Edition)</span></a></cite> Axel Polleres, Harold Boley, Michael Kifer, eds. W3C Recommendation, 5 February 2013, <a href="http://www.w3.org/TR/2013/REC-rif-dtb-20130205/">http://www.w3.org/TR/2013/REC-rif-dtb-20130205/</a>.  Latest version available at <a href="http://www.w3.org/TR/rif-dtb/">http://www.w3.org/TR/rif-dtb/</a>.</span></dd></dl>
<p><span class="anchor" id="ref-prd"></span> 
</p>
<dl><dt> [RIF-PRD]
</dt><dd><span><cite><a href="http://www.w3.org/TR/2013/REC-rif-prd-20130205/"><span>RIF Production Rule Dialect (Second Edition)</span></a></cite> Christian de Sainte Marie, Gary Hallmark, Adrian Paschke, eds. W3C Recommendation, 5 February 2013, <a href="http://www.w3.org/TR/2013/REC-rif-prd-20130205/">http://www.w3.org/TR/2013/REC-rif-prd-20130205/</a>.  Latest version available at <a href="http://www.w3.org/TR/rif-prd/">http://www.w3.org/TR/rif-prd/</a>.</span></dd></dl>
<p><span class="anchor" id="ref-swc"></span> 
</p>
<dl><dt> [RIF-RDF-OWL]
</dt><dd><span><cite><a href="http://www.w3.org/TR/2013/REC-rif-rdf-owl-20130205/"><span>RIF RDF and OWL Compatibility (Second Edition)</span></a></cite> Jos de Bruijn, Chris Welty, eds. W3C Recommendation, 5 February 2013, <a href="http://www.w3.org/TR/2013/REC-rif-rdf-owl-20130205/">http://www.w3.org/TR/2013/REC-rif-rdf-owl-20130205/</a>.  Latest version available at <a href="http://www.w3.org/TR/rif-rdf-owl/">http://www.w3.org/TR/rif-rdf-owl/</a>.</span></dd></dl>
<p><span class="anchor" id="ref-xdm"></span> 
</p>
<dl><dt> [XDM]
</dt><dd> <i><a class="external text" href="http://www.w3.org/TR/xpath-datamodel/" rel="nofollow" title="http://www.w3.org/TR/xpath-datamodel/">XQuery 1.0 and XPath 2.0 Data Model (XDM)</a></i>,  M. Fern&aacute;ndez, A. Malhotra, J. Marsh, M. Nagy, N. Walsh, Editors. W3C Recommendation 23 January 2007. This version is <a class="external free" href="http://www.w3.org/TR/2007/REC-xpath-datamodel-20070123/" rel="nofollow" title="http://www.w3.org/TR/2007/REC-xpath-datamodel-20070123/">http://www.w3.org/TR/2007/REC-xpath-datamodel-20070123/</a>. The latest version is available at <a class="external free" href="http://www.w3.org/TR/xpath-datamodel/" rel="nofollow" title="http://www.w3.org/TR/xpath-datamodel/">http://www.w3.org/TR/xpath-datamodel/</a>.
</dd></dl>
<p><span class="anchor" id="ref-xfo"></span> 
</p>
<dl><dt> [XFO]
</dt><dd> <i><a class="external text" href="http://www.w3.org/TR/xpath-functions/" rel="nofollow" title="http://www.w3.org/TR/xpath-functions/">XQuery 1.0 and XPath 2.0 Functions and Operators</a></i>, Ashok Malhotra, Jim Melton, and Norman Walsh, Editors. World Wide Web Consortium, 23 Jan 2007. This version is <a class="external free" href="http://www.w3.org/TR/2007/REC-xpath-functions-20070123/" rel="nofollow" title="http://www.w3.org/TR/2007/REC-xpath-functions-20070123/">http://www.w3.org/TR/2007/REC-xpath-functions-20070123/</a>. The latest version is available at <a class="external free" href="http://www.w3.org/TR/xpath-functions/" rel="nofollow" title="http://www.w3.org/TR/xpath-functions/">http://www.w3.org/TR/xpath-functions/</a>.
</dd></dl>
<p><span class="anchor" id="ref-xml"></span> 
</p>
<dl><dt> [XML]
</dt><dd> <i><a class="external text" href="http://www.w3.org/TR/REC-xml/" rel="nofollow" title="http://www.w3.org/TR/REC-xml/">Extensible Markup Language (XML) 1.0 (Fifth Edition)</a></i>, T. Bray, J. Paoli, C. M. Sperberg-McQueen, E. Maler, F. Yergeau, Editor. W3C Recommendation 26 November 2008. This version is <a class="external free" href="http://www.w3.org/TR/2005/REC-xml-id-20050909/" rel="nofollow" title="http://www.w3.org/TR/2005/REC-xml-id-20050909/">http://www.w3.org/TR/2005/REC-xml-id-20050909/</a>. The latest version is available at <a class="external free" href="http://www.w3.org/TR/REC-xml/" rel="nofollow" title="http://www.w3.org/TR/REC-xml/">http://www.w3.org/TR/REC-xml/</a>.
</dd></dl>
<p><span class="anchor" id="ref-xml-id"></span> 
</p>
<dl><dt> [xml:id]
</dt><dd> <i><a class="external text" href="http://www.w3.org/TR/xml-id/" rel="nofollow" title="http://www.w3.org/TR/xml-id/">xml:id Version 1.0</a></i>, J. Marsh, D. Veillard, N. Walsh, Editors. W3C Recommendation 9 September 2005. This version is <a class="external free" href="http://www.w3.org/TR/2008/REC-xml-20081126/" rel="nofollow" title="http://www.w3.org/TR/2008/REC-xml-20081126/">http://www.w3.org/TR/2008/REC-xml-20081126/</a>. The latest version is available at <a class="external free" href="http://www.w3.org/TR/xml-id/" rel="nofollow" title="http://www.w3.org/TR/xml-id/">http://www.w3.org/TR/xml-id/</a>.
</dd></dl>
<p><span class="anchor" id="ref-xpath-20"></span> 
</p>
<dl><dt> [XPath 2.0]
</dt><dd> <i><a class="external text" href="http://www.w3.org/TR/xpath20/" rel="nofollow" title="http://www.w3.org/TR/xpath20/">XML Path Language (XPath) 2.0</a></i>, D. Chamberlin , A. Berglund, S. Boag, et. al., Editors. W3C Recommendation 23 Jan 2007. This version is <a class="external free" href="http://www.w3.org/TR/2007/REC-xpath20-20070123/" rel="nofollow" title="http://www.w3.org/TR/2007/REC-xpath20-20070123/">http://www.w3.org/TR/2007/REC-xpath20-20070123/</a>. The latest version is available at <a class="external free" href="http://www.w3.org/TR/xpath20/" rel="nofollow" title="http://www.w3.org/TR/xpath20/">http://www.w3.org/TR/xpath20/</a>.
</dd></dl>
<p><span class="anchor" id="ref-xquery"></span> 
</p>
<dl><dt> [XQuery 1.0]
</dt><dd> <i><a class="external text" href="http://www.w3.org/TR/xquery/" rel="nofollow" title="http://www.w3.org/TR/xquery/">XQuery 1.0: An XML Query Language</a></i>, D. Chamberlin , A. Berglund, S. Boag, et. al., Editors. W3C Recommendation 23 Jan 2007. This version is <a class="external free" href="http://www.w3.org/TR/2007/REC-xquery-20070123/" rel="nofollow" title="http://www.w3.org/TR/2007/REC-xquery-20070123/">http://www.w3.org/TR/2007/REC-xquery-20070123/</a>. The latest version is available at <a class="external free" href="http://www.w3.org/TR/xquery/" rel="nofollow" title="http://www.w3.org/TR/xquery/">http://www.w3.org/TR/xquery/</a>.
</dd></dl>
<p><span class="anchor" id="ref-xsd11-1"></span> 
</p>
<dl><dt> [XSD 1.1 Part 1]
</dt><dd> <cite><a class="external text" href="http://www.w3.org/TR/2012/REC-xmlschema11-1-20120405/" rel="nofollow" title="http://www.w3.org/TR/2012/REC-xmlschema11-1-20120405/">W3C XML Schema Definition Language (XSD) 1.1 Part 1: Structures</a></cite>, D. Beech, M. Maloney, H. S. Thompson, C. M. Sperberg-McQueen, S. Gao Gao, N. Mendelsohn,  Editors, W3C Recommendation, 5 April 2012, <a class="external free" href="http://www.w3.org/TR/2012/REC-xmlschema11-1-20120405/" rel="nofollow" title="http://www.w3.org/TR/2012/REC-xmlschema11-1-20120405/">http://www.w3.org/TR/2012/REC-xmlschema11-1-20120405/</a>.  Latest version available at <a class="external free" href="http://www.w3.org/TR/xmlschema11-1" rel="nofollow" title="http://www.w3.org/TR/xmlschema11-1">http://www.w3.org/TR/xmlschema11-1</a>.
</dd></dl>
<p><span class="anchor" id="ref-xsd11-2"></span> 
</p>
<dl><dt> [XSD 1.1 Part 2]
</dt><dd> <cite><a class="external text" href="http://www.w3.org/TR/2012/REC-xmlschema11-2-20120405/" rel="nofollow" title="http://www.w3.org/TR/2012/REC-xmlschema11-2-20120405/">W3C XML Schema Definition Language (XSD) 1.1 Part 2: Datatypes</a></cite>, D. Peterson, S. Gao Gao, H. S. Thompson, P. V. Biron, A. Malhotra, A. Malhotra, C. M. Sperberg-McQueen,  Editors, W3C Recommendation, 5 April 2012, <a class="external free" href="http://www.w3.org/TR/2012/REC-xmlschema11-2-20120405/" rel="nofollow" title="http://www.w3.org/TR/2012/REC-xmlschema11-2-20120405/">http://www.w3.org/TR/2012/REC-xmlschema11-2-20120405/</a>. Latest version available at <a class="external free" href="http://www.w3.org/TR/xmlschema11-2/" rel="nofollow" title="http://www.w3.org/TR/xmlschema11-2/">http://www.w3.org/TR/xmlschema11-2/</a>.
</dd></dl>
<p><span class="anchor" id="ref-xsd-cd"></span> 
</p>
<dl><dt> [XSD-CD]
</dt><dd> <i><a class="external text" href="http://www.w3.org/TR/2010/CR-xmlschema-ref-20100119/" rel="nofollow" title="http://www.w3.org/TR/2010/CR-xmlschema-ref-20100119/">W3C XML Schema Definition Language (XSD): Component Designators</a></i>, , Editors. W3C Candidate Recommandation 19 January 2010. W3C Recommendation 23 Jan 2007. This version is <a class="external free" href="http://www.w3.org/TR/2010/CR-xmlschema-ref-20100119/" rel="nofollow" title="http://www.w3.org/TR/2010/CR-xmlschema-ref-20100119/">http://www.w3.org/TR/2010/CR-xmlschema-ref-20100119/</a>. The latest version is available at <a class="external free" href="http://www.w3.org/TR/xmlschema-ref/" rel="nofollow" title="http://www.w3.org/TR/xmlschema-ref/">http://www.w3.org/TR/xmlschema-ref/</a>.
</dd></dl>
<p><span class="anchor" id="appendix-glossary"></span>
</p>
<a id="Appendix_A:_Glossary_.28non-normative.29" name="Appendix_A:_Glossary_.28non-normative.29"></a><h2> <span class="mw-headline">5  Appendix A: Glossary (non-normative) </span></h2>
<p><span class="anchor" id="glos-component-kind"></span> 
</p>
<dl><dt> <b>component-kind()</b>  <i>(from [<a href="#ref-xsd-cd" title="">XSD-CD</a>], section 4.5.1)</i>
</dt><dd> The component-kind accessor returns an expanded name identifying the kind of the schema component.
</dd></dl>
<p><span class="anchor" id="glos-component-name"></span> 
</p>
<dl><dt> <b>component-name()</b>  <i>(from [<a href="#ref-xsd-cd" title="">XSD-CD</a>], section 4.5.2)</i>
</dt><dd> The component-name accessor returns zero or one xs:QName values giving the name of the component.
</dd></dl>
<p><span class="anchor" id="glos-context-node"></span> 
</p>
<dl><dt> <b>Context node</b> <i>(from [<a href="#ref-xpath-20" title="">XPath 2.0</a>], section 2.1.1)</i>
</dt><dd> The context item is the item currently being processed. An item is either an atomic value or a node. When the context item is a node, it can also be referred to as the context node.
</dd></dl>
<p><span class="anchor" id="glos-declared-type"></span> 
</p>
<dl><dt> <b>Declared type</b> <i>(from [<a href="#ref-xdm" title="">XDM</a>], section 3.3.1.1)</i>
</dt><dd> The precise definition of the schema type of an element or attribute information item depends on the properties of the PSVI. In the PSVI, <a href="#ref-xsd11-1" title="">Schema Part 1</a> defines a <b>[type definition]</b> property as well as the <b>[type definition namespace]</b>, <b>[type definition name]</b> and <b>[type definition anonymous]</b> properties, which are effectively short-cut terms for properties of the type definition. Further, the <b>[element declaration]</b> and <b>[attribute declaration]</b> properties are defined for elements and attributes, respectively. These declarations in turn will identify the <b>[type definition]</b> declared for the element or attribute. To distinguish the <b>[type definition]</b> given in the PSVI for the element or attribute instance from the <b>[type definition]</b> associated with the declaration, the former is referred to below as the <b>actual type</b> and the latter as the <b>declared type</b> of the element or attribute instance in question.
</dd></dl>
<p><span class="anchor" id="glos-derived-from"></span> 
</p>
<dl><dt> <b>derived-from</b> <i>(from [<a href="#ref-xpath-20" title="">XPath 2.0</a>], section 2.5.4)</i>
</dt><dd> [The] pseudo-function named <i>derives-from(AT, ET)</i> [...] takes an actual simple or complex schema type <i>AT</i> and an expected simple or complex schema type <i>ET</i>, and either returns a boolean value or raises [an error].
<ul><li> <i>derives-from(AT, ET)</i> returns <i>true</i> if <i>ET</i> is a known type and any of the following three conditions is true:
<ol><li> <i>AT</i> is a schema type found in the [in-scope schema definitions]<sup><small>XP</small></sup>, and is the same as <i>ET</i> or is derived by restriction or extension from <i>ET</i>
</li><li> <i>AT</i> is a schema type not found in the [in-scope schema definitions]<sup><small>XP</small></sup>, and an implementation-dependent mechanism is able to determine that <i>AT</i> is derived by restriction from <i>ET</i>
</li><li> There exists some schema type <i>IT</i> such that <i>derives-from(IT, ET)</i> and <i>derives-from(AT, IT)</i> are <i>true</i>.
</li></ol>
</li><li> <i>derives-from(AT, ET)</i> returns <i>false</i> if <i>ET</i> is a known type and either the first and third or the second and third of the following conditions are true:
<ol><li> <i>AT</i> is a schema type found in the [in-scope schema definitions]<sup><small>XP</small></sup>, and is not the same as <i>ET</i>, and is not derived by restriction or extension from <i>ET</i>
</li><li> <i>AT</i> is a schema type not found in the [in-scope schema definitions]<sup><small>XP</small></sup>, and an implementation-dependent mechanism is able to determine that <i>AT</i> is not derived by restriction from <i>ET</i>
</li><li> No schema type <i>IT</i> exists such that <i>derives-from(IT, ET)</i> and <i>derives-from(AT, IT)</i> are <i>true</i>.
</li></ol>
</li><li> <i>derives-from(AT, ET)</i> raises [an error] if:
<ol><li> <i>ET</i> is an unknown type, or
</li><li> <i>AT</i> is an unknown type, and the implementation is not able to determine whether <i>AT</i> is derived by restriction from <i>ET</i>.
</li></ol>
</li></ul>
</dd></dl>
<p><span class="anchor" id="glos-document-order"></span> 
</p>
<dl><dt> <b>Document order</b> <i>(derived from [<a href="#ref-xdm" title="">XDM</a>], section 2.4)</i>
</dt><dd> A document order is defined among all the element information items that describe a given XML document. Document order is a total ordering. Informally, document order is the order in which nodes appear in the XML serialization of a document.
</dd></dl>
<p><span class="anchor" id="glos-fn-data"></span> 
</p>
<dl><dt> <b><tt>fn:data</tt></b> <i>(from [<a href="#ref-xfo" title="">XFO</a>], section 2.4)</i>
</dt><dd> <tt>fn:data</tt> takes a sequence of items and returns a sequence of atomic values.
</dd><dd> The result of fn:data is the sequence of atomic values produced by applying the following rules to each argument:
<ul><li> If the item is an atomic value, it is returned.
</li><li> If the item is a [node]<sup><small>XDM</small></sup>:
<ul><li> If the [node]<sup><small>XDM</small></sup> does not have a [typed value]<sup><small>XDM</small></sup> an error is raised.
</li><li> Otherwise, <tt>fn:data()</tt> returns the [typed value]<sup><small>XDM</small></sup> of the [node]<sup><small>XDM</small></sup>.
</li></ul>
</li></ul>
</dd></dl>
<p><span class="anchor" id="glos-fn-string"></span> 
</p>
<dl><dt> <b><tt>fn:string</tt></b> <i>(from [<a href="#ref-xfo" title="">XFO</a>], section 2.3)</i>
</dt><dd> <tt>fn:string</tt> returns the value of its arguments represented as a <tt>xs:string</tt>. If no argument is supplied, the [context item]<sup><small>XP</small></sup> is used as the default argument. The behavior of the function if the argument is omitted is exactly the same as if the [context item]<sup><small>XP</small></sup> had been passed as the argument.
</dd><dd> If the [context item]<sup><small>XP</small></sup> is undefined, an error is raised.
</dd><dd> If the list of arguments is the empty sequence, the zero-length string is returned.
</dd><dd> If the argument is a node, the function returns the [string-value]<sup><small>XDM</small></sup> of the node.
</dd><dd> If the argument is an atomic value, then the function returns the value of the argument cast as a <tt>xs:string</tt>.
</dd></dl>
<p><span class="anchor" id="glos-governing-type-definition"></span> 
</p>
<dl><dt> <b>Governing type definition</b>  <i>(from [<a href="#ref-xsd11-1" title="">XSD 1.1 Part 1</a>], section 3.2.4.2 for an attribute, section 3.3.4.6 for an element)</i>
</dt><dd>  The governing type definition of an attribute, in a given schema-validity &middot;assessment&middot; episode, is the {type definition} of the &middot;governing attribute declaration&middot;, unless the processor has stipulated another type definition at the start of &middot;assessment&middot; (see Assessing Schema-Validity (&sect;5.2)), in which case it is the stipulated type definition.
</dd><dd> The governing type definition of an element information item E, in a given schema-validity &middot;assessment&middot; episode, is the first of the following which applies:
<ol><li> An &middot;instance-specified type definition&middot; which &middot;overrides&middot; a type definition stipulated by the processor (see Assessing Schema-Validity (&sect;5.2)).
</li><li> A type definition stipulated by the processor (see Assessing Schema-Validity (&sect;5.2)).
</li><li> An &middot;instance-specified type definition&middot; which &middot;overrides&middot; the &middot;selected type definition&middot; of E.
</li><li> The &middot;selected type definition&middot; of E.
</li><li> The value &middot;absent&middot; if E is &middot;skipped&middot;.
</li><li> An &middot;instance-specified type definition&middot; which &middot;overrides&middot; the &middot;locally declared type&middot;.
</li><li> The &middot;locally declared type&middot;.
</li><li> An &middot;instance-specified type definition&middot;.
</li></ol>
</dd><dd> If none of these apply, there is no &middot;governing type definition&middot; (or, in equivalent words, it is &middot;absent&middot;). 
</dd></dl>
<p><br />
<span class="anchor" id="glos-in-scope-schema-definitions"></span> 
</p>
<dl><dt> <b>In-scope schema definitions</b> <i>(from [<a href="#ref-xpath-20" title="">XPath 2.0</a>], section 2.1.1)</i>
</dt><dd> This is a generic term for all the element declarations, attribute declarations, and schema type definitions that are in scope during processing of an expression.] It includes <i>[the In-scope schema types, the In-scope element declarations, the substitution groups and the In-scope attribute declarations]</i>.
</dd></dl>
<p><br />
<span class="anchor" id="glos-node"></span> 
</p>
<dl><dt> <b>Node</b> <i>(from [<a href="#ref-xdm" title="">XDM</a>], section 2.1)</i>
</dt><dd> <i>(from [<a href="#ref-xdm" title="">XDM</a>], section 2.1)</i> There are seven kinds of Nodes in the data model: document, element, attribute, text, namespace, processing instruction, and comment.
</dd><dd> <i>(from [<a href="#ref-xpath-20" title="">XPath 2.0</a>], section 2)</i> Each node has a unique node identity, a typed value, and a string value. In addition, some nodes have a name. The typed value of a node is a sequence of zero or more atomic values. The string value of a node is a value of type <tt>xs:string</tt>. The name of a node is a value of type <tt>xs:QName</tt>.
</dd></dl>
<p><span class="anchor" id="glos-normalized-value"></span> 
</p>
<dl><dt> <b>Normalized value </b> <i>(from [<a href="#ref-xsd11-1" title="">XSD 1.1 Part 1</a>], section 3.1.4)</i>
</dt><dd> The normalized value of an element or attribute information item is an initial value which has been normalized according to the value of the whiteSpace facet, and the values of any other pre-lexical facets, associated with the simple type definition used in its validation.
</dd><dd> The initial value of an attribute information item is the normalized attribute value, as specified in [<a href="#ref-xml" title="">XML</a>], section 3.3.3 (Attribute-value normalization). Similarly, the initial value of an element information item is the string composed of, in <a href="#glos-document-order" title="">document order</a>, the character code of each character information item in the [children]<sub><small>info</small></sub> of that element information item.
</dd></dl>
<p><span class="anchor" id="glos-schema-normalized-value"></span> 
</p>
<dl><dt> <b>Schema normalized value</b> <i>(from [<a href="#ref-xsd11-1" title="">XSD 1.1 Part 1</a>], section 3.2.5.4 for attributes, section 3.3.5.4 for elements)</i>
</dt><dd> If an attribute's <a href="#glos-normalized-value" title="">normalized value</a> is valid with respect to the governing type definition, then the schema normalized value of the attribute is the <a href="#glos-normalized-value" title="">normalized value</a> as validated, otherwise it is absent.
</dd><dd> If an element information item is not nilled and either the <a href="#glos-governing-type-definition" title="">governing type definition</a> is a simple type definition or its {content type} has {variety} <i>simple</i>, then the schema normalized value of the element is the lexical form of its value constraint if applicable; else, if the element's <a href="#glos-normalized-value" title="">initial value</a> is valid with respect to the simple type definition as defined by String Valid ([<a href="#ref-xsd11-1" title="">XSD 1.1 Part 1</a>], section 3.16.4), then the schema normalized value is the <a href="#glos-normalized-value" title="">normalized value</a> of the item as validated; otherwise it is absent.
</dd></dl>
<p><span class="anchor" id="glos-statically-known-namespaces"></span> 
</p>
<dl><dt> <b>Statically-known namespaces</b> <i>(from [<a href="#ref-xpath-20" title="">XPath 2.0</a>], section 2.1.1)</i>
</dt><dd> This is a set of (prefix, URI) pairs that define all the namespaces that are known during static processing of a given expression.
</dd></dl>
<p><span class="anchor" id="glos-string-value"></span> 
</p>
<dl><dt> <b>String value</b>
</dt><dd> The string value of a node is a string and can be extracted by applying the <tt>fn:string</tt> function to the node.
</dd><dd> <i>(from [<a href="#ref-xdm" title="">XDM</a>], section 3.3.1.3)</i> Element and attribute nodes have both typed-value and string-value properties. However, implementations are allowed some flexibility in how these properties are stored. An implementation may choose to store the string-value only and derive the typed-value from it, or to store the typed-value only and derive the string-value from it, or to store both the string-value and the typed-value.
</dd><dd> In order to permit these various implementation strategies, some variations in the string value of a node are defined as insignificant. Implementations that store only the typed value of a node are permitted to return a string value that is different from the original lexical form of the node content.
</dd></dl>
<p><span class="anchor" id="glos-type-axis"></span> 
</p>
<dl><dt> <b>type-axis()</b>  <i>(from [<a href="#ref-xsd-cd" title="">XSD-CD</a>], section 4.4.5)</i>
</dt><dd> The type axis contains simple type definition and complex type definition components linked to the current component through {type definition}, {type definitions}, {content type}, or {simple type definition} arcs
</dd></dl>
<p><span class="anchor" id="glos-typed-value"></span> 
</p>
<dl><dt> <b>Typed value</b>
</dt><dd> The typed value of a node is a sequence of atomic values and can be extracted by applying the <tt>fn:data</tt> function to the node.
</dd><dd> <i>(from [<a href="#ref-xdm" title="">XDM</a>], section 3.3.1.2)</i> This section describes how the typed value of an Element or Attribute Node is computed from an element or attribute PSVI information item, where the information item has either a simple type or a complex type with simple content. [...]
</dd><dd> The typed value of Attribute Nodes and some Element Nodes is a sequence of atomic values. The types of the items in the typed value of a node may differ from the type of the node itself. [...]
</dd><dd> The types of the items in the typed value of a node are determined as follows. The process begins with T, the schema type of the node itself, as represented in the PSVI. For each primitive or ordinary simple type T, the W3C XML Schema specification defines a function M mapping the lexical representation of a value onto the value itself.
</dd><dd> The typed value is determined as follows:
<ul><li> If the nilled property of the node in question is true, then the typed value is the empty sequence.
</li><li> If T is xs:anySimpleType or xs:anyAtomicType, the typed value is the <a href="#glos-schema-normalized-value" title="">schema normalized value</a> as an instance of xs:untypedAtomic.
</li><li> Otherwise, the typed value is the result of applying M to the string value as an instance of the appropriate value type, where the appropriate value type is the [member type definition] if T is a union type, otherwise it is simply T.
</li></ul>
</dd><dd> The typed value determination process is guaranteed to result in a sequence of atomic values, each having a well-defined atomic type.
</dd></dl>
<p><span class="anchor" id="appendix-embedding"></span>
</p>
<a id="Appendix_B:_Change_Log_.28non-normative.29" name="Appendix_B:_Change_Log_.28non-normative.29"></a><h2> <span class="mw-headline">6  Appendix B: Change Log (non-normative) </span></h2>
<p><span id="changelog"></span>
</p>
<ul><li> Complete rework of the semantics
</li></ul>
<p>Since the <a class="external text" href="http://www.w3.org/TR/2010/WD-rif-xml-data-20100622/" rel="nofollow" title="http://www.w3.org/TR/2010/WD-rif-xml-data-20100622/">WD published 22 June 2010</a>:
</p>
<ul><li> Completed the semantics
</li><li> Replaced the ad hoc syntax with <a href="#ref-xpath-20" title="">XPath 2.0</a> and <a href="#ref-xsd-cd" title="">XML schema component designator syntaxes</a>
</li></ul>


</body>
</html>