<!-- http://www.w3.org/TR/xmlenc-transform20/ -->
<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <title>XML Encryption 1.1 CipherReference Processing using 2.0 Transforms</title>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
   
  
  
  
<style>/*****************************************************************
 * ReSpec 3 CSS
 * Robin Berjon - http://berjon.com/
 *****************************************************************/

/* --- INLINES --- */
em.rfc2119 { 
    text-transform:     lowercase;
    font-variant:       small-caps;
    font-style:         normal;
    color:              #900;
}

h1 acronym, h2 acronym, h3 acronym, h4 acronym, h5 acronym, h6 acronym, a acronym,
h1 abbr, h2 abbr, h3 abbr, h4 abbr, h5 abbr, h6 abbr, a abbr {
    border: none;
}

dfn {
    font-weight:    bold;
}

a.internalDFN {
    color:  inherit;
    border-bottom:  1px solid #99c;
    text-decoration:    none;
}

a.externalDFN {
    color:  inherit;
    border-bottom:  1px dotted #ccc;
    text-decoration:    none;
}

a.bibref {
    text-decoration:    none;
}

cite .bibref {
    font-style: normal;
}

code {
    color:  #ff4500;
}


/* --- --- */
ol.algorithm { counter-reset:numsection; list-style-type: none; }
ol.algorithm li { margin: 0.5em 0; }
ol.algorithm li:before { font-weight: bold; counter-increment: numsection; content: counters(numsection, ".") ") "; }

/* --- TOC --- */
.toc a, .tof a {
    text-decoration:    none;
}

a .secno, a .figno {
    color:  #000;
}

ul.tof, ol.tof {
    list-style: none outside none;
}

.caption {
    margin-top: 0.5em;
    font-style:   italic;
}

/* --- TABLE --- */
table.simple {
    border-spacing: 0;
    border-collapse:    collapse;
    border-bottom:  3px solid #005a9c;
}

.simple th {
    background: #005a9c;
    color:  #fff;
    padding:    3px 5px;
    text-align: left;
}

.simple th[scope="row"] {
    background: inherit;
    color:  inherit;
    border-top: 1px solid #ddd;
}

.simple td {
    padding:    3px 10px;
    border-top: 1px solid #ddd;
}

.simple tr:nth-child(even) {
    background: #f0f6ff;
}

/* --- DL --- */
.section dd > p:first-child {
    margin-top: 0;
}

.section dd > p:last-child {
    margin-bottom: 0;
}

.section dd {
    margin-bottom:  1em;
}

.section dl.attrs dd, .section dl.eldef dd {
    margin-bottom:  0;
}
</style><link rel="stylesheet" href="http://www.w3.org/StyleSheets/TR/W3C-WG-NOTE"><!--[if lt IE 9]><script src='http://www.w3.org/2008/site/js/html5shiv.js'></script><![endif]--></head>
<body><div class="head">
  <p>
    
      <a href="http://www.w3.org/"><img width="72" height="48" src="http://www.w3.org/Icons/w3c_home" alt="W3C"></a>
    
  </p>
  <h1 class="title" id="title">XML Encryption 1.1 CipherReference Processing using 2.0 Transforms</h1>
  
  <h2 id="w3c-working-group-note-11-april-2013"><abbr title="World Wide Web Consortium">W3C</abbr> Working Group Note 11 April 2013</h2>
  <dl>
    
      <dt>This version:</dt>
      <dd><a href="http://www.w3.org/TR/2013/NOTE-xmlenc-transform20-20130411/">http://www.w3.org/TR/2013/NOTE-xmlenc-transform20-20130411/</a></dd>
      <dt>Latest published version:</dt>
      <dd><a href="http://www.w3.org/TR/xmlenc-transform20/">http://www.w3.org/TR/xmlenc-transform20/</a></dd>
    
    
      <dt>Latest editor's draft:</dt>
      <dd><a href="http://www.w3.org/2008/xmlsec/Drafts/xmlenc-transform20/">http://www.w3.org/2008/xmlsec/Drafts/xmlenc-transform20/</a></dd>
    
    
    
    
    
      <dt>Previous version:</dt>
      <dd><a href="http://www.w3.org/TR/2012/CR-xmlenc-transform20-20120313/">http://www.w3.org/TR/2012/CR-xmlenc-transform20-20120313/</a></dd>
    
    
    <dt>Editor:</dt>
    <dd><span>Frederick Hirsch</span>, <span class="ed_mailto"><a href="mailto:frederick.hirsch@nokia.com">frederick.hirsch@nokia.com</a></span></dd>

    
  </dl>
  
  
  
  
    
      <p class="copyright">
        <a href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> © 
        2013
        
        <a href="http://www.w3.org/"><abbr title="World Wide Web Consortium">W3C</abbr></a><sup>®</sup> 
        (<a href="http://www.csail.mit.edu/"><abbr title="Massachusetts Institute of Technology">MIT</abbr></a>,
        <a href="http://www.ercim.eu/"><abbr title="European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>,
        <a href="http://www.keio.ac.jp/">Keio</a>, <a href="http://ev.buaa.edu.cn/">Beihang</a>), All Rights Reserved.
        <abbr title="World Wide Web Consortium">W3C</abbr> <a href="http://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>,
        <a href="http://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and
        <a href="http://www.w3.org/Consortium/Legal/copyright-documents">document use</a> rules apply.
      </p>
    
  
  <hr>
</div>
<section id="abstract" class="introductory"><h2>Abstract</h2>
      <p>This informative <abbr title="World Wide Web Consortium">W3C</abbr> Working Group Note describes 
 specifies how the XML Signature 2.0 transform model
may be used with XML Encryption 1.1 for <code>CipherReference</code>
  processing.</p> 
</section><section id="sotd" class="introductory"><h2>Status of This Document</h2>
  
    
      
        <p>
          <em>This section describes the status of this document at the time of its publication. Other
          documents may supersede this document. A list of current <abbr title="World Wide Web Consortium">W3C</abbr> publications and the latest revision
          of this technical report can be found in the <a href="http://www.w3.org/TR/"><abbr title="World Wide Web Consortium">W3C</abbr> technical reports
          index</a> at http://www.w3.org/TR/.</em>
        </p>
        
  <p>The XML Security Working Group has agreed 
  not to progress this XML Signature Streaming Profile of XPath 1.0
  specification further as a Recommendation track document, electing
  to publish it as an informative Working Group Note.  The Working Group has not performed interop testing on the
  material in this document. </p>
  <p>Other than publishing as a <abbr title="World Wide Web Consortium">W3C</abbr> Working Group Note, the only changes
  since the last publication have been to update the abstract to
  clarify the status and to  update the references (<a href="Overview_diff.html">diff</a>).</p>

        <p>
          This document was published by the <a href="http://www.w3.org/2008/xmlsec/">XML Security Working Group</a> as a Working Group Note.
          
          
          If you wish to make comments regarding this document, please send them to 
          <a href="mailto:public-xmlsec@w3.org">public-xmlsec@w3.org</a> 
          (<a href="mailto:public-xmlsec-request@w3.org?subject=subscribe">subscribe</a>,
          <a href="http://lists.w3.org/Archives/Public/public-xmlsec/">archives</a>).
          
          
          
          
        All comments are welcome.
        
        
          </p><p>
            Publication as a Working Group Note does not imply endorsement by the <abbr title="World Wide Web Consortium">W3C</abbr> Membership.
            This is a draft document and may be updated, replaced or obsoleted by other documents at 
            any time. It is inappropriate to cite this document as other than work in progress.
          </p>
        
        
        <p>
          
            This document was produced by a group operating under the 
            <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/">5 February 2004 <abbr title="World Wide Web Consortium">W3C</abbr> Patent Policy</a>.
          
          
          
            
              <abbr title="World Wide Web Consortium">W3C</abbr> maintains a <a href="http://www.w3.org/2004/01/pp-impl/42458/status" rel="disclosure">public list of any patent disclosures</a> 
            
            made in connection with the deliverables of the group; that page also includes instructions for 
            disclosing a patent. An individual who has actual knowledge of a patent which the individual believes contains
            <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#def-essential">Essential Claim(s)</a> must disclose the
            information in accordance with <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#sec-Disclosure">section
            6 of the <abbr title="World Wide Web Consortium">W3C</abbr> Patent Policy</a>.
          
          
        </p>
        
      
    
  
</section><section id="toc"><h2 class="introductory">Table of Contents</h2><ul class="toc"><li class="tocline"><a href="#sec-Introduction" class="tocxref"><span class="secno">1. </span>Introduction</a></li><li class="tocline"><a href="#sec-Example" class="tocxref"><span class="secno">2. </span>Example</a></li><li class="tocline"><a href="#sec-version" class="tocxref"><span class="secno">3. </span>Version recognition</a></li><li class="tocline"><a href="#sec-CipherReferenceProcessing" class="tocxref"><span class="secno">4. </span><code>CipherReference</code> Processing with 2.0 Transform Model</a></li><li class="tocline"><a href="#sec-Schema" class="tocxref"><span class="secno">5. </span>Schema</a></li><li class="tocline"><a href="#references" class="tocxref"><span class="secno">A. </span>References</a><ul class="toc"><li class="tocline"><a href="#normative-references" class="tocxref"><span class="secno">A.1 </span>Normative references</a></li></ul></li></ul></section>

<section id="sec-Introduction" class="informative">
<!--OddPage--><h2><span class="secno">1. </span>Introduction</h2><p><em>This section is non-normative.</em></p>

<p>This document specifies how the XML Signature 2.0 transform model
may be used with XML Encryption 1.1 for <code>CipherReference</code>
  processing.
The XML Signature 2.0 [<cite><a class="bibref" href="#bib-XMLDSIG-CORE2">XMLDSIG-CORE2</a></cite>] Transform processing model offers
simplification to the 
XML Encryption 1.1 [<cite><a class="bibref" href="#bib-XMLENC-CORE1">XMLENC-CORE1</a></cite>] <code>CipherReference</code> transform
processing model.  
</p><p>
The current model in XML Encryption 1.1 is that
a <code>CipherReference</code> element 
specifies a <code>URI</code> attribute for obtaining content and may
also optionally apply further 
transforms through the use of one or more <code>Transform</code> elements
contained in a <code>Transforms</code> child of
the <code>CipherReference</code>. The example in XML Encryption 1.1
shows use of an XPath 
transform to select 
a specific element within an XML document and then a base64 transform to
decode the base64 to octets (two 1.1 transforms are applied). 
</p><p>
This document is only applicable when transforms are applied in XML
Encryption 1.1 to obtain cipher content, however this may be frequent
when base64 decoding is required. 
</p><p>
The 2.0 Transform model has a single fixed transform that supports a
selection element, enabling the  <code>CipherReference</code>
processing model to be simplified (the 2.0 model  also has other
features that are 
not discussed in this document). The overall set of simplifications
are as 
follows:
</p>
<ol>
<li><p>Use the 2.0 Transform <code>dsig2:Selection</code> element with
    a <code>URL</code> attribute value that specifies the source of
    the cipher value, using XML fragments as 
    appropriate. In the XML Encryption 1.1 example this removes the
    need for an XPath transform.
</p></li>
<li><p>
Process the content retrieved from the URL source appropriately, as
defined according to the <code>dsig2:Selection</code> 
 <code>Algorithm</code> attribute. The type defined for base64 content
 encoded in XML is appropriate to the example in XML Encryption 1.1.
</p></li>
</ol>
<p>
This approach entirely eliminates the use of transforms, apart from
the backwardly-compatible mechanism of using the
2.0 <code>Transform</code> element to
enable use of the 2.0 selection mechanism.
</p>
</section>
<section id="sec-Example" class="informative">
<!--OddPage--><h2><span class="secno">2. </span>Example</h2><p><em>This section is non-normative.</em></p>
<p>This example corresponds to the example shown in <a href="http://www.w3.org/TR/xmlenc-core1/#sec-CipherReference">section 3.3.1 of
  XML Encryption 1.1</a>.
</p>
<pre class="xml-example">  &lt;CipherReference URI=""&gt;

    &lt;Transforms&gt;

      &lt;ds:Transform Algorithm="http://www.w3.org/2010/xmldsig2#transform"&gt;

       &lt;dsig2:Selection
         URI="http://www.example.com/CipherValues.xml#example1"
         Algorithm="http://www.w3.org/2010/xmldsig2#binaryfromBase64"
         xmlns:dsig2="http://www.w3.org/2010/xmldsig2#"&gt;
        &lt;/dsig2:Selection&gt;

      &lt;/ds:Transform&gt;

    &lt;/Transforms&gt;

  &lt;/CipherReference&gt;</pre>

</section>
<section id="sec-version">
<!--OddPage--><h2><span class="secno">3. </span>Version recognition</h2>
<p>
Use of 2.0 transform processing can be recognized by examination of
the <code>Algorithm</code> attribute value on
the <code>Transform</code> element and seeing 
that it is the 2.0 value defined in XML Signature 2.0: 
<code>"http://www.w3.org/2010/xmldsig2#transform" </code>.
</p><p>
This document is only applicable if it has a compatible value (this
value or later).
</p>
</section>
<section id="sec-CipherReferenceProcessing">
<!--OddPage--><h2><span class="secno">4. </span><code>CipherReference</code> Processing with 2.0 Transform Model</h2>
<p>
<code>CipherReference</code> processing with the 2.0 transform model
is only performed if the <code>CipherReference</code> element has
a <code>Transforms</code> child element with a <code>Transform</code>
child having an <code>Algorithm</code> attribute value consistent with 2.0
processing. The only current such value is
<code>"http://www.w3.org/2010/xmldsig2#transform" </code>.
</p>
<p>If this is the case, it is an error if there is more than
  one <code>Transforms</code> child element of
  the <code>CipherReference</code> element or if there is more than
  one
 <code>Transform</code> child element of
the <code>Transforms</code> element.
</p><p>
The <code>dsig2:Selection</code> element <em class="rfc2119" title="MUST">MUST</em> be present as a child of
the single 
<code>Transform</code> element. 
The <code>URI</code> 
attribute of the <code>dsig2:Selection</code> element <em class="rfc2119" title="MUST">MUST</em> specify the
source for 
the cipher data (and for content from within XML should specify the
fragment if necessary, see 10.6.1 Selection of XML Documents or
Fragments of XML Signature 2.0 for details) 
</p>
<p>
If the cipher data is base64 encoded content within an XML source, the
<code>http://www.w3.org/2010/xmldsig2#binaryfromBase64</code>
algorithm identifier 
<em class="rfc2119" title="MUST">MUST</em> be specified as the <code>dsig2:Selection</code> <code>Algorithm</code>
attribute value.  
</p>
<p>
If the cipher data is binary (and not base64 encoded) content from the
URI source, the <code>http://www.w3.org/2010/xmldsig2#binaryExternal</code>
algorithm identifier <em class="rfc2119" title="MUST">MUST</em> be specified as the <code>dsig2:Selection</code>
<code>Algorithm</code> attribute value. 
</p>
<p>
No other <code>Algorithm</code> attribute value should be used.
</p>
</section>
<section id="sec-Schema">
<!--OddPage--><h2><span class="secno">5. </span>Schema</h2>
<p>
This document specifies no change to the schema definition of
the <code>CipherReference</code> element defined in XML 
Encryption 1.1, but the <code>URI</code> attribute of this element is
ignored when the 2.0 transform processing model is used as described
in this document.
</p>
</section>


<section id="references" class="appendix"><!--OddPage--><h2><span class="secno">A. </span>References</h2><p>Dated references below are to the latest known or appropriate edition of the referenced work.  The referenced works may be subject to revision, and conformant implementations may follow, and are encouraged to investigate the appropriateness of following, some or all more recent editions or replacements of the works cited. It is in each case implementation-defined which  editions are supported.</p><section id="normative-references"><h3><span class="secno">A.1 </span>Normative references</h3><dl class="bibliography"><dt id="bib-XMLDSIG-CORE2">[XMLDSIG-CORE2]</dt><dd>D. Eastlake; J. Reagle; D. Solo; F. Hirsch; T. Roessler; K. Yiu; P. Datta; S. Cantor. <a href="http://www.w3.org/TR/2013/NOTE-xmldsig-core2-20130411/"><cite>XML Signature Syntax and Processing Version 2.0</cite></a>. 11 April 2013. W3C Working Group Note. URL: <a href="http://www.w3.org/TR/2013/NOTE-xmldsig-core2-20130411/">http://www.w3.org/TR/2013/NOTE-xmldsig-core2-20130411/</a>
</dd><dt id="bib-XMLENC-CORE1">[XMLENC-CORE1]</dt><dd>J. Reagle; D. Eastlake; F. Hirsch; T. Roessler. <a href="http://www.w3.org/TR/2013/REC-xmlenc-core1-20130411/"><cite>XML Encryption Syntax and Processing Version 1.1</cite></a>. 11 April 2013. W3C Recommendation. URL: <a href="http://www.w3.org/TR/2013/REC-xmlenc-core1-20130411/">http://www.w3.org/TR/2013/REC-xmlenc-core1-20130411/</a>
</dd></dl></section></section></body></html>
