<!-- http://www.w3.org/TR/messaging/ -->
<!DOCTYPE html>
<!-- saved from url=(0041)http://www.w3.org/2012/sysapps/messaging/ -->

<html lang="en" dir="ltr">
<head>
  <meta name="generator" content=
  "HTML Tidy for HTML5 (experimental) for Linux https://github.com/w3c/tidy-html5/tree/8025154">
  <meta http-equiv="Content-Type" content=
  "text/html; charset=utf-8">

  <title>Messaging API</title>
  <style>
/*****************************************************************
  * ReSpec 3 CSS
  * Robin Berjon - http://berjon.com/
  *****************************************************************/

  /* --- INLINES --- */
  em.rfc2119 { 
    text-transform:     lowercase;
    font-variant:       small-caps;
    font-style:         normal;
    color:              #900;
  }

  h1 acronym, h2 acronym, h3 acronym, h4 acronym, h5 acronym, h6 acronym, a acronym,
  h1 abbr, h2 abbr, h3 abbr, h4 abbr, h5 abbr, h6 abbr, a abbr {
    border: none;
  }

  dfn {
    font-weight:    bold;
  }

  a.internalDFN {
    color:  inherit;
    border-bottom:  1px solid #99c;
    text-decoration:    none;
  }

  a.externalDFN {
    color:  inherit;
    border-bottom:  1px dotted #ccc;
    text-decoration:    none;
  }

  a.bibref {
    text-decoration:    none;
  }

  cite .bibref {
    font-style: normal;
  }

  code {
    color:  #ff4500;
  }

  /* --- TOC --- */
  .toc a, .tof a {
    text-decoration:    none;
  }

  a .secno, a .figno {
    color:  #000;
  }

  ul.tof, ol.tof {
    list-style: none outside none;
  }

  .caption {
    margin-top: 0.5em;
    font-style:   italic;
  }

  /* --- TABLE --- */
  table.simple {
    border-spacing: 0;
    border-collapse:    collapse;
    border-bottom:  3px solid #005a9c;
  }

  .simple th {
    background: #005a9c;
    color:  #fff;
    padding:    3px 5px;
    text-align: left;
  }

  .simple th[scope="row"] {
    background: inherit;
    color:  inherit;
    border-top: 1px solid #ddd;
  }

  .simple td {
    padding:    3px 10px;
    border-top: 1px solid #ddd;
  }

  .simple tr:nth-child(even) {
    background: #f0f6ff;
  }

  /* --- DL --- */
  .section dd > p:first-child {
    margin-top: 0;
  }

  .section dd > p:last-child {
    margin-bottom: 0;
  }

  .section dd {
    margin-bottom:  1em;
  }

  .section dl.attrs dd, .section dl.eldef dd {
    margin-bottom:  0;
  }
  </style>
  <style>
/* --- EXAMPLES --- */
  div.example-title {
    min-width: 7.5em;
    color: #b9ab2d;
  }
  div.example-title span {
    text-transform: uppercase;   
  }
  aside.example, div.example, div.illegal-example {
    padding: 0.5em;
    margin: 1em 0;
    position: relative;
    clear: both;
  }
  div.illegal-example { color: red }
  div.illegal-example p { color: black }
  aside.example, div.example {
    padding: .5em;
    border-left-width: .5em;
    border-left-style: solid;
    border-color: #e0cb52;
    background: #fcfaee;    
  }

  aside.example div.example {
    border-left-width: .1em;
    border-color: #999;
    background: #fff;
  }
  aside.example div.example div.example-title {
    color: #999;
  }
  </style>
  <style>
/* --- ISSUES/NOTES --- */
  div.issue-title, div.note-title {
    padding-right:  1em;
    min-width: 7.5em;
    color: #b9ab2d;
  }
  div.issue-title { color: #e05252; }
  div.note-title { color: #2b2; }
  div.issue-title span, div.note-title span {
    text-transform: uppercase;
  }
  div.note, div.issue {
    margin-top: 1em;
    margin-bottom: 1em;
  }
  .note > p:first-child, .issue > p:first-child { margin-top: 0 }
  .issue, .note {
    padding: .5em;
    border-left-width: .5em;
    border-left-style: solid;
  }
  div.issue, div.note {
    padding: 1em 1.2em 0.5em;
    margin: 1em 0;
    position: relative;
    clear: both;
  }
  span.note, span.issue { padding: .1em .5em .15em; }

  .issue {
    border-color: #e05252;
    background: #fbe9e9;
  }
  .note {
    border-color: #52e052;
    background: #e9fbe9;
  }


  </style>
  <style>
/* HIGHLIGHTS */
  code.prettyprint {
    color:  inherit;
  }

  /* this from google-code-prettify */
  .pln{color:#000}@media screen{.str{color:#080}.kwd{color:#008}.com{color:#800}.typ{color:#606}.lit{color:#066}.pun,.opn,.clo{color:#660}.tag{color:#008}.atn{color:#606}.atv{color:#080}.dec,.var{color:#606}.fun{color:red}}@media print,projection{.str{color:#060}.kwd{color:#006;font-weight:bold}.com{color:#600;font-style:italic}.typ{color:#404;font-weight:bold}.lit{color:#044}.pun,.opn,.clo{color:#440}.tag{color:#006;font-weight:bold}.atn{color:#404}.atv{color:#060}}ol.linenums{margin-top:0;margin-bottom:0}li.L0,li.L1,li.L2,li.L3,li.L5,li.L6,li.L7,li.L8{list-style-type:none}li.L1,li.L3,li.L5,li.L7,li.L9{background:#eee}
  </style>
  <style>
/* --- WEB IDL --- */
  pre.idl {
    border-top: 1px solid #90b8de;
    border-bottom: 1px solid #90b8de;
    padding:    1em;
    line-height:    120%;
  }

  pre.idl::before {
    content:    "WebIDL";
    display:    block;
    width:      150px;
    background: #90b8de;
    color:  #fff;
    font-family:    initial;
    padding:    3px;
    font-weight:    bold;
    margin: -1em 0 1em -1em;
  }

  .idlType {
    color:  #ff4500;
    font-weight:    bold;
    text-decoration:    none;
  }

  /*.idlModule*/
  /*.idlModuleID*/
  /*.idlInterface*/
  .idlInterfaceID, .idlDictionaryID, .idlCallbackID, .idlEnumID {
    font-weight:    bold;
    color:  #005a9c;
  }
  a.idlEnumItem {
    color:  #000;
    border-bottom:  1px dotted #ccc;
    text-decoration: none;
  }

  .idlSuperclass {
    font-style: italic;
    color:  #005a9c;
  }

  /*.idlAttribute*/
  .idlAttrType, .idlFieldType, .idlMemberType {
    color:  #005a9c;
  }
  .idlAttrName, .idlFieldName, .idlMemberName {
    color:  #ff4500;
  }
  .idlAttrName a, .idlFieldName a, .idlMemberName a {
    color:  #ff4500;
    border-bottom:  1px dotted #ff4500;
    text-decoration: none;
  }

  /*.idlMethod*/
  .idlMethType, .idlCallbackType {
    color:  #005a9c;
  }
  .idlMethName {
    color:  #ff4500;
  }
  .idlMethName a {
    color:  #ff4500;
    border-bottom:  1px dotted #ff4500;
    text-decoration: none;
  }

  /*.idlCtor*/
  .idlCtorName {
    color:  #ff4500;
  }
  .idlCtorName a {
    color:  #ff4500;
    border-bottom:  1px dotted #ff4500;
    text-decoration: none;
  }

  /*.idlParam*/
  .idlParamType {
    color:  #005a9c;
  }
  .idlParamName, .idlDefaultValue {
    font-style: italic;
  }

  .extAttr {
    color:  #666;
  }

  /*.idlSectionComment*/
  .idlSectionComment {
    color: gray;
  }

  /*.idlConst*/
  .idlConstType {
    color:  #005a9c;
  }
  .idlConstName {
    color:  #ff4500;
  }
  .idlConstName a {
    color:  #ff4500;
    border-bottom:  1px dotted #ff4500;
    text-decoration: none;
  }

  /*.idlException*/
  .idlExceptionID {
    font-weight:    bold;
    color:  #c00;
  }

  .idlTypedefID, .idlTypedefType {
    color:  #005a9c;
  }

  .idlRaises, .idlRaises a.idlType, .idlRaises a.idlType code, .excName a, .excName a code {
    color:  #c00;
    font-weight:    normal;
  }

  .excName a {
    font-family:    monospace;
  }

  .idlRaises a.idlType, .excName a.idlType {
    border-bottom:  1px dotted #c00;
  }

  .excGetSetTrue, .excGetSetFalse, .prmNullTrue, .prmNullFalse, .prmOptTrue, .prmOptFalse {
    width:  45px;
    text-align: center;
  }
  .excGetSetTrue, .prmNullTrue, .prmOptTrue { color:  #0c0; }
  .excGetSetFalse, .prmNullFalse, .prmOptFalse { color:  #c00; }

  .idlImplements a {
    font-weight:    bold;
  }

  dl.attributes, dl.methods, dl.constants, dl.constructors, dl.fields, dl.dictionary-members {
    margin-left:    2em;
  }

  .attributes dt, .methods dt, .constants dt, .constructors dt, .fields dt, .dictionary-members dt {
    font-weight:    normal;
  }

  .attributes dt code, .methods dt code, .constants dt code, .constructors dt code, .fields dt code, .dictionary-members dt code {
    font-weight:    bold;
    color:  #000;
    font-family:    monospace;
  }

  .attributes dt code, .fields dt code, .dictionary-members dt code {
    background:  #ffffd2;
  }

  .attributes dt .idlAttrType code, .fields dt .idlFieldType code, .dictionary-members dt .idlMemberType code {
    color:  #005a9c;
    background:  transparent;
    font-family:    inherit;
    font-weight:    normal;
    font-style: italic;
  }

  .methods dt code {
    background:  #d9e6f8;
  }

  .constants dt code {
    background:  #ddffd2;
  }

  .constructors dt code {
    background:  #cfc;
  }

  .attributes dd, .methods dd, .constants dd, .constructors dd, .fields dd, .dictionary-members dd {
    margin-bottom:  1em;
  }

  table.parameters, table.exceptions {
    border-spacing: 0;
    border-collapse:    collapse;
    margin: 0.5em 0;
    width:  100%;
  }
  table.parameters { border-bottom:  1px solid #90b8de; }
  table.exceptions { border-bottom:  1px solid #deb890; }

  .parameters th, .exceptions th {
    color:  #fff;
    padding:    3px 5px;
    text-align: left;
    font-family:    initial;
    font-weight:    normal;
    text-shadow:    #666 1px 1px 0;
  }
  .parameters th { background: #90b8de; }
  .exceptions th { background: #deb890; }

  .parameters td, .exceptions td {
    padding:    3px 10px;
    border-top: 1px solid #ddd;
    vertical-align: top;
  }

  .parameters tr:first-child td, .exceptions tr:first-child td {
    border-top: none;
  }

  .parameters td.prmName, .exceptions td.excName, .exceptions td.excCodeName {
    width:  100px;
  }

  .parameters td.prmType {
    width:  120px;
  }

  table.exceptions table {
    border-spacing: 0;
    border-collapse:    collapse;
    width:  100%;
  }
  </style>
  <link rel="stylesheet" href=
  "http://www.w3.org/StyleSheets/TR/W3C-WD">
</head>

<body class="h-entry">
  <div class="head">
    <p><a href="http://www.w3.org/"><img alt="W3C" width="72"
    height="48" src="http://www.w3.org/Icons/w3c_home"></a></p>

    <h1 class="title p-name" id="title">Messaging API</h1>

    <h2 id="date"><abbr title=
    "World Wide Web Consortium">W3C</abbr> First Public Working Draft 16 May
    2013</h2>

    <dl>
      <dt>This version:</dt>

      <dd>
        <a class="u-url" href=
        "http://www.w3.org/TR/2013/WD-messaging-20130516/">http://www.w3.org/TR/2013/WD-messaging-20130516/</a>
      </dd>

      <dt>Latest published version:</dt>

      <dd>
        <a href=
        "http://www.w3.org/TR/messaging/">http://www.w3.org/TR/messaging/</a>
      </dd>

      <dt>Latest editor's draft:</dt>

      <dd>
        <a href=
        "http://www.w3.org/2012/sysapps/messaging/">http://www.w3.org/2012/sysapps/messaging/</a>
      </dd>

      <dt>Editors:</dt>

      <dd class="p-author h-card vcard">
        <span class="p-name fn">Eduardo Fullea</span>, <a class=
        "p-org org h-org h-card" href=
        "http://www.tid.es/">Telefonica</a>
      </dd>

      <dd class="p-author h-card vcard">
        <span class="p-name fn">Jose M. Cantera</span>, <a class=
        "p-org org h-org h-card" href=
        "http://www.tid.es/">Telefonica</a>
      </dd>

      <dd class="p-author h-card vcard">
        <span class="p-name fn">Zoltan Kis</span>, <a class=
        "p-org org h-org h-card" href=
        "http://www.intel.com/">Intel</a>
      </dd>
    </dl>

    <p class="copyright"><a href=
    "http://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a>
    © 2013 <a href="http://www.w3.org/"><abbr title=
    "World Wide Web Consortium">W3C</abbr></a><sup>®</sup>
    (<a href="http://www.csail.mit.edu/"><abbr title=
    "Massachusetts Institute of Technology">MIT</abbr></a>,
    <a href="http://www.ercim.eu/"><abbr title=
    "European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>,
    <a href="http://www.keio.ac.jp/">Keio</a>, <a href=
    "http://ev.buaa.edu.cn/">Beihang</a>), All Rights Reserved.
    <abbr title="World Wide Web Consortium">W3C</abbr> <a href=
    "http://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">
    liability</a>, <a href=
    "http://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a>
    and <a href=
    "http://www.w3.org/Consortium/Legal/copyright-documents">document
    use</a> rules apply.</p>
    <hr>
  </div>
  <!--============================ Abstract ==================================-->

  <section id="abstract" class="introductory">
    <h2>Abstract</h2>

    <p>This specification defines a System Level API which offers a
    simple interface to get access to mobile messaging services. A
    typical use case of the Messaging API is the implementation of
    a messaging client application that allows the user to send SMS
    and MMS messages as well as to access and manage the received
    SMS and MMS messages.</p>
  </section>

  <section id="sotd" class="introductory">
    <h2>Status of This Document</h2>

    <p><em>This section describes the status of this document at
    the time of its publication. Other documents may supersede this
    document. A list of current <abbr title=
    "World Wide Web Consortium">W3C</abbr> publications and the
    latest revision of this technical report can be found in the
    <a href="http://www.w3.org/TR/"><abbr title=
    "World Wide Web Consortium">W3C</abbr> technical reports
    index</a> at http://www.w3.org/TR/.</em></p>

    <p>This document defines a System Level API for access to
    mobile messaging services including SMS and MMS messages.
    This can be contrasted with the earlier and discontinued draft
    <a href="http://dev.w3.org/2009/dap/messaging/">messaging</a>
    specification for the regular browser context.</p>

    <p>This document was published by the <a href=
    "http://www.w3.org/2012/sysapps/">System Applications Working
    Group</a> as a First Public Working Draft. This document is
    intended to become a <abbr title=
    "World Wide Web Consortium">W3C</abbr> Recommendation. If you
    wish to make comments regarding this document, please send them
    to <a href=
    "mailto:public-sysapps@w3.org">public-sysapps@w3.org</a>
    (<a href=
    "mailto:public-sysapps-request@w3.org?subject=subscribe">subscribe</a>,
    <a href=
    "http://lists.w3.org/Archives/Public/public-sysapps/">archives</a>).
    All feedback is welcome.</p>

    <p>Publication as a First Public Working Draft does not imply
    endorsement by the <abbr title="World Wide Web Consortium">W3C</abbr>
    Membership. This is a draft document and may be updated,
    replaced or obsoleted by other documents at any time. It is
    inappropriate to cite this document as other than work in
    progress.</p>

    <p>This document was produced by a group operating under the
    <a href=
    "http://www.w3.org/Consortium/Patent-Policy-20040205/">5
    February 2004 <abbr title=
    "World Wide Web Consortium">W3C</abbr> Patent Policy</a>.
    <abbr title="World Wide Web Consortium">W3C</abbr> maintains a
    <a href="http://www.w3.org/2004/01/pp-impl/58119/status" rel=
    "disclosure">public list of any patent disclosures</a> made in
    connection with the deliverables of the group; that page also
    includes instructions for disclosing a patent. An individual
    who has actual knowledge of a patent which the individual
    believes contains <a href=
    "http://www.w3.org/Consortium/Patent-Policy-20040205/#def-essential">
    Essential Claim(s)</a> must disclose the information in
    accordance with <a href=
    "http://www.w3.org/Consortium/Patent-Policy-20040205/#sec-Disclosure">
    section 6 of the <abbr title=
    "World Wide Web Consortium">W3C</abbr> Patent Policy</a>.</p>
  </section>

  <section id="toc">
    <h2 class="introductory">Table of Contents</h2>

    <ul class="toc">
      <li class="tocline">
        <a href="#introduction" class="tocxref"><span class=
        "secno">1.</span> Introduction</a>
      </li>

      <li class="tocline">
        <a href="#conformance" class="tocxref"><span class=
        "secno">2.</span> Conformance</a>
      </li>

      <li class="tocline">
        <a href="#terminology" class="tocxref"><span class=
        "secno">3.</span> Terminology</a>
      </li>

      <li class="tocline">
        <a href="#security-and-privacy-considerations" class=
        "tocxref"><span class="secno">4.</span> Security and
        privacy considerations</a>
      </li>

      <li class="tocline">
        <a href="#navigator-interface" class="tocxref"><span class=
        "secno">5.</span> <span class=
        "formerLink"><code>Navigator</code></span> Interface</a>

        <ul class="toc">
          <li class="tocline">
            <a href="#attributes" class="tocxref"><span class=
            "secno">5.1</span> Attributes</a>
          </li>
        </ul>
      </li>

      <li class="tocline">
        <a href="#messagingmanager-interface" class=
        "tocxref"><span class="secno">6.</span> <span class=
        "formerLink"><code>MessagingManager</code></span>
        Interface</a>

        <ul class="toc">
          <li class="tocline">
            <a href="#attributes-1" class="tocxref"><span class=
            "secno">6.1</span> Attributes</a>
          </li>

          <li class="tocline">
            <a href="#methods" class="tocxref"><span class=
            "secno">6.2</span> Methods</a>
          </li>

          <li class="tocline">
            <a href="#steps" class="tocxref"><span class=
            "secno">6.3</span> Steps</a>
          </li>
        </ul>
      </li>

      <li class="tocline">
        <a href="#smsmanager-interface" class=
        "tocxref"><span class="secno">7.</span> <span class=
        "formerLink"><code>SmsManager</code></span> Interface</a>

        <ul class="toc">
          <li class="tocline">
            <a href="#attributes-2" class="tocxref"><span class=
            "secno">7.1</span> Attributes</a>
          </li>

          <li class="tocline">
            <a href="#methods-1" class="tocxref"><span class=
            "secno">7.2</span> Methods</a>
          </li>

          <li class="tocline">
            <a href="#steps-1" class="tocxref"><span class=
            "secno">7.3</span> Steps</a>
          </li>

          <li class="tocline">
            <a href="#event-handlers" class="tocxref"><span class=
            "secno">7.4</span> Event handlers</a>
          </li>
        </ul>
      </li>

      <li class="tocline">
        <a href="#smssegmentinfo-dictionary" class=
        "tocxref"><span class="secno">8.</span> <span class=
        "formerLink"><code>SmsSegmentInfo</code></span>
        Dictionary</a>

        <ul class="toc">
          <li class="tocline">
            <a href="#dictionary-smssegmentinfo-members" class=
            "tocxref"><span class="secno">8.1</span> Dictionary
            <span class=
            "formerLink"><code>SmsSegmentInfo</code></span>
            Members</a>
          </li>
        </ul>
      </li>

      <li class="tocline">
        <a href="#mmsmanager-interface" class=
        "tocxref"><span class="secno">9.</span> <span class=
        "formerLink"><code>MmsManager</code></span> Interface</a>

        <ul class="toc">
          <li class="tocline">
            <a href="#attributes-3" class="tocxref"><span class=
            "secno">9.1</span> Attributes</a>
          </li>

          <li class="tocline">
            <a href="#methods-2" class="tocxref"><span class=
            "secno">9.2</span> Methods</a>
          </li>

          <li class="tocline">
            <a href="#steps-2" class="tocxref"><span class=
            "secno">9.3</span> Steps</a>
          </li>

          <li class="tocline">
            <a href="#event-handlers-1" class=
            "tocxref"><span class="secno">9.4</span> Event
            handlers</a>
          </li>
        </ul>
      </li>

      <li class="tocline">
        <a href="#smsmessage-interface" class=
        "tocxref"><span class="secno">10.</span> <span class=
        "formerLink"><code>SmsMessage</code></span> Interface</a>

        <ul class="toc">
          <li class="tocline">
            <a href="#attributes-4" class="tocxref"><span class=
            "secno">10.1</span> Attributes</a>
          </li>
        </ul>
      </li>

      <li class="tocline">
        <a href="#mmsmessage-interface" class=
        "tocxref"><span class="secno">11.</span> <span class=
        "formerLink"><code>MmsMessage</code></span> Interface</a>

        <ul class="toc">
          <li class="tocline">
            <a href="#attributes-5" class="tocxref"><span class=
            "secno">11.1</span> Attributes</a>
          </li>
        </ul>
      </li>

      <li class="tocline">
        <a href="#mmscontent-dictionary" class=
        "tocxref"><span class="secno">12.</span> <span class=
        "formerLink"><code>MmsContent</code></span> Dictionary</a>

        <ul class="toc">
          <li class="tocline">
            <a href="#dictionary-mmscontent-members" class=
            "tocxref"><span class="secno">12.1</span> Dictionary
            <span class="formerLink"><code>MmsContent</code></span>
            Members</a>
          </li>
        </ul>
      </li>

      <li class="tocline">
        <a href="#mmsattachment-dictionary" class=
        "tocxref"><span class="secno">13.</span> <span class=
        "formerLink"><code>MmsAttachment</code></span>
        Dictionary</a>

        <ul class="toc">
          <li class="tocline">
            <a href="#dictionary-mmsattachment-members" class=
            "tocxref"><span class="secno">13.1</span> Dictionary
            <span class=
            "formerLink"><code>MmsAttachment</code></span>
            Members</a>
          </li>
        </ul>
      </li>

      <li class="tocline">
        <a href="#conversation-interface" class=
        "tocxref"><span class="secno">14.</span> <span class=
        "formerLink"><code>Conversation</code></span> Interface</a>

        <ul class="toc">
          <li class="tocline">
            <a href="#attributes-6" class="tocxref"><span class=
            "secno">14.1</span> Attributes</a>
          </li>
        </ul>
      </li>

      <li class="tocline">
        <a href="#messagingcursor-interface" class=
        "tocxref"><span class="secno">15.</span> <span class=
        "formerLink"><code>MessagingCursor</code></span>
        Interface</a>

        <ul class="toc">
          <li class="tocline">
            <a href="#attributes-7" class="tocxref"><span class=
            "secno">15.1</span> Attributes</a>
          </li>

          <li class="tocline">
            <a href="#methods-3" class="tocxref"><span class=
            "secno">15.2</span> Methods</a>
          </li>
        </ul>
      </li>

      <li class="tocline">
        <a href="#receivedmessage-interface" class=
        "tocxref"><span class="secno">16.</span> <span class=
        "formerLink"><code>ReceivedMessage</code></span>
        Interface</a>

        <ul class="toc">
          <li class="tocline">
            <a href="#attributes-8" class="tocxref"><span class=
            "secno">16.1</span> Attributes</a>
          </li>
        </ul>
      </li>

      <li class="tocline">
        <a href="#deliveryreport-interface" class=
        "tocxref"><span class="secno">17.</span> <span class=
        "formerLink"><code>DeliveryReport</code></span>
        Interface</a>

        <ul class="toc">
          <li class="tocline">
            <a href="#attributes-9" class="tocxref"><span class=
            "secno">17.1</span> Attributes</a>
          </li>
        </ul>
      </li>

      <li class="tocline">
        <a href="#messagingevent-interface" class=
        "tocxref"><span class="secno">18.</span> <span class=
        "formerLink"><code>MessagingEvent</code></span>
        Interface</a>

        <ul class="toc">
          <li class="tocline">
            <a href="#attributes-10" class="tocxref"><span class=
            "secno">18.1</span> Attributes</a>
          </li>
        </ul>
      </li>

      <li class="tocline">
        <a href="#deliveryreportevent-interface" class=
        "tocxref"><span class="secno">19.</span> <span class=
        "formerLink"><code>DeliveryReportEvent</code></span>
        Interface</a>

        <ul class="toc">
          <li class="tocline">
            <a href="#attributes-11" class="tocxref"><span class=
            "secno">19.1</span> Attributes</a>
          </li>
        </ul>
      </li>

      <li class="tocline">
        <a href="#servicechangeevent-interface" class=
        "tocxref"><span class="secno">20.</span> <span class=
        "formerLink"><code>ServiceChangeEvent</code></span>
        Interface</a>

        <ul class="toc">
          <li class="tocline">
            <a href="#attributes-12" class="tocxref"><span class=
            "secno">20.1</span> Attributes</a>
          </li>
        </ul>
      </li>

      <li class="tocline">
        <a href="#messagingfilter-dictionary" class=
        "tocxref"><span class="secno">21.</span> <span class=
        "formerLink"><code>MessagingFilter</code></span>
        Dictionary</a>

        <ul class="toc">
          <li class="tocline">
            <a href="#dictionary-messagingfilter-members" class=
            "tocxref"><span class="secno">21.1</span> Dictionary
            <span class=
            "formerLink"><code>MessagingFilter</code></span>
            Members</a>
          </li>
        </ul>
      </li>

      <li class="tocline">
        <a href="#filteroptions-dictionary" class=
        "tocxref"><span class="secno">22.</span> <span class=
        "formerLink"><code>FilterOptions</code></span>
        Dictionary</a>

        <ul class="toc">
          <li class="tocline">
            <a href="#dictionary-filteroptions-members" class=
            "tocxref"><span class="secno">22.1</span> Dictionary
            <span class=
            "formerLink"><code>FilterOptions</code></span>
            Members</a>
          </li>
        </ul>
      </li>

      <li class="tocline">
        <a href="#enumerations" class="tocxref"><span class=
        "secno">23.</span> Enumerations</a>
      </li>

      <li class="tocline">
        <a href="#acknowledgements" class="tocxref"><span class=
        "secno">24.</span> Acknowledgements</a>
      </li>

      <li class="tocline">
        <a href="#references" class="tocxref"><span class=
        "secno">A.</span> References</a>

        <ul class="toc">
          <li class="tocline">
            <a href="#normative-references" class=
            "tocxref"><span class="secno">A.1</span> Normative
            references</a>
          </li>

          <li class="tocline">
            <a href="#informative-references" class=
            "tocxref"><span class="secno">A.2</span> Informative
            references</a>
          </li>
        </ul>
      </li>
    </ul>
  </section>
  <!--===================== Status of this document ==========================--><!--=========================== Introduction ===============================-->

  <section class="informative" id="introduction">
    <!--OddPage-->

    <h2><span class="secno">1.</span> Introduction</h2>

    <p><em>This section is non-normative.</em></p>

    <p>The Messaging API provides operations to get access to the
    primitives offered by mobile messaging services (send, receive)
    as well as those that allow to manage a mobile messaging client
    inbox (delete, store, mark as read)</p>

    <p>An example of use is provided below:</p>

    <div class="example">
      <div class="example-title">
        <span>Example 1</span>
      </div>
      <pre class="example highlight prettyprint">
<span class="pln">navigator</span><span class=
"pun">.</span><span class="pln">messaging</span><span class=
"pun">.</span><span class="pln">sms</span><span class=
"pun">.</span><span class="pln">send </span><span class=
"pun">(</span><span class="pln"> </span><span class=
"str">'+1234567890'</span><span class="pun">,</span><span class=
"pln"> </span><span class="str">'How are you?'</span><span class=
"pun">).</span><span class="kwd">done</span><span class=
"pun">(</span><span class="pln">
  </span><span class="kwd">function</span><span class=
"pun">(</span><span class="pln">message</span><span class=
"pun">)</span><span class="pln"> </span><span class=
"pun">{</span><span class="pln"> window</span><span class=
"pun">.</span><span class="pln">console</span><span class=
"pun">.</span><span class="pln">log</span><span class=
"pun">(</span><span class=
"str">'Message with identifier  '</span><span class=
"pln"> </span><span class="pun">+</span><span class="pln">
                      message</span><span class=
"pun">.</span><span class="pln">messageID </span><span class=
"pun">+</span><span class="pln"> </span><span class=
"str">' sent at '</span><span class="pln"> </span><span class=
"pun">+</span><span class="pln"> message</span><span class=
"pun">.</span><span class="pln">timestamp</span><span class=
"pun">);</span><span class="pln"> </span><span class=
"pun">},</span><span class="pln">
  </span><span class="kwd">function</span><span class=
"pun">(</span><span class="pln">error</span><span class=
"pun">)</span><span class="pln"> </span><span class=
"pun">{</span><span class="pln">   window</span><span class=
"pun">.</span><span class="pln">console</span><span class=
"pun">.</span><span class="pln">error</span><span class=
"pun">(</span><span class="str">'Error: '</span><span class=
"pln"> </span><span class="pun">+</span><span class=
"pln"> error</span><span class="pun">);</span><span class=
"pln"> </span><span class="pun">}</span><span class=
"pln"> </span><span class="pun">)</span>
</pre>
    </div>
  </section>
  <!--========================== Conformance =================================-->

  <section id="conformance">
    <!--OddPage-->

    <h2><span class="secno">2.</span> Conformance</h2>

    <p>As well as sections marked as non-normative, all authoring
    guidelines, diagrams, examples, and notes in this specification
    are non-normative. Everything else in this specification is
    normative.</p>

    <p>The key words <em class="rfc2119" title="MUST">MUST</em>,
    <em class="rfc2119" title="MUST NOT">MUST NOT</em>, <em class=
    "rfc2119" title="REQUIRED">REQUIRED</em>, <em class="rfc2119"
    title="SHOULD">SHOULD</em>, <em class="rfc2119" title=
    "SHOULD NOT">SHOULD NOT</em>, <em class="rfc2119" title=
    "RECOMMENDED">RECOMMENDED</em>, <em class="rfc2119" title=
    "MAY">MAY</em>, and <em class="rfc2119" title=
    "OPTIONAL">OPTIONAL</em> in this specification are to be
    interpreted as described in [<cite><a class="bibref" href=
    "#bib-RFC2119">RFC2119</a></cite>].</p>

    <p>This specification defines conformance criteria that apply
    to a single product: the <dfn id="dfn-user-agent">user
    agent</dfn> that implements the interfaces that it
    contains.</p>

    <p>Implementations that use ECMAScript to implement the APIs
    defined in this specification <em class="rfc2119" title=
    "MUST">MUST</em> implement them in a manner consistent with the
    ECMAScript Bindings defined in the Web IDL specification
    [<cite><a class="bibref" href="#bib-WEBIDL">WEBIDL</a></cite>],
    as this specification uses that specification and
    terminology.</p>
  </section>
  <!--=========================== Terminology ================================-->

  <section id="terminology">
    <!--OddPage-->

    <h2><span class="secno">3.</span> Terminology</h2>

    <p>The <code><a href=
    "http://dev.w3.org/html5/spec/webappapis.html#eventhandler">EventHandler</a></code>
    interface represents a callback used for event handlers as
    defined in [<cite><a class="bibref" href=
    "#bib-HTML5">HTML5</a></cite>].</p>

    <p>The concepts <dfn id="dfn-queue-a-task"><a href=
    "http://dev.w3.org/html5/spec/webappapis.html#queue-a-task">queue
    a task</a></dfn> and <dfn id="dfn-fire-an-event"><a href=
    "http://dev.w3.org/html5/spec/webappapis.html#fire-a-simple-event">
    fire an event</a></dfn> are defined in [<cite><a class="bibref"
    href="#bib-HTML5">HTML5</a></cite>].</p>

    <p>The terms <a href=
    "http://dev.w3.org/html5/spec/webappapis.html#event-handlers"><dfn id="dfn-eventhandler">
    event handler</dfn></a> and <a href=
    "http://dev.w3.org/html5/spec/webappapis.html#event-handler-event-type">
    <dfn id="dfn-eventtypes">event handler event types</dfn></a>
    are defined in [<cite><a class="bibref" href=
    "#bib-HTML5">HTML5</a></cite>].</p>
  </section>
  <!--====================== Security and privacy ============================-->

  <section id="security-and-privacy-considerations">
    <!--OddPage-->

    <h2><span class="secno">4.</span> Security and privacy
    considerations</h2>

    <p>This API must be only exposed to trusted content</p>
  </section>
  <!--==================== Extended interface Navigator ======================-->

  <section id="navigator-interface">
    <!--OddPage-->

    <h2><span class="secno">5.</span> <a href="#idl-def-Navigator"
    class="idlType"><code>Navigator</code></a> Interface</h2>
    <pre class="idl">
<span class="idlInterface" id=
"idl-def-Navigator">partial interface <span class=
"idlInterfaceID">Navigator</span> {
<span class="idlAttribute">    readonly    attribute <span class=
"idlAttrType"><a>Messaging</a></span> <span class=
"idlAttrName"><a href=
"#widl-Navigator-messaging">messaging</a></span>;</span>
};</span>
</pre>

    <section id="attributes">
      <h3><span class="secno">5.1</span> Attributes</h3>

      <dl class="attributes">
        <dt id="widl-Navigator-messaging"><code>messaging</code> of
        type <span class="idlAttrType"><a>Messaging</a></span>,
        readonly</dt>

        <dd>The object that exposes the interface to mobile
        messaging services.</dd>
      </dl>
    </section>
  </section>
  <!--====================== Interface MessagingManager =============================-->

  <section id="messagingmanager-interface">
    <!--OddPage-->

    <h2><span class="secno">6.</span> <a href=
    "#idl-def-MessagingManager" class=
    "idlType"><code>MessagingManager</code></a> Interface</h2>

    <p>The <a href="#idl-def-MessagingManager" class=
    "idlType"><code>MessagingManager</code></a> interface
    represents the initial entry point for getting access to the
    mobile messaging services, i.e. SMS and MMS.</p>
    <pre class="idl">
<span class="idlInterface" id=
"idl-def-MessagingManager">interface <span class=
"idlInterfaceID">MessagingManager</span> {
<span class="idlAttribute">    readonly    attribute <span class=
"idlAttrType"><a href="#idl-def-SmsManager" class=
"idlType"><code>SmsManager</code></a></span> <span class=
"idlAttrName"><a href=
"#widl-MessagingManager-sms">sms</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class=
"idlAttrType"><a href="#idl-def-MmsManager" class=
"idlType"><code>MmsManager</code></a></span> <span class=
"idlAttrName"><a href=
"#widl-MessagingManager-mms">mms</a></span>;</span>
<span class="idlMethod">    <span class=
"idlMethType"><a>Future</a></span> <span class=
"idlMethName"><a href=
"#widl-MessagingManager-findMessages-Future-MessagingFilter-filter-FilterOptions-options">findMessages</a></span> (<span class="idlParam"><span class="idlParamType"><a href="#idl-def-MessagingFilter"
class=
"idlType"><code>MessagingFilter</code></a></span> <span class="idlParamName">filter</span></span>, <span class="idlParam"><span class="idlParamType"><a href="#idl-def-FilterOptions"
class="idlType"><code>FilterOptions</code></a></span> <span class=
"idlParamName">options</span></span>);</span>
<span class="idlMethod">    <span class=
"idlMethType"><a>Future</a></span> <span class=
"idlMethName"><a href=
"#widl-MessagingManager-findConversations-Future-DOMString-groupBy-MessagingFilter-filter-FilterOptions-options">findConversations</a></span> (<span class="idlParam"><span class="idlParamType"><a>DOMString</a></span> <span class="idlParamName">groupBy</span></span>, <span class="idlParam"><span class="idlParamType"><a href="#idl-def-MessagingFilter"
class=
"idlType"><code>MessagingFilter</code></a></span> <span class="idlParamName">filter</span></span>, <span class="idlParam"><span class="idlParamType"><a href="#idl-def-FilterOptions"
class="idlType"><code>FilterOptions</code></a></span> <span class=
"idlParamName">options</span></span>);</span>
<span class="idlMethod">    <span class=
"idlMethType"><a>Future</a></span> <span class=
"idlMethName"><a href=
"#widl-MessagingManager-getMessage-Future-DOMString-messageID">getMessage</a></span> (<span class="idlParam"><span class="idlParamType"><a>DOMString</a></span> <span class="idlParamName">messageID</span></span>);</span>
<span class="idlMethod">    <span class=
"idlMethType"><a>Future</a></span> <span class=
"idlMethName"><a href=
"#widl-MessagingManager-deleteMessage-Future-DOMString-messageID">deleteMessage</a></span> (<span class="idlParam"><span class="idlParamType"><a>DOMString</a></span> <span class="idlParamName">messageID</span></span>);</span>
<span class="idlMethod">    <span class=
"idlMethType"><a>Future</a></span> <span class=
"idlMethName"><a href=
"#widl-MessagingManager-deleteConversation-Future-DOMString-conversationID">deleteConversation</a></span> (<span class="idlParam"><span class="idlParamType"><a>DOMString</a></span> <span class="idlParamName">conversationID</span></span>);</span>
<span class="idlMethod">    <span class=
"idlMethType"><a>Future</a></span> <span class=
"idlMethName"><a href=
"#widl-MessagingManager-markMessageRead-Future-DOMString-messageID-boolean-value">markMessageRead</a></span> (<span class="idlParam"><span class="idlParamType"><a>DOMString</a></span> <span class="idlParamName">messageID</span></span>, <span class="idlParam">optional <span class="idlParamType"><a>boolean</a></span> <span class="idlParamName">value</span> = <span class="idlDefaultValue">true</span></span>);</span>
<span class="idlMethod">    <span class=
"idlMethType"><a>Future</a></span> <span class=
"idlMethName"><a href=
"#widl-MessagingManager-markConversationRead-Future-DOMString-conversationID-boolean-value">markConversationRead</a></span> (<span class="idlParam"><span class="idlParamType"><a>DOMString</a></span> <span class="idlParamName">conversationID</span></span>, <span class="idlParam">optional <span class="idlParamType"><a>boolean</a></span> <span class="idlParamName">value</span> = <span class="idlDefaultValue">true</span></span>);</span>
};</span>
</pre>

    <section id="attributes-1">
      <h3><span class="secno">6.1</span> Attributes</h3>

      <dl class="attributes">
        <dt id="widl-MessagingManager-sms"><code>sms</code> of type
        <span class="idlAttrType"><a href="#idl-def-SmsManager"
        class="idlType"><code>SmsManager</code></a></span>,
        readonly</dt>

        <dd>Provides access to the SMS service's specific
        functionality.</dd>

        <dt id="widl-MessagingManager-mms"><code>mms</code> of type
        <span class="idlAttrType"><a href="#idl-def-MmsManager"
        class="idlType"><code>MmsManager</code></a></span>,
        readonly</dt>

        <dd>Provides access to the MMS service's specific
        functionality.</dd>
      </dl>
    </section>

    <section id="methods">
      <h3><span class="secno">6.2</span> Methods</h3>

      <dl class="methods">
        <dt id=
        "widl-MessagingManager-findMessages-Future-MessagingFilter-filter-FilterOptions-options">
        <code>findMessages</code></dt>

        <dd>
          This method makes a request to retrieve the messages
          matching the filter described by the <code>filter</code>
          parameter and according to the filtering options
          described in the <code>options</code>. It returns a new
          <code>Future</code> that will be used to notify the
          caller about the result of the operation, which is a
          MessagingCursor to access the set of messages.

          <table class="parameters">
            <tr>
              <th>Parameter</th>

              <th>Type</th>

              <th>Nullable</th>

              <th>Optional</th>

              <th>Description</th>
            </tr>

            <tr>
              <td class="prmName">filter</td>

              <td class="prmType"><code><a href=
              "#idl-def-MessagingFilter" class=
              "idlType"><code>MessagingFilter</code></a></code></td>

              <td class="prmNullFalse">✘</td>

              <td class="prmOptFalse">✘</td>

              <td class="prmDesc">Filter that identifies the set of
              messages that are requested to be retrieved</td>
            </tr>

            <tr>
              <td class="prmName">options</td>

              <td class="prmType"><code><a href=
              "#idl-def-FilterOptions" class=
              "idlType"><code>FilterOptions</code></a></code></td>

              <td class="prmNullFalse">✘</td>

              <td class="prmOptFalse">✘</td>

              <td class="prmDesc">Indicates the filtering options
              (i.e. sorting criteria, sorting order, limit of
              results).</td>
            </tr>
          </table>

          <div>
            <em>Return type:</em> <code><a>Future</a></code>
          </div>
        </dd>

        <dt id=
        "widl-MessagingManager-findConversations-Future-DOMString-groupBy-MessagingFilter-filter-FilterOptions-options">
        <code>findConversations</code></dt>

        <dd>
          This method makes a request to retrieve the list of
          conversations in which the messages can be grouped using
          the criteria defined by the <code>groupBy</code>
          parameter. Only those messages matching the filter
          described in the <code>filter</code> parameter <em class=
          "rfc2119" title="SHALL">SHALL</em> be included in the
          resulting conversations, what can be useful for instance
          to filter just a specific type of messages (e.g. SMS) or
          to implement message search in a conversational messaging
          client. It returns a new <code>Future</code> that will be
          used to notify the caller about the result of the
          operation, which is a MessagingCursor to access the set
          of conversations.

          <table class="parameters">
            <tr>
              <th>Parameter</th>

              <th>Type</th>

              <th>Nullable</th>

              <th>Optional</th>

              <th>Description</th>
            </tr>

            <tr>
              <td class="prmName">groupBy</td>

              <td class="prmType">
              <code><a>DOMString</a></code></td>

              <td class="prmNullFalse">✘</td>

              <td class="prmOptFalse">✘</td>

              <td class="prmDesc">Indicates the criteria used to
              define the conversations. It may have the values
              'participants' if a conversation is to be defined as
              the set of messages exchanged among the same set of
              parties, and 'subject' if a conversation is to be
              defined as the set of messages with the same
              subject.</td>
            </tr>

            <tr>
              <td class="prmName">filter</td>

              <td class="prmType"><code><a href=
              "#idl-def-MessagingFilter" class=
              "idlType"><code>MessagingFilter</code></a></code></td>

              <td class="prmNullFalse">✘</td>

              <td class="prmOptFalse">✘</td>

              <td class="prmDesc">Filter that identifies the set of
              messages that are requested to be included in the
              resulting conversations.</td>
            </tr>

            <tr>
              <td class="prmName">options</td>

              <td class="prmType"><code><a href=
              "#idl-def-FilterOptions" class=
              "idlType"><code>FilterOptions</code></a></code></td>

              <td class="prmNullFalse">✘</td>

              <td class="prmOptFalse">✘</td>

              <td class="prmDesc">Indicates the filtering options
              (i.e. sorting criteria, sorting order, limit of
              results) to be aplied when filtering the messages to
              be included in each of the resulting
              conversations.</td>
            </tr>
          </table>

          <div>
            <em>Return type:</em> <code><a>Future</a></code>
          </div>
        </dd>

        <dt id=
        "widl-MessagingManager-getMessage-Future-DOMString-messageID">
        <code>getMessage</code></dt>

        <dd>
          This method makes a request to retrieve the message
          identified by the <code>messageID</code> parameter. It
          returns a new <code>Future</code> object which allows the
          caller to be notified about the result of the operation.

          <table class="parameters">
            <tr>
              <th>Parameter</th>

              <th>Type</th>

              <th>Nullable</th>

              <th>Optional</th>

              <th>Description</th>
            </tr>

            <tr>
              <td class="prmName">messageID</td>

              <td class="prmType">
              <code><a>DOMString</a></code></td>

              <td class="prmNullFalse">✘</td>

              <td class="prmOptFalse">✘</td>

              <td class="prmDesc">Identifier of the message that is
              requested to be retrieved</td>
            </tr>
          </table>

          <div>
            <em>Return type:</em> <code><a>Future</a></code>
          </div>
        </dd>

        <dt id=
        "widl-MessagingManager-deleteMessage-Future-DOMString-messageID">
        <code>deleteMessage</code></dt>

        <dd>
          This method requests the deletion of the message with
          identifier equal to the <code>messageID</code> parameter.
          A new <code>Future</code> is returned in order to notify
          the request result (success or error) to the caller.

          <table class="parameters">
            <tr>
              <th>Parameter</th>

              <th>Type</th>

              <th>Nullable</th>

              <th>Optional</th>

              <th>Description</th>
            </tr>

            <tr>
              <td class="prmName">messageID</td>

              <td class="prmType">
              <code><a>DOMString</a></code></td>

              <td class="prmNullFalse">✘</td>

              <td class="prmOptFalse">✘</td>

              <td class="prmDesc">Identifier of the message that is
              requested to be deleted</td>
            </tr>
          </table>

          <div>
            <em>Return type:</em> <code><a>Future</a></code>
          </div>
        </dd>

        <dt id=
        "widl-MessagingManager-deleteConversation-Future-DOMString-conversationID">
        <code>deleteConversation</code></dt>

        <dd>
          This method requests the deletion of all the messages in
          the conversation with identifier equal to the
          <code>conversationID</code> parameter. A new
          <code>Future</code> is returned in order to notify the
          request result (success or error) to the caller.

          <table class="parameters">
            <tr>
              <th>Parameter</th>

              <th>Type</th>

              <th>Nullable</th>

              <th>Optional</th>

              <th>Description</th>
            </tr>

            <tr>
              <td class="prmName">conversationID</td>

              <td class="prmType">
              <code><a>DOMString</a></code></td>

              <td class="prmNullFalse">✘</td>

              <td class="prmOptFalse">✘</td>

              <td class="prmDesc">Identifier of the conversation
              whose messages are requested to be deleted</td>
            </tr>
          </table>

          <div>
            <em>Return type:</em> <code><a>Future</a></code>
          </div>
        </dd>

        <dt id=
        "widl-MessagingManager-markMessageRead-Future-DOMString-messageID-boolean-value">
        <code>markMessageRead</code></dt>

        <dd>
          This method requests to mark as read or unread the
          message with identifier equal to the
          <code>messageID</code> parameter. The method returns a
          new <code>Future</code> that will allow the caller to be
          notified about the result (success, error) of the
          operation.

          <table class="parameters">
            <tr>
              <th>Parameter</th>

              <th>Type</th>

              <th>Nullable</th>

              <th>Optional</th>

              <th>Description</th>
            </tr>

            <tr>
              <td class="prmName">messageID</td>

              <td class="prmType">
              <code><a>DOMString</a></code></td>

              <td class="prmNullFalse">✘</td>

              <td class="prmOptFalse">✘</td>

              <td class="prmDesc">Identifier of the message that is
              requested to be marked as read or unread</td>
            </tr>

            <tr>
              <td class="prmName">value</td>

              <td class="prmType"><code><a>boolean</a> =
              true</code></td>

              <td class="prmNullFalse">✘</td>

              <td class="prmOptTrue">✔</td>

              <td class="prmDesc">Indicates whether the message is
              to be marked as read ('true', which is the default)
              or unread ('false')</td>
            </tr>
          </table>

          <div>
            <em>Return type:</em> <code><a>Future</a></code>
          </div>
        </dd>

        <dt id=
        "widl-MessagingManager-markConversationRead-Future-DOMString-conversationID-boolean-value">
        <code>markConversationRead</code></dt>

        <dd>
          This method requests to mark as read or unread all the
          messages in the conversation with identifier equal to the
          <code>conversationID</code> parameter. The method returns
          a new <code>Future</code> that will allow the caller to
          be notified about the result (success, error) of the
          operation.

          <table class="parameters">
            <tr>
              <th>Parameter</th>

              <th>Type</th>

              <th>Nullable</th>

              <th>Optional</th>

              <th>Description</th>
            </tr>

            <tr>
              <td class="prmName">conversationID</td>

              <td class="prmType">
              <code><a>DOMString</a></code></td>

              <td class="prmNullFalse">✘</td>

              <td class="prmOptFalse">✘</td>

              <td class="prmDesc">Identifier of the conversation
              whose messages are requested to be marked as read or
              unread</td>
            </tr>

            <tr>
              <td class="prmName">value</td>

              <td class="prmType"><code><a>boolean</a> =
              true</code></td>

              <td class="prmNullFalse">✘</td>

              <td class="prmOptTrue">✔</td>

              <td class="prmDesc">Indicates whether the messages in
              the conversation are to be marked as read ('true',
              which is the default) or unread ('false')</td>
            </tr>
          </table>

          <div>
            <em>Return type:</em> <code><a>Future</a></code>
          </div>
        </dd>
      </dl>
    </section>

    <section id="steps">
      <h3><span class="secno">6.3</span> Steps</h3>

      <p>The <dfn id=
      "dfn-findmessages"><code>findMessages</code></dfn> method
      when invoked <em class="rfc2119" title="MUST">MUST</em> run
      the following steps:</p>

      <ol>
        <li>Make a request to the system to get the message(s)
        matching the filter included in the <code>filter</code>
        parameter and according to the filtering options described
        in the <code>options</code> parameter.</li>

        <li>Let <var>future</var> be a new <code>Future</code>
        object and <var>resolver</var> its associated
        <code>resolver</code></li>

        <li>Return <var>future</var> to the caller.</li>

        <li>If an <var>error</var> occurs call
        <var>resolver</var>'s <code>reject(value)</code>method with
        <var>error</var> as <code>value</code> argument.</li>

        <li>When the request has been successfully completed:

          <ol>
            <li>Let <var>messagingCursor</var> be a new
            <code>MessagingCursor</code> object providing access to
            the results of the retrieval, i.e. the set of
            <code>SmsMessage</code> and/or <code>MmsMessage</code>
            elements.</li>

            <li>Call <var>resolver</var>'s
            <code>accept(value)</code>method with
            <var>messagingCursor</var> as <code>value</code>
            argument.</li>
          </ol>
        </li>
      </ol>

      <p>The <dfn id=
      "dfn-findconversations"><code>findConversations</code></dfn>
      method when invoked <em class="rfc2119" title=
      "MUST">MUST</em> run the following steps:</p>

      <ol>
        <li>Make a request to the system to get the set of
        conversations in which the messages can be grouped,
        according to the set of participants or the subject as
        indicated in the <code>groupBy</code> parameter, and
        filtering the messages included in those conversations
        according to the filter included in the <code>filter</code>
        parameter and the filtering options described in the
        <code>options</code> parameter.</li>

        <li>Let <var>future</var> be a new <code>Future</code>
        object and <var>resolver</var> its associated
        <code>resolver</code></li>

        <li>Return <var>future</var> to the caller.</li>

        <li>If an <var>error</var> occurs call
        <var>resolver</var>'s <code>reject(value)</code>method with
        <var>error</var> as <code>value</code> argument.</li>

        <li>When the request has been successfully completed:

          <ol>
            <li>Let <var>messagingCursor</var> be a new
            <code>MessagingCursor</code> object providing access to
            the results of the retrieval, i.e. the set of
            <code>Conversation</code> elements.</li>

            <li>Call <var>resolver</var>'s
            <code>accept(value)</code>method with
            <var>messagingCursor</var> as <code>value</code>
            argument.</li>
          </ol>
        </li>
      </ol>

      <p>The <dfn id="dfn-getmessage"><code>getMessage</code></dfn>
      method when invoked <em class="rfc2119" title=
      "MUST">MUST</em> run the following steps:</p>

      <ol>
        <li>Make a request to the system to get the message with
        identifier equal to the <code>messageID</code> parameter
        passed in the request.</li>

        <li>Let <var>future</var> be a new <code>Future</code>
        object and <var>resolver</var> its associated
        <code>resolver</code></li>

        <li>Return <var>future</var> to the caller.</li>

        <li>If an <var>error</var> occurs call
        <var>resolver</var>'s <code>reject(value)</code>method with
        <var>error</var> as <code>value</code> argument.</li>

        <li>When the request has been successfully completed:

          <ol>
            <li>Let <var>message</var> be the
            <code>SmsMessage</code> or <code>MmsMessage</code>
            whose identifier matches the <code>messageID</code>
            parameter.</li>

            <li>Call <var>resolver</var>'s
            <code>accept(value)</code>method with
            <var>message</var> as <code>value</code> argument.</li>
          </ol>
        </li>
      </ol>

      <p>The <dfn id=
      "dfn-deletemessage"><code>deleteMessage</code></dfn> method
      when invoked <em class="rfc2119" title="MUST">MUST</em> run
      the following steps:</p>

      <ol>
        <li>Make a request to the system to delete the message with
        identifier equal to the <code>messageID</code> parameter
        passed in the request.</li>

        <li>Let <var>future</var> be a new <code>Future</code>
        object and <var>resolver</var> its associated
        <code>resolver</code></li>

        <li>Return <var>future</var> to the caller.</li>

        <li>If an <var>error</var> occurs call
        <var>resolver</var>'s <code>reject(value)</code>method with
        <var>error</var> as <code>value</code> argument.</li>

        <li>When the request has been successfully completed:

          <ol>
            <li>Let <var>messageID</var> be the
            <code>messageID</code> parameter passed in the
            request</li>

            <li>Call <var>resolver</var>'s
            <code>accept(value)</code>method with
            <var>messageID</var> as <code>value</code>
            argument.</li>
          </ol>
        </li>
      </ol>

      <p>The <dfn id=
      "dfn-deleteconversation"><code>deleteConversation</code></dfn>
      method when invoked <em class="rfc2119" title=
      "MUST">MUST</em> run the following steps:</p>

      <ol>
        <li>Make a request to the system to delete the messages in
        the conversation with identifier equal to the
        <code>conversationID</code> parameter passed in the
        request.</li>

        <li>Let <var>future</var> be a new <code>Future</code>
        object and <var>resolver</var> its associated
        <code>resolver</code></li>

        <li>Return <var>future</var> to the caller.</li>

        <li>If an <var>error</var> occurs call
        <var>resolver</var>'s <code>reject(value)</code>method with
        <var>error</var> as <code>value</code> argument.</li>

        <li>When the request has been successfully completed:

          <ol>
            <li>Let <var>conversationID</var> be the
            <code>conversationID</code> parameter passed in the
            request</li>

            <li>Call <var>resolver</var>'s
            <code>accept(value)</code>method with
            <var>conversationID</var> as <code>value</code>
            argument.</li>
          </ol>
        </li>
      </ol>

      <p>The <dfn id=
      "dfn-markmessageread"><code>markMessageRead</code></dfn>
      method when invoked <em class="rfc2119" title=
      "MUST">MUST</em> run the following steps:</p>

      <ol>
        <li>Make a request to the system to mark as read/unread
        (depending on the <code>value</code> parameter being
        respectively 'true' or 'false') the message with identifier
        equal to the <code>messageID</code> parameter passed in the
        request.</li>

        <li>Let <var>future</var> be a new <code>Future</code>
        object and <var>resolver</var> its associated
        <code>resolver</code></li>

        <li>Return <var>future</var> to the caller.</li>

        <li>If an <var>error</var> occurs call
        <var>resolver</var>'s <code>reject(value)</code>method with
        <var>error</var> as <code>value</code> argument.</li>

        <li>When the request has been successfully completed:

          <ol>
            <li>Let <var>messageID</var> be the
            <code>messageID</code> parameter passed in the
            request</li>

            <li>Call <var>resolver</var>'s
            <code>accept(value)</code>method with
            <var>messageID</var> as <code>value</code>
            argument.</li>
          </ol>
        </li>
      </ol>

      <p>The <dfn id=
      "dfn-markconversationread"><code>markConversationRead</code></dfn>
      method when invoked <em class="rfc2119" title=
      "MUST">MUST</em> run the following steps:</p>

      <ol>
        <li>Make a request to the system to mark as read/unread
        (depending on the <code>value</code> parameter being
        respectively 'true' or 'false') the messages in the
        conversation with identifier equal to the
        <code>conversationID</code> parameter passed in the
        request.</li>

        <li>Let <var>future</var> be a new <code>Future</code>
        object and <var>resolver</var> its associated
        <code>resolver</code></li>

        <li>Return <var>future</var> to the caller.</li>

        <li>If an <var>error</var> occurs call
        <var>resolver</var>'s <code>reject(value)</code>method with
        <var>error</var> as <code>value</code> argument.</li>

        <li>When the request has been successfully completed:

          <ol>
            <li>Let <var>conversationID</var> be the
            <code>conversationID</code> parameter passed in the
            request</li>

            <li>Call <var>resolver</var>'s
            <code>accept(value)</code>method with
            <var>conversationID</var> as <code>value</code>
            argument.</li>
          </ol>
        </li>
      </ol>

      <div class="note">
        <div class="note-title" role="heading" aria-level="4">
          <span>Note</span>
        </div>

        <div class="">
          It is FFS whether the methods deleteMessage() and
          markMessageRead() should also accept an array of message
          identifiers as input parameter.
        </div>
      </div>
    </section>
  </section>
  <!--====================== Interface SmsManager ============================-->

  <section id="smsmanager-interface">
    <!--OddPage-->

    <h2><span class="secno">7.</span> <a href="#idl-def-SmsManager"
    class="idlType"><code>SmsManager</code></a> Interface</h2>

    <p>The <a href="#idl-def-SmsManager" class=
    "idlType"><code>SmsManager</code></a> interface represents the
    SMS messaging service manager.</p>
    <pre class="idl">
<span class="idlInterface" id=
"idl-def-SmsManager">interface <span class=
"idlInterfaceID">SmsManager</span> : <span class=
"idlSuperclass"><a>EventTarget</a></span> {
<span class="idlAttribute">    readonly    attribute <span class=
"idlAttrType"><a href="#idl-def-MessageType" class=
"idlType"><code>MessageType</code></a></span>  <span class=
"idlAttrName"><a href=
"#widl-SmsManager-type">type</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class=
"idlAttrType"><a>DOMString</a>[]</span>  <span class=
"idlAttrName"><a href=
"#widl-SmsManager-serviceIDs">serviceIDs</a></span>;</span>
<span class="idlMethod">    <span class="idlMethType"><a href=
"#idl-def-SmsSegmentInfo" class=
"idlType"><code>SmsSegmentInfo</code></a></span> <span class=
"idlMethName"><a href=
"#widl-SmsManager-segmentInfo-SmsSegmentInfo-DOMString-text-DOMString-serviceID">segmentInfo</a></span> (<span class="idlParam"><span class="idlParamType"><a>DOMString</a></span> <span class="idlParamName">text</span></span>, <span class="idlParam">optional <span class="idlParamType"><a>DOMString</a></span> <span class="idlParamName">serviceID</span></span>);</span>
<span class="idlMethod">    <span class=
"idlMethType"><a>Future</a></span>         <span class=
"idlMethName"><a href=
"#widl-SmsManager-send-Future-DOMString-to-DOMString-text-DOMString-serviceID">send</a></span> (<span class="idlParam"><span class="idlParamType"><a>DOMString</a></span> <span class="idlParamName">to</span></span>, <span class="idlParam"><span class="idlParamType"><a>DOMString</a></span> <span class="idlParamName">text</span></span>, <span class="idlParam">optional <span class="idlParamType"><a>DOMString</a></span> <span class="idlParamName">serviceID</span></span>);</span>
<span class="idlMethod">    <span class=
"idlMethType"><a>Future</a></span>         <span class=
"idlMethName"><a href=
"#widl-SmsManager-clear-Future-DOMString-serviceID">clear</a></span> (<span class="idlParam"><span class="idlParamType"><a>DOMString</a></span> <span class="idlParamName">serviceID</span></span>);</span>
<span class="idlAttribute">                attribute <span class=
"idlAttrType"><a>EventHandler</a></span> <span class=
"idlAttrName"><a href=
"#widl-SmsManager-onreceived">onreceived</a></span>;</span>
<span class="idlAttribute">                attribute <span class=
"idlAttrType"><a>EventHandler</a></span> <span class=
"idlAttrName"><a href=
"#widl-SmsManager-onsent">onsent</a></span>;</span>
<span class="idlAttribute">                attribute <span class=
"idlAttrType"><a>EventHandler</a></span> <span class=
"idlAttrName"><a href=
"#widl-SmsManager-ondeliverysuccess">ondeliverysuccess</a></span>;</span>
<span class="idlAttribute">                attribute <span class=
"idlAttrType"><a>EventHandler</a></span> <span class=
"idlAttrName"><a href=
"#widl-SmsManager-ondeliveryfailure">ondeliveryfailure</a></span>;</span>
<span class="idlAttribute">                attribute <span class=
"idlAttrType"><a>EventHandler</a></span> <span class=
"idlAttrName"><a href=
"#widl-SmsManager-onserviceadded">onserviceadded</a></span>;</span>
<span class="idlAttribute">                attribute <span class=
"idlAttrType"><a>EventHandler</a></span> <span class=
"idlAttrName"><a href=
"#widl-SmsManager-onserviceremoved">onserviceremoved</a></span>;</span>
};</span>
</pre>

    <section id="attributes-2">
      <h3><span class="secno">7.1</span> Attributes</h3>

      <dl class="attributes">
        <dt id="widl-SmsManager-type"><code>type</code> of type
        <span class="idlAttrType"><a href="#idl-def-MessageType"
        class="idlType"><code>MessageType</code></a></span>,
        readonly</dt>

        <dd><em class="rfc2119" title="MUST">MUST</em> return the
        type of the messaging service manager. It can have the
        following values: 'sms' or 'mms'.</dd>

        <dt id="widl-SmsManager-serviceIDs"><code>serviceIDs</code>
        of type array of <span class=
        "idlAttrType"><a>DOMString</a></span>, readonly</dt>

        <dd><em class="rfc2119" title="MUST">MUST</em> return the
        identifier of the different services for this type of
        messaging service (e.g. 'sms_sim1').</dd>

        <dt id="widl-SmsManager-onreceived"><code>onreceived</code>
        of type <span class=
        "idlAttrType"><a>EventHandler</a></span>,</dt>

        <dd>
          Handles the <code>received</code> event of type <a href=
          "#idl-def-MessagingEvent" class=
          "idlType"><code>MessagingEvent</code></a>, fired when a
          new message is received on this messaging service
          manager.
        </dd>

        <dt id="widl-SmsManager-onsent"><code>onsent</code> of type
        <span class="idlAttrType"><a>EventHandler</a></span>,</dt>

        <dd>
          Handles the <code>sent</code> event of type <a href=
          "#idl-def-MessagingEvent" class=
          "idlType"><code>MessagingEvent</code></a>, fired when a
          new message is sent using this messaging service manager.
        </dd>

        <dt id="widl-SmsManager-ondeliverysuccess">
        <code>ondeliverysuccess</code> of type <span class=
        "idlAttrType"><a>EventHandler</a></span>,</dt>

        <dd>
          Handles the <code>deliverysuccess</code> event of type
          <a href="#idl-def-DeliveryReportEvent" class=
          "idlType"><code>DeliveryReportEvent</code></a>, fired
          when a new succesful delivery report is received on this
          messaging service manager.
        </dd>

        <dt id="widl-SmsManager-ondeliveryfailure">
        <code>ondeliveryfailure</code> of type <span class=
        "idlAttrType"><a>EventHandler</a></span>,</dt>

        <dd>
          Handles the <code>deliveryfailure</code> event of type
          <a href="#idl-def-DeliveryReportEvent" class=
          "idlType"><code>DeliveryReportEvent</code></a>, fired
          when a new failure delivery report is received on this
          messaging service manager.
        </dd>

        <dt id="widl-SmsManager-onserviceadded">
        <code>onserviceadded</code> of type <span class=
        "idlAttrType"><a>EventHandler</a></span>,</dt>

        <dd>
          Handles the <code>serviceadded</code> event of type
          <a href="#idl-def-ServiceChangeEvent" class=
          "idlType"><code>ServiceChangeEvent</code></a>, fired
          whenever a new messaging service is enabled on this
          messaging service manager.
        </dd>

        <dt id="widl-SmsManager-onserviceremoved">
        <code>onserviceremoved</code> of type <span class=
        "idlAttrType"><a>EventHandler</a></span>,</dt>

        <dd>
          Handles the <code>serviceremoved</code> event of type
          <a href="#idl-def-ServiceChangeEvent" class=
          "idlType"><code>ServiceChangeEvent</code></a>, fired when
          an existing messaging service is disabled on this
          messaging service manager.
        </dd>
      </dl>
    </section>

    <section id="methods-1">
      <h3><span class="secno">7.2</span> Methods</h3>

      <dl class="methods">
        <dt id=
        "widl-SmsManager-segmentInfo-SmsSegmentInfo-DOMString-text-DOMString-serviceID">
        <code>segmentInfo</code></dt>

        <dd>
          This method returns an <code>SmsSegmentInfo</code> object
          including information on the number of concatenated SMS
          segments needed to send the text in the <code>text</code>
          parameter, the number of characters available per segment
          and the maximum number of available characters in the
          last segment.

          <table class="parameters">
            <tr>
              <th>Parameter</th>

              <th>Type</th>

              <th>Nullable</th>

              <th>Optional</th>

              <th>Description</th>
            </tr>

            <tr>
              <td class="prmName">text</td>

              <td class="prmType">
              <code><a>DOMString</a></code></td>

              <td class="prmNullFalse">✘</td>

              <td class="prmOptFalse">✘</td>

              <td class="prmDesc">Text intended to be sent as an
              SMS, whose segmentation information is checked by
              this method.</td>
            </tr>

            <tr>
              <td class="prmName">serviceID</td>

              <td class="prmType">
              <code><a>DOMString</a></code></td>

              <td class="prmNullFalse">✘</td>

              <td class="prmOptTrue">✔</td>

              <td class="prmDesc">Identifier of the service through
              which the message is would be sent.</td>
            </tr>
          </table>

          <div>
            <em>Return type:</em> <code><a href=
            "#idl-def-SmsSegmentInfo" class=
            "idlType"><code>SmsSegmentInfo</code></a></code>
          </div>
        </dd>

        <dt id=
        "widl-SmsManager-send-Future-DOMString-to-DOMString-text-DOMString-serviceID">
        <code>send</code></dt>

        <dd>
          This method issues a request to the messaging system to
          send an SMS message with the text of the
          <code>text</code> parameter to the destination number
          indicated in the <code>to</code> parameter. A
          <code>Future</code> object will be returned in order to
          notify the result of the request.

          <table class="parameters">
            <tr>
              <th>Parameter</th>

              <th>Type</th>

              <th>Nullable</th>

              <th>Optional</th>

              <th>Description</th>
            </tr>

            <tr>
              <td class="prmName">to</td>

              <td class="prmType">
              <code><a>DOMString</a></code></td>

              <td class="prmNullFalse">✘</td>

              <td class="prmOptFalse">✘</td>

              <td class="prmDesc">Destination number for the SMS
              message.</td>
            </tr>

            <tr>
              <td class="prmName">text</td>

              <td class="prmType">
              <code><a>DOMString</a></code></td>

              <td class="prmNullFalse">✘</td>

              <td class="prmOptFalse">✘</td>

              <td class="prmDesc">Content of the SMS message to be
              sent.</td>
            </tr>

            <tr>
              <td class="prmName">serviceID</td>

              <td class="prmType">
              <code><a>DOMString</a></code></td>

              <td class="prmNullFalse">✘</td>

              <td class="prmOptTrue">✔</td>

              <td class="prmDesc">Identifier of the service through
              which the message is requested to be sent.</td>
            </tr>
          </table>

          <div>
            <em>Return type:</em> <code><a>Future</a></code>
          </div>
        </dd>

        <dt id="widl-SmsManager-clear-Future-DOMString-serviceID">
        <code>clear</code></dt>

        <dd>
          This method makes a request to delete all the messages
          associated to the messaging service passed as parameter.

          <table class="parameters">
            <tr>
              <th>Parameter</th>

              <th>Type</th>

              <th>Nullable</th>

              <th>Optional</th>

              <th>Description</th>
            </tr>

            <tr>
              <td class="prmName">serviceID</td>

              <td class="prmType">
              <code><a>DOMString</a></code></td>

              <td class="prmNullFalse">✘</td>

              <td class="prmOptFalse">✘</td>

              <td class="prmDesc">Identifies the messaging service
              all whose messages are requested to be deleted.</td>
            </tr>
          </table>

          <div>
            <em>Return type:</em> <code><a>Future</a></code>
          </div>
        </dd>
      </dl>
    </section>

    <section id="steps-1">
      <h3><span class="secno">7.3</span> Steps</h3>

      <p>The <dfn id="dfn-send"><code>send</code></dfn> method when
      invoked <em class="rfc2119" title="MUST">MUST</em> run the
      following steps:</p>

      <ol>
        <li>Create a new instance of <code>SmsMessage</code>:

          <ol>
            <li>Generate a identifier for this message that is
            globally unique within the implementation, i.e. there
            cannot be any other message with the same
            identifier.</li>

            <li>Set the <code>messageID</code> of the
            <code>SmsMessage</code> to the generated
            identifier.</li>

            <li>Set the <code>type</code> of the
            <code>SmsMessage</code> to 'sms'.</li>

            <li>Set the <code>serviceID</code> of the
            <code>SmsMessage</code> to the identifier of the
            service used to send the message, i.e. the one passed
            in the <code>serviceID</code> parameter, if provided,
            or otherwise to the first element in the
            <code>serviceIDs</code> attribute of the
            <code>SmsManager</code>.</li>

            <li>Set the <code>from</code> of the
            <code>SmsMessage</code> to the number of the mobile
            subscription used to send this SMS message.</li>

            <li>Set the <code>read</code> of the
            <code>SmsMessage</code> to 'true'.</li>

            <li>Set the <code>to</code> of the
            <code>SmsMessage</code> to the value of the
            <code>to</code> parameter.</li>

            <li>Set the <code>body</code> of the
            <code>SmsMessage</code> to the value of the
            <code>text</code> parameter.</li>

            <li>Set the <code>messageClass</code> of the
            <code>SmsMessage</code> to 'class1'.</li>

            <li>Set the <code>state</code> of the
            <code>SmsMessage</code> to 'sending'.</li>

            <li>Set the <code>deliveryStatus</code> of the
            <code>SmsMessage</code> to 'pending' if a delivery
            report has been requested or to 'not-applicable'
            otherwise.</li>

            <li>Make a request to the system to send an SMS message
            with text passed in the <code>text</code> parameter to
            the number of the recipient indicated in the
            <code>to</code> parameter, using the proper service as
            described above.</li>

            <li>
              <a href="#dfn-queue-a-task" class="internalDFN">Queue
              a task</a> to monitor SMS submission process.
            </li>
          </ol>
        </li>

        <li>Let <var>future</var> be a new <code>Future</code>
        object and <var>resolver</var> its associated
        <code>resolver</code></li>

        <li>Return <var>future</var> to the caller.</li>

        <li>If an <var>error</var> occurs run these substeps and
        terminate these steps

          <ol>
            <li>If a delivery report had been requested set the
            <code>deliveryStatus</code> of the
            <code>SmsMessage</code> to 'error'.</li>

            <li>call <var>resolver</var>'s
            <code>reject(value)</code>method with <var>error</var>
            as <code>value</code> argument.</li>
          </ol>
        </li>

        <li>When the request has been successfully completed:

          <ol>
            <li>Set the <code>state</code> of the
            <code>SmsMessage</code> to 'sent'.</li>

            <li>Set the <code>timestamp</code> of the
            <code>SmsMessage</code> to the timestamp when the SMS
            message reached the Short Message Center, i.e. the
            value of the TP-Service-Centre-Time-Stamp (TP-SCTS)
            parameter returned in the SMS-SUBMIT-REPORT Protocol
            Data Unit [<cite><a class="bibref" href=
            "#bib-GSM-SMS">GSM-SMS</a></cite>].</li>

            <li>Call <var>resolver</var>'s
            <code>accept(value)</code>method with the sent
            <code>SmsMessage</code> as <code>value</code>
            argument.</li>

            <li>
              <a href="#dfn-queue-a-task" class="internalDFN">Queue
              a task</a> to <a href="#dfn-fire-an-event" class=
              "internalDFN">fire an event</a> named
              <code>sent</code> with the <code>message</code>
              attribute set to the sent <code>SmsMessage</code>.
            </li>
          </ol>
        </li>
      </ol>

      <p>The <dfn id=
      "dfn-segmentinfo"><code>segmentInfo</code></dfn> method when
      invoked <em class="rfc2119" title="MUST">MUST</em> return a
      <code>SmsSegmentInfo</code> object that contains the
      following elements:</p>

      <ol>
        <li>A <code>segments</code> element indicating the number
        of concatenated SMS segments needed to send the text passed
        in the <code>text</code> parameter using the service with
        identifier equal to the one passed in the
        <code>serviceID</code> parameter, if provided, or otherwise
        to the first element in the <code>serviceIDs</code>
        attribute of the <code>SmsManager</code>. Note that the
        application <em class="rfc2119" title="SHOULD NOT">SHOULD
        NOT</em> split the text in a set of strings that fit each
        into a single SMS segment as it would result in different
        independent SMS messages being sent, but <em class=
        "rfc2119" title="SHOULD">SHOULD</em> instead send the full
        message in a single <code>sendSMS</code> request. However
        having information on the number of SMS segments may be
        required by the application in order to inform the user
        (e.g. in case the length of the text impacts on the price
        charged for sending the message).</li>

        <li>A <code>charsPerSegment</code> element indicating the
        number of characters available per SMS segment. This number
        depends on the encoding to be used to send the SMS message,
        which in turn depends on the language / special characters
        included in the text.</li>

        <li>A <code>charsAvailableInLastSegment</code> element
        indicating the maximum number of available characters in
        the last segment that would be needed to send the input
        string. This provides useful information to the user on the
        number of characters that can type without requiring an
        additional SMS segment to send the text.</li>
      </ol>

      <p>Upon a new SMS message being received, the <a href=
      "#dfn-user-agent" class="internalDFN">user agent</a>
      <em class="rfc2119" title="MUST">MUST</em>:</p>

      <ol>
        <li>Create a new instance of <code>SmsMessage</code>.</li>

        <li>Generate a identifier for this message that is globally
        unique within the implementation, i.e. there cannot be any
        other message with the same identifier.</li>

        <li>Set the <code>messageID</code> of the
        <code>SmsMessage</code> to the generated identifier.</li>

        <li>Set the <code>type</code> of the
        <code>SmsMessage</code> to 'sms'.</li>

        <li>Set the <code>serviceID</code> of the
        <code>SmsMessage</code> to the identifier of the service at
        which the message has been received.</li>

        <li>Set the <code>from</code> of the
        <code>SmsMessage</code> to the sender of the SMS message,
        i.e. the value of the TP Originating Address (TP-OA) field
        of the SMS message [<cite><a class="bibref" href=
        "#bib-GSM-SMS">GSM-SMS</a></cite>].</li>

        <li>Set the <code>timestamp</code> of the
        <code>SmsMessage</code> to the timestamp of the SMS
        message, i.e. the value of the TP-Service-Centre-Time-Stamp
        (TP-SCTS) parameter received in the SMS DELIVER Protocol
        Data Unit [<cite><a class="bibref" href=
        "#bib-GSM-SMS">GSM-SMS</a></cite>].</li>

        <li>Set the <code>read</code> of the
        <code>SmsMessage</code> to 'false'.</li>

        <li>Set the <code>to</code> of the <code>SmsMessage</code>
        to the recipient of the SMS message, i.e. the value of the
        TP Destination Address (TP-DA) field of the SMS message
        [<cite><a class="bibref" href=
        "#bib-GSM-SMS">GSM-SMS</a></cite>].</li>

        <li>Set the <code>messageClass</code> of the
        <code>SmsMessage</code> to the message class indicated in
        the TP-Data-Coding-Scheme (TP-DCS) field of the SMS message
        [<cite><a class="bibref" href=
        "#bib-GSM-SMS">GSM-SMS</a></cite>].</li>

        <li>Set the <code>body</code> element to the text of the
        received SMS message, i.e. the value of the SM element
        contained within the TP User Data (TP-UD) field of the SMS
        message [<cite><a class="bibref" href=
        "#bib-GSM-SMS">GSM-SMS</a></cite>].</li>

        <li>Set the <code>state</code> of the
        <code>SmsMessage</code> to 'received'.</li>

        <li>Set the <code>deliveryStatus</code> of the
        <code>SmsMessage</code> to 'not-applicable'.</li>

        <li>
          <a href="#dfn-queue-a-task" class="internalDFN">Queue a
          task</a> to <a href="#dfn-fire-an-event" class=
          "internalDFN">fire an event</a> named <code><a href=
          "#dfn-received-1" class="internalDFN">received</a></code>
          with the <code>message</code> attribute set to the newly
          created <code>SmsMessage</code> instance.
        </li>

        <li>
          <a href="#dfn-queue-a-task" class="internalDFN">Queue a
          task</a> to fire a system message named
          <code>received</code> of type <code><a href=
          "#idl-def-ReceivedMessage" class=
          "idlType"><code>ReceivedMessage</code></a></code> with
          the <code>message</code> attribute set to the newly
          created <code>SmsMessage</code> instance.
        </li>
      </ol>

      <p>Upon a delivery report of a previously sent SMS message
      being received, the <a href="#dfn-user-agent" class=
      "internalDFN">user agent</a> <em class="rfc2119" title=
      "MUST">MUST</em></p>

      <ol>
        <li>Set the <code>deliveryStatus</code> parameter of the
        <code>SmsMessage</code> to 'success' or 'error' depending
        on the reported result.</li>

        <li>
          <a href="#dfn-queue-a-task" class="internalDFN">Queue a
          task</a> to <a href="#dfn-fire-an-event" class=
          "internalDFN">fire an event</a> named <a href=
          "#dfn-deliverysuccess-1" class=
          "internalDFN">deliverysuccess</a> or <a href=
          "#dfn-deliveryfailure-1" class=
          "internalDFN">deliveryfailure</a> respectively if the
          delivery was successfull or not, with

          <ol>
            <li>the <code>messageID</code> attribute set to the
            identifier of the <code>SmsMessage</code> to which this
            confirmation is related,</li>

            <li>the <code>serviceID</code> attribute set to the
            identifier of the service used to send such message,
            and</li>

            <li>the <code>recipients</code> attribute set to the
            recipient of such message.</li>
          </ol>
        </li>

        <li>
          <a href="#dfn-queue-a-task" class="internalDFN">Queue a
          task</a> to fire a system message of type <code><a href=
          "#idl-def-DeliveryReport" class=
          "idlType"><code>DeliveryReport</code></a></code>named
          <a href="#dfn-deliverysuccess-1" class=
          "internalDFN">deliverysuccess</a> or <a href=
          "#dfn-deliveryfailure-1" class=
          "internalDFN">deliveryfailure</a> respectively if the
          delivery was successfull or not, with

          <ol>
            <li>the <code>messageID</code> attribute set to the
            identifier of the <code>SmsMessage</code> to which this
            confirmation is related,</li>

            <li>the <code>serviceID</code> attribute set to the
            identifier of the service used to send such message,
            and</li>

            <li>the <code>recipients</code> attribute set to the
            recipient of such message.</li>
          </ol>
        </li>
      </ol>

      <p>The <dfn id="dfn-clear"><code>clear</code></dfn> method
      when invoked <em class="rfc2119" title="MUST">MUST</em> run
      the following steps:</p>

      <ol>
        <li>Make a request to the system to delete all the messages
        associated to the messaging service with identifier equal
        to the <code>serviceID</code> parameter.</li>

        <li>Let <var>future</var> be a new <code>Future</code>
        object and <var>resolver</var> its associated
        <code>resolver</code></li>

        <li>Return <var>future</var> to the caller.</li>

        <li>If an <var>error</var> occurs call
        <var>resolver</var>'s <code>reject(value)</code>method with
        <var>error</var> as <code>value</code> argument.</li>

        <li>When the request has been successfully completed:

          <ol>
            <li>Let <var>serviceID</var> be the
            <code>serviceID</code> parameter passed in the
            request</li>

            <li>Call <var>resolver</var>'s
            <code>accept(value)</code>method with
            <var>serviceID</var> as <code>value</code>
            argument.</li>
          </ol>
        </li>
      </ol>
    </section>

    <section id="event-handlers">
      <h3><span class="secno">7.4</span> Event handlers</h3>

      <p>The following are the <a class="internalDFN" href=
      "#dfn-eventhandler">event handlers</a> (and their
      corresponding <a class="internalDFN" href=
      "#dfn-eventtypes">event types</a>) that <em class="rfc2119"
      title="MUST">MUST</em> be supported as attributes by the
      <a href="#idl-def-SmsManager" class=
      "idlType"><code>SmsManager</code></a> object.</p>

      <table class="simple">
        <thead>
          <tr>
            <th>event handler</th>

            <th>event name</th>

            <th>event type</th>

            <th>short description</th>
          </tr>
        </thead>

        <tbody>
          <tr>
            <td><strong><code>onreceived</code></strong></td>

            <td><code><dfn id=
            "dfn-received">received</dfn></code></td>

            <td>
              <a href="#idl-def-MessagingEvent" class=
              "idlType"><code>MessagingEvent</code></a>
            </td>

            <td>handles received messages</td>
          </tr>

          <tr>
            <td><strong><code>onsent</code></strong></td>

            <td><code><dfn id="dfn-sent">sent</dfn></code></td>

            <td>
              <a href="#idl-def-MessagingEvent" class=
              "idlType"><code>MessagingEvent</code></a>
            </td>

            <td>handles sent messages</td>
          </tr>

          <tr>
            <td>
            <strong><code>ondeliverysuccess</code></strong></td>

            <td><code><dfn id=
            "dfn-deliverysuccess">deliverysuccess</dfn></code></td>

            <td>
              <a href="#idl-def-DeliveryReportEvent" class=
              "idlType"><code>DeliveryReportEvent</code></a>
            </td>

            <td>handles successful delivery reports</td>
          </tr>

          <tr>
            <td>
            <strong><code>ondeliveryfailure</code></strong></td>

            <td><code><dfn id=
            "dfn-deliveryfailure">deliveryfailure</dfn></code></td>

            <td>
              <a href="#idl-def-DeliveryReportEvent" class=
              "idlType"><code>DeliveryReportEvent</code></a>
            </td>

            <td>handles failure delivery reports</td>
          </tr>

          <tr>
            <td><strong><code>onserviceadded</code></strong></td>

            <td><code><dfn id=
            "dfn-serviceadded">serviceadded</dfn></code></td>

            <td>
              <a href="#idl-def-ServiceChangeEvent" class=
              "idlType"><code>ServiceChangeEvent</code></a>
            </td>

            <td>handle new messaging services</td>
          </tr>

          <tr>
            <td><strong><code>onserviceremoved</code></strong></td>

            <td><code><dfn id=
            "dfn-serviceremoved">serviceremoved</dfn></code></td>

            <td>
              <a href="#idl-def-ServiceChangeEvent" class=
              "idlType"><code>ServiceChangeEvent</code></a>
            </td>

            <td>handle disabled messaging services</td>
          </tr>
        </tbody>
      </table>
    </section>
  </section>
  <!--====================== Interface SmsSegmentInfo ========================-->

  <section id="smssegmentinfo-dictionary">
    <!--OddPage-->

    <h2><span class="secno">8.</span> <a href=
    "#idl-def-SmsSegmentInfo" class=
    "idlType"><code>SmsSegmentInfo</code></a> Dictionary</h2>

    <p>The <a href="#idl-def-SmsSegmentInfo" class=
    "idlType"><code>SmsSegmentInfo</code></a> dictionary contains
    information about the segmentation of a given text to be sent
    as SMS.</p>
    <pre class="idl">
<span class="idlDictionary" id=
"idl-def-SmsSegmentInfo">dictionary <span class=
"idlDictionaryID">SmsSegmentInfo</span> {
<span class="idlMember">    <span class=
"idlMemberType"><a>long</a></span> <span class=
"idlMemberName"><a href=
"#widl-SmsSegmentInfo-segments">segments</a></span>;</span>
<span class="idlMember">    <span class=
"idlMemberType"><a>long</a></span> <span class=
"idlMemberName"><a href=
"#widl-SmsSegmentInfo-charsPerSegment">charsPerSegment</a></span>;</span>
<span class="idlMember">    <span class=
"idlMemberType"><a>long</a></span> <span class=
"idlMemberName"><a href=
"#widl-SmsSegmentInfo-charsAvailableInLastSegment">charsAvailableInLastSegment</a></span>;</span>
};</span>
</pre>

    <section id="dictionary-smssegmentinfo-members">
      <h3><span class="secno">8.1</span> Dictionary <a class=
      "idlType" href=
      "#idl-def-SmsSegmentInfo"><code>SmsSegmentInfo</code></a>
      Members</h3>

      <dl class="dictionary-members">
        <dt id="widl-SmsSegmentInfo-segments"><code>segments</code>
        of type <span class="idlMemberType"><a>long</a></span></dt>

        <dd><em class="rfc2119" title="MUST">MUST</em> return the
        total number of SMS segments needed to send the input
        string, taking into account the encoding to be used to send
        such message as well as the overhead associated to
        concatenated SMS messages.</dd>

        <dt id="widl-SmsSegmentInfo-charsPerSegment">
        <code>charsPerSegment</code> of type <span class=
        "idlMemberType"><a>long</a></span></dt>

        <dd><em class="rfc2119" title="MUST">MUST</em> return the
        number of characters available per SMS segment as per the
        encoding to be used to send the SMS message. In case the
        variable length encoding, the value of this element
        <em class="rfc2119" title="MUST">MUST</em> be calculated
        asumming the minimum length for all the characters.</dd>

        <dt id="widl-SmsSegmentInfo-charsAvailableInLastSegment">
        <code>charsAvailableInLastSegment</code> of type
        <span class="idlMemberType"><a>long</a></span></dt>

        <dd><em class="rfc2119" title="MUST">MUST</em> return the
        maximum number of available characters in the last segment
        needed to send the input string. In case the variable
        length encoding, the value of this element <em class=
        "rfc2119" title="MUST">MUST</em> be calculated asumming the
        minimum length for all the remaining characters.</dd>
      </dl>
    </section>
  </section>
  <!--====================== Interface MmsManager ============================-->

  <section id="mmsmanager-interface">
    <!--OddPage-->

    <h2><span class="secno">9.</span> <a href="#idl-def-MmsManager"
    class="idlType"><code>MmsManager</code></a> Interface</h2>

    <p>The <a href="#idl-def-MmsManager" class=
    "idlType"><code>MmsManager</code></a> interface represents the
    MMS messaging service manager.</p>
    <pre class="idl">
<span class="idlInterface" id=
"idl-def-MmsManager">interface <span class=
"idlInterfaceID">MmsManager</span> : <span class=
"idlSuperclass"><a>EventTarget</a></span> {
<span class="idlAttribute">    readonly    attribute <span class=
"idlAttrType"><a href="#idl-def-MessageType" class=
"idlType"><code>MessageType</code></a></span>  <span class=
"idlAttrName"><a href=
"#widl-MmsManager-type">type</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class=
"idlAttrType"><a>DOMString</a>[]</span>  <span class=
"idlAttrName"><a href=
"#widl-MmsManager-serviceIDs">serviceIDs</a></span>;</span>
<span class="idlMethod">    <span class="idlMethType"><a href=
"#idl-def-FetchMode" class=
"idlType"><code>FetchMode</code></a></span> <span class=
"idlMethName"><a href=
"#widl-MmsManager-getFetchMode-FetchMode-DOMString-serviceID">getFetchMode</a></span> (<span class="idlParam">optional <span class="idlParamType"><a>DOMString</a></span> <span class="idlParamName">serviceID</span></span>);</span>
<span class="idlMethod">    <span class=
"idlMethType"><a>void</a></span>      <span class=
"idlMethName"><a href=
"#widl-MmsManager-setFetchMode-void-FetchMode-fetchMode-DOMString-serviceID">setFetchMode</a></span> (<span class="idlParam"><span class="idlParamType"><a href="#idl-def-FetchMode"
class="idlType"><code>FetchMode</code></a></span> <span class=
"idlParamName">fetchMode</span></span>, <span class=
"idlParam">optional <span class=
"idlParamType"><a>DOMString</a></span> <span class=
"idlParamName">serviceID</span></span>);</span>
<span class="idlMethod">    <span class=
"idlMethType"><a>Future</a></span>    <span class=
"idlMethName"><a href=
"#widl-MmsManager-send-Future-MmsContent-mmsContent-DOMString-serviceID">send</a></span> (<span class="idlParam"><span class="idlParamType"><a href="#idl-def-MmsContent"
class="idlType"><code>MmsContent</code></a></span> <span class=
"idlParamName">mmsContent</span></span>, <span class=
"idlParam">optional <span class=
"idlParamType"><a>DOMString</a></span> <span class=
"idlParamName">serviceID</span></span>);</span>
<span class="idlMethod">    <span class=
"idlMethType"><a>Future</a></span>    <span class=
"idlMethName"><a href=
"#widl-MmsManager-fetch-Future-DOMString-messageID">fetch</a></span> (<span class="idlParam"><span class="idlParamType"><a>DOMString</a></span> <span class="idlParamName">messageID</span></span>);</span>
<span class="idlMethod">    <span class=
"idlMethType"><a>Future</a></span>    <span class=
"idlMethName"><a href=
"#widl-MmsManager-clear-Future-DOMString-serviceID">clear</a></span> (<span class="idlParam"><span class="idlParamType"><a>DOMString</a></span> <span class="idlParamName">serviceID</span></span>);</span>
<span class="idlAttribute">                attribute <span class=
"idlAttrType"><a>EventHandler</a></span> <span class=
"idlAttrName"><a href=
"#widl-MmsManager-onreceived">onreceived</a></span>;</span>
<span class="idlAttribute">                attribute <span class=
"idlAttrType"><a>EventHandler</a></span> <span class=
"idlAttrName"><a href=
"#widl-MmsManager-onsent">onsent</a></span>;</span>
<span class="idlAttribute">                attribute <span class=
"idlAttrType"><a>EventHandler</a></span> <span class=
"idlAttrName"><a href=
"#widl-MmsManager-ondeliverysuccess">ondeliverysuccess</a></span>;</span>
<span class="idlAttribute">                attribute <span class=
"idlAttrType"><a>EventHandler</a></span> <span class=
"idlAttrName"><a href=
"#widl-MmsManager-ondeliveryfailure">ondeliveryfailure</a></span>;</span>
<span class="idlAttribute">                attribute <span class=
"idlAttrType"><a>EventHandler</a></span> <span class=
"idlAttrName"><a href=
"#widl-MmsManager-onserviceadded">onserviceadded</a></span>;</span>
<span class="idlAttribute">                attribute <span class=
"idlAttrType"><a>EventHandler</a></span> <span class=
"idlAttrName"><a href=
"#widl-MmsManager-onserviceremoved">onserviceremoved</a></span>;</span>
};</span>
</pre>

    <section id="attributes-3">
      <h3><span class="secno">9.1</span> Attributes</h3>

      <dl class="attributes">
        <dt id="widl-MmsManager-type"><code>type</code> of type
        <span class="idlAttrType"><a href="#idl-def-MessageType"
        class="idlType"><code>MessageType</code></a></span>,
        readonly</dt>

        <dd><em class="rfc2119" title="MUST">MUST</em> return the
        type of the messaging service manager. It can have the
        following values: 'sms' or 'mms'.</dd>

        <dt id="widl-MmsManager-serviceIDs"><code>serviceIDs</code>
        of type array of <span class=
        "idlAttrType"><a>DOMString</a></span>, readonly</dt>

        <dd><em class="rfc2119" title="MUST">MUST</em> return the
        identifier of the different services for this type of
        messaging service (e.g. 'sms_sim1').</dd>

        <dt id="widl-MmsManager-onreceived"><code>onreceived</code>
        of type <span class=
        "idlAttrType"><a>EventHandler</a></span>,</dt>

        <dd>
          Handles the <code>received</code> event of type <a href=
          "#idl-def-MessagingEvent" class=
          "idlType"><code>MessagingEvent</code></a>, fired when a
          new message is received on this messaging service
          manager.
        </dd>

        <dt id="widl-MmsManager-onsent"><code>onsent</code> of type
        <span class="idlAttrType"><a>EventHandler</a></span>,</dt>

        <dd>
          Handles the <code>sent</code> event of type <a href=
          "#idl-def-MessagingEvent" class=
          "idlType"><code>MessagingEvent</code></a>, fired when a
          new message is sent using this messaging service manager.
        </dd>

        <dt id="widl-MmsManager-ondeliverysuccess">
        <code>ondeliverysuccess</code> of type <span class=
        "idlAttrType"><a>EventHandler</a></span>,</dt>

        <dd>
          Handles the <code>deliverysuccess</code> event of type
          <a href="#idl-def-DeliveryReportEvent" class=
          "idlType"><code>DeliveryReportEvent</code></a>, fired
          when a new succesful delivery report is received on this
          messaging service manager.
        </dd>

        <dt id="widl-MmsManager-ondeliveryfailure">
        <code>ondeliveryfailure</code> of type <span class=
        "idlAttrType"><a>EventHandler</a></span>,</dt>

        <dd>
          Handles the <code>deliveryfailure</code> event of type
          <a href="#idl-def-DeliveryReportEvent" class=
          "idlType"><code>DeliveryReportEvent</code></a>, fired
          when a new failure delivery report is received on this
          messaging service manager.
        </dd>

        <dt id="widl-MmsManager-onserviceadded">
        <code>onserviceadded</code> of type <span class=
        "idlAttrType"><a>EventHandler</a></span>,</dt>

        <dd>
          Handles the <code>serviceadded</code> event of type
          <a href="#idl-def-ServiceChangeEvent" class=
          "idlType"><code>ServiceChangeEvent</code></a>, fired
          whenever a new messaging service is enabled on this
          messaging service manager.
        </dd>

        <dt id="widl-MmsManager-onserviceremoved">
        <code>onserviceremoved</code> of type <span class=
        "idlAttrType"><a>EventHandler</a></span>,</dt>

        <dd>
          Handles the <code>serviceremoved</code> event of type
          <a href="#idl-def-ServiceChangeEvent" class=
          "idlType"><code>ServiceChangeEvent</code></a>, fired when
          an existing messaging service is disabled on this
          messaging service manager.
        </dd>
      </dl>
    </section>

    <section id="methods-2">
      <h3><span class="secno">9.2</span> Methods</h3>

      <dl class="methods">
        <dt id=
        "widl-MmsManager-getFetchMode-FetchMode-DOMString-serviceID">
        <code>getFetchMode</code></dt>

        <dd>
          This method requests to retrieve the fetch mode
          associated to a specific service (the one identified by
          the <code>serviceID</code> attribute, if provided, or the
          first element in the <code>serviceIDs</code> attribute of
          the <code>MmsManager</code> otherwise).

          <table class="parameters">
            <tr>
              <th>Parameter</th>

              <th>Type</th>

              <th>Nullable</th>

              <th>Optional</th>

              <th>Description</th>
            </tr>

            <tr>
              <td class="prmName">serviceID</td>

              <td class="prmType">
              <code><a>DOMString</a></code></td>

              <td class="prmNullFalse">✘</td>

              <td class="prmOptTrue">✔</td>

              <td class="prmDesc">Identifier of the service whose
              fetch mode is queried.</td>
            </tr>
          </table>

          <div>
            <em>Return type:</em> <code><a href=
            "#idl-def-FetchMode" class=
            "idlType"><code>FetchMode</code></a></code>
          </div>
        </dd>

        <dt id=
        "widl-MmsManager-setFetchMode-void-FetchMode-fetchMode-DOMString-serviceID">
        <code>setFetchMode</code></dt>

        <dd>
          This method issues a request to the messaging system to
          set to <a class="internalDFN" href=
          "#idl-def-FetchMode.manual">manual</a> or <a class=
          "internalDFN" href=
          "#idl-def-FetchMode.automatic">automatic</a> the MMS
          message fetch mode of the specific service, the one
          identified by the <code>serviceID</code> attribute, if
          provided, or all services otherwise).

          <table class="parameters">
            <tr>
              <th>Parameter</th>

              <th>Type</th>

              <th>Nullable</th>

              <th>Optional</th>

              <th>Description</th>
            </tr>

            <tr>
              <td class="prmName">fetchMode</td>

              <td class="prmType"><code><a href=
              "#idl-def-FetchMode" class=
              "idlType"><code>FetchMode</code></a></code></td>

              <td class="prmNullFalse">✘</td>

              <td class="prmOptFalse">✘</td>

              <td class="prmDesc">Fetch mode that is requested to
              be set for a specific service.</td>
            </tr>

            <tr>
              <td class="prmName">serviceID</td>

              <td class="prmType">
              <code><a>DOMString</a></code></td>

              <td class="prmNullFalse">✘</td>

              <td class="prmOptTrue">✔</td>

              <td class="prmDesc">Identifier of the service whose
              fetch mode is requested to be set.</td>
            </tr>
          </table>

          <div>
            <em>Return type:</em> <code><a>void</a></code>
          </div>
        </dd>

        <dt id=
        "widl-MmsManager-send-Future-MmsContent-mmsContent-DOMString-serviceID">
        <code>send</code></dt>

        <dd>
          This method issues a request to the messaging system to
          send an MMS message with the content and recipients
          included in the <code>mmsContent</code> parameter. A
          <code>Future</code> object will be returned in order to
          notify the result of the request.

          <table class="parameters">
            <tr>
              <th>Parameter</th>

              <th>Type</th>

              <th>Nullable</th>

              <th>Optional</th>

              <th>Description</th>
            </tr>

            <tr>
              <td class="prmName">mmsContent</td>

              <td class="prmType"><code><a href=
              "#idl-def-MmsContent" class=
              "idlType"><code>MmsContent</code></a></code></td>

              <td class="prmNullFalse">✘</td>

              <td class="prmOptFalse">✘</td>

              <td class="prmDesc">Content and recipients of the MMS
              message to be sent.</td>
            </tr>

            <tr>
              <td class="prmName">serviceID</td>

              <td class="prmType">
              <code><a>DOMString</a></code></td>

              <td class="prmNullFalse">✘</td>

              <td class="prmOptTrue">✔</td>

              <td class="prmDesc">Identifier of the service through
              which the message is requested to be sent.</td>
            </tr>
          </table>

          <div>
            <em>Return type:</em> <code><a>Future</a></code>
          </div>
        </dd>

        <dt id="widl-MmsManager-fetch-Future-DOMString-messageID">
        <code>fetch</code></dt>

        <dd>
          This method requests to fetch an MMS message with
          identifier equal to the indicated in the
          <code>messageID</code> parameter from the URL indicated
          in the MMS notification. The method returns a new
          <code>Future</code> that will allow the caller to be
          notified about the result (success, error) of the
          operation.

          <table class="parameters">
            <tr>
              <th>Parameter</th>

              <th>Type</th>

              <th>Nullable</th>

              <th>Optional</th>

              <th>Description</th>
            </tr>

            <tr>
              <td class="prmName">messageID</td>

              <td class="prmType">
              <code><a>DOMString</a></code></td>

              <td class="prmNullFalse">✘</td>

              <td class="prmOptFalse">✘</td>

              <td class="prmDesc">Identifier of the MMS message
              that is requested to be download.</td>
            </tr>
          </table>

          <div>
            <em>Return type:</em> <code><a>Future</a></code>
          </div>
        </dd>

        <dt id="widl-MmsManager-clear-Future-DOMString-serviceID">
        <code>clear</code></dt>

        <dd>
          This method makes a request to delete all the messages
          associated to the messaging service passed as parameter.

          <table class="parameters">
            <tr>
              <th>Parameter</th>

              <th>Type</th>

              <th>Nullable</th>

              <th>Optional</th>

              <th>Description</th>
            </tr>

            <tr>
              <td class="prmName">serviceID</td>

              <td class="prmType">
              <code><a>DOMString</a></code></td>

              <td class="prmNullFalse">✘</td>

              <td class="prmOptFalse">✘</td>

              <td class="prmDesc">Identifies the messaging service
              all whose messages are requested to be deleted.</td>
            </tr>
          </table>

          <div>
            <em>Return type:</em> <code><a>Future</a></code>
          </div>
        </dd>
      </dl>
    </section>

    <div class="note">
      <div class="note-title" role="heading" aria-level="3">
        <span>Note</span>
      </div>

      <div class="">
        It is FFS whether MMS settings (e.g. fetch mode, creation
        mode) needs to be managed through the MmsManager interface.
      </div>
    </div>

    <section id="steps-2">
      <h3><span class="secno">9.3</span> Steps</h3>

      <p>The <dfn id="dfn-send-1"><code>send</code></dfn> method
      when invoked <em class="rfc2119" title="MUST">MUST</em> run
      the following steps:</p>

      <ol>
        <li>Create a new instance of <code>MmsMessage</code> and:

          <ol>
            <li>Generate a identifier for this message that is
            globally unique within the implementation, i.e. there
            cannot be any other message with the same
            identifier.</li>

            <li>Set the <code>messageID</code> of the
            <code>MmsMessage</code> to the generated
            identifier.</li>

            <li>Set the <code>type</code> of the
            <code>MmsMessage</code> to 'mms'.</li>

            <li>Set the <code>serviceID</code> of the
            <code>MmsMessage</code> to the identifier of the
            service used to send the message, i.e. the one passed
            in the <code>serviceID</code> parameter, if provided,
            or otherwise to the first element in the
            <code>serviceIDs</code> attribute of the
            <code>MmsManager</code>.</li>

            <li>Set the <code>from</code> of the
            <code>MmsMessage</code> to the number of the mobile
            subscription used to send this MMS message.</li>

            <li>Set the <code>read</code> of the
            <code>MmsMessage</code> to 'true'.</li>

            <li>Set the <code>to</code> of the
            <code>MmsMessage</code> to the <code>to</code> in the
            <code>mmsContent</code> parameter.</li>

            <li>Set the <code>cc</code> of the
            <code>MmsMessage</code> to the <code>cc</code> array in
            the <code>mmsContent</code> parameter.</li>

            <li>Set the <code>bcc</code> of the
            <code>MmsMessage</code> to the <code>bcc</code> array
            in the <code>mmsContent</code> parameter.</li>

            <li>Set the <code>subject</code> of the
            <code>MmsMessage</code> to the value of the the
            <code>subject</code> parameter in
            <code>mmsContent</code>.</li>

            <li>Set the <code>smil</code> of the
            <code>MmsMessage</code> to the value of the the
            <code>smil</code> parameter in
            <code>mmsContent</code>.</li>

            <li>Set the <code>attachments</code> of the
            <code>MmsMessage</code> to the value of the the
            <code>attachments</code> array in
            <code>mmsContent</code> parameter.</li>

            <li>Set the <code>state</code> of the
            <code>MmsMessage</code> to 'sending'.</li>

            <li>Add a new element in the
            <code>deliveryStatus</code> array of the
            <code>MmsMessage</code> for each of the addresses
            included in the <code>to</code>, <code>cc</code> and
            <code>bcc</code> parameters, with value 'pending' if a
            delivery report has been requested or with value
            'not-applicable' otherwise.</li>

            <li>Make a request to the system to send an MMS message
            with the content passed in the <code>content</code>
            parameter to the number(s) of indicated in the
            <code>to</code> parameter, using the proper service as
            described above.</li>

            <li>
              <a href="#dfn-queue-a-task" class="internalDFN">Queue
              a task</a> to monitor MMS sending progress.
            </li>
          </ol>
        </li>

        <li>Let <var>future</var> be a new <code>Future</code>
        object and <var>resolver</var> its associated
        <code>resolver</code></li>

        <li>Return <var>future</var> to the caller.</li>

        <li>If an <var>error</var> occurs run these substeps and
        terminate these steps

          <ol>
            <li>If a delivery report had been requested set the
            different elements in the <code>deliveryStatus</code>
            array of the <code>MmsMessage</code> to 'error'.</li>

            <li>call <var>resolver</var>'s
            <code>reject(value)</code>method with <var>error</var>
            as <code>value</code> argument.</li>
          </ol>
        </li>

        <li>When the request has been successfully completed:

          <ol>
            <li>Set the <code>state</code> of the
            <code>MmsMessage</code> to 'sent'.</li>

            <li>Set the <code>timestamp</code> of the
            <code>MmsMessage</code> to the timestamp when the MMS
            message was sent, i.e. the date when the M-Send.req
            Protocol Data Unit was send from the MMS Client to the
            MMS Server.</li>

            <li>Call <var>resolver</var>'s
            <code>accept(value)</code>method with the sent
            <code>MmsMessage</code> as <code>value</code>
            argument.</li>

            <li>
              <a href="#dfn-queue-a-task" class="internalDFN">Queue
              a task</a> to <a href="#dfn-fire-an-event" class=
              "internalDFN">fire an event</a> named
              <code>sent</code> with the <code>message</code>
              attribute set to the sent <code>MmsMessage</code>.
            </li>
          </ol>
        </li>
      </ol>

      <p>The reception of an MMS message is a two-step process:
      Firstly, an MMS notification encapsulated in a WAP Push OTA
      message [<cite><a class="bibref" href=
      "#bib-OMA-PUSH">OMA-PUSH</a></cite>] is received by the
      device. This MMS notification contains limited information
      about the MMS message and a URL where the device can retrieve
      the full MMS message from. Secondly, the MMS message is
      retrieved either automatically, i.e. performed right after
      the reception of the MMS notification, or manually, i.e.
      invoked manually by the user.</p>

      <p>Upon a new MMS notification being received, the <a href=
      "#dfn-user-agent" class="internalDFN">user agent</a>
      <em class="rfc2119" title="MUST">MUST</em>:</p>

      <ol>
        <li>Create a new instance of <code>MmsMessage</code>.</li>

        <li>Generate a identifier for this message that is globally
        unique within the implementation, i.e. there cannot be any
        other message with the same identifier.</li>

        <li>Set the <code>messageID</code> of the
        <code>MmsMessage</code> to the generated identifier.</li>

        <li>Set the <code>type</code> of the
        <code>MmsMessage</code> to 'mms'.</li>

        <li>Set the <code>serviceID</code> of the
        <code>MmsMessage</code> to the identifier of the service at
        which the message has been received.</li>

        <li>Set the <code>read</code> of the
        <code>MmsMessage</code> to 'false'.</li>

        <li>if the fetch mode is <a class="internalDFN" href=
        "#idl-def-FetchMode.manual">manual</a>:

          <ol>
            <li>Set the <code>from</code> of the
            <code>MmsMessage</code> to the value of the 'From'
            field of the MMS notification, if present.</li>

            <li>Set the <code>timestamp</code> of the
            <code>MmsMessage</code> to the timestamp of the binary
            SMS message used to transport the MMS notification,
            i.e. the value of the TP-Service-Centre-Time-Stamp
            (TP-SCTS) parameter received in the SMS-DELIVER
            Protocol Data Unit [<cite><a class="bibref" href=
            "#bib-GSM-SMS">GSM-SMS</a></cite>].</li>

            <li>Add a new element in the <code>to</code> array of
            the <code>MmsMessage</code> for each of recipients in
            the 'To' field of the MMS notification [<cite><a class=
            "bibref" href="#bib-MMS13">MMS13</a></cite>], if
            present.</li>

            <li>Add a new element in the <code>cc</code> array of
            the <code>MmsMessage</code> for each of recipients in
            the 'Cc' field of the MMS notification [<cite><a class=
            "bibref" href="#bib-MMS13">MMS13</a></cite>], if
            present.</li>

            <li>Add a new element in the <code>bcc</code> array of
            the <code>MmsMessage</code> for each of recipients in
            the 'Bcc' field of the MMS notification
            [<cite><a class="bibref" href=
            "#bib-MMS13">MMS13</a></cite>], if present.</li>

            <li>Set the <code>subject</code> element to the value
            of the 'Subject' field of the MMS notification
            [<cite><a class="bibref" href=
            "#bib-MMS13">MMS13</a></cite>], if present.</li>

            <li>Set the <code>state</code> of the
            <code>MmsMessage</code> to 'not-downloaded'.</li>
          </ol>
        </li>

        <li>if the fetch mode is otherwise <a class="internalDFN"
        href="#idl-def-FetchMode.automatic">automatic</a>:

          <ol>
            <li>Make a request to the system to fetch the MMS
            message from the URL indicated in the
            X-Mms-Content-Location field of the MMS notification.
            Once the MMS has been fetched continue with following
            steps.</li>

            <li>Run the <dfn id="dfn-fill-mms-message">steps for
            filling the <code>MmsMessage</code> object with the
            data contained in the MMS message enclosed in the
            M-Retrieve.conf Protocol Data Unit</dfn>.

              <ol>
                <li>Set the <code>from</code> of the
                <code>MmsMessage</code> to the value of the 'From'
                field of the MMS message [<cite><a class="bibref"
                href="#bib-MMS13">MMS13</a></cite>].</li>

                <li>Set the <code>timestamp</code> of the
                <code>MmsMessage</code> to the value of the 'Date'
                field of the MMS message [<cite><a class="bibref"
                href="#bib-MMS13">MMS13</a></cite>].</li>

                <li>Add a new element in the <code>to</code> array
                of the <code>MmsMessage</code> for each of
                recipients in the 'To' field of the MMS message
                [<cite><a class="bibref" href=
                "#bib-MMS13">MMS13</a></cite>], if present.</li>

                <li>Add a new element in the <code>cc</code> array
                of the <code>MmsMessage</code> for each of
                recipients in the 'Cc' field of the MMS message
                [<cite><a class="bibref" href=
                "#bib-MMS13">MMS13</a></cite>], if present.</li>

                <li>Add a new element in the <code>bcc</code> array
                of the <code>MmsMessage</code> for each of
                recipients in the 'Bcc' field of the MMS message
                [<cite><a class="bibref" href=
                "#bib-MMS13">MMS13</a></cite>], if present.</li>

                <li>Set the <code>subject</code> element to the
                value of the 'Subject' field of the MMS message
                [<cite><a class="bibref" href=
                "#bib-MMS13">MMS13</a></cite>], if present.</li>

                <li>Set the <code>smil</code> element to a
                <code>DOMString</code> containing the SMIL object
                of the received MMS message [<cite><a class=
                "bibref" href="#bib-MMS13">MMS13</a></cite>], if
                present.</li>

                <li>For each of the media files attached to the
                received MMS message add a new element to the
                <code>attachments</code> array with:

                  <ol>
                    <li>A new <code>Blob</code> object including
                    the media type and the actual content of the
                    attachment.</li>

                    <li>The <code>contentID</code> attribute filled
                    with the Content-ID used to reference this
                    element from the SMIL object in the incoming
                    MMS message [<cite><a class="bibref" href=
                    "#bib-MMS13">MMS13</a></cite>], if
                    present.</li>

                    <li>The <code>contentLocation</code> attribute
                    filled with the Content-Location used to
                    reference this element from the SMIL object in
                    the incoming MMS message [<cite><a class=
                    "bibref" href="#bib-MMS13">MMS13</a></cite>],
                    if present.</li>
                  </ol>
                </li>
              </ol>
            </li>

            <li>Set the <code>state</code> of the
            <code>MmsMessage</code> to 'received'.</li>

            <li>Add a new element in the
            <code>deliveryStatus</code> array of the
            <code>MmsMessage</code> for each of recipients in the
            'To', 'Cc' and 'Bcc' fields with value
            'not-applicable'.</li>
          </ol>
        </li>

        <li>
          <a href="#dfn-queue-a-task" class="internalDFN">Queue a
          task</a> to <a href="#dfn-fire-an-event" class=
          "internalDFN">fire an event</a> named <code><a href=
          "#dfn-received-1" class="internalDFN">received</a></code>
          with the <code>message</code> attribute set to the newly
          created <code>MmsMessage</code> instance.
        </li>

        <li>
          <a href="#dfn-queue-a-task" class="internalDFN">Queue a
          task</a> to fire a system message named
          <code>received</code> of type <code><a href=
          "#idl-def-ReceivedMessage" class=
          "idlType"><code>ReceivedMessage</code></a></code> with
          the <code>message</code> attribute set to the newly
          created <code>MmsMessage</code> instance.
        </li>
      </ol>

      <p>The <dfn id="dfn-fetch"><code>fetch</code></dfn> method
      can be invoked to fetch an MMS message that has not been
      automatically fetched upon receiving the corresponding MMS
      notification due to the fetch mode being manual. When this
      method is invoked the User Agent <em class="rfc2119" title=
      "MUST">MUST</em> run the following steps:</p>

      <ol>
        <li>If the <code>messageID</code> parameter passed in the
        request matches with an MMS message that has already been
        fetched, or to an SMS message go to next step, otherwise
        make a request to the system to fetch the MMS message.</li>

        <li>Let <var>future</var> be a new <code>Future</code>
        object and <var>resolver</var> its associated
        <code>resolver</code></li>

        <li>Return <var>future</var> to the caller.</li>

        <li>If an <var>error</var> occurs call
        <var>resolver</var>'s <code>reject(value)</code>method with
        <var>error</var> as <code>value</code> argument.</li>

        <li>When the request has been successfully completed:

          <ol>
            <li>Run the <a class="internalDFN" href=
            "#dfn-fill-mms-message">steps for filling the
            MmsMessage object with the data contained in the MMS
            message</a>.
            </li>

            <li>Let <var>message</var> be the
            <code>MmsMessage</code> that has been fetched.</li>

            <li>Call <var>resolver</var>'s
            <code>accept(value)</code>method with
            <var>message</var> as <code>value</code> argument.</li>
          </ol>
        </li>
      </ol>

      <p>An example of manual fetch of an MMS is provided
      below:</p>

      <div class="example">
        <div class="example-title">
          <span>Example 2</span>
        </div>
        <pre class="example highlight prettyprint">
<span class="pln">navigator</span><span class=
"pun">.</span><span class=
"pln">setMessageHandler </span><span class=
"pun">(</span><span class="str">'received'</span><span class=
"pun">,</span><span class=
"pln"> onMessageReceived</span><span class=
"pun">)</span><span class="pln">
</span><span class="kwd">function</span><span class=
"pln"> onMessageReceived</span><span class=
"pun">(</span><span class="pln">message</span><span class=
"pun">)</span><span class="pln"> </span><span class=
"pun">{</span><span class="pln">
  </span><span class="kwd">if</span><span class=
"pln"> </span><span class="pun">(</span><span class=
"pln">message</span><span class="pun">.</span><span class=
"pln">type </span><span class="pun">==</span><span class=
"pln"> </span><span class="str">'sms'</span><span class=
"pun">)</span><span class="pln"> </span><span class=
"pun">{</span><span class="pln"> window</span><span class=
"pun">.</span><span class="pln">console</span><span class=
"pun">.</span><span class="pln">log</span><span class=
"pun">(</span><span class=
"str">'SMS Message from '</span><span class=
"pln"> </span><span class="pun">+</span><span class="pln">
                               message</span><span class=
"pun">.</span><span class="kwd">from</span><span class=
"pln"> </span><span class="pun">+</span><span class=
"pln"> </span><span class="str">' received'</span><span class=
"pun">);</span><span class="pln">  </span><span class=
"pun">}</span><span class="pln"> 
  </span><span class="kwd">else</span><span class=
"pln"> </span><span class="kwd">if</span><span class=
"pln"> </span><span class="pun">(</span><span class=
"pln">message</span><span class="pun">.</span><span class=
"pln">type </span><span class="pun">==</span><span class=
"pln"> </span><span class="str">'mms'</span><span class=
"pun">)</span><span class="pln"> </span><span class=
"pun">{</span><span class="pln">
        window</span><span class="pun">.</span><span class=
"pln">console</span><span class="pun">.</span><span class=
"pln">log</span><span class="pun">(</span><span class=
"str">'MMS Message from '</span><span class=
"pln"> </span><span class="pun">+</span><span class=
"pln"> message</span><span class="pun">.</span><span class=
"kwd">from</span><span class="pln"> </span><span class=
"pun">+</span><span class="pln"> </span><span class=
"str">' received'</span><span class="pun">);</span><span class=
"pln">  
        </span><span class="kwd">if</span><span class=
"pln"> </span><span class="pun">(</span><span class=
"pln">message</span><span class="pun">.</span><span class=
"pln">state </span><span class="pun">==</span><span class=
"pln"> </span><span class="str">'not-downloaded'</span><span class=
"pun">)</span><span class="pln"> </span><span class=
"pun">{</span><span class="pln"> 
                 window</span><span class=
"pun">.</span><span class="pln">console</span><span class=
"pun">.</span><span class="pln">log</span><span class=
"pun">(</span><span class=
"str">'MMS Message download started'</span><span class=
"pun">);</span><span class="pln">  
                 navigator</span><span class=
"pun">.</span><span class="pln">messaging</span><span class=
"pun">.</span><span class="pln">mms</span><span class=
"pun">.</span><span class="pln">fetch </span><span class=
"pun">(</span><span class="pln">message</span><span class=
"pun">.</span><span class="pln">id</span><span class=
"pun">).</span><span class="kwd">done</span><span class=
"pun">(</span><span class="pln">
                        </span><span class=
"kwd">function</span><span class="pun">(</span><span class=
"pln">message</span><span class="pun">)</span><span class=
"pln"> </span><span class="pun">{</span><span class=
"pln"> window</span><span class="pun">.</span><span class=
"pln">console</span><span class="pun">.</span><span class=
"pln">log</span><span class="pun">(</span><span class=
"str">'MMS Message downloaded!'</span><span class=
"pun">);},</span><span class="pln">
                        </span><span class=
"kwd">function</span><span class="pun">(</span><span class=
"pln">error</span><span class="pun">)</span><span class=
"pln">   </span><span class="pun">{</span><span class=
"pln"> window</span><span class="pun">.</span><span class=
"pln">console</span><span class="pun">.</span><span class=
"pln">error</span><span class="pun">(</span><span class=
"str">'Error: '</span><span class="pln"> </span><span class=
"pun">+</span><span class="pln"> error</span><span class=
"pun">);}</span><span class="pln"> </span><span class=
"pun">);</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span>
</pre>
      </div>

      <div class="note">
        <div class="note-title" role="heading" aria-level="4">
          <span>Note</span>
        </div>

        <div class="">
          It is FFS how to report the progress of the sending and
          fetching of an MMS message.
        </div>
      </div>

      <p>Upon a delivery report of a previously sent MMS message
      being received, the <a href="#dfn-user-agent" class=
      "internalDFN">user agent</a> <em class="rfc2119" title=
      "MUST">MUST</em></p>

      <ol>
        <li>Set the elements of the <code>deliveryStatus</code>
        array of the <code>MmsMessage</code> corresponding to the
        recipients to which the delivery report refers to 'success'
        or 'error' depending on the reported result.</li>

        <li>
          <a href="#dfn-queue-a-task" class="internalDFN">Queue a
          task</a> to <a href="#dfn-fire-an-event" class=
          "internalDFN">fire an event</a> named <a href=
          "#dfn-deliverysuccess-1" class=
          "internalDFN">deliverysuccess</a> or <a href=
          "#dfn-deliveryfailure-1" class=
          "internalDFN">deliveryfailure</a> respectively if the
          delivery was successfull or not, with

          <ol>
            <li>the <code>messageID</code> attribute set to the
            identifier of the <code>MmsMessage</code> to which this
            confirmation is related,</li>

            <li>the <code>serviceID</code> attribute set to the
            identifier of the service used to send such message,
            and</li>

            <li>the <code>recipients</code> attribute set to the
            subset of the original recipients to which this
            delivery report is related.</li>
          </ol>
        </li>

        <li>
          <a href="#dfn-queue-a-task" class="internalDFN">Queue a
          task</a> to fire a system message of type <code><a href=
          "#idl-def-DeliveryReport" class=
          "idlType"><code>DeliveryReport</code></a></code>named
          <a href="#dfn-deliverysuccess-1" class=
          "internalDFN">deliverysuccess</a> or <a href=
          "#dfn-deliveryfailure-1" class=
          "internalDFN">deliveryfailure</a> respectively if the
          delivery was successfull or not, with

          <ol>
            <li>the <code>messageID</code> attribute set to the
            identifier of the <code>MmsMessage</code> to which this
            confirmation is related,</li>

            <li>the <code>serviceID</code> attribute set to the
            identifier of the service used to send such message,
            and</li>

            <li>the <code>recipients</code> attribute set to the
            recipient of such message.</li>
          </ol>
        </li>
      </ol>

      <p>The <dfn id="dfn-clear-1"><code>clear</code></dfn> method
      when invoked <em class="rfc2119" title="MUST">MUST</em> run
      the following steps:</p>

      <ol>
        <li>Make a request to the system to delete all the messages
        associated to the messaging service with identifier equal
        to the <code>serviceID</code> parameter.</li>

        <li>Let <var>future</var> be a new <code>Future</code>
        object and <var>resolver</var> its associated
        <code>resolver</code></li>

        <li>Return <var>future</var> to the caller.</li>

        <li>If an <var>error</var> occurs call
        <var>resolver</var>'s <code>reject(value)</code>method with
        <var>error</var> as <code>value</code> argument.</li>

        <li>When the request has been successfully completed:

          <ol>
            <li>Let <var>serviceID</var> be the
            <code>serviceID</code> parameter passed in the
            request</li>

            <li>Call <var>resolver</var>'s
            <code>accept(value)</code>method with
            <var>serviceID</var> as <code>value</code>
            argument.</li>
          </ol>
        </li>
      </ol>
    </section>

    <section id="event-handlers-1">
      <h3><span class="secno">9.4</span> Event handlers</h3>

      <p>The following are the <a class="internalDFN" href=
      "#dfn-eventhandler">event handlers</a> (and their
      corresponding <a class="internalDFN" href=
      "#dfn-eventtypes">event types</a>) that <em class="rfc2119"
      title="MUST">MUST</em> be supported as attributes by the
      <a href="#idl-def-MmsManager" class=
      "idlType"><code>MmsManager</code></a> object.</p>

      <table class="simple">
        <thead>
          <tr>
            <th>event handler</th>

            <th>event name</th>

            <th>event type</th>

            <th>short description</th>
          </tr>
        </thead>

        <tbody>
          <tr>
            <td><strong><code>onreceived</code></strong></td>

            <td><code><dfn id=
            "dfn-received-1">received</dfn></code></td>

            <td>
              <a href="#idl-def-MessagingEvent" class=
              "idlType"><code>MessagingEvent</code></a>
            </td>

            <td>handles received messages</td>
          </tr>

          <tr>
            <td><strong><code>onsent</code></strong></td>

            <td><code><dfn id="dfn-sent-1">sent</dfn></code></td>

            <td>
              <a href="#idl-def-MessagingEvent" class=
              "idlType"><code>MessagingEvent</code></a>
            </td>

            <td>handles sent messages</td>
          </tr>

          <tr>
            <td>
            <strong><code>ondeliverysuccess</code></strong></td>

            <td><code><dfn id=
            "dfn-deliverysuccess-1">deliverysuccess</dfn></code></td>

            <td>
              <a href="#idl-def-DeliveryReportEvent" class=
              "idlType"><code>DeliveryReportEvent</code></a>
            </td>

            <td>handles successful delivery reports</td>
          </tr>

          <tr>
            <td>
            <strong><code>ondeliveryfailure</code></strong></td>

            <td><code><dfn id=
            "dfn-deliveryfailure-1">deliveryfailure</dfn></code></td>

            <td>
              <a href="#idl-def-DeliveryReportEvent" class=
              "idlType"><code>DeliveryReportEvent</code></a>
            </td>

            <td>handles failure delivery reports</td>
          </tr>

          <tr>
            <td><strong><code>onserviceadded</code></strong></td>

            <td><code><dfn id=
            "dfn-serviceadded-1">serviceadded</dfn></code></td>

            <td>
              <a href="#idl-def-ServiceChangeEvent" class=
              "idlType"><code>ServiceChangeEvent</code></a>
            </td>

            <td>handle new messaging services</td>
          </tr>

          <tr>
            <td><strong><code>onserviceremoved</code></strong></td>

            <td><code><dfn id=
            "dfn-serviceremoved-1">serviceremoved</dfn></code></td>

            <td>
              <a href="#idl-def-ServiceChangeEvent" class=
              "idlType"><code>ServiceChangeEvent</code></a>
            </td>

            <td>handle disabled messaging services</td>
          </tr>
        </tbody>
      </table>
    </section>
  </section>
  <!--====================== Interface SmsMessage ============================-->

  <section id="smsmessage-interface">
    <!--OddPage-->

    <h2><span class="secno">10.</span> <a href=
    "#idl-def-SmsMessage" class=
    "idlType"><code>SmsMessage</code></a> Interface</h2>

    <p>The <a href="#idl-def-SmsMessage" class=
    "idlType"><code>SmsMessage</code></a> interface represents an
    SMS message as defined in [<cite><a class="bibref" href=
    "#bib-GSM-SMS">GSM-SMS</a></cite>]. This interface is not
    intended to represent binary SMS, which are out of the scope of
    this API.</p>
    <pre class="idl">
<span class="idlInterface" id=
"idl-def-SmsMessage">interface <span class=
"idlInterfaceID">SmsMessage</span> {
<span class="idlAttribute">    readonly    attribute <span class=
"idlAttrType"><a>DOMString</a></span>       <span class=
"idlAttrName"><a href=
"#widl-SmsMessage-messageID">messageID</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class=
"idlAttrType"><a href="#idl-def-MessageType" class=
"idlType"><code>MessageType</code></a></span>     <span class=
"idlAttrName"><a href=
"#widl-SmsMessage-type">type</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class=
"idlAttrType"><a>DOMString</a></span>       <span class=
"idlAttrName"><a href=
"#widl-SmsMessage-serviceID">serviceID</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class=
"idlAttrType"><a>DOMString</a></span>       <span class=
"idlAttrName"><a href=
"#widl-SmsMessage-from">from</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class=
"idlAttrType"><a>Date</a></span>            <span class=
"idlAttrName"><a href=
"#widl-SmsMessage-timestamp">timestamp</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class=
"idlAttrType"><a>boolean</a></span>         <span class=
"idlAttrName"><a href=
"#widl-SmsMessage-read">read</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class=
"idlAttrType"><a>DOMString</a></span>       <span class=
"idlAttrName"><a href="#widl-SmsMessage-to">to</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class=
"idlAttrType"><a>DOMString</a></span>       <span class=
"idlAttrName"><a href=
"#widl-SmsMessage-body">body</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class=
"idlAttrType"><a href="#idl-def-SmsState" class=
"idlType"><code>SmsState</code></a></span>        <span class=
"idlAttrName"><a href=
"#widl-SmsMessage-state">state</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class=
"idlAttrType"><a href="#idl-def-DeliveryStatus" class=
"idlType"><code>DeliveryStatus</code></a>?</span> <span class=
"idlAttrName"><a href=
"#widl-SmsMessage-deliveryStatus">deliveryStatus</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class=
"idlAttrType"><a href="#idl-def-MessageClass" class=
"idlType"><code>MessageClass</code></a></span>    <span class=
"idlAttrName"><a href=
"#widl-SmsMessage-messageClass">messageClass</a></span>;</span>
};</span>
</pre>

    <section id="attributes-4">
      <h3><span class="secno">10.1</span> Attributes</h3>

      <dl class="attributes">
        <dt id="widl-SmsMessage-messageID"><code>messageID</code>
        of type <span class="idlAttrType"><a>DOMString</a></span>,
        readonly</dt>

        <dd><em class="rfc2119" title="MUST">MUST</em> return the
        identifier of the message.</dd>

        <dt id="widl-SmsMessage-type"><code>type</code> of type
        <span class="idlAttrType"><a href="#idl-def-MessageType"
        class="idlType"><code>MessageType</code></a></span>,
        readonly</dt>

        <dd><em class="rfc2119" title="MUST">MUST</em> return the
        type of message, i.e. 'sms'.</dd>

        <dt id="widl-SmsMessage-serviceID"><code>serviceID</code>
        of type <span class="idlAttrType"><a>DOMString</a></span>,
        readonly</dt>

        <dd><em class="rfc2119" title="MUST">MUST</em> return the
        messaging service id used to send / receive this
        message.</dd>

        <dt id="widl-SmsMessage-from"><code>from</code> of type
        <span class="idlAttrType"><a>DOMString</a></span>,
        readonly</dt>

        <dd><em class="rfc2119" title="MUST">MUST</em> return the
        sender of the message, i.e. the TP Originating Address
        (TP-OA) of the SMS message.</dd>

        <dt id="widl-SmsMessage-timestamp"><code>timestamp</code>
        of type <span class="idlAttrType"><a>Date</a></span>,
        readonly</dt>

        <dd><em class="rfc2119" title="MUST">MUST</em> return the
        time the message reached the Short Message Center,
        indicated in the TP-Service-Centre-Time-Stamp (TP-SCTS)
        parameter of the SMS message.</dd>

        <dt id="widl-SmsMessage-read"><code>read</code> of type
        <span class="idlAttrType"><a>boolean</a></span>,
        readonly</dt>

        <dd><em class="rfc2119" title="MUST">MUST</em> return
        'true' if the message has been marked as read, or 'false'
        otherwise.</dd>

        <dt id="widl-SmsMessage-to"><code>to</code> of type
        <span class="idlAttrType"><a>DOMString</a></span>,
        readonly</dt>

        <dd><em class="rfc2119" title="MUST">MUST</em> return the
        recipient of the message, i.e. the TP Destination Address
        (TP-DA) of the SMS message.</dd>

        <dt id="widl-SmsMessage-body"><code>body</code> of type
        <span class="idlAttrType"><a>DOMString</a></span>,
        readonly</dt>

        <dd><em class="rfc2119" title="MUST">MUST</em> return text
        of the SMS message, i.e. the SM element contained within
        the TP User Data (TP-UD) field of the SMS message.</dd>

        <dt id="widl-SmsMessage-state"><code>state</code> of type
        <span class="idlAttrType"><a href="#idl-def-SmsState"
        class="idlType"><code>SmsState</code></a></span>,
        readonly</dt>

        <dd><em class="rfc2119" title="MUST">MUST</em> return the
        status of the SMS message.</dd>

        <dt id="widl-SmsMessage-deliveryStatus">
        <code>deliveryStatus</code> of type <span class=
        "idlAttrType"><a href="#idl-def-DeliveryStatus" class=
        "idlType"><code>DeliveryStatus</code></a></span>, readonly
        , nullable</dt>

        <dd><em class="rfc2119" title="MUST">MUST</em> return the
        delivery status of the SMS message.</dd>

        <dt id="widl-SmsMessage-messageClass">
        <code>messageClass</code> of type <span class=
        "idlAttrType"><a href="#idl-def-MessageClass" class=
        "idlType"><code>MessageClass</code></a></span>,
        readonly</dt>

        <dd><em class="rfc2119" title="MUST">MUST</em> return the
        SMS message class, according to the value indicated in the
        TP-Data-Coding-Scheme (TP-DCS) field of the SMS.</dd>
      </dl>
    </section>
  </section>
  <!--====================== Interface MmsMessage ============================-->

  <section id="mmsmessage-interface">
    <!--OddPage-->

    <h2><span class="secno">11.</span> <a href=
    "#idl-def-MmsMessage" class=
    "idlType"><code>MmsMessage</code></a> Interface</h2>

    <p>The <a href="#idl-def-MmsMessage" class=
    "idlType"><code>MmsMessage</code></a> interface represents an
    MMS message, as defined in [<cite><a class="bibref" href=
    "#bib-MMS13">MMS13</a></cite>].</p>
    <pre class="idl">
<span class="idlInterface" id=
"idl-def-MmsMessage">interface <span class=
"idlInterfaceID">MmsMessage</span> {
<span class="idlAttribute">    readonly    attribute <span class=
"idlAttrType"><a>DOMString</a></span>         <span class=
"idlAttrName"><a href=
"#widl-MmsMessage-messageID">messageID</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class=
"idlAttrType"><a href="#idl-def-MessageType" class=
"idlType"><code>MessageType</code></a></span>       <span class=
"idlAttrName"><a href=
"#widl-MmsMessage-type">type</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class=
"idlAttrType"><a>DOMString</a></span>         <span class=
"idlAttrName"><a href=
"#widl-MmsMessage-serviceID">serviceID</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class=
"idlAttrType"><a>DOMString</a></span>         <span class=
"idlAttrName"><a href=
"#widl-MmsMessage-from">from</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class=
"idlAttrType"><a>Date</a></span>              <span class=
"idlAttrName"><a href=
"#widl-MmsMessage-timestamp">timestamp</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class=
"idlAttrType"><a>boolean</a></span>           <span class=
"idlAttrName"><a href=
"#widl-MmsMessage-read">read</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class=
"idlAttrType"><a>DOMString</a>[]</span>       <span class=
"idlAttrName"><a href="#widl-MmsMessage-to">to</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class=
"idlAttrType"><a>DOMString</a>[]</span>       <span class=
"idlAttrName"><a href="#widl-MmsMessage-cc">cc</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class=
"idlAttrType"><a>DOMString</a>[]</span>       <span class=
"idlAttrName"><a href="#widl-MmsMessage-bcc">bcc</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class=
"idlAttrType"><a>DOMString</a></span>         <span class=
"idlAttrName"><a href=
"#widl-MmsMessage-subject">subject</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class=
"idlAttrType"><a>DOMString</a></span>         <span class=
"idlAttrName"><a href=
"#widl-MmsMessage-smil">smil</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class=
"idlAttrType"><a>MmsAttachments</a>[]?</span> <span class=
"idlAttrName"><a href=
"#widl-MmsMessage-attachments">attachments</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class=
"idlAttrType"><a href="#idl-def-MmsState" class=
"idlType"><code>MmsState</code></a></span>          <span class=
"idlAttrName"><a href=
"#widl-MmsMessage-state">state</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class=
"idlAttrType"><a href="#idl-def-DeliveryStatus" class=
"idlType"><code>DeliveryStatus</code></a>[]</span>  <span class=
"idlAttrName"><a href=
"#widl-MmsMessage-deliveryStatus">deliveryStatus</a></span>;</span>
};</span>
</pre>

    <section id="attributes-5">
      <h3><span class="secno">11.1</span> Attributes</h3>

      <dl class="attributes">
        <dt id="widl-MmsMessage-messageID"><code>messageID</code>
        of type <span class="idlAttrType"><a>DOMString</a></span>,
        readonly</dt>

        <dd><em class="rfc2119" title="MUST">MUST</em> return the
        identifier of the message.</dd>

        <dt id="widl-MmsMessage-type"><code>type</code> of type
        <span class="idlAttrType"><a href="#idl-def-MessageType"
        class="idlType"><code>MessageType</code></a></span>,
        readonly</dt>

        <dd><em class="rfc2119" title="MUST">MUST</em> return the
        type of message, i.e. 'mms'.</dd>

        <dt id="widl-MmsMessage-serviceID"><code>serviceID</code>
        of type <span class="idlAttrType"><a>DOMString</a></span>,
        readonly</dt>

        <dd><em class="rfc2119" title="MUST">MUST</em> return the
        messaging service id used to send / receive this
        message.</dd>

        <dt id="widl-MmsMessage-from"><code>from</code> of type
        <span class="idlAttrType"><a>DOMString</a></span>,
        readonly</dt>

        <dd><em class="rfc2119" title="MUST">MUST</em> return the
        sender of the message, i.e. the 'From' field of the MMS
        message.</dd>

        <dt id="widl-MmsMessage-timestamp"><code>timestamp</code>
        of type <span class="idlAttrType"><a>Date</a></span>,
        readonly</dt>

        <dd><em class="rfc2119" title="MUST">MUST</em> return the
        time the message was sent at, i.e. the 'Date' field of the
        MMS message.</dd>

        <dt id="widl-MmsMessage-read"><code>read</code> of type
        <span class="idlAttrType"><a>boolean</a></span>,
        readonly</dt>

        <dd><em class="rfc2119" title="MUST">MUST</em> return
        'true' if the message has been marked as read, or 'false'
        otherwise.</dd>

        <dt id="widl-MmsMessage-to"><code>to</code> of type array
        of <span class="idlAttrType"><a>DOMString</a></span>,
        readonly</dt>

        <dd><em class="rfc2119" title="MUST">MUST</em> return an
        array containing the recipient(s) included in the 'To'
        field of the MMS message.</dd>

        <dt id="widl-MmsMessage-cc"><code>cc</code> of type array
        of <span class="idlAttrType"><a>DOMString</a></span>,
        readonly</dt>

        <dd><em class="rfc2119" title="MUST">MUST</em> return an
        array containing the recipient(s) included in the 'Cc'
        field of the MMS message.</dd>

        <dt id="widl-MmsMessage-bcc"><code>bcc</code> of type array
        of <span class="idlAttrType"><a>DOMString</a></span>,
        readonly</dt>

        <dd><em class="rfc2119" title="MUST">MUST</em> return an
        array containing the recipient(s) included in the 'Bcc'
        field of the MMS message.</dd>

        <dt id="widl-MmsMessage-subject"><code>subject</code> of
        type <span class="idlAttrType"><a>DOMString</a></span>,
        readonly</dt>

        <dd><em class="rfc2119" title="MUST">MUST</em> return the
        subject of the MMS message, corresponding to the 'Subject'
        field of the MMS message.</dd>

        <dt id="widl-MmsMessage-smil"><code>smil</code> of type
        <span class="idlAttrType"><a>DOMString</a></span>,
        readonly</dt>

        <dd><em class="rfc2119" title="MUST">MUST</em> return the
        SMIL, i.e. the presentation element, unparsed as DOMString,
        that the messaging client needs to use to determine the way
        the content of the MMS message is displayed.</dd>

        <dt id="widl-MmsMessage-attachments">
        <code>attachments</code> of type array of <span class=
        "idlAttrType"><a>MmsAttachments</a></span>, readonly ,
        nullable</dt>

        <dd><em class="rfc2119" title="MUST">MUST</em> return the
        set of attachments of the MMS message.</dd>

        <dt id="widl-MmsMessage-state"><code>state</code> of type
        <span class="idlAttrType"><a href="#idl-def-MmsState"
        class="idlType"><code>MmsState</code></a></span>,
        readonly</dt>

        <dd><em class="rfc2119" title="MUST">MUST</em> return the
        status of the MMS message.</dd>

        <dt id="widl-MmsMessage-deliveryStatus">
        <code>deliveryStatus</code> of type array of <span class=
        "idlAttrType"><a href="#idl-def-DeliveryStatus" class=
        "idlType"><code>DeliveryStatus</code></a></span>,
        readonly</dt>

        <dd><em class="rfc2119" title="MUST">MUST</em> return an
        array with each of the elements indicating the delivery
        status to each of the recipients of the message, in order
        starting with the recipients in the 'To' field, followed by
        those in 'Cc' and ending with those in 'Bcc'.</dd>
      </dl>
    </section>
  </section>
  <!--====================== Dictionary MmsContent ===========================-->

  <section id="mmscontent-dictionary">
    <!--OddPage-->

    <h2><span class="secno">12.</span> <a href=
    "#idl-def-MmsContent" class=
    "idlType"><code>MmsContent</code></a> Dictionary</h2>
    <pre class="idl">
<span class="idlDictionary" id=
"idl-def-MmsContent">dictionary <span class=
"idlDictionaryID">MmsContent</span> {
<span class="idlMember">    <span class=
"idlMemberType"><a>DOMString</a></span>       <span class=
"idlMemberName"><a href=
"#widl-MmsContent-subject">subject</a></span>;</span>
<span class="idlMember">    <span class=
"idlMemberType"><a>DOMString</a>[]</span>     <span class=
"idlMemberName"><a href="#widl-MmsContent-to">to</a></span>;</span>
<span class="idlMember">    <span class=
"idlMemberType"><a>DOMString</a>[]</span>     <span class=
"idlMemberName"><a href="#widl-MmsContent-cc">cc</a></span>;</span>
<span class="idlMember">    <span class=
"idlMemberType"><a>DOMString</a>[]</span>     <span class=
"idlMemberName"><a href=
"#widl-MmsContent-bcc">bcc</a></span>;</span>
<span class="idlMember">    <span class=
"idlMemberType"><a>DOMString</a></span>       <span class=
"idlMemberName"><a href=
"#widl-MmsContent-smil">smil</a></span>;</span>
<span class="idlMember">    <span class="idlMemberType"><a href=
"#idl-def-MmsAttachment" class=
"idlType"><code>MmsAttachment</code></a>[]</span> <span class=
"idlMemberName"><a href=
"#widl-MmsContent-attachments">attachments</a></span>;</span>
};</span>
</pre>

    <section id="dictionary-mmscontent-members">
      <h3><span class="secno">12.1</span> Dictionary <a class=
      "idlType" href=
      "#idl-def-MmsContent"><code>MmsContent</code></a>
      Members</h3>

      <dl class="dictionary-members">
        <dt id="widl-MmsContent-subject"><code>subject</code> of
        type <span class=
        "idlMemberType"><a>DOMString</a></span></dt>

        <dd>Indicates the subject of the MMS message, corresponding
        to the 'Subject' field of the MMS message.</dd>

        <dt id="widl-MmsContent-to"><code>to</code> of type array
        of <span class="idlMemberType"><a>DOMString</a></span></dt>

        <dd>Indicates the recipient(s) included in the 'To' field
        of the MMS message. There <em class="rfc2119" title=
        "MUST">MUST</em> be at least one recipient in any of the
        <code>to</code>, <code>cc</code> or <code>bcc</code>
        attributes.</dd>

        <dt id="widl-MmsContent-cc"><code>cc</code> of type array
        of <span class="idlMemberType"><a>DOMString</a></span></dt>

        <dd>Indicates the recipient(s) included in the 'Cc' field
        of the MMS message. There <em class="rfc2119" title=
        "MUST">MUST</em> be at least one recipient in any of the
        <code>to</code>, <code>cc</code> or <code>bcc</code>
        attributes.</dd>

        <dt id="widl-MmsContent-bcc"><code>bcc</code> of type array
        of <span class="idlMemberType"><a>DOMString</a></span></dt>

        <dd>Indicates the recipient(s) included in the 'Bcc' field
        of the MMS message. There <em class="rfc2119" title=
        "MUST">MUST</em> be at least one recipient in any of the
        <code>to</code>, <code>cc</code> or <code>bcc</code>
        attributes.</dd>

        <dt id="widl-MmsContent-smil"><code>smil</code> of type
        <span class="idlMemberType"><a>DOMString</a></span></dt>

        <dd>Contains the SMIL component, i.e. the presentation
        element that determines the way the content of the MMS
        message <em class="rfc2119" title="MUST">MUST</em> be
        displayed.</dd>

        <dt id="widl-MmsContent-attachments">
        <code>attachments</code> of type array of <span class=
        "idlMemberType"><a href="#idl-def-MmsAttachment" class=
        "idlType"><code>MmsAttachment</code></a></span></dt>

        <dd>Contains the set of attachments of the MMS
        message.</dd>
      </dl>
    </section>
  </section>
  <!--====================== Dictionary MmsAttachment ========================-->

  <section id="mmsattachment-dictionary">
    <!--OddPage-->

    <h2><span class="secno">13.</span> <a href=
    "#idl-def-MmsAttachment" class=
    "idlType"><code>MmsAttachment</code></a> Dictionary</h2>
    <pre class="idl">
<span class="idlDictionary" id=
"idl-def-MmsAttachment">dictionary <span class=
"idlDictionaryID">MmsAttachment</span> {
<span class="idlMember">    <span class=
"idlMemberType"><a>DOMString</a></span> <span class=
"idlMemberName"><a href=
"#widl-MmsAttachment-contentID">contentID</a></span>;</span>
<span class="idlMember">    <span class=
"idlMemberType"><a>DOMString</a></span> <span class=
"idlMemberName"><a href=
"#widl-MmsAttachment-contentLocation">contentLocation</a></span>;</span>
<span class="idlMember">    <span class=
"idlMemberType"><a>Blob</a></span>      <span class=
"idlMemberName"><a href=
"#widl-MmsAttachment-content">content</a></span>;</span>
};</span>
</pre>

    <section id="dictionary-mmsattachment-members">
      <h3><span class="secno">13.1</span> Dictionary <a class=
      "idlType" href=
      "#idl-def-MmsAttachment"><code>MmsAttachment</code></a>
      Members</h3>

      <dl class="dictionary-members">
        <dt id="widl-MmsAttachment-contentID">
        <code>contentID</code> of type <span class=
        "idlMemberType"><a>DOMString</a></span></dt>

        <dd>The Content-ID parameter that <em class="rfc2119"
        title="MAY">MAY</em> be used to refer to the attachment
        from the SMIL presentation object as described in
        [<cite><a class="bibref" href=
        "#bib-MMS13">MMS13</a></cite>] and [<cite><a class="bibref"
        href="#bib-MIME-ENC">MIME-ENC</a></cite>]. At least one of
        contentID and contentLocation <em class="rfc2119" title=
        "MUST">MUST</em> be specified if the MMS Message contains
        an SMIL presentation object.</dd>

        <dt id="widl-MmsAttachment-contentLocation">
        <code>contentLocation</code> of type <span class=
        "idlMemberType"><a>DOMString</a></span></dt>

        <dd>The Content-Location parameter that <em class="rfc2119"
        title="MAY">MAY</em> be used to refer to the attachment
        from the SMIL presentation object as described in
        [<cite><a class="bibref" href=
        "#bib-MMS13">MMS13</a></cite>] and [<cite><a class="bibref"
        href="#bib-MIME-ENC">MIME-ENC</a></cite>]. At least one of
        contentID and contentLocation <em class="rfc2119" title=
        "MUST">MUST</em> be specified if the MMS Message contains
        an SMIL presentation object. It may also be used as a hint
        to define the filename when the attachment is stored at the
        file system.</dd>

        <dt id="widl-MmsAttachment-content"><code>content</code> of
        type <span class="idlMemberType"><a>Blob</a></span></dt>

        <dd>The Blob object containing the media type and the
        binary content of the attachment.</dd>
      </dl>
    </section>
  </section>
  <!--====================== Interface Conversation ==========================-->

  <section id="conversation-interface">
    <!--OddPage-->

    <h2><span class="secno">14.</span> <a href=
    "#idl-def-Conversation" class=
    "idlType"><code>Conversation</code></a> Interface</h2>

    <p>The <a href="#idl-def-Conversation" class=
    "idlType"><code>Conversation</code></a> interface represents a
    set of messages that are grouped together either because they
    are exchanged among the same set of participants or because
    they have the same subject.</p>
    <pre class="idl">
<span class="idlInterface" id=
"idl-def-Conversation">interface <span class=
"idlInterfaceID">Conversation</span> {
<span class="idlAttribute">    readonly    attribute <span class=
"idlAttrType"><a>DOMString</a></span>     <span class=
"idlAttrName"><a href=
"#widl-Conversation-conversationID">conversationID</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class=
"idlAttrType"><a href="#idl-def-MessageType" class=
"idlType"><code>MessageType</code></a></span>   <span class=
"idlAttrName"><a href=
"#widl-Conversation-type">type</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class=
"idlAttrType"><a>DOMString</a>[]</span>   <span class=
"idlAttrName"><a href=
"#widl-Conversation-participants">participants</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class=
"idlAttrType"><a>DOMString</a></span>     <span class=
"idlAttrName"><a href=
"#widl-Conversation-subject">subject</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class=
"idlAttrType"><a>DOMString</a>[]</span>   <span class=
"idlAttrName"><a href=
"#widl-Conversation-messageTypes">messageTypes</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class=
"idlAttrType"><a>unsigned long</a></span> <span class=
"idlAttrName"><a href=
"#widl-Conversation-messageCount">messageCount</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class=
"idlAttrType"><a>unsigned long</a></span> <span class=
"idlAttrName"><a href=
"#widl-Conversation-unreadCount">unreadCount</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class=
"idlAttrType"><a>DOMString</a></span>     <span class=
"idlAttrName"><a href=
"#widl-Conversation-lastMessageID">lastMessageID</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class=
"idlAttrType"><a>MessageCursor</a></span> <span class=
"idlAttrName"><a href=
"#widl-Conversation-cursor">cursor</a></span>;</span>
};</span>
</pre>

    <section id="attributes-6">
      <h3><span class="secno">14.1</span> Attributes</h3>

      <dl class="attributes">
        <dt id="widl-Conversation-conversationID">
        <code>conversationID</code> of type <span class=
        "idlAttrType"><a>DOMString</a></span>, readonly</dt>

        <dd><em class="rfc2119" title="MUST">MUST</em> return the
        identifier of the conversation, which is globally unique
        within the implementation, i.e. there cannot be any other
        conversation with the same identifier.</dd>

        <dt id="widl-Conversation-type"><code>type</code> of type
        <span class="idlAttrType"><a href="#idl-def-MessageType"
        class="idlType"><code>MessageType</code></a></span>,
        readonly</dt>

        <dd><em class="rfc2119" title="MUST">MUST</em> return the
        type of conversation, with value 'participants' if the
        conversation is defined as the set of messages exchanged
        among the same set of parties, and 'subject' if the
        conversation is defined as the set of messages with the
        same subject.</dd>

        <dt id="widl-Conversation-participants">
        <code>participants</code> of type array of <span class=
        "idlAttrType"><a>DOMString</a></span>, readonly</dt>

        <dd><em class="rfc2119" title="MUST">MUST</em> return an
        array containing the participants in the conversation. In
        case the conversation is of type 'subject' and there are
        messages in the conversation with a different set of
        participants then this element <em class="rfc2119" title=
        "MUST">MUST</em> return the union of the participants of
        all the messages in the conversation.</dd>

        <dt id="widl-Conversation-subject"><code>subject</code> of
        type <span class="idlAttrType"><a>DOMString</a></span>,
        readonly</dt>

        <dd><em class="rfc2119" title="MUST">MUST</em> return the
        subject of the conversation, if there is a single one.</dd>

        <dt id="widl-Conversation-messageTypes">
        <code>messageTypes</code> of type array of <span class=
        "idlAttrType"><a>DOMString</a></span>, readonly</dt>

        <dd><em class="rfc2119" title="MUST">MUST</em> return an
        array contining the different types of messages included in
        the conversation.</dd>

        <dt id="widl-Conversation-messageCount">
        <code>messageCount</code> of type <span class=
        "idlAttrType"><a>unsigned long</a></span>, readonly</dt>

        <dd><em class="rfc2119" title="MUST">MUST</em> return the
        number of messages in the conversation.</dd>

        <dt id="widl-Conversation-unreadCount">
        <code>unreadCount</code> of type <span class=
        "idlAttrType"><a>unsigned long</a></span>, readonly</dt>

        <dd><em class="rfc2119" title="MUST">MUST</em> return the
        number of unread messages in the conversation.</dd>

        <dt id="widl-Conversation-lastMessageID">
        <code>lastMessageID</code> of type <span class=
        "idlAttrType"><a>DOMString</a></span>, readonly</dt>

        <dd><em class="rfc2119" title="MUST">MUST</em> return the
        identifier of the message in the conversation with the most
        recent timestamp.</dd>

        <dt id="widl-Conversation-cursor"><code>cursor</code> of
        type <span class="idlAttrType"><a>MessageCursor</a></span>,
        readonly</dt>

        <dd><em class="rfc2119" title="MUST">MUST</em> return the
        <code>MessageCursor</code> to access the messages in this
        conversation.</dd>
      </dl>
    </section>
  </section>
  <!--====================== Interface MessagingCursor =======================-->

  <section id="messagingcursor-interface">
    <!--OddPage-->

    <h2><span class="secno">15.</span> <a href=
    "#idl-def-MessagingCursor" class=
    "idlType"><code>MessagingCursor</code></a> Interface</h2>

    <p>The <a href="#idl-def-MessagingCursor" class=
    "idlType"><code>MessagingCursor</code></a> interface allows to
    iterate through a list of <code>Conversation</code> elements or
    of messages (<code>SmsMessage</code> and/or
    <code>MmsMessage</code> elements).</p>

    <p>A <a href="#idl-def-MessagingCursor" class=
    "idlType"><code>MessagingCursor</code></a> always has, an
    <dfn id="dfn-associated-request">associated request</dfn> which
    is the <a>Future</a> that created it.</p>

    <p>As soon as the <a href="#idl-def-MessagingCursor" class=
    "idlType"><code>MessagingCursor</code></a> is <dfn id=
    "dfn-accessing-an-element">accessing an element</dfn>, it
    <em class="rfc2119" title="MUST">MUST</em> put its <a href=
    "#dfn-associated-request" class="internalDFN">associated
    request</a> in the 'processing' <code>readyState</code>, and
    set the <code>result</code> to null. Then, the UA <em class=
    "rfc2119" title="MUST">MUST</em> fetch the next/previous
    element asynchronously. When the element is retrieved, the
    <a href="#dfn-associated-request" class=
    "internalDFN">associated request</a>'s <code>readyState</code>
    must be set to 'done' and the <code>result</code> must point to
    the cursor. If no element was found, the cursor's
    <code>element</code> property must return null.</p>
    <pre class="idl">
<span class="idlInterface" id=
"idl-def-MessagingCursor">interface <span class=
"idlInterfaceID">MessagingCursor</span> {
<span class="idlAttribute">    readonly    attribute <span class=
"idlAttrType"><a>any</a>?</span> <span class="idlAttrName"><a href=
"#widl-MessagingCursor-element">element</a></span>;</span>
<span class="idlMethod">    <span class=
"idlMethType"><a>void</a></span> <span class="idlMethName"><a href=
"#widl-MessagingCursor-next-void">next</a></span> ();</span>
<span class="idlMethod">    <span class=
"idlMethType"><a>void</a></span> <span class="idlMethName"><a href=
"#widl-MessagingCursor-previous-void">previous</a></span> ();</span>
};</span>
</pre>

    <section id="attributes-7">
      <h3><span class="secno">15.1</span> Attributes</h3>

      <dl class="attributes">
        <dt id="widl-MessagingCursor-element"><code>element</code>
        of type <span class="idlAttrType"><a>any</a></span>,
        readonly , nullable</dt>

        <dd>
          This property <em class="rfc2119" title="MUST">MUST</em>
          return the currently accessed element. If the cursor went
          past the last element or if it is currently <a>accessing
          the next element</a>, it <em class="rfc2119" title=
          "MUST">MUST</em> return null.
        </dd>
      </dl>
    </section>

    <section id="methods-3">
      <h3><span class="secno">15.2</span> Methods</h3>

      <dl class="methods">
        <dt id="widl-MessagingCursor-next-void">
        <code>next</code></dt>

        <dd>
          When this method is called, the cursor <em class=
          "rfc2119" title="MUST">MUST</em> change its internal
          state to <a href="#dfn-accessing-an-element" class=
          "internalDFN">accessing an element</a> and proceed to
          access to the next element.<br>
          If this method is called while the cursor is in the
          process of <a href="#dfn-accessing-an-element" class=
          "internalDFN">accessing an element</a>, the method
          <em class="rfc2119" title="MUST">MUST</em> throw an
          <code>"InvalidStateError"</code> error as defined in
          [<cite><a class="bibref" href=
          "#bib-DOM4">DOM4</a></cite>].

          <div>
            <em>No parameters.</em>
          </div>

          <div>
            <em>Return type:</em> <code><a>void</a></code>
          </div>
        </dd>

        <dt id="widl-MessagingCursor-previous-void">
        <code>previous</code></dt>

        <dd>
          When this method is called, the cursor <em class=
          "rfc2119" title="MUST">MUST</em> change its internal
          state to <a href="#dfn-accessing-an-element" class=
          "internalDFN">accessing an element</a> and proceed to
          access to the previous element.<br>
          If this method is called while the cursor is in the
          process of <a href="#dfn-accessing-an-element" class=
          "internalDFN">accessing an element</a>, the method
          <em class="rfc2119" title="MUST">MUST</em> throw an
          <code>"InvalidStateError"</code> error as defined in
          [<cite><a class="bibref" href=
          "#bib-DOM4">DOM4</a></cite>].

          <div>
            <em>No parameters.</em>
          </div>

          <div>
            <em>Return type:</em> <code><a>void</a></code>
          </div>
        </dd>
      </dl>
    </section>
  </section>
  <!--====================== Interface ReceivedMessage =======================-->

  <section id="receivedmessage-interface">
    <!--OddPage-->

    <h2><span class="secno">16.</span> <a href=
    "#idl-def-ReceivedMessage" class=
    "idlType"><code>ReceivedMessage</code></a> Interface</h2>

    <p>The <a href="#idl-def-ReceivedMessage" class=
    "idlType"><code>ReceivedMessage</code></a> interface represents
    a system message related to a received message. This event is
    originated from the system and will start the application if it
    is not currently running.</p>

    <p>The application that consumes this API <em class="rfc2119"
    title="SHOULD">SHOULD</em> set a message handler for the
    <code>ReceivedMessage</code> system message to listen for when
    a system message related to a received message is fired.</p>
    <pre class="idl">
<span class="idlInterface" id=
"idl-def-ReceivedMessage">interface <span class=
"idlInterfaceID">ReceivedMessage</span> {
<span class="idlAttribute">    readonly    attribute <span class=
"idlAttrType">(<a href="#idl-def-SmsMessage" class=
"idlType"><code>SmsMessage</code></a> or <a href=
"#idl-def-MmsMessage" class=
"idlType"><code>MmsMessage</code></a>)</span> <span class=
"idlAttrName"><a href=
"#widl-ReceivedMessage-message">message</a></span>;</span>
};</span>
</pre>

    <section id="attributes-8">
      <h3><span class="secno">16.1</span> Attributes</h3>

      <dl class="attributes">
        <dt id="widl-ReceivedMessage-message"><code>message</code>
        of type <span class="idlAttrType"><a>(SmsMessage or
        MmsMessage)</a></span>, readonly</dt>

        <dd><em class="rfc2119" title="MUST">MUST</em> return the
        <code>SmsMessage</code> or <code>MmsMessage</code> object
        to which this system message is related.</dd>
      </dl>
    </section>
  </section>
  <!--====================== Interface DeliveryReport ========================-->

  <section id="deliveryreport-interface">
    <!--OddPage-->

    <h2><span class="secno">17.</span> <a href=
    "#idl-def-DeliveryReport" class=
    "idlType"><code>DeliveryReport</code></a> Interface</h2>

    <p>The <a href="#idl-def-DeliveryReport" class=
    "idlType"><code>DeliveryReport</code></a> interface represents
    a system message related to a delivery report of a sent
    message. This event is originated from the system and will
    start the application if it is not currently running.</p>

    <p>The application that consumes this API <em class="rfc2119"
    title="MAY">MAY</em> set a message handler for the
    <code>DeliveryReport</code> system message to listen for when a
    system message related to a received delivery report is
    fired.</p>
    <pre class="idl">
<span class="idlInterface" id=
"idl-def-DeliveryReport">interface <span class=
"idlInterfaceID">DeliveryReport</span> {
<span class="idlAttribute">    readonly    attribute <span class=
"idlAttrType"><a>DOMString</a></span>   <span class=
"idlAttrName"><a href=
"#widl-DeliveryReport-serviceID">serviceID</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class=
"idlAttrType"><a>DOMString</a></span>   <span class=
"idlAttrName"><a href=
"#widl-DeliveryReport-messageID">messageID</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class=
"idlAttrType"><a>DOMString</a>[]</span> <span class=
"idlAttrName"><a href=
"#widl-DeliveryReport-recipients">recipients</a></span>;</span>
};</span>
</pre>

    <section id="attributes-9">
      <h3><span class="secno">17.1</span> Attributes</h3>

      <dl class="attributes">
        <dt id="widl-DeliveryReport-serviceID">
        <code>serviceID</code> of type <span class=
        "idlAttrType"><a>DOMString</a></span>, readonly</dt>

        <dd><em class="rfc2119" title="MUST">MUST</em> return the
        identifier of the service used to send the message to which
        this delivery report is related.</dd>

        <dt id="widl-DeliveryReport-messageID">
        <code>messageID</code> of type <span class=
        "idlAttrType"><a>DOMString</a></span>, readonly</dt>

        <dd><em class="rfc2119" title="MUST">MUST</em> return the
        identifier of the message to which this delivery report is
        related.</dd>

        <dt id="widl-DeliveryReport-recipients">
        <code>recipients</code> of type array of <span class=
        "idlAttrType"><a>DOMString</a></span>, readonly</dt>

        <dd><em class="rfc2119" title="MUST">MUST</em> return an
        array contining the addresses of the subset of the original
        recipients of the message to which this delivery report is
        related. As delivery reports related to just part of the
        recipients of the MMS message are possible, this array may
        not contain the full list of recipients to which the MMS
        message was sent. If the delivery report is related to an
        SMS message then the array will contain a single element
        corresponding to the single recipient of the SMS
        message.</dd>
      </dl>
    </section>
  </section>
  <!--====================== Interface MessagingEvent ========================-->

  <section id="messagingevent-interface">
    <!--OddPage-->

    <h2><span class="secno">18.</span> <a href=
    "#idl-def-MessagingEvent" class=
    "idlType"><code>MessagingEvent</code></a> Interface</h2>

    <p>The <a href="#idl-def-MessagingEvent" class=
    "idlType"><code>MessagingEvent</code></a> interface represents
    events related to a message sent or received.</p>
    <pre class="idl">
<span class="idlInterface" id=
"idl-def-MessagingEvent">interface <span class=
"idlInterfaceID">MessagingEvent</span> {
<span class="idlAttribute">    readonly    attribute <span class=
"idlAttrType">(<a href="#idl-def-SmsMessage" class=
"idlType"><code>SmsMessage</code></a> or <a href=
"#idl-def-MmsMessage" class=
"idlType"><code>MmsMessage</code></a>)</span> <span class=
"idlAttrName"><a href=
"#widl-MessagingEvent-message">message</a></span>;</span>
};</span>
</pre>

    <section id="attributes-10">
      <h3><span class="secno">18.1</span> Attributes</h3>

      <dl class="attributes">
        <dt id="widl-MessagingEvent-message"><code>message</code>
        of type <span class="idlAttrType"><a>(SmsMessage or
        MmsMessage)</a></span>, readonly</dt>

        <dd><em class="rfc2119" title="MUST">MUST</em> return the
        <code>SmsMessage</code> or <code>MmsMessage</code> object
        to which this event is related.</dd>
      </dl>
    </section>
  </section>
  <!--====================== Interface DeliveryReportEvent ================-->

  <section id="deliveryreportevent-interface">
    <!--OddPage-->

    <h2><span class="secno">19.</span> <a href=
    "#idl-def-DeliveryReportEvent" class=
    "idlType"><code>DeliveryReportEvent</code></a> Interface</h2>

    <p>The <a href="#idl-def-DeliveryReportEvent" class=
    "idlType"><code>DeliveryReportEvent</code></a> interface
    represents events related to a delivery report of a sent
    message.</p>
    <pre class="idl">
<span class="idlInterface" id=
"idl-def-DeliveryReportEvent">interface <span class=
"idlInterfaceID">DeliveryReportEvent</span> : <span class=
"idlSuperclass"><a>Event</a></span> {
<span class="idlAttribute">    readonly    attribute <span class=
"idlAttrType"><a>DOMString</a></span>   <span class=
"idlAttrName"><a href=
"#widl-DeliveryReportEvent-serviceID">serviceID</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class=
"idlAttrType"><a>DOMString</a></span>   <span class=
"idlAttrName"><a href=
"#widl-DeliveryReportEvent-messageID">messageID</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class=
"idlAttrType"><a>DOMString</a>[]</span> <span class=
"idlAttrName"><a href=
"#widl-DeliveryReportEvent-recipients">recipients</a></span>;</span>
};</span>
</pre>

    <section id="attributes-11">
      <h3><span class="secno">19.1</span> Attributes</h3>

      <dl class="attributes">
        <dt id="widl-DeliveryReportEvent-serviceID">
        <code>serviceID</code> of type <span class=
        "idlAttrType"><a>DOMString</a></span>, readonly</dt>

        <dd><em class="rfc2119" title="MUST">MUST</em> return the
        identifier of the service used to send the message to which
        this delivery report event is related.</dd>

        <dt id="widl-DeliveryReportEvent-messageID">
        <code>messageID</code> of type <span class=
        "idlAttrType"><a>DOMString</a></span>, readonly</dt>

        <dd><em class="rfc2119" title="MUST">MUST</em> return the
        identifier of the message to which this delivery report
        event is related.</dd>

        <dt id="widl-DeliveryReportEvent-recipients">
        <code>recipients</code> of type array of <span class=
        "idlAttrType"><a>DOMString</a></span>, readonly</dt>

        <dd><em class="rfc2119" title="MUST">MUST</em> return an
        array contining the addresses of the subset of the original
        recipients of the message to which this delivery report
        event is related. As delivery reports related to just part
        of the recipients of the MMS message are possible, this
        array may not contain the full list of recipients to which
        the MMS message was sent. If the delivery report is related
        to an SMS message then the array will contain a single
        element corresponding to the single recipient of the SMS
        message.</dd>
      </dl>
    </section>
  </section>
  <!--====================== Interface ServiceChangeEvent ====================-->

  <section id="servicechangeevent-interface">
    <!--OddPage-->

    <h2><span class="secno">20.</span> <a href=
    "#idl-def-ServiceChangeEvent" class=
    "idlType"><code>ServiceChangeEvent</code></a> Interface</h2>

    <p>The <a href="#idl-def-ServiceChangeEvent" class=
    "idlType"><code>ServiceChangeEvent</code></a> interface
    represents events related to messaging services enabled or
    disabled.</p>
    <pre class="idl">
<span class="idlInterface" id=
"idl-def-ServiceChangeEvent">interface <span class=
"idlInterfaceID">ServiceChangeEvent</span> : <span class=
"idlSuperclass"><a>Event</a></span> {
<span class="idlAttribute">    readonly    attribute <span class=
"idlAttrType"><a>DOMString</a></span> <span class=
"idlAttrName"><a href=
"#widl-ServiceChangeEvent-serviceID">serviceID</a></span>;</span>
};</span>
</pre>

    <section id="attributes-12">
      <h3><span class="secno">20.1</span> Attributes</h3>

      <dl class="attributes">
        <dt id="widl-ServiceChangeEvent-serviceID">
        <code>serviceID</code> of type <span class=
        "idlAttrType"><a>DOMString</a></span>, readonly</dt>

        <dd><em class="rfc2119" title="MUST">MUST</em> return the
        identifier of the messaging service which is enabled or
        disabled.</dd>
      </dl>
    </section>
  </section>
  <!--====================== Dictionary MessagingFilter ======================-->

  <section id="messagingfilter-dictionary">
    <!--OddPage-->

    <h2><span class="secno">21.</span> <a href=
    "#idl-def-MessagingFilter" class=
    "idlType"><code>MessagingFilter</code></a> Dictionary</h2>

    <p>The <a href="#idl-def-MessagingFilter" class=
    "idlType"><code>MessagingFilter</code></a> Dictionary
    represents a filter that is used to select a set of messages
    (e.g. to be provided upon invoking the
    <code>findMessages</code> or the <code>findConversations</code>
    method in the <code>Messaging</code> interface).</p>
    <pre class="idl">
<span class="idlDictionary" id=
"idl-def-MessagingFilter">dictionary <span class=
"idlDictionaryID">MessagingFilter</span> {
<span class="idlMember">    <span class="idlMemberType"><a href=
"#idl-def-MessageType" class=
"idlType"><code>MessageType</code></a></span>            <span class="idlMemberName"><a href="#widl-MessagingFilter-type">type</a></span>;</span>
<span class="idlMember">    <span class=
"idlMemberType"><a>Date</a></span>                   <span class=
"idlMemberName"><a href=
"#widl-MessagingFilter-startDate">startDate</a></span>;</span>
<span class="idlMember">    <span class=
"idlMemberType"><a>Date</a></span>                   <span class=
"idlMemberName"><a href=
"#widl-MessagingFilter-endDate">endDate</a></span>;</span>
<span class="idlMember">    <span class=
"idlMemberType"><a>DOMString</a></span>              <span class=
"idlMemberName"><a href=
"#widl-MessagingFilter-from">from</a></span>;</span>
<span class="idlMember">    <span class=
"idlMemberType">sequence&lt;<a>DOMString</a>&gt;</span>    <span class="idlMemberName"><a href="#widl-MessagingFilter-recipients">recipients</a></span>;</span>
<span class="idlMember">    <span class="idlMemberType">(<a href=
"#idl-def-SmsState" class=
"idlType"><code>SmsState</code></a> or <a href="#idl-def-MmsState"
class="idlType"><code>MmsState</code></a>)</span> <span class=
"idlMemberName"><a href=
"#widl-MessagingFilter-state">state</a></span>;</span>
<span class="idlMember">    <span class=
"idlMemberType"><a>DOMString</a></span>              <span class=
"idlMemberName"><a href=
"#widl-MessagingFilter-serviceID">serviceID</a></span>;</span>
<span class="idlMember">    <span class=
"idlMemberType"><a>boolean</a></span>                <span class=
"idlMemberName"><a href=
"#widl-MessagingFilter-read">read</a></span>;</span>
};</span>
</pre>

    <section id="dictionary-messagingfilter-members">
      <h3><span class="secno">21.1</span> Dictionary <a class=
      "idlType" href=
      "#idl-def-MessagingFilter"><code>MessagingFilter</code></a>
      Members</h3>

      <dl class="dictionary-members">
        <dt id="widl-MessagingFilter-type"><code>type</code> of
        type <span class="idlMemberType"><a href=
        "#idl-def-MessageType" class=
        "idlType"><code>MessageType</code></a></span></dt>

        <dd>Indicates whether just the SMS or MMS messages are to
        be provided in the results of this filter, respectively if
        it is set to string value 'SMS' or 'MMS'.</dd>

        <dt id="widl-MessagingFilter-startDate">
        <code>startDate</code> of type <span class=
        "idlMemberType"><a>Date</a></span></dt>

        <dd>Indicates that messages with timestamp previous to this
        date will not be provided in the results of this
        filter.</dd>

        <dt id="widl-MessagingFilter-endDate"><code>endDate</code>
        of type <span class="idlMemberType"><a>Date</a></span></dt>

        <dd>Indicates that messages with timestamp after this date
        will not be provided in the results of this filter.</dd>

        <dt id="widl-MessagingFilter-from"><code>from</code> of
        type <span class=
        "idlMemberType"><a>DOMString</a></span></dt>

        <dd>Indicates that just messages sent from this number are
        to be provided in the results of this filter.</dd>

        <dt id="widl-MessagingFilter-recipients">
        <code>recipients</code> of type <span class=
        "idlMemberType">sequence&lt;<a>DOMString</a>&gt;</span></dt>

        <dd>Indicates that just messages sent to one of these
        numbers are to be provided in the results of this
        filter.</dd>

        <dt id="widl-MessagingFilter-state"><code>state</code> of
        type <span class="idlMemberType"><a>(SmsState or
        MmsState)</a></span></dt>

        <dd>Indicates whether the results of this filter just needs
        to return the messages matching the indicated state.</dd>

        <dt id="widl-MessagingFilter-serviceID">
        <code>serviceID</code> of type <span class=
        "idlMemberType"><a>DOMString</a></span></dt>

        <dd>Indicates that just messages associated to the
        messaging service with this identifier are to be provided
        in the results of this filter.</dd>

        <dt id="widl-MessagingFilter-read"><code>read</code> of
        type <span class="idlMemberType"><a>boolean</a></span></dt>

        <dd>Indicates whether just read or unread messages are to
        be provided in the results of this filter, respectively if
        it is set to 'true' or 'false'.</dd>
      </dl>
    </section>
  </section>
  <!--====================== Dictionary FilterOptions ========================-->

  <section id="filteroptions-dictionary">
    <!--OddPage-->

    <h2><span class="secno">22.</span> <a href=
    "#idl-def-FilterOptions" class=
    "idlType"><code>FilterOptions</code></a> Dictionary</h2>
    <pre class="idl">
<span class="idlDictionary" id=
"idl-def-FilterOptions">dictionary <span class=
"idlDictionaryID">FilterOptions</span> {
<span class="idlMember">    <span class=
"idlMemberType"><a>DOMString</a></span>     <span class=
"idlMemberName"><a href=
"#widl-FilterOptions-sortBy">sortBy</a></span>;</span>
<span class="idlMember">    <span class=
"idlMemberType"><a>DOMString</a></span>     <span class=
"idlMemberName"><a href=
"#widl-FilterOptions-sortOrder">sortOrder</a></span>;</span>
<span class="idlMember">    <span class=
"idlMemberType"><a>unsigned long</a></span> <span class=
"idlMemberName"><a href=
"#widl-FilterOptions-limit">limit</a></span>;</span>
};</span>
</pre>

    <section id="dictionary-filteroptions-members">
      <h3><span class="secno">22.1</span> Dictionary <a class=
      "idlType" href=
      "#idl-def-FilterOptions"><code>FilterOptions</code></a>
      Members</h3>

      <dl class="dictionary-members">
        <dt id="widl-FilterOptions-sortBy"><code>sortBy</code> of
        type <span class=
        "idlMemberType"><a>DOMString</a></span></dt>

        <dd>Indicates the attribute on which the filtered messages
        are sorted.</dd>

        <dt id="widl-FilterOptions-sortOrder">
        <code>sortOrder</code> of type <span class=
        "idlMemberType"><a>DOMString</a></span></dt>

        <dd>Indicates the order on which the filtered messages are
        sorted with possible values 'ascending' and
        'descending'.</dd>

        <dt id="widl-FilterOptions-limit"><code>limit</code> of
        type <span class="idlMemberType"><a>unsigned
        long</a></span></dt>

        <dd>Indicates the maximum number of messages that can be
        returned as a result of applying the corresponding
        filter.</dd>
      </dl>
    </section>
  </section><!--
  <p class="issue">
  It needs to be discussed whether to just allow using the above
  messaging-specific MessagingFilter or otherwise to allow defining filters with
  a generic syntax (as defined in the following sections) and reflect in this
  specification on which attributes the implementation is required to filter in
  an efficient manner (e.g. creating the corresponding indexes).
  </p>

<!======================== Interface CompositeFilter =======================-->
  <!--section>
  <h2><a>CompositeFilter</a> Interface</h2>
  <p>The <a>CompositeFilter</a> interface represents a filter that is the result
  of combining several filters with an operator ('and' / 'or').
  <dl title="interface CompositeFilter : AbstractFilter"
      class="idl">
    <dt>attribute AbstractFilter[] filters</dt>
    <dd>The different filters that are combined in the composite
    filter.</dd>

    <dt>attribute CompositeFilterOperator operator</dt>
    <dd>Indicates the operator used to combined the different filters. It can
    have the following possible values: 'and' and 'or'.</dd>
  </dl>
</section>
    

<!======================== Interface AttributeFilter========================-->
  <!--section>
  <h2><a>AttributeFilter</a> Interface</h2>
  <p>The <a>AttributeFilter</a> interface represents a filter of messages
  based on the value of a specific attribute.
  <dl title="interface AttributeFilter : AbstractFilter"
      class="idl">
    <dt>attribute DOMString filterBy</dt>
    <dd>The attribute based on whose value the messages are filtered.</dd>

    <dt>attribute AttributeFilterOperator operator</dt>
    <dd>Indicates the operator applied on the attribute indicated in the
    <code>filterBy</code> parameter to filter the messages. It can have the
    following possible values: 'is', 'contains', 'startswith', 'endswith',
    'exists'.</dd>

    <dt>attribute any filterValue</dt>
    <dd>The value with which the attribute indicated in the
    <code>filterBy</code> parameter is compared to filter the messages.</dd>
  </dl>
</section>


<!======================== Interface AttributeRangeFilter ==================-->
  <!--section>
  <h2><a>AttributeRangeFilter</a> Interface</h2>
  <p>The <a>AttributeRangeFilter</a> interface represents a filter of messages
  with the value of a specific attribute within a range of values.
  <dl title="interface AttributeRangeFilter : AbstractFilter"
      class="idl">
    <dt>attribute DOMString filterBy</dt>
    <dd>The attribute based on whose value the messages are filtered.</dd>

    <dt>attribute any startValue</dt>
    <dd>The minum value that the attribute indicated in the
    <code>filterBy</code> parameter may have so that the corresponding message
    is included in the result of this filter.</dd>

    <dt>attribute any endValue</dt>
    <dd>The maximum value that the attribute indicated in the
    <code>filterBy</code> parameter may have so that the corresponding message
    si included in the result of this filter.</dd>
  </dl>
</section>

<!======================== Interface Enumerations ==========================-->

  <section id="enumerations">
    <!--OddPage-->

    <h2><span class="secno">23.</span> Enumerations</h2>

    <p>The attibute <code>type</code> can have the following
    values:</p>
    <pre class="idl">
<span class="idlEnum" id="idl-def-MessageType">enum <span class=
"idlEnumID">MessageType</span> {
    "<a href="#idl-def-MessageType.sms" class=
"idlEnumItem">sms</a>",
    "<a href="#idl-def-MessageType.mms" class=
"idlEnumItem">mms</a>"
};</span>
</pre>

    <table class="simple">
      <tr>
        <th colspan="2">Enumeration description</th>
      </tr>

      <tr>
        <td><code id="idl-def-MessageType.sms">sms</code></td>

        <td>Corresponding to SMS message(s).</td>
      </tr>

      <tr>
        <td><code id="idl-def-MessageType.mms">mms</code></td>

        <td>Corresponding to MMS message(s).</td>
      </tr>
    </table>

    <p>The attibute <code>messageClass</code> in an
    <code>SmsMessage</code> can have the following values:</p>
    <pre class="idl">
<span class="idlEnum" id="idl-def-MessageClass">enum <span class=
"idlEnumID">MessageClass</span> {
    "<a href="#idl-def-MessageClass.class-0" class=
"idlEnumItem">class-0</a>",
    "<a href="#idl-def-MessageClass.class-1" class=
"idlEnumItem">class-1</a>",
    "<a href="#idl-def-MessageClass.class-2" class=
"idlEnumItem">class-2</a>",
    "<a href="#idl-def-MessageClass.class-3" class=
"idlEnumItem">class-3</a>",
    "<a href="#idl-def-MessageClass.normal" class=
"idlEnumItem">normal</a>"
};</span>
</pre>

    <table class="simple">
      <tr>
        <th colspan="2">Enumeration description</th>
      </tr>

      <tr>
        <td><code id=
        "idl-def-MessageClass.class-0">class-0</code></td>

        <td>The message is of class 0.</td>
      </tr>

      <tr>
        <td><code id=
        "idl-def-MessageClass.class-1">class-1</code></td>

        <td>The message is of class 1.</td>
      </tr>

      <tr>
        <td><code id=
        "idl-def-MessageClass.class-2">class-2</code></td>

        <td>The message is of class 2.</td>
      </tr>

      <tr>
        <td><code id=
        "idl-def-MessageClass.class-3">class-3</code></td>

        <td>The message is of class 3.</td>
      </tr>

      <tr>
        <td><code id=
        "idl-def-MessageClass.normal">normal</code></td>

        <td>The message is of class 1 (same as 'class-1').</td>
      </tr>
    </table>

    <p>The attibute <code>state</code> in an
    <code>SmsMessage</code> can have the following values:</p>
    <pre class="idl">
<span class="idlEnum" id="idl-def-SmsState">enum <span class=
"idlEnumID">SmsState</span> {
    "<a href="#idl-def-SmsState.received" class=
"idlEnumItem">received</a>",
    "<a href="#idl-def-SmsState.draft" class=
"idlEnumItem">draft</a>",
    "<a href="#idl-def-SmsState.sending" class=
"idlEnumItem">sending</a>",
    "<a href="#idl-def-SmsState.sent" class=
"idlEnumItem">sent</a>",
    "<a href="#idl-def-SmsState.failed" class=
"idlEnumItem">failed</a>"
};</span>
</pre>

    <table class="simple">
      <tr>
        <th colspan="2">Enumeration description</th>
      </tr>

      <tr>
        <td><code id=
        "idl-def-SmsState.received">received</code></td>

        <td>The message is an inbound message.</td>
      </tr>

      <tr>
        <td><code id="idl-def-SmsState.draft">draft</code></td>

        <td>The message is a draft, i.e. it has not yet been
        sent.</td>
      </tr>

      <tr>
        <td><code id="idl-def-SmsState.sending">sending</code></td>

        <td>The message is in process of being sent.</td>
      </tr>

      <tr>
        <td><code id="idl-def-SmsState.sent">sent</code></td>

        <td>The message has been successfully sent.</td>
      </tr>

      <tr>
        <td><code id="idl-def-SmsState.failed">failed</code></td>

        <td>The message is an outbound message whose submission has
        failed.</td>
      </tr>
    </table>

    <p>The attibute <code>state</code> in an
    <code>MmsMessage</code> can have the following values:</p>
    <pre class="idl">
<span class="idlEnum" id="idl-def-MmsState">enum <span class=
"idlEnumID">MmsState</span> {
    "<a href="#idl-def-MmsState.not-downloaded" class=
"idlEnumItem">not-downloaded</a>",
    "<a href="#idl-def-MmsState.received" class=
"idlEnumItem">received</a>",
    "<a href="#idl-def-MmsState.draft" class=
"idlEnumItem">draft</a>",
    "<a href="#idl-def-MmsState.sending" class=
"idlEnumItem">sending</a>",
    "<a href="#idl-def-MmsState.sent" class=
"idlEnumItem">sent</a>",
    "<a href="#idl-def-MmsState.failed" class=
"idlEnumItem">failed</a>"
};</span>
</pre>

    <table class="simple">
      <tr>
        <th colspan="2">Enumeration description</th>
      </tr>

      <tr>
        <td><code id=
        "idl-def-MmsState.not-downloaded">not-downloaded</code></td>

        <td>The message is an inbound message, for which an MMS
        mnotification has been received but that has not yet been
        downloaded.</td>
      </tr>

      <tr>
        <td><code id=
        "idl-def-MmsState.received">received</code></td>

        <td>The message is an inbound message.</td>
      </tr>

      <tr>
        <td><code id="idl-def-MmsState.draft">draft</code></td>

        <td>The message is a draft, i.e. it has not yet been
        sent.</td>
      </tr>

      <tr>
        <td><code id="idl-def-MmsState.sending">sending</code></td>

        <td>The message is in process of being sent.</td>
      </tr>

      <tr>
        <td><code id="idl-def-MmsState.sent">sent</code></td>

        <td>The message has been successfully sent.</td>
      </tr>

      <tr>
        <td><code id="idl-def-MmsState.failed">failed</code></td>

        <td>The message is an outbound message whose submission has
        failed.</td>
      </tr>
    </table>

    <p>The attibute <code>deliveryStatus</code> can have the
    following values:</p>
    <pre class="idl">
<span class="idlEnum" id="idl-def-DeliveryStatus">enum <span class=
"idlEnumID">DeliveryStatus</span> {
    "<a href="#idl-def-DeliveryStatus.success" class=
"idlEnumItem">success</a>",
    "<a href="#idl-def-DeliveryStatus.pending" class=
"idlEnumItem">pending</a>",
    "<a href="#idl-def-DeliveryStatus.error" class=
"idlEnumItem">error</a>",
    "<a href="#idl-def-DeliveryStatus.not-applicable" class=
"idlEnumItem">not-applicable</a>"
};</span>
</pre>

    <table class="simple">
      <tr>
        <th colspan="2">Enumeration description</th>
      </tr>

      <tr>
        <td><code id=
        "idl-def-DeliveryStatus.success">success</code></td>

        <td>The message has been succesfully delivered to the
        recipient.</td>
      </tr>

      <tr>
        <td><code id=
        "idl-def-DeliveryStatus.pending">pending</code></td>

        <td>The message is pending delivery.</td>
      </tr>

      <tr>
        <td><code id=
        "idl-def-DeliveryStatus.error">error</code></td>

        <td>The delivery of the message has failed.</td>
      </tr>

      <tr>
        <td><code id=
        "idl-def-DeliveryStatus.not-applicable">not-applicable</code></td>

        <td>The delivery status is not applicable either because a
        delivery report has not been requested or because the
        message is an inbound message</td>
      </tr>
    </table>

    <p>The MMS fetch mode can have the following values:</p>
    <pre class="idl">
<span class="idlEnum" id="idl-def-FetchMode">enum <span class=
"idlEnumID">FetchMode</span> {
    "<a href="#idl-def-FetchMode.automatic" class=
"idlEnumItem">automatic</a>",
    "<a href="#idl-def-FetchMode.manual" class=
"idlEnumItem">manual</a>"
};</span>
</pre>

    <table class="simple">
      <tr>
        <th colspan="2">Enumeration description</th>
      </tr>

      <tr>
        <td><code id=
        "idl-def-FetchMode.automatic">automatic</code></td>

        <td>MMS message is fecthed right after the reception of the
        MMS notification.</td>
      </tr>

      <tr>
        <td><code id="idl-def-FetchMode.manual">manual</code></td>

        <td>The message is not fecthed until the user manually
        requests it.</td>
      </tr>
    </table>
  </section>
  <!--====================== Acknowledgements ================================-->

  <section id="acknowledgements">
    <!--OddPage-->

    <h2><span class="secno">24.</span> Acknowledgements</h2>

    <p>The editors would like to express their gratitude to the
    Mozilla B2G Team and specially to Jonas Sicking, Mounir Lamouri
    and Vicamo Yang for their technical guidance, implementation
    work and support.</p>
  </section>

  <section id="references" class="appendix">
    <!--OddPage-->

    <h2><span class="secno">A.</span> References</h2>

    <section id="normative-references">
      <h3><span class="secno">A.1</span> Normative references</h3>

      <dl class="bibliography">
        <dt id="bib-DOM4">[DOM4]</dt>

        <dd>
          Anne van Kesteren; Aryeh Gregor; Lachlan Hunt; Ms2ger.
          <a href=
          "http://www.w3.org/TR/2012/WD-dom-20121206"><cite>DOM4</cite></a>.
          6 December 2012. W3C Working Draft. URL: <a href=
          "http://www.w3.org/TR/2012/WD-dom-20121206">http://www.w3.org/TR/2012/WD-dom-20121206</a>
        </dd>

        <dt id="bib-GSM-SMS">[GSM-SMS]</dt>

        <dd>
          Richard Burbidge. <a href=
          "http://www.3gpp.org/ftp/Specs/html-info/23040.htm"><cite>
          Technical realization of the Short Message Service
          (SMS)</cite></a>. URL: <a href=
          "http://www.3gpp.org/ftp/Specs/html-info/23040.htm">http://www.3gpp.org/ftp/Specs/html-info/23040.htm</a>
        </dd>

        <dt id="bib-HTML5">[HTML5]</dt>

        <dd>
          Robin Berjon et al. <a href=
          "http://www.w3.org/TR/html5/"><cite>HTML5</cite></a>. 17
          December 2012. W3C Candidate Recommendation. URL:
          <a href="http://www.w3.org/TR/html5/">http://www.w3.org/TR/html5/</a>
        </dd>

        <dt id="bib-MIME-ENC">[MIME-ENC]</dt>

        <dd>
          J. Palme; A. Hopmann; N. Shelness. <a href=
          "http://www.ietf.org/rfc/rfc2557.txt"><cite>MIME
          Encapsulation of Aggregate Documents, such as HTML
          (MHTML)</cite></a>. March 1999. RFC. URL: <a href=
          "http://www.ietf.org/rfc/rfc2557.txt">http://www.ietf.org/rfc/rfc2557.txt</a>
        </dd>

        <dt id="bib-MMS13">[MMS13]</dt>

        <dd>
          <a href=
          "http://technical.openmobilealliance.org/Technical/release_program/mms_v1_3.aspx">
          <cite>Multimedia Messaging Service 1.3</cite></a>. 13
          September 2011. Approved Enabler Release. URL: <a href=
          "http://technical.openmobilealliance.org/Technical/release_program/mms_v1_3.aspx">
          http://technical.openmobilealliance.org/Technical/release_program/mms_v1_3.aspx</a>
        </dd>

        <dt id="bib-RFC2119">[RFC2119]</dt>

        <dd>
          S. Bradner. <a href=
          "http://www.ietf.org/rfc/rfc2119.txt"><cite>Key words for
          use in RFCs to Indicate Requirement Levels.</cite></a>
          March 1997. Internet RFC 2119. URL: <a href=
          "http://www.ietf.org/rfc/rfc2119.txt">http://www.ietf.org/rfc/rfc2119.txt</a>
        </dd>

        <dt id="bib-WEBIDL">[WEBIDL]</dt>

        <dd>
          Cameron McCormack. <a href=
          "http://www.w3.org/TR/2012/CR-WebIDL-20120419/"><cite>Web
          IDL</cite></a>. 19 April 2012. W3C Candidate
          Recommendation. URL: <a href=
          "http://www.w3.org/TR/2012/CR-WebIDL-20120419/">http://www.w3.org/TR/2012/CR-WebIDL-20120419/</a>
        </dd>
      </dl>
    </section>

    <section id="informative-references">
      <h3><span class="secno">A.2</span> Informative
      references</h3>

      <dl class="bibliography">
        <dt id="bib-OMA-PUSH">[OMA-PUSH]</dt>

        <dd>
          Open Mobile Alliance. OMA Push Version 2.3. URL: <a href=
          "http://www.openmobilealliance.org/Technical/release_program/push_v2_3.aspx">
          http://www.openmobilealliance.org/Technical/release_program/push_v2_3.aspx</a>
        </dd>
      </dl>
    </section>
  </section>
</body>
</html>
