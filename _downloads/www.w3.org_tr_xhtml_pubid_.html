<!-- http://www.w3.org/TR/xhtml-pubid/ -->
<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Public Identifiers for entity resolution in XHTML</title>
<style type="text/css">
.quote {background-color: #EEEEEE;
margin-left:3em;
margin-left:3em;
}
.diff-add {color:green}
  </style>
<link rel="stylesheet" type="text/css" href="http://www.w3.org/StyleSheets/TR/W3C-WD.css"/>
</head>
<body>
<div class="head">
<div class="logo">
    <a href="http://www.w3.org/"><img width="72" height="48" src="http://www.w3.org/Icons/w3c_home" alt="W3C"/></a>
</div>

<h1 id="title">Public Identifiers for entity resolution in XHTML</h1>
<h2 id="w3c-doctype">W3C Working Draft 22 August 2013</h2>
<dl><dt>This version:</dt><dd>
<a href="http://www.w3.org/TR/2013/WD-xhtml-pubid-20130822/">http://www.w3.org/TR/2013/WD-xhtml-pubid-20130822/</a>
</dd><dt>Latest version:</dt><dd>
<a href="http://www.w3.org/TR/xhtml-pubid/">http://www.w3.org/TR/xhtml-pubid/</a>
</dd><dt>Previous version:</dt><dd>
<a href="http://www.w3.org/TR/2013/WD-xhtml-pubid-20130228/">http://www.w3.org/TR/2013/WD-xhtml-pubid-20130228/</a>
</dd><dt>Latest editor's draft:</dt><dd>
<a href="http://www.w3.org/2003/entities/2007doc/xhtml-pubid.html">http://www.w3.org/2003/entities/2007doc/xhtml-pubid.html</a>
</dd><dt>Editor:</dt><dd>David Carlisle, NAG</dd></dl>
<p class="copyright"><a href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> &#169; 2013 <a href="http://www.w3.org/"><abbr title="World Wide Web Consortium">W3C</abbr></a><sup>&#174;</sup> (<a href="http://www.csail.mit.edu/"><abbr title="Massachusetts Institute of Technology">MIT</abbr></a>, <a href="http://www.ercim.eu/"><abbr title="European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>, <a href="http://www.keio.ac.jp/">Keio</a>, <a href="http://ev.buaa.edu.cn/">Beihang</a>), All Rights Reserved. W3C <a href="http://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>, <a href="http://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and <a href="http://www.w3.org/Consortium/Legal/copyright-documents">document use</a> rules apply.</p>
</div>
<hr/>
<div>
<h2 id="abstract">Abstract</h2>
<p>
This document adds an additional public identifier that should be recognised by XHTML user agents
and cause the HTML character entity definitions to be loaded. Unlike the identifiers already listed by the 
<a href="#">[HTML5]</a> specification, the identifier added by this extension references the set of defintions that is used by HTML.
</p>
</div>
<div>
<h2 id="status">Status of this Document</h2>
<p><em>This section describes the status of this document at the time
of its publication. Other documents may supersede this document. A
list of current W3C publications and the latest revision of this
technical report can be found in the <a href="http://www.w3.org/TR/">W3C technical reports index</a> at
http://www.w3.org/TR/.</em>
</p>
<p>This document was published by the <a href="http://www.w3.org/html/wg/">HTML Working Group</a> as a Public Working Draft.
 If you are not a HTML working group member and wish to make comments regarding this document please send them to
<a href="mailto:public-html-comments@w3.org">public-html-comments@w3.org</a>
 (<a href="mailto:public-html-comments-request@w3.org?subject=subscribe">subscribe</a>, <a href="http://lists.w3.org/Archives/Public/public-html-comments/">archives</a>).
If you are a HTML working group member and wish to make comments regarding this document, please send them to
<a href="mailto:public-html@w3.org">public-html@w3.org</a> 
(<a href="mailto:public-html-request@w3.org?subject=subscribe">subscribe</a>, <a href="http://lists.w3.org/Archives/Public/public-html/">archives</a>). All feedback is welcome.</p>
<p>A Test file for this specification is avalable as part of the <a href="http://w3c-test.org/html-testsuite/master/ext-xhtml-pubid/the-xhtml-syntax/parsing-xhtml-documents/">HTML Test Suite</a>.</p>
<p>Publication as a Working Draft does not imply endorsement by the W3C Membership. This is a draft document and may be updated, replaced or obsoleted by other documents at any time. It is inappropriate to cite this document as other than work in progress.</p>
<p> This document was produced by a group operating under the 
            <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/">5 February 2004
<abbr title="World Wide Web Consortium">W3C</abbr> Patent Policy</a>.
 <abbr title="World Wide Web Consortium">W3C</abbr> maintains
            a <a href="http://www.w3.org/2004/01/pp-impl/40318/status" rel="disclosure">public list of any patent disclosures</a> 
            
            made in connection with the deliverables of the group; that page also includes instructions for 
            disclosing a patent. An individual who has actual knowledge of a patent which the individual believes contains
            <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#def-essential">Essential Claim(s)</a> must disclose the
            information in accordance with <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#sec-Disclosure">section
            6 of the <abbr title="World Wide Web Consortium">W3C</abbr> Patent Policy</a>.
          
          
        </p>
<p>There are no chnages to this document other than the date and updating this section to refer to the test suite.</p>
</div>
<div class="toc">
<h2 id="contents">Table of Contents</h2>
<p class="toc">
1 <a href="#xhtmlpubid_intro">Introduction</a><br/>
2 <a href="#diff">Addition to the HTML specification</a><br/>
3 <a href="#normative">Normative references</a><br/>
4 <a href="#background">Background and Rationale (Non-Normative)</a><br/>
</p>
</div>
<hr/>
<div class="body">
<div class="div1">
<h2 id="xhtmlpubid_intro">1 Introduction</h2>

  <p>This specification is an extension to the <a href="http://www.w3.org/html/wg/drafts/html/master/">HTML5 specification</a> [<a href="#bib-HTML5">HTML5</a>]. It defines an additional Public Identifier that a conforming User agent <em title="should" class="rfc2119">should</em> recognise and trigger the loading of the entities defined in  [<a href="#bib-HTML5">HTML5</a>] unlike the Identifiers listed in the current HTML specification.</p>
  

<p>The key words <em title="must" class="rfc2119">must</em>, <em title="must not" class="rfc2119">must not</em>, <em title="required" class="rfc2119">required</em>, <em title="should" class="rfc2119">should</em>, <em title="should not" class="rfc2119">should not</em>, <em title="recommended" class="rfc2119">recommended</em>, <em title="may" class="rfc2119">may</em>, and <em title="optional" class="rfc2119">optional</em> in this specification are to be interpreted as described in [<cite><a class="bibref" href="#bib-RFC2119">RFC2119</a></cite>].  </p>
</div>
</div>
<div class="div1">
<h2 id="diff">2 Addition to the HTML specification</h2>
<p> <a href="#">[HTML5]</a> <a href="http://www.w3.org/TR/html5/the-xhtml-syntax.html#parsing-xhtml-documents">Section  9.2</a> currently 
defines the following list of public identifiers that cause a pre-defined list of entity definitions to be loaded:</p>
<div class="quote" id="old"><ul class="brief">
<li><code title="">-//W3C//DTD&#160;XHTML&#160;1.0&#160;Transitional//EN</code></li>
<li><code title="">-//W3C//DTD&#160;XHTML&#160;1.1//EN</code></li>
<li><code title="">-//W3C//DTD&#160;XHTML&#160;1.0&#160;Strict//EN</code></li>
<li><code title="">-//W3C//DTD&#160;XHTML&#160;1.0&#160;Frameset//EN</code></li>
<li><code title="">-//W3C//DTD&#160;XHTML&#160;Basic&#160;1.0//EN</code></li>
<li><code title="">-//W3C//DTD&#160;XHTML&#160;1.1&#160;plus&#160;MathML&#160;2.0//EN</code></li>
<li><code title="">-//W3C//DTD&#160;XHTML&#160;1.1&#160;plus&#160;MathML&#160;2.0&#160;plus&#160;SVG&#160;1.1//EN</code></li>
<li><code title="">-//W3C//DTD&#160;MathML&#160;2.0//EN</code></li>
<li><code title="">-//WAPFORUM//DTD&#160;XHTML&#160;Mobile&#160;1.0//EN</code></li></ul>
</div>
<p>The only change proposed by this extension is to add a further identifier to the list such that it reads:</p>
<div class="quote" id="new"><ul class="brief">
<li><code title="">-//W3C//DTD XHTML 1.0 Transitional//EN</code></li>
<li><code title="">-//W3C//DTD XHTML 1.1//EN</code></li>
<li><code title="">-//W3C//DTD XHTML 1.0 Strict//EN</code></li>
<li><code title="">-//W3C//DTD XHTML 1.0 Frameset//EN</code></li>
<li><code title="">-//W3C//DTD XHTML Basic 1.0//EN</code></li>
<li><code title="">-//W3C//DTD XHTML 1.1 plus MathML 2.0//EN</code></li>
<li><code title="">-//W3C//DTD XHTML 1.1 plus MathML 2.0 plus SVG 1.1//EN</code></li>
<li><code title="">-//W3C//DTD MathML 2.0//EN</code></li>
<li><code title="">-//WAPFORUM//DTD XHTML Mobile 1.0//EN</code></li>
<li class="diff-add"><code title="">-//W3C//ENTITIES HTML MathML Set//EN//XML</code></li>
</ul>
</div>
<p>Note the above list includes one other editorial change from the current HTML specification.
The white space in each of the Identifiers should be space character U+0020,
however the current HTML specification uses non-breaking space U+00A0 as shown in the first list above;
this does not work with cutting and pasting into a document.</p>
</div>
<div class="div1">
<div id="normative-references">
   <h3 id="normative">3 Normative references</h3>

 <dl>
   <dt id="bib-HTML5">[HTML5]</dt>
   <dd> Robin Berjon, Travis Leithead, Erika Doyle Navara, Edward O'Connor, Silvia Pfeiffer. <a href="http://www.w3.org/html/wg/drafts/html/CR/Overview.html">HTML 5</a> W3C Candidate Recommendation 08 November 2012 URL: <a href="http://www.w3.org/html/wg/drafts/html/CR/Overview.html">http://www.w3.org/html/wg/drafts/html/CR/Overview.html</a></dd>
   <dt id="bib-RFC2119">[RFC2119]</dt>
   <dd>S. Bradner. <a href="http://www.ietf.org/rfc/rfc2119.txt">Key words for use in RFCs to Indicate Requirement Levels.</a> March 1997. Internet RFC 2119.  URL: <a href="http://www.ietf.org/rfc/rfc2119.txt">http://www.ietf.org/rfc/rfc2119.txt</a></dd>
   <dt id="bib-xmlent">[XMLEntities]</dt>
   <dd>David Carlisle, Patrick Ion. <a href="http://www.w3.org/TR/xml-entity-names/">XML Entity Definitions for Characters</a>  W3C Recommendation 01 April 2010 URL: <a href="http://www.w3.org/TR/xml-entity-names/">http://www.w3.org/TR/xml-entity-names/</a></dd>
   <dt id="bib-Bug13409">[Bug13409]</dt>
   <dd>David Carlisle, <a href="https://www.w3.org/Bugs/Public/show_bug.cgi?id=13409">Bug 13409, Defining Entity references for characters in XHTML</a>. URL: <a href="https://www.w3.org/Bugs/Public/show_bug.cgi?id=13409">https://www.w3.org/Bugs/Public/show_bug.cgi?id=13409</a></dd>
 </dl>




</div>
</div>
<div class="div1">
<h2 id="background">4 Background and Rationale (Non-Normative)</h2>
<p>A major reason to use the XHTML rather than HTML syntax for a
document is to process the document using an XML-based toolchain, as
well as in a browser. All the existing public identifiers listed
identify DTDs that contain incompatible entity sets, thus unless
processed using a non-standard configuration or catalogue that overrides the DTD then data
corruption or fatal errors due to undefined entities will occur.</p>
<p>The Identifier 
<code>-//W3C//ENTITIES HTML MathML Set//EN//XML</code>
Is the Public Identifier of the entity declaration file
<a href="http://www.w3.org/2003/entities/2007/htmlmathml-f.ent">http://www.w3.org/2003/entities/2007/htmlmathml-f.ent</a>
defined by the XML Entity Definitions for Characters Recommendation <a href="#bib-xmlent">[XMLEntities]</a>.
The entity definition file used by HTML is extracted from the same source 
(<a href="http://www.w3.org/2003/entities/2007xml/unicode.xml">unicode.xml</a>) so using this file ensures that XML and HTML processing of
entity references are as similar as possible.</p>
<p >Authors (and authoring systems of XHTML documents) may prefer to
use no DTD and just use numeric character references rather than entity
references for characters, for instance, <code>caf&amp;#xe9;</code> or
<code>caf&#233;</code> rather that <code>caf&amp;eacute;</code>.
If they wish to use the <code>caf&amp;eacute;</code> form then they <em title="should" class="rfc2119">should</em>
use the form</p>
<pre>
 &lt;!DOCTYPE html PUBLIC
         "-//W3C//ENTITIES HTML MathML Set//EN//XML"
         "some/path/htmlmathml-f.ent"
       >
</pre>
<p>Where <code>some/path/htmlmathml-f.ent</code> is a URL to a copy of <code>http://www.w3.org/2003/entities/2007/htmlmathml-f.ent</code>.</p>

<h3 id="benefits">Benefits</h3>
<p>If a user agent supports the extended list specified in this document then authors may use entity references such as <code>&amp;langle;</code> or 
<code>&amp;loang;</code> and the document will be processed using the same characters (<code>&amp;#x27E8;</code> and <code>&amp;#x27EC;</code>) in XHTML agents and general XML processing tools.</p>
<ul>
<li>If a document specifies <code>-//W3C//DTD XHTML 1.1//EN</code>, then, in an XHTML User Agent, <code>&amp;langle;</code> and 
<code>&amp;loang;</code> are recognised as <code>&amp;#x27E8;</code> and <code>&amp;#x27EC;</code> however, if processed by a standard XML parser that
references an XHTML 1 DTD, <code>&amp;langle;</code> would be expanded to <code>&amp;x2329;</code> which is not in Unicode NFC form. If normalised, data corruption would occur as this character is normalised to the Asian punctuation character <code>&amp;x3008;</code>. For a document which references the XHTML 1 DTD and uses <code>&amp;loang;</code> the entity is undefined so this would be a fatal XML parsing error and the entire document would be rejected if processed with standard XML tools.</li>
<li>If a document specifies <code>-//W3C//DTD XHTML 1.1 plus MathML 2.0//EN</code>, then, in an XHTML User Agent, <code>&amp;langle;</code> and 
<code>&amp;loang;</code> are recognised as above; however, if processed by a standard XML parser that
references the XHTML 1.1 plus MathML 2 DTD and uses <code>&amp;loang;</code> the entity would expand to the Asian Punctuation Character <code>&amp;#x3018;</code> thus silent data modification would occur. (The character U+27EC was added to Unicode 5.1 after the HTML 1.1 Recommendation was published precisely to avoid this problem.</li>
</ul>

<p>There are similar problems with all the Identifiers in the list currently specified by HTML.
Appendix C of <a href="#bib-xmlent">[XMLEntities]</a> lists all the changes between the HTML5 Entity set and the earlier XHTML 1 and MathML2 sets.</p>

<h3 id="risks">Risks</h3>
<p>The main risk of adding a new recognised Identifier is that older HTML User Agents, and other User Agents not conforming to this specification will not recognise the Identifier. This is unavoidable, but is no worse than the current situation where as noted in the previous section, the identifiers that are recognised can still lead to undefined entities and worse, silent data corruption. The list (even as amended by  this extension specifcation) is not compatible with the behaviour of all legacy user agents. A good example of this is the <a href="http://www.w3.org/TR/MathML2/chapter3.xml">XHTML version of Chapter 2 of the MathML2 Recommendation</a> This was processed by all relevant user agents at the time of its publication but is rejected as not well formed by user agents conforming to HTML. It would still be rejected by User Agents conforming to this extension. However, this extension gives a possibility of changing the document to use a declaration that will work for current XHTML and XML parsers, a possibility that is not there with HTML as currently published.</p>
<p>It could be noted that a form compatible with this extension specification, and at least some older User Agents such as Firefox 1&#x2013;3, or Internet Explorer 6+, is:</p>
<pre>
&lt;!DOCTYPE html PUBLIC
         "-//W3C//ENTITIES HTML MathML Set//EN//XML"
         "mathml.dtd"
       >
</pre>
where <code>mathml.dtd</code> is the copy of <code>htmlmathml-f.ent</code> as recommended above.
Early Firefox (and Mozilla/Netscape) would use their bundled entity declarations for this usage, and Internet explorer would fetch the specified DTD. It is only <em>since</em> the publication of the early drafts of HTML5 that browser behaviour has changed, so in Firefox 4+ and browsers of a similar era it is not possible to reference an HTML5 compatible set of entity declarations in a way that causes those entities to be defined in an XHTML5 user agent. This was raised as <a href="#bib-Bug13409">[Bug13409]</a> on the HTML5 specification.
</div>
</body>


</html>
