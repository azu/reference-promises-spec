<!-- http://www.w3.org/TR/mmi-interop/ -->
<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>
<html dir="ltr" xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
    <title>MMI interoperability test report</title>
    <meta content="text/html;charset=utf-8" http-equiv="Content-Type" />
    
    
	<script type="text/javascript">
	function updateExample(doc, content) {
       // perform transformations to make it render and prettier
	   return '&lt;pre class=&quot;example sh_javascript&quot;&gt;' + doc._esc(content) + '&lt;/pre&gt;';
    }
	</script>
  <style type="text/css">
/*****************************************************************
 * ReSpec CSS
 * Robin Berjon (robin at berjon dot com)
 * v0.05 - 2009-07-31
 *****************************************************************/


/* --- INLINES --- */
em.rfc2119 { 
    text-transform:     lowercase;
    font-variant:       small-caps;
    font-style:         normal;
    color:              #900;
}

h1 acronym, h2 acronym, h3 acronym, h4 acronym, h5 acronym, h6 acronym, a acronym,
h1 abbr, h2 abbr, h3 abbr, h4 abbr, h5 abbr, h6 abbr, a abbr {
    border: none;
}

dfn {
    font-weight:    bold;
}

a.internalDFN {
    color:  inherit;
    border-bottom:  1px solid #99c;
    text-decoration:    none;
}

a.externalDFN {
    color:  inherit;
    border-bottom:  1px dotted #ccc;
    text-decoration:    none;
}

a.bibref {
    text-decoration:    none;
}

code {
    color:  #ff4500;
}


/* --- WEB IDL --- */
pre.idl {
    border-top: 1px solid #90b8de;
    border-bottom: 1px solid #90b8de;
    padding:    1em;
    line-height:    120%;
}

pre.idl::before {
    content:    "WebIDL";
    display:    block;
    width:      150px;
    background: #90b8de;
    color:  #fff;
    font-family:    initial;
    padding:    3px;
    font-weight:    bold;
    margin: -1em 0 1em -1em;
}

.idlType {
    color:  #ff4500;
    font-weight:    bold;
    text-decoration:    none;
}

/*.idlModule*/
/*.idlModuleID*/
/*.idlInterface*/
.idlInterfaceID {
    font-weight:    bold;
    color:  #005a9c;
}

.idlSuperclass {
    font-style: italic;
    color:  #005a9c;
}

/*.idlAttribute*/
.idlAttrType, .idlFieldType {
    color:  #005a9c;
}
.idlAttrName, .idlFieldName {
    color:  #ff4500;
}
.idlAttrName a, .idlFieldName a {
    color:  #ff4500;
    border-bottom:  1px dotted #ff4500;
    text-decoration: none;
}

/*.idlMethod*/
.idlMethType {
    color:  #005a9c;
}
.idlMethName {
    color:  #ff4500;
}
.idlMethName a {
    color:  #ff4500;
    border-bottom:  1px dotted #ff4500;
    text-decoration: none;
}

/*.idlParam*/
.idlParamType {
    color:  #005a9c;
}
.idlParamName {
    font-style: italic;
}

.extAttr {
    color:  #666;
}

/*.idlConst*/
.idlConstType {
    color:  #005a9c;
}
.idlConstName {
    color:  #ff4500;
}
.idlConstName a {
    color:  #ff4500;
    border-bottom:  1px dotted #ff4500;
    text-decoration: none;
}

/*.idlException*/
.idlExceptionID {
    font-weight:    bold;
    color:  #c00;
}

.idlTypedefID, .idlTypedefType {
    color:  #005a9c;
}

.idlRaises, .idlRaises a.idlType, .idlRaises a.idlType code, .excName a, .excName a code {
    color:  #c00;
    font-weight:    normal;
}

.excName a {
    font-family:    monospace;
}

.idlRaises a.idlType, .excName a.idlType {
    border-bottom:  1px dotted #c00;
}

.excGetSetTrue, .excGetSetFalse, .prmNullTrue, .prmNullFalse, .prmOptTrue, .prmOptFalse {
    width:  45px;
    text-align: center;
}
.excGetSetTrue, .prmNullTrue, .prmOptTrue { color:  #0c0; }
.excGetSetFalse, .prmNullFalse, .prmOptFalse { color:  #c00; }

.idlImplements a {
    font-weight:    bold;
}

dl.attributes, dl.methods, dl.constants, dl.fields {
    margin-left:    2em;
}

.attributes dt, .methods dt, .constants dt, .fields dt {
    font-weight:    normal;
}

.attributes dt code, .methods dt code, .constants dt code, .fields dt code {
    font-weight:    bold;
    color:  #000;
    font-family:    monospace;
}

.attributes dt code, .fields dt code {
    background:  #ffffd2;
}

.attributes dt .idlAttrType code, .fields dt .idlFieldType code {
    color:  #005a9c;
    background:  transparent;
    font-family:    inherit;
    font-weight:    normal;
    font-style: italic;
}

.methods dt code {
    background:  #d9e6f8;
}

.constants dt code {
    background:  #ddffd2;
}

.attributes dd, .methods dd, .constants dd, .fields dd {
    margin-bottom:  1em;
}

table.parameters, table.exceptions {
    border-spacing: 0;
    border-collapse:    collapse;
    margin: 0.5em 0;
    width:  100%;
}
table.parameters { border-bottom:  1px solid #90b8de; }
table.exceptions { border-bottom:  1px solid #deb890; }

.parameters th, .exceptions th {
    color:  #fff;
    padding:    3px 5px;
    text-align: left;
    font-family:    initial;
    font-weight:    normal;
    text-shadow:    #666 1px 1px 0;
}
.parameters th { background: #90b8de; }
.exceptions th { background: #deb890; }

.parameters td, .exceptions td {
    padding:    3px 10px;
    border-top: 1px solid #ddd;
    vertical-align: top;
}

.parameters tr:first-child td, .exceptions tr:first-child td {
    border-top: none;
}

.parameters td.prmName, .exceptions td.excName, .exceptions td.excCodeName {
    width:  100px;
}

.parameters td.prmType {
    width:  120px;
}

table.exceptions table {
    border-spacing: 0;
    border-collapse:    collapse;
    width:  100%;
}

/* --- TOC --- */
.toc a {
    text-decoration:    none;
}

a .secno {
    color:  #000;
}

/* --- TABLE --- */
table.simple {
    border-spacing: 0;
    border-collapse:    collapse;
    border-bottom:  3px solid #005a9c;
}

.simple th {
    background: #005a9c;
    color:  #fff;
    padding:    3px 5px;
    text-align: left;
}

.simple th[scope="row"] {
    background: inherit;
    color:  inherit;
    border-top: 1px solid #ddd;
}

.simple td {
    padding:    3px 10px;
    border-top: 1px solid #ddd;
}

.simple tr:nth-child(even) {
    background: #f0f6ff;
}

/* --- DL --- */
.section dd > p:first-child {
    margin-top: 0;
}

.section dd > p:last-child {
    margin-bottom: 0;
}

.section dd {
    margin-bottom:  1em;
}

.section dl.attrs dd, .section dl.eldef dd {
    margin-bottom:  0;
}

/* --- EXAMPLES --- */
pre.example {
/*    border-top: 1px solid #ff4500; */
/*    border-bottom: 1px solid #ff4500; */
    padding:    1em;
    margin-top: 1em;
    background: #f0f6ff;
}

/*
pre.example::before {
    content:    "Example";
    display:    block;
    width:      150px;
    background: #ff4500;
    color:  #fff;
    font-family:    initial;
    padding:    3px;
    font-weight:    bold;
    margin: -1em 0 1em -1em;
}
*/

/* --- EDITORIAL NOTES --- */
.issue {
    padding:    1em;
    margin: 1em 0em 0em;
    border: 1px solid #f00;
    background: #ffc;
}

.issue::before {
    content:    "Issue";
    display:    block;
    width:  150px;
    margin: -1.5em 0 0.5em 0;
    font-weight:    bold;
    border: 1px solid #f00;
    background: #fff;
    padding:    3px 1em;
}

.note {
    margin: 1em 0em 0em;
    padding:    1em;
    border: 2px solid #cff6d9;
    background: #e2fff0;
}

.note::before {
    content:    "Note";
    display:    block;
    width:  150px;
    margin: -1.5em 0 0.5em 0;
    font-weight:    bold;
    border: 1px solid #cff6d9;
    background: #fff;
    padding:    3px 1em;
}

/* --- Best Practices --- */
div.practice {
    border: solid #bebebe 1px;
    margin: 2em 1em 1em 2em;
}

span.practicelab {
    margin: 1.5em 0.5em 1em 1em;
    font-weight: bold;
    font-style: italic;
}

span.practicelab   { background: #dfffff; }

span.practicelab {
    position: relative;
    padding: 0 0.5em;
    top: -1.5em;
}

p.practicedesc {
    margin: 1.5em 0.5em 1em 1em;
}

@media screen {
    p.practicedesc {
        position: relative;
        top: -2em;
        padding: 0;
        margin: 1.5em 0.5em -1em 1em;
    }
}

/* --- SYNTAX HIGHLIGHTING --- */
pre.sh_sourceCode {
  background-color: white;
  color: black;
  font-style: normal;
  font-weight: normal;
}

pre.sh_sourceCode .sh_keyword { color: #005a9c; font-weight: bold; }           /* language keywords */
pre.sh_sourceCode .sh_type { color: #666; }                            /* basic types */
pre.sh_sourceCode .sh_usertype { color: teal; }                             /* user defined types */
pre.sh_sourceCode .sh_string { color: red; font-family: monospace; }        /* strings and chars */
pre.sh_sourceCode .sh_regexp { color: orange; font-family: monospace; }     /* regular expressions */
pre.sh_sourceCode .sh_specialchar { color: 	#ffc0cb; font-family: monospace; }  /* e.g., \n, \t, \\ */
pre.sh_sourceCode .sh_comment { color: #A52A2A; font-style: italic; }         /* comments */
pre.sh_sourceCode .sh_number { color: purple; }                             /* literal numbers */
pre.sh_sourceCode .sh_preproc { color: #00008B; font-weight: bold; }       /* e.g., #include, import */
pre.sh_sourceCode .sh_symbol { color: blue; }                            /* e.g., *, + */
pre.sh_sourceCode .sh_function { color: black; font-weight: bold; }         /* function calls and declarations */
pre.sh_sourceCode .sh_cbracket { color: red; }                              /* block brackets (e.g., {, }) */
pre.sh_sourceCode .sh_todo { font-weight: bold; background-color: #00FFFF; }   /* TODO and FIXME */

/* Predefined variables and functions (for instance glsl) */
pre.sh_sourceCode .sh_predef_var { color: #00008B; }
pre.sh_sourceCode .sh_predef_func { color: #00008B; font-weight: bold; }

/* for OOP */
pre.sh_sourceCode .sh_classname { color: teal; }

/* line numbers (not yet implemented) */
pre.sh_sourceCode .sh_linenum { display: none; }

/* Internet related */
pre.sh_sourceCode .sh_url { color: blue; text-decoration: underline; font-family: monospace; }

/* for ChangeLog and Log files */
pre.sh_sourceCode .sh_date { color: blue; font-weight: bold; }
pre.sh_sourceCode .sh_time, pre.sh_sourceCode .sh_file { color: #00008B; font-weight: bold; }
pre.sh_sourceCode .sh_ip, pre.sh_sourceCode .sh_name { color: #006400; }

/* for Prolog, Perl... */
pre.sh_sourceCode .sh_variable { color: #006400; }

/* for LaTeX */
pre.sh_sourceCode .sh_italics { color: #006400; font-style: italic; }
pre.sh_sourceCode .sh_bold { color: #006400; font-weight: bold; }
pre.sh_sourceCode .sh_underline { color: #006400; text-decoration: underline; }
pre.sh_sourceCode .sh_fixed { color: green; font-family: monospace; }
pre.sh_sourceCode .sh_argument { color: #006400; }
pre.sh_sourceCode .sh_optionalargument { color: purple; }
pre.sh_sourceCode .sh_math { color: orange; }
pre.sh_sourceCode .sh_bibtex { color: blue; }

/* for diffs */
pre.sh_sourceCode .sh_oldfile { color: orange; }
pre.sh_sourceCode .sh_newfile { color: #006400; }
pre.sh_sourceCode .sh_difflines { color: blue; }

/* for css */
pre.sh_sourceCode .sh_selector { color: purple; }
pre.sh_sourceCode .sh_property { color: blue; }
pre.sh_sourceCode .sh_value { color: #006400; font-style: italic; }

/* other */
pre.sh_sourceCode .sh_section { color: black; font-weight: bold; }
pre.sh_sourceCode .sh_paren { color: red; }
pre.sh_sourceCode .sh_attribute { color: #006400; }

</style><link href="http://www.w3.org/StyleSheets/TR/W3C-WG-NOTE" rel="stylesheet" type="text/css" charset="utf-8" /></head>
  <body style="display: inherit;"><div class="head"><p><a href="http://www.w3.org/"><img height="48" width="72" alt="W3C" src="http://www.w3.org/Icons/w3c_home" /></a></p><h1 id="title" class="title">MMI interoperability test report</h1><h2 id="w3c-working-group-note-24-january-2012"><acronym title="World Wide Web Consortium">W3C</acronym> Working Group Note 24 January 2012</h2><dl><dt>This version:</dt><dd><a href="http://www.w3.org/TR/2012/NOTE-mmi-interop-20120124/">http://www.w3.org/TR/2012/NOTE-mmi-interop-20120124/</a></dd><dt>Latest published version:</dt><dd><a href="http://www.w3.org/TR/mmi-interop/">http://www.w3.org/TR/mmi-interop/</a></dd><dt>Previous version:</dt><dd>none</dd><dt>Editor:</dt><dd><span>Ingmar Kliche</span>, <a href="http://www.telekom.de/">Deutsche Telekom AG</a></dd>
<dt>Authors:</dt><dd><span>Nagesh Kharidi</span>, <a href="http://www.openstream.com/">Openstream</a></dd>
<dd><span>Piotr Wiechno</span>, <a href="http://www.orange.com/">France Telecom</a></dd>
</dl><p class="copyright"><a href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> © 2012 <a href="http://www.w3.org/"><acronym title="World Wide Web Consortium">W3C</acronym></a><sup>®</sup> (<a href="http://www.csail.mit.edu/"><acronym title="Massachusetts Institute of Technology">MIT</acronym></a>, <a href="http://www.ercim.eu/"><acronym title="European Research Consortium for Informatics and Mathematics">ERCIM</acronym></a>, <a href="http://www.keio.ac.jp/">Keio</a>), All Rights Reserved. <acronym title="World Wide Web Consortium">W3C</acronym> <a href="http://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>, <a href="http://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and <a href="http://www.w3.org/Consortium/Legal/copyright-documents">document use</a> rules apply.</p><hr /></div>
    <div id="abstract" class="introductory section"><h2>Abstract</h2>
      This document describes an interoperability test, executed by various members of 
	  the Multimodal Interaction Working Group, to demonstrate interoperability of multimodal 
	  components which are implementing the &quot;Multimodal Architecture and Interfaces&quot; [<cite><a class="bibref" rel="biblioentry" href="#bib-MMI-ARCH">MMI-ARCH</a></cite>] 
	  specification.
	</div><div class="introductory section" id="sotd"><h2>Status of This Document</h2><p><em>This section describes the status of this document at the time of its publication. Other documents may supersede this document. A list of current <acronym title="World Wide Web Consortium">W3C</acronym> publications and the latest revision of this technical report can be found in the <a href="http://www.w3.org/TR/"><acronym title="World Wide Web Consortium">W3C</acronym> technical reports index</a> at http://www.w3.org/TR/.</em></p>
<p>This is the 23 January 2012
<a href="http://www.w3.org/2005/10/Process-20051014/tr.html#WGNote"><acronym title="World Wide Web Consortium">W3C</acronym>
Working Group Note</a> of &quot;MMI interoperability test report&quot;.

This <acronym title="World Wide Web Consortium">W3C</acronym> Working Group Note has been developed by the <a href="http://www.w3.org/2002/mmi/">Multimodal Interaction Working
Group</a> of the <acronym title="World Wide Web Consortium">W3C</acronym> <a href="http://www.w3.org/2002/mmi/Activity.html">Multimodal
Interaction Activity</a>.</p>

<p>Comments for this note are welcomed and should have a subject
starting with the prefix '[INTEROP]'. Please send them to <a href="mailto:www-multimodal@w3.org">www-multimodal@w3.org</a>, the
public email list for issues related to Multimodal. This list is <a href="http://lists.w3.org/Archives/Public/www-multimodal/">archived</a>
and acceptance of this archiving policy is requested automatically
upon first post. To subscribe to this list send an email to <a href="mailto:www-multimodal-request@w3.org">www-multimodal-request@w3.org</a>
with the word &quot;subscribe&quot; in the subject line.</p>

<p>This document was published by the <a href="http://www.w3.org/2002/mmi">Multimodal Interaction Working Group</a> as a Working Group Note. If you wish to make comments regarding this document, please send them to <a href="mailto:www-multimodal@w3.org">www-multimodal@w3.org</a> (<a href="mailto:www-multimodal-request@w3.org?subject=subscribe">subscribe</a>, <a href="http://lists.w3.org/Archives/Public/www-multimodal/">archives</a>). All comments are welcomed and should have a subject starting with the prefix '[INTEROP]'.</p><p>Publication as a Working Group Note does not imply endorsement by the <acronym title="World Wide Web Consortium">W3C</acronym> Membership. This is a draft document and may be updated, replaced or obsoleted by other documents at any time. It is inappropriate to cite this document as other than work in progress.</p><p>This document was produced by a group operating under the <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/">5 February 2004 <acronym title="World Wide Web Consortium">W3C</acronym> Patent Policy</a>. <acronym title="World Wide Web Consortium">W3C</acronym> maintains a <a rel="disclosure" href="http://www.w3.org/2004/01/pp-impl/34607/status">public list of any patent disclosures</a> made in connection with the deliverables of the group; that page also includes instructions for disclosing a patent. An individual who has actual knowledge of a patent which the individual believes contains <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#def-essential">Essential Claim(s)</a> must disclose the information in accordance with <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#sec-Disclosure">section 6 of the <acronym title="World Wide Web Consortium">W3C</acronym> Patent Policy</a>.</p></div><div id="toc" class="section"><h2 class="introductory">Table of Contents</h2><ul class="toc"><li class="tocline"><a href="#introduction" class="tocxref"><span class="secno">1. </span>Introduction</a></li><li class="tocline"><a href="#setup" class="tocxref"><span class="secno">2. </span>Test setup</a></li><li class="tocline"><a href="#modality_components" class="tocxref"><span class="secno">3. </span>Components of the multimodal system</a></li><li class="tocline"><a href="#application" class="tocxref"><span class="secno">4. </span>A MathQuiz</a></li><li class="tocline"><a href="#application_scripts" class="tocxref"><span class="secno">A. </span>Application scripts</a></li><li class="tocline"><a href="#acknowledgements" class="tocxref"><span class="secno">B. </span>Acknowledgements</a></li><li class="tocline"><a href="#references" class="tocxref"><span class="secno">C. </span>References</a><ul class="toc"><li class="tocline"><a href="#normative-references" class="tocxref"><span class="secno">C.1 </span>Normative references</a></li><li class="tocline"><a href="#informative-references" class="tocxref"><span class="secno">C.2 </span>Informative references</a></li></ul></li></ul></div>
    

    
    <div id="introduction" class="section">
      
<!-- OddPage -->
<h2><span class="secno">1. </span>Introduction</h2>
      <p>
        The <acronym title="World Wide Web Consortium">W3C</acronym> MMI Working Group developed the “Multimodal Architecture and Interfaces” 
		specification [<cite><a class="bibref" rel="biblioentry" href="#bib-MMI-ARCH">MMI-ARCH</a></cite>], which is a <acronym title="World Wide Web Consortium">W3C</acronym> Candidate Recommendation since January 2011. To prove implementability 
		various working group members (Openstream, France Telecom and Deutsche Telekom) initiated an 
		interoperability test activity. The goal of this activity was to build a multimodal system 
		based on components from the different participants and to prove and demonstrate 
		interoperability of the components by using a simple application.
      </p>
	  <p>The key principles of the Multimodal Architecture are to treat Modality Components as 'black-boxes',  making no assumptions about their internal
	   implementation and allowing them to communicate solely through the life-cycle events as described. The architecture supports extension of
	   functionality through extension-events, but  requires that modality components do not communicate directly with each other, but only through the Interaction Manager.
      </p>
	  <p>The current exercise, is to verify that MCs developed by different vendors, can actually communicate through life cycle events and verify the architectural principles outlined in the Multimodal Architecture and Interfaces specification [<cite><a class="bibref" rel="biblioentry" href="#bib-MMI-ARCH">MMI-ARCH</a></cite>].
      </p>
    </div>
        
    <div id="setup" class="section">
      
<!-- OddPage -->
<h2><span class="secno">2. </span>Test setup</h2>
      <p>
        The multimodal system has been built using 3 architectural components: one Interaction 
		Manager and two Modality Components. All 3 components have been provided by different 
		participants. The following figure gives an overview of the structure of the system.
      </p>
	  <img src="./images/Interop_Architecture.png" alt="interoperabilty test architecture" />
	  <p>
	    As shown in the figure the system consisted of a voice modality component and a graphical 
		modality component (GUI). The system has been set up as a distributed environment and 
		HTTP has been used for the lifecycle event transport. A description of the details of 
		the lifecycle event transport can be found in the &quot;Multimodal Architecture and Interfaces&quot; 
		[<cite><a class="bibref" rel="biblioentry" href="#bib-MMI-ARCH">MMI-ARCH</a></cite>] specification. 
	  </p>
	  <p>
	  There is a more detailed description of implementation options (some of them have also been used during this test) 
	  in the &quot;Authoring Applications for the Multimodal Architecture&quot; note [<cite><a class="bibref" rel="biblioentry" href="#bib-MMI-AUTH">MMI-AUTH</a></cite>]
	  </p>
    </div>

	
<!--  ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++  -->

    <div id="modality_components" class="section">
      
<!-- OddPage -->
<h2><span class="secno">3. </span>Components of the multimodal system</h2>
	  <h3 id="interaction-manager">Interaction Manager</h3>
	  
	  <p>The Interaction Manager is an HTTP server that runs SCXML applications and processes MMI life-cycle events. The server manages multiple SCXML interpreter instances simultaneously (one per each application context). Life-cycle events are transported via HTTP as described in Appendix E of the Multimodal Architecture and Interfaces specification. The server is Java-based and uses Commons-SCXML to interpret SCXML. HTTP transport and internal event routing is handled by Mule ESB.
	  </p>
	  <p>An additional instanceId parameter has been added to initial HTTP requests sent by distributed Modality Components to enable instance (context) sharing. The instanceId parameter needs to be configured on each Modality Component that wants to share a context with another Modality Component. If the IM receives a NewContextRequest message with an attached instanceId that matches a previously received value, it will reuse the previously generated context ID in the NewContextResponse message. If no match is found for the provided instanceId or if the parameter is missing, the IM will generate a new context (state machine instance).

	  </p>
	  <h3 id="graphical-modality-component">Graphical modality component</h3>
	  <p>
	  The graphical modality component has been implemented using HTML [<cite><a class="bibref" rel="biblioentry" href="#bib-HTML401">HTML401</a></cite>], ECMAScript [<cite><a class="bibref" rel="biblioentry" href="#bib-ECMA-262">ECMA-262</a></cite>] and XMLHttpRequests [<cite><a class="bibref" rel="biblioentry" href="#bib-XMLHTTPREQUEST">XMLHTTPREQUEST</a></cite>]. 
	  The graphical modality component acts as a wrapper around the application specific HTML (see below) and handles 
	  DOM events (such as click or focus) generated by the application specific HTML. The graphical modality component uses
	  XMLHttpRequests [<cite><a class="bibref" rel="biblioentry" href="#bib-XMLHTTPREQUEST">XMLHTTPREQUEST</a></cite>] to send these events (wrapped in MMI lifecycle events) to the server side interaction manager. 
	  Lifecycle events are received from the interaction manager also usint XMLHttpRequests (see also &quot;Authoring Applications for the Multimodal Architecture&quot; 
	  [<cite><a class="bibref" rel="biblioentry" href="#bib-MMI-AUTH">MMI-AUTH</a></cite>] for a more detailed description). 
	  </p>
	  <p>
	  The following table describes the functionality and the API of the graphical modality component (see also [<cite><a class="bibref" rel="biblioentry" href="#bib-MMI-MCBP">MMI-MCBP</a></cite>] for more details):
	  </p><table class="simple">
	    <tbody><tr>
	      <th>Life Cycle Event</th>
		  <th>Component Implementation</th>
	    </tr>
		<tr>
		  <td>NewContextRequest</td>
		  <td>(Standard) The component requests a new context from the IM.
<pre>Example:
&lt;mmi:mmi xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot; version=&quot;1.0&quot;&gt;
	&lt;mmi:NewContextRequest source=&quot;GUI&quot; requestID=&quot;r1&quot; target=&quot;MathQuiz&quot; context=&quot;-1&quot; /&gt;
&lt;/mmi:mmi&gt;
</pre>
		  </td>
		</tr>
		<tr>
		  <td>NewContextResponse</td>
		  <td>(Standard) The component starts a new context and assigns the new context id to it.</td>
		</tr>
		<tr>
		  <td>PrepareRequest</td>
		  <td>The component does not take any action on a PrepareRequest.</td>
		</tr>
		<tr>
		  <td>PrepareResponse</td>
		  <td>The component does not send a PrepareResponse.</td>
		</tr>
		<tr>
		  <td>StartRequest</td>
		  <td>The component starts processing of the document referenced by contentURL 
<pre>Example:
&lt;mmi:mmi xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot; version=&quot;1.0&quot;&gt;
   &lt;mmi:StartRequest source=&quot;MathQuiz&quot; requestID=&quot;r2&quot; target=&quot;GUI&quot; context=&quot;c1&quot;&gt;
      &lt;mmi:contentURL mmi:href=”http://localhost/gui.html”/&gt;
   &lt;/mmi:StartRequest&gt;
&lt;/mmi:mmi&gt;
</pre>
        </td>
		</tr>
		<tr>
		  <td>StartResponse</td>
		  <td>(Standard)</td>
		</tr>
		<tr>
		  <td>DoneNotification</td>
		  <td>Not used by the modality component.</td>
		</tr>
		<tr>
		  <td>CancelRequest</td>
		  <td>This component cannot cancel.</td>
		</tr>
		<tr>
		  <td>CancelResponse</td>
		  <td>The component does not send a CancelResponse.</td>
		</tr>
		<tr>
		  <td>PauseRequest</td>
		  <td>This component cannot pause.</td>
		</tr>
		<tr>
		  <td>PauseResponse</td>
		  <td>The component does not send a PauseResponse.</td>
		</tr>
		<tr>
		  <td>ResumeRequest</td>
		  <td>This component cannot resume.</td>
		</tr>
		<tr>
		  <td>ResumeResponse</td>
		  <td>The component does not send a ResumeResponse.</td>
		</tr>
		<tr>
		  <td>ExtensionNotification (focus)</td>
		  <td>The component sends an “ExtensionNotification” lifecycle event to the IM when an input field gets focus. The attribute “id” contains the elements ID within the HTML document.
<pre>Example:
&lt;mmi:mmi xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot; version=&quot;1.0&quot;&gt;
  &lt;mmi:ExtensionNotification mmi:name=&quot;focus&quot; mmi:source=&quot;GUI&quot; mmi:requestID=&quot;r2&quot; mmi:context=&quot;c1&quot;&gt;
    &lt;mmi:data&gt;
      &lt;emma:emma xmlns:emma=&quot;http://www.w3.org/2003/04/emma&quot; version=&quot;1.0&quot;&gt;
        &lt;emma:interpretation id=&quot;int-01&quot; emma:medium=&quot;tactile&quot; emma:mode=&quot;ink&quot;&gt;
          &lt;focus id=&quot;field1&quot; value=&quot;123&quot; /&gt;
        &lt;/emma:interpretation&gt;
      &lt;/emma:emma&gt;
    &lt;/mmi:data&gt;
  &lt;/mmi:ExtensionNotification&gt;
&lt;/mmi:mmi&gt;
</pre>
</td>
		</tr>
		<tr>
		  <td>ExtensionNotification (click)</td>
		  <td>The component sends an “ExtensionNotification” lifecycle event to the IM when a button was clicked. The attribute “id” contains the buttons ID within the HTML document.
<pre>Example:
&lt;mmi:mmi xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot; version=&quot;1.0&quot;&gt;
  &lt;mmi:ExtensionNotification mmi:name=&quot;click&quot; mmi:source=&quot;GUI&quot; mmi:requestID=&quot;r2&quot; mmi:context=&quot;c1&quot;&gt;
    &lt;mmi:data&gt;
      &lt;emma:emma xmlns:emma=&quot;http://www.w3.org/2003/04/emma&quot; version=&quot;1.0&quot;&gt;
        &lt;emma:interpretation id=&quot;int-01&quot; emma:medium=&quot;tactile&quot; emma:mode=&quot;ink&quot;&gt;
          &lt;click id=&quot;button1&quot; value=&quot;&quot; /&gt;
        &lt;/emma:interpretation&gt;
      &lt;/emma:emma&gt;
    &lt;/mmi:data&gt;
  &lt;/mmi:ExtensionNotification&gt;
&lt;/mmi:mmi&gt;
</pre>
</td>
		</tr>		
		<tr>
		  <td>ExtensionNotification (change)</td>
		  <td>The component sends an “ExtensionNotification” lifecycle event to the IM when the content of an input field was changed.
This event will not be sent until the input field loses focus. The attribute “id” contains the input fields ID within the HTML document.
<pre>Example:
&lt;mmi:mmi xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot; version=&quot;1.0&quot;&gt;
  &lt;mmi:ExtensionNotification mmi:name=&quot;change&quot; mmi:source=&quot;GUI&quot; mmi:requestID=&quot;r2&quot; mmi:context=&quot;c1&quot;&gt;
    &lt;mmi:data&gt;
      &lt;emma:emma xmlns:emma=&quot;http://www.w3.org/2003/04/emma&quot; version=&quot;1.0&quot;&gt;
        &lt;emma:interpretation id=&quot;int-01&quot; emma:medium=&quot;tactile&quot; emma:mode=&quot;ink&quot;&gt;
          &lt;change id=&quot;field1&quot; value=&quot;16&quot; /&gt;
        &lt;/emma:interpretation&gt;
      &lt;/emma:emma&gt;
    &lt;/mmi:data&gt;
  &lt;/mmi:ExtensionNotification&gt;
&lt;/mmi:mmi&gt;
</pre>
</td>
		</tr>
		<tr>
		  <td>ExtensionNotification (setValue)</td>
		  <td>The IM can send an “ExtensionNotification” lifecycle event to the modality component to set a value of an input field. The attribute “id” must contain ID of the HTML element.
<pre>Example:
&lt;mmi:mmi version=&quot;1.0&quot; xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot;&gt;
  &lt;mmi:ExtensionNotification mmi:name=&quot;setValue&quot; mmi:target=&quot;GUI&quot; mmi:requestID=&quot;r3&quot; mmi:context=&quot;c1&quot;&gt;
    &lt;mmi:data&gt;
      &lt;function name=&quot;setValue&quot; id=&quot;field1&quot; value=&quot;20&quot; /&gt; 
    &lt;/mmi:data&gt;
  &lt;/mmi:ExtensionNotification&gt;
&lt;/mmi:mmi&gt;
</pre>
</td>
		</tr>
<tr>
		  <td>ExtensionNotification (setFocus)</td>
		  <td>The IM can send an “ExtensionNotification” lifecycle event to the modality component to set the focus of an input field. The attribute “id” must contain ID of the HTML element.
<pre>Example:
&lt;mmi:mmi version=&quot;1.0&quot; xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot;&gt;
  &lt;mmi:ExtensionNotification mmi:name=&quot;setValue&quot; mmi:target=&quot;GUI&quot; mmi:requestID=&quot;r3&quot; mmi:context=&quot;c1&quot;&gt;
    &lt;mmi:data&gt;
      &lt;function name=&quot;setFocus&quot; id=&quot;field1&quot; value=&quot;20&quot; /&gt; 
    &lt;/mmi:data&gt;
  &lt;/mmi:ExtensionNotification&gt;
&lt;/mmi:mmi&gt;
</pre>
</td>
		</tr>		<tr>
		  <td>ClearContextRequest</td>
		  <td>(Standard)</td>
		</tr>
		<tr>
		  <td>clearContextResponse</td>
		  <td>(Standard)</td>
		</tr>
		<tr>
		  <td>StatusRequest</td>
		  <td>The component does not take any action on a StatusRequest.</td>
		</tr>
		<tr>
		  <td>StatusResponse</td>
		  <td>The component does not take any action on a StatusRequest.</td>
		</tr>
		</tbody></table>
	
<!--  ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++  -->

	  
	  <h3 id="voice-modality-component">Voice modality component</h3>

	  <p>The Openstream Voice modality component(VoiceMC) is a fully conformant MMI Modality Component providing both speech-recognition (ASR) and text-to-speech (TTS) functions. It is available on various mobile and desktop platforms including iOS, Android, Blackberry, Windows Phone, Windows XP and Windows 7. Both embedded as well as MRCP v1 and v2 compliant remote speech engines are supported.
	  </p>

	  <p>The iOS implementation of the VoiceMC running on an iPhone device running iOS 4 was used for the interoperability test. The iOS instance of the VoiceMC has been implemented in Objective-C and it uses embedded ASR and TTS engines for speech-recognition and text-to-speech.
      </p>
	  
	  <p>VoiceMC communicates with an  Interaction Manager(IM) using the standard MMI [MMI-ARCH] lifecycle events. HTTP is used as the transport protocol, with the component acting as a client and always initiating the connection request to the IM acting as the HTTP server. Lifecycle events that are initiated by the component are sent to the IM using HTTP POST requests. HTTP GET requests are used to receive responses from the Interaction Manager, as well as to receive new lifecycle events initiated by the IM.
	  </p>
	  
	  <p>On startup, the VoiceMC sends the NewContextRequest MMI lifecycle event to establish a context with the IM. Once the context is established, IM can add/remove speech recognition grammars and initiate ASR/TTS operations using the standard MMI lifecycle events. Speech recognition grammars can be added or removed using the ExtensionNotification lifecycle event. Speech-recognition and text-to-speech operations can be initiated by sending the StartRequest lifecycle event. Speech recognition result is formatted as an EMMA document and sent to the IM in the DoneNotification lifecycle event.
	  </p>

	  <p>
	  The following table describes the functionality and the API of the voice modality component (see also [<cite><a class="bibref" rel="biblioentry" href="#bib-MMI-MCBP">MMI-MCBP</a></cite>] for more details):
	  </p>
	  <table class="simple">
	    <tbody><tr>
	      <th>Life Cycle Event</th>
		  <th>Component Implementation</th>
	    </tr>
		<tr>
		  <td>NewContextRequest</td>
		  <td>(Standard) The component requests a new context from the IM.

Example:
<pre>&lt;mmi:mmi xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot; version=&quot;1.0&quot;&gt;
   &lt;mmi:NewContextRequest source=&quot;Voice&quot; requestID=&quot;vui-req-1&quot; target=&quot;MathQuiz&quot; context=&quot;-1&quot;&gt;
   &lt;/mmi:NewContextRequest&gt;
&lt;/mmi:mmi&gt;
</pre>
		  </td>
		</tr>
		<tr>
		  <td>NewContextResponse</td>
		  <td>(Standard) The component starts a new context and assigns the new context ID to it.</td>
		</tr>
		<tr>
		  <td>PrepareRequest</td>
		  <td>The component requires a PrepareRequest event to initiate a session with a remote Voice server.
<pre>Example:
&lt;mmi:mmi xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot; version=&quot;1.0&quot;&gt;
   &lt;mmi:PrepareRequest requestID=&quot;im-req-2&quot; target=&quot;Voice&quot; context=&quot;MathQuiz-2be0bbb7&quot;&gt;
	 &lt;mmi:contentURL href=&quot;http://example.com/VUI/VUIProxy&quot; max-age=&quot;&quot; fetchtimeout=&quot;1s&quot;/&gt;
   &lt;/mmi:PrepareRequest&gt;
&lt;/mmi:mmi&gt;
</pre>
</td>
		</tr>
		<tr>
		  <td>PrepareResponse</td>
		  <td>(Standard) The component establishes a remote Voice server session.</td>
		</tr>
		<tr>
		  <td>StartRequest</td>
		  <td>The component will start an ASR or TTS operation.

Start TTS example:
<pre>&lt;mmi:mmi version=&quot;1.0&quot; xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot;&gt;
  &lt;mmi:StartRequest target=&quot;Voice&quot; requestID=&quot;im-req-03&quot; context=&quot;MathQuiz-2be0bbb7&quot;&gt;
    &lt;mmi:content&gt;play&lt;/mmi:content&gt;
    &lt;mmi:data&gt;You are correct.  Please press next for the next question.&lt;/mmi:data&gt;
  &lt;/mmi:StartRequest&gt;
&lt;/mmi:mmi&gt;
</pre>
Start ASR example:
<pre>&lt;mmi:mmi version=&quot;1.0&quot; xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot;&gt;
  &lt;mmi:StartRequest target=&quot;Voice&quot; requestID=&quot;im-req-04&quot; context=&quot;MathQuiz-2be0bbb7&quot;&gt;
    &lt;mmi:content&gt;recognize&lt;/mmi:content&gt;
  &lt;/mmi:StartRequest&gt;
&lt;/mmi:mmi&gt;
</pre>
        </td>
		</tr>
		<tr>
		  <td>StartResponse</td>
		  <td>(Standard)</td>
		</tr>
		<tr>
		  <td>DoneNotification</td>
		  <td>The Modality component returns the result of processing the ASR or TTS request.  The result of matching an active grammar with a user utterance will be contained within an EMMA document.
TTS Example:
<pre>&lt;mmi:mmi xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot; version=&quot;1.0&quot;&gt;
   &lt;mmi:DoneNotification source=&quot;Voice&quot;  context=&quot;MathQuiz-2be0bbb7&quot; status=&quot;success&quot; requestID=&quot;vui-req-3&quot;&gt;
   &lt;/mmi:DoneNotification&gt;
&lt;/mmi:mmi&gt;
</pre>

ASR Example:
<pre>&lt;mmi:mmi xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot; version=&quot;1.0&quot;
xmlns:emma=&quot;http://www.w3.org/2003/04/emma&quot;&gt;
   &lt;mmi:DoneNotification source=&quot;Voice&quot;  context=&quot;MathQuiz-2be0bbb7&quot; status=&quot;success&quot; requestID=&quot;vui-req-4&quot; confidential=&quot;true&quot;&gt;
       &lt;mmi:data&gt;
           &lt;emma:emma version=&quot;1.0&quot;&gt;
               &lt;emma:interpretation id=&quot;int1&quot; emma:medium=&quot;acoustic&quot; emma:confidence=&quot;.75&quot; 
                                 emma:mode=&quot;voice&quot;&gt;
                   &lt;answer&gt;18&lt;/answer&gt;
               &lt;/emma:interpretation&gt;
           &lt;/emma:emma&gt;
       &lt;/mmi:data&gt;
   &lt;/mmi:DoneNotification&gt;
&lt;/mmi:mmi&gt;
</pre>
</td>
		</tr>
		<tr>
		  <td>CancelRequest</td>
		  <td>This component cannot cancel.</td>
		</tr>
		<tr>
		  <td>CancelResponse</td>
		  <td><em>StatusInfo</em> field is &quot;cannot cancel&quot;.</td>
		</tr>
		<tr>
		  <td>PauseRequest</td>
		  <td>This component cannot pause.</td>
		</tr>
		<tr>
		  <td>PauseResponse</td>
		  <td><em>StatusInfo</em> field is &quot;cannot pause&quot;.</td>
		</tr>
		<tr>
		  <td>ResumeRequest</td>
		  <td>This component cannot resume.</td>
		</tr>
		<tr>
		  <td>ResumeResponse</td>
		  <td><em>StatusInfo</em> field is &quot;cannot resume&quot;.</td>
		</tr>
		<tr>
		  <td>ExtensionNotification</td>
		  <td>This component processes “ExtensionNotification” lifecycle events from the IM when instructed to perform one of the following tasks:

		  <ol>
		    <li>Add grammar with provided URL</li>
			<li>Remove grammar with provided URL</li>
		  </ol>

Add grammar example:
<pre>&lt;mmi:mmi xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot; version=&quot;1.0&quot;&gt;
   &lt;mmi:ExtensionNotification name=&quot;addGrammar&quot; requestID=&quot;im-req-10&quot; target=&quot;Voice&quot; context=&quot;MathQuiz-2be0bbb7&quot;&gt;
      &lt;mmi:data&gt;
         &lt;grammar href=“http://example.com/app/gram/ex.gram&quot; /&gt;          
      &lt;/mmi:data&gt;
   &lt;/mmi:ExtensionNotification&gt;
&lt;/mmi:mmi&gt;
</pre>

Remove grammar example:
<pre>&lt;mmi:mmi xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot; version=&quot;1.0&quot;&gt;
   &lt;mmi:ExtensionNotification name=&quot;removeGrammar&quot; requestID=&quot;im-req-11&quot; target=&quot;Voice&quot; context=&quot;MathQuiz-2be0bbb7&quot;&gt;
      &lt;mmi:data&gt;
         &lt;grammar href=“http://example.com/app/gram/ex.gram&quot;/&gt;
      &lt;/mmi:data&gt;
   &lt;/mmi:ExtensionNotification&gt;
&lt;/mmi:mmi&gt;
</pre>

This component sends the following “ExtensionNotification” lifecycle events to the IM:
<ol>
	<li>Add grammar result</li>
	<li>Remove grammar result</li>
	<li>Recording started</li>
	<li>Recording ended</li>
</ol>

Add grammar result example:
<pre>&lt;mmi:mmi xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot; version=&quot;1.0&quot;&gt;
   &lt;mmi:ExtensionNotification name=&quot;addGrammarResult&quot; requestID=&quot;vui-req-12&quot; source=&quot;Voice&quot; context=&quot;MathQuiz-2be0bbb7&quot;&gt;
      &lt;mmi:data&gt;
         &lt;grammar href=&quot;http://example.com/app/gram/ex.gram&quot; status=&quot;success&quot;/&gt;
      &lt;/mmi:data&gt;
   &lt;/mmi:ExtensionNotification&gt;
&lt;/mmi:mmi&gt;
</pre>

Remove grammar result example:
<pre>&lt;mmi:mmi xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot; version=&quot;1.0&quot;&gt;
   &lt;mmi:ExtensionNotification name=&quot;removeGrammarResult&quot; requestID=&quot;vui-req-13&quot; source=&quot;Voice&quot; context=&quot;MathQuiz-2be0bbb7&quot;&gt;
      &lt;mmi:data&gt;
         &lt;grammar href=&quot;http://example.com/app/gram/ex.gram&quot;  status=&quot;success&quot;/&gt;
      &lt;/mmi:data&gt;
   &lt;/mmi:ExtensionNotification&gt;
&lt;/mmi:mmi&gt;
</pre>

Recording started example:
<pre>&lt;mmi:mmi xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot; version=&quot;1.0&quot;&gt;
   &lt;mmi:ExtensionNotification name=&quot;recordStarted&quot; requestID=&quot;vui-req-14&quot; source=&quot;Voice&quot; context=&quot;MathQuiz-2be0bbb7&quot;&gt;
   &lt;/mmi:ExtensionNotification&gt;
&lt;/mmi:mmi&gt;
</pre>

Recording ended example:
<pre>&lt;mmi:mmi xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot; version=&quot;1.0&quot;&gt;
   &lt;mmi:ExtensionNotification name=&quot;recordEnded&quot; requestID=&quot;vui-req-15&quot; source=&quot;Voice&quot; context=&quot;MathQuiz-2be0bbb7&quot;&gt;
   &lt;/mmi:ExtensionNotification&gt;
&lt;/mmi:mmi&gt;
</pre>
</td>
		</tr>		
		<tr>
		  <td>ClearContextRequest</td>
		  <td>(Standard)</td>
		</tr>
		<tr>
		  <td>clearContextResponse</td>
		  <td>(Standard)</td>
		</tr>
		<tr>
		  <td>StatusRequest</td>
		  <td>(Standard)</td>
		</tr>
		<tr>
		  <td>StatusResponse</td>
		  <td>The component returns a standard life cycle response. The &quot;automaticUpdate&quot; attribute is &quot;false&quot;, because this component does not supply automatic updates.</td>
		</tr>
		</tbody></table>
	  
    </div>
	
    <div id="application" class="section">
      
<!-- OddPage -->
<h2><span class="secno">4. </span>A MathQuiz</h2>
	  <h3 id="the-application">The application</h3>
      <p>
        For the purpose of showing interoperability a simple math-quiz application has been 
		developed: the quiz consists of a series of questions given one by one until the player 
		chooses to stop. The question is going to be presented by voice and visual output. The
		user has the opportunity to answer the quiz question either by voice or by GUI input. 
		Correct solutions are given immediately after the player's answers. 
	  </p>
	  <p>
	    After starting the application a screen is presented at the GUI containing the following elements:
	  </p>
      <ol>
	    <li>a “question label” containing the question (e.g. “2+2”)</li>
        <li>an input element giving the user the ability to enter the solution</li>
        <li>an “OK” Button to confirm the input</li>
        <li>a “voice input activation” button for voice input acitivation (push to activate)</li>
        <li>a “validity label” indicating the validity of the users solution (this label might 
		be gray at the beginning and will be switched to red or green depending on the validity 
		of the users response)</li> 
        <li>a “stop button” to stop finish application</li>
        <li>a “next button” to go to the next question (the “next button” is disabled by default 
		and will be enabled only once the user answered the question correctly)</li>
      </ol>
	  <p>
	    At the same time (while starting the GUI component) the VUI component plays a prompt
		with the question “what is two plus two?”. 
      </p>
	  <p>
	    If the user uses GUI input to answer the question he has to give input into the input 
		element and click the OK button. The system responds by:
	  </p>
	  <ol>
	    <li>changing the “validity label” either to red or green</li>
        <li>enabling the “next button” in case of a right answer</li>
        <li>playing a prompt, either “this is correct” or “this is not correct, please try again”</li>
      </ol>
	  <p>
	    If the user wants to use voice input to answer the question he has to press the microphone 
		button on the GUI to activate the speech recognition and speak into the microphone. 
		The system responds by:
	  </p>
	  <ol>
	    <li>displaying the recognition result at the GUI</li>
	    <li>changing the “validity label” either to red or green</li>
        <li>enabling the “next button” in case of a right answer</li>
        <li>playing a prompt, either “this is correct” or “this is not correct, please try again”</li>
      </ol>
	  <h3 id="life-cycle-event-flow">Life cycle event flow</h3>
	  
	  <p>The following section describes the detailed event flow during application execution and shows the details of each lifecycle event.
	  </p>
	  <p>Figure 1 shows the initialization sequence. The dotted rectangle on the left hand side shows visual representation of the graphical
	  modality component. During the initialization the graphical component has not loaded any visual content.
	  </p>
      <img src="./images/sequence-diagram-01.png" alt="sequence diagram 01" />
	  <p>Lifecycle Event 1:</p>
	  <div><pre class="example sh_javascript">&lt;mmi:mmi version=&quot;1.0&quot; xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot;&gt;
  &lt;mmi:newContextRequest source=&quot;GUI&quot; target=&quot;MathQuiz&quot; requestID=&quot;gui-req-01&quot; context=&quot;-1&quot; /&gt;
&lt;/mmi:mmi&gt;</pre></div>
	  <p>Lifecycle Event 2:</p>
	  <div><pre class="example sh_javascript">&lt;mmi:mmi version=&quot;1.0&quot; xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot;&gt;
  &lt;mmi:newContextResponse target=&quot;GUI&quot; requestID=&quot;gui-req-01&quot; context=&quot;ctx-01&quot; status=&quot;success&quot; /&gt;
&lt;/mmi:mmi&gt;</pre></div>
	  <p>Lifecycle Event 3:</p>
	  <div><pre class="example sh_javascript">&lt;mmi:mmi version=&quot;1.0&quot; xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot;&gt;
  &lt;mmi:newContextRequest source=&quot;Voice&quot; target=&quot;MathQuiz&quot; requestID=&quot;voice-req-01&quot; context=&quot;-1&quot; /&gt;
&lt;/mmi:mmi&gt;</pre></div>
	  <p>Lifecycle Event 4:</p>
	  <div><pre class="example sh_javascript">&lt;mmi:mmi version=&quot;1.0&quot; xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot;&gt;
  &lt;mmi:newContextResponse target=&quot;Voice&quot; requestID=&quot;voice-req-01&quot; context=&quot;ctx-01&quot; status=&quot;success&quot; /&gt;
&lt;/mmi:mmi&gt;</pre></div>
 
	  <p>After all modality components have connected to the interaction manager, the preparation sequence is started by the interaction manager. In this configuration the voice modality component is instructed to load application specific grammars. The graphical component still has not loaded any visual content.
	  </p>
      <img src="./images/sequence-diagram-02.png" alt="sequence diagram 02" />
	  <p>Lifecycle Event 5:</p>
	  <div><pre class="example sh_javascript">&lt;mmi:mmi xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot; version=&quot;1.0&quot;&gt;
  &lt;mmi:extensionNotification name=&quot;addGrammar&quot; requestID=&quot;im-req-v2&quot; target=&quot;Voice&quot; context=&quot;ctx-01&quot;&gt;
    &lt;mmi:data&gt;&lt;grammar href=&quot;http://example.com/mathQuiz/gram/answer_options.gram&quot;/&gt;&lt;/mmi:data&gt;
  &lt;/mmi:extensionNotification&gt;
&lt;/mmi:mmi&gt;</pre></div>
	  <p>Lifecycle Event 6:</p>
	  <div><pre class="example sh_javascript">&lt;mmi:mmi xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot; version=&quot;1.0&quot;&gt;
  &lt;mmi:extensionNotification name=&quot;addGrammarResult&quot; requestID=&quot;im-req-v2&quot; source=&quot;Voice&quot; context=&quot;ctx-01&quot;&gt;
    &lt;mmi:data&gt;&lt;grammar href=&quot;http://example.com/mathQuiz/gram/answer_options.gram&quot; status=&quot;success&quot;/&gt;&lt;/mmi:data&gt;
  &lt;/mmi:extensionNotification&gt;
&lt;/mmi:mmi&gt;</pre></div>
	  
	  <p>Now, as the voice modality component has been prepared, the interaction manager starts the actual application. It sends StartRequests to both
	  modality components. The graphical modality component loads and displays the &quot;welcome.html&quot; page, which is shown on the left hand side. The voice modality component plays the following prompt to the user: <em>&quot;Welcome to the Math-Quiz. Please press 'Start' to continue.&quot;</em>
	  </p>
      <img src="./images/sequence-diagram-03.png" alt="sequence diagram 03" />
	  <p>Lifecycle Event 7:</p>
	  <div><pre class="example sh_javascript">&lt;mmi:mmi version=&quot;1.0&quot; xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot;&gt;
  &lt;mmi:startRequest target=&quot;GUI&quot; requestID=&quot;im-req-01&quot; context=&quot;ctx-01&quot;&gt;
    &lt;mmi:contentURL href=&quot;welcome.html&quot; /&gt;
  &lt;/mmi:startRequest&gt;
&lt;/mmi:mmi&gt;</pre></div>
	  <p>Lifecycle Event 8:</p>
	  <div><pre class="example sh_javascript">&lt;mmi:mmi version=&quot;1.0&quot; xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot;&gt;
  &lt;mmi:startResponse source=&quot;GUI&quot; requestID=&quot;im-req-01&quot; context=&quot;ctx-01&quot; status=&quot;success&quot; /&gt;
&lt;/mmi:mmi&gt;</pre></div>	  
	  <p>Lifecycle Event 9:</p>
	  <div><pre class="example sh_javascript">&lt;mmi:mmi version=&quot;1.0&quot; xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot;&gt;
  &lt;mmi:startRequest target=&quot;Voice&quot; requestID=&quot;im-req-v3&quot; context=&quot;ctx-01&quot;&gt;
    &lt;mmi:data&gt;&lt;voice cmd=&quot;play&quot;&gt;&lt;text&gt;Welcome to the math quiz. Please press Start to continue.&lt;/text&gt;&lt;/voice&gt;&lt;/mmi:data&gt;
  &lt;/mmi:startRequest&gt;
&lt;/mmi:mmi&gt;</pre></div>	  
	  <p>Lifecycle Event 10:</p>
	  <div><pre class="example sh_javascript">&lt;mmi:mmi version=&quot;1.0&quot; xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot;&gt;
  &lt;mmi:startResponse source=&quot;Voice&quot; requestID=&quot;im-req-v3&quot; context=&quot;ctx-01&quot; status=&quot;success&quot; /&gt;
&lt;/mmi:mmi&gt;</pre></div>	  
	  <p>Lifecycle Event 11:</p>
	  <div><pre class="example sh_javascript">&lt;mmi:mmi xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot; version=&quot;1.0&quot;&gt;
   &lt;mmi:doneNotification source=&quot;Voice&quot; context=&quot;ctx-01&quot; status=&quot;success&quot; requestID=&quot;im-req-v3&quot; &gt;
   &lt;/mmi:doneNotification&gt;
&lt;/mmi:mmi&gt;</pre></div>	  
	  
	  <p>To start the application, the user presses the &quot;Start&quot; button on the graphical modality component. This leads to an ExtensionNotification
      lifecycle event, which contains the click event represented within an EMMA [<cite><a class="bibref" rel="biblioentry" href="#bib-EMMA">EMMA</a></cite>] document.	  
	  </p>
      <img src="./images/sequence-diagram-04.png" alt="sequence diagram 04" />
	  <p>Lifecycle Event 12:</p>
	  <div><pre class="example sh_javascript">&lt;mmi:mmi version=&quot;1.0&quot; xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot;&gt;
  &lt;mmi:extensionNotification name=&quot;click&quot; source=&quot;GUI&quot; requestID=&quot;gui-req-02&quot; context=&quot;ctx-01&quot;&gt;
    &lt;mmi:data&gt;
      &lt;emma:emma version=&quot;1.0&quot; xmlns:emma=&quot;http://www.w3.org/2003/04/emma&quot;&gt;
        &lt;emma:interpretation id=&quot;int-01&quot; emma:medium=&quot;tactile&quot; emma:mode=&quot;ink&quot;&gt;
          &lt;click id=&quot;start_button&quot; value=&quot;&quot; /&gt;
        &lt;/emma:interpretation&gt;
      &lt;/emma:emma&gt;
    &lt;/mmi:data&gt;
  &lt;/mmi:extensionNotification&gt;
&lt;/mmi:mmi&gt;</pre></div>
	  
	  <p>The interaction manager script sends StartRequests to both modality components. The graphical modality component loads the visual representation of the first math quiz question whereas the voice modality is instructed to play the question <em>&quot;What is 7 plus 9?&quot;</em>
	  </p>
      <img src="./images/sequence-diagram-05.png" alt="sequence diagram 05" />
	  <p>Lifecycle Event 13:</p>
	  <div><pre class="example sh_javascript">&lt;mmi:mmi version=&quot;1.0&quot; xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot;&gt;
  &lt;mmi:startRequest target=&quot;GUI&quot; requestID=&quot;im-req-03&quot; context=&quot;ctx-01&quot;&gt;
    &lt;mmi:contentURL href=&quot;question1.html&quot; /&gt;
  &lt;/mmi:startRequest&gt;
&lt;/mmi:mmi&gt;</pre></div>
	  <p>Lifecycle Event 14:</p>
	  <div><pre class="example sh_javascript">&lt;mmi:mmi version=&quot;1.0&quot; xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot;&gt;
  &lt;mmi:startResponse source=&quot;GUI&quot; requestID=&quot;im-req-03&quot; context=&quot;ctx-01&quot; status=&quot;success&quot; /&gt;
&lt;/mmi:mmi&gt;</pre></div>	  
	  <p>Lifecycle Event 15:</p>
	  <div><pre class="example sh_javascript">&lt;mmi:mmi version=&quot;1.0&quot; xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot;&gt;
  &lt;mmi:startRequest target=&quot;Voice&quot; requestID=&quot;im-req-v4&quot; context=&quot;ctx-01&quot;&gt;
    &lt;mmi:data&gt;&lt;voice cmd=&quot;play&quot;&gt;&lt;text&gt;Welcome What is 7 plus 9?&lt;/text&gt;&lt;/voice&gt;&lt;/mmi:data&gt;
  &lt;/mmi:startRequest&gt;
&lt;/mmi:mmi&gt;</pre></div>	  
	  <p>Lifecycle Event 16:</p>
	  <div><pre class="example sh_javascript">&lt;mmi:mmi version=&quot;1.0&quot; xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot;&gt;
  &lt;mmi:startResponse source=&quot;Voice&quot; requestID=&quot;im-req-v4&quot; context=&quot;ctx-01&quot; status=&quot;success&quot; /&gt;
&lt;/mmi:mmi&gt;</pre></div>	  
	  <p>Lifecycle Event 17:</p>
	  <div><pre class="example sh_javascript">&lt;mmi:mmi xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot; version=&quot;1.0&quot;&gt;
   &lt;mmi:doneNotification source=&quot;Voice&quot; context=&quot;ctx-01&quot; status=&quot;success&quot; requestID=&quot;im-req-v4&quot; &gt;
   &lt;/mmi:doneNotification&gt;
&lt;/mmi:mmi&gt;</pre></div>	 

	  <p>The user now uses the keyboard to enter the answer (types &quot;1&quot; and &quot;6&quot;). The application dependent HTML has been written in a way that the change event is used to send the value of the input element to the interaction manager. The change event is thrown as soon as the input element looses its focus (and not when the actual input occurs, this is why there is no lifecycle event generated as a direct result to the keyboard input of &quot;1&quot; and &quot;6&quot;), which happens when the user clicks the &quot;check&quot; button. Thus two lifecycle events are sent to the interaction manager immediately after each other. 
	  </p>
	  <p>The user hits the &quot;1&quot; on the keyboard:</p>
      <img src="./images/sequence-diagram-06.png" alt="sequence diagram 06" />
	  <p>The user hits the &quot;6&quot; on the keyboard:</p>
      <img src="./images/sequence-diagram-07.png" alt="sequence diagram 07" />
	  <p>The user clicks the &quot;check&quot; button, which leads to the &quot;change&quot; and &quot;click&quot; HTML DOM events, which are handled by the modality components scripts and wrapped into two lifecycle events:</p>
	  <img src="./images/sequence-diagram-08.png" alt="sequence diagram 08" />
	  <p>Lifecycle Event 18:</p>
	  <div><pre class="example sh_javascript">&lt;mmi:mmi version=&quot;1.0&quot; xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot;&gt;
  &lt;mmi:extensionNotification name=&quot;change&quot; source=&quot;GUI&quot; requestID=&quot;gui-req-03&quot; context=&quot;ctx-01&quot;&gt;
    &lt;mmi:data&gt;
      &lt;emma:emma version=&quot;1.0&quot; xmlns:emma=&quot;http://www.w3.org/2003/04/emma&quot;&gt;
        &lt;emma:interpretation id=&quot;int-01&quot; emma:medium=&quot;tactile&quot; emma:mode=&quot;ink&quot;&gt;
          &lt;change id=&quot;answer_field&quot; value=&quot;16&quot; /&gt;
        &lt;/emma:interpretation&gt;
      &lt;/emma:emma&gt;
    &lt;/mmi:data&gt;
  &lt;/mmi:extensionNotification&gt;
&lt;/mmi:mmi&gt;</pre></div>
	  <p>Lifecycle Event 19:</p>
	  <div><pre class="example sh_javascript">&lt;mmi:mmi version=&quot;1.0&quot; xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot;&gt;
  &lt;mmi:extensionNotification name=&quot;click&quot; source=&quot;GUI&quot; requestID=&quot;gui-req-04&quot; context=&quot;ctx-01&quot;&gt;
    &lt;mmi:data&gt;
      &lt;emma:emma version=&quot;1.0&quot; xmlns:emma=&quot;http://www.w3.org/2003/04/emma&quot;&gt;
        &lt;emma:interpretation id=&quot;int-01&quot; emma:medium=&quot;tactile&quot; emma:mode=&quot;ink&quot;&gt;
          &lt;click id=&quot;check_button&quot; value=&quot;&quot; /&gt;
        &lt;/emma:interpretation&gt;
      &lt;/emma:emma&gt;
    &lt;/mmi:data&gt;
  &lt;/mmi:extensionNotification&gt;
&lt;/mmi:mmi&gt;</pre></div>	  

	  <p>The interaction manager script (application dependent SCXML, see below) checks the users input. Since the answer is correct, it sends an ExtensionNotification lifecycle event to the graphical modality component to change the result indicator to green color. A StartRequest is used to instruct the voice modality component to play <em>&quot;This is correct. Please press 'Next' for another question or press 'Stop' to finish the application.&quot;</em>
	  </p>
	  <img src="./images/sequence-diagram-09.png" alt="sequence diagram 09" />
	  <p>Lifecycle Event 19:</p>
	  <div><pre class="example sh_javascript">&lt;mmi:mmi version=&quot;1.0&quot; xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot;&gt;
  &lt;mmi:extensionNotification name=&quot;click&quot; source=&quot;GUI&quot; requestID=&quot;gui-req-04&quot; context=&quot;ctx-01&quot;&gt;
    &lt;mmi:data&gt;
      &lt;emma:emma version=&quot;1.0&quot; xmlns:emma=&quot;http://www.w3.org/2003/04/emma&quot;&gt;
        &lt;emma:interpretation id=&quot;int-01&quot; emma:medium=&quot;tactile&quot; emma:mode=&quot;ink&quot;&gt;
          &lt;click id=&quot;check_button&quot; value=&quot;&quot; /&gt;
        &lt;/emma:interpretation&gt;
      &lt;/emma:emma&gt;
    &lt;/mmi:data&gt;
  &lt;/mmi:extensionNotification&gt;
&lt;/mmi:mmi&gt;</pre></div>
	  <p>Lifecycle Event 20:</p>
	  <div><pre class="example sh_javascript">&lt;mmi:mmi version=&quot;1.0&quot; xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot;&gt;
  &lt;mmi:extensionNotification name=&quot;setValue&quot; target=&quot;GUI&quot; requestID=&quot;im-req-05&quot; context=&quot;ctx-01&quot;&gt;
    &lt;mmi:data&gt;
      &lt;function name=&quot;setValue&quot; id=&quot;result_identifier&quot; value=&quot;on&quot; /&gt;
    &lt;/mmi:data&gt;
  &lt;/mmi:startRequest&gt;
&lt;/mmi:mmi&gt;</pre></div>	  
	  <p>Lifecycle Event 21:</p>
	  <div><pre class="example sh_javascript">&lt;mmi:mmi version=&quot;1.0&quot; xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot;&gt;
  &lt;mmi:startRequest target=&quot;Voice&quot; requestID=&quot;im-req-v5&quot; context=&quot;ctx-01&quot;&gt;
    &lt;mmi:data&gt;&lt;voice cmd=&quot;play&quot;&gt;&lt;text&gt;This is correct. Please press Next for another question or press Stop to finish the application.&lt;/text&gt;&lt;/voice&gt;&lt;/mmi:data&gt;
  &lt;/mmi:startRequest&gt;
&lt;/mmi:mmi&gt;</pre></div>
	  <p>Lifecycle Event 22:</p>
	  <div><pre class="example sh_javascript">&lt;mmi:mmi version=&quot;1.0&quot; xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot;&gt;
  &lt;mmi:startResponse source=&quot;Voice&quot; requestID=&quot;im-req-v5&quot; context=&quot;ctx-01&quot; status=&quot;success&quot; /&gt;
&lt;/mmi:mmi&gt;</pre></div>	  
	  <p>Lifecycle Event 23:</p>
	  <div><pre class="example sh_javascript">&lt;mmi:mmi xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot; version=&quot;1.0&quot;&gt;
   &lt;mmi:doneNotification source=&quot;Voice&quot; context=&quot;ctx-01&quot; status=&quot;success&quot; requestID=&quot;im-req-v5&quot; &gt;
   &lt;/mmi:doneNotification&gt;
&lt;/mmi:mmi&gt;</pre></div>	  
	  
	  <p>Since the user clicks &quot;Next&quot;, the graphical modality component again sends an ExtensionNotification lifecycle event to the interaction manager.
	  </p>
	  <img src="./images/sequence-diagram-10.png" alt="sequence diagram 10" />
	  <p>Lifecycle Event 24:</p>
	  <div><pre class="example sh_javascript">&lt;mmi:mmi version=&quot;1.0&quot; xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot;&gt;
  &lt;mmi:extensionNotification name=&quot;click&quot; source=&quot;GUI&quot; requestID=&quot;gui-req-05&quot; context=&quot;ctx-01&quot;&gt;
    &lt;mmi:data&gt;
      &lt;emma:emma version=&quot;1.0&quot; xmlns:emma=&quot;http://www.w3.org/2003/04/emma&quot;&gt;
        &lt;emma:interpretation id=&quot;int-01&quot; emma:medium=&quot;tactile&quot; emma:mode=&quot;ink&quot;&gt;
          &lt;click id=&quot;next_button&quot; value=&quot;&quot; /&gt;
        &lt;/emma:interpretation&gt;
      &lt;/emma:emma&gt;
    &lt;/mmi:data&gt;
  &lt;/mmi:extensionNotification&gt;
&lt;/mmi:mmi&gt;</pre></div>
	  
	  <p>As above, the interaction manager script instructs both modality components to load new markup and play a prompt to present the next math quiz question to the user.
	  </p>
	  <img src="./images/sequence-diagram-11.png" alt="sequence diagram 11" />
	  <p>Lifecycle Event 25:</p>
	  <div><pre class="example sh_javascript">&lt;mmi:mmi version=&quot;1.0&quot; xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot;&gt;
  &lt;mmi:startRequest target=&quot;GUI&quot; requestID=&quot;im-req-07&quot; context=&quot;ctx-01&quot;&gt;
    &lt;mmi:contentURL href=&quot;question2.html&quot; /&gt;
  &lt;/mmi:startRequest&gt;
&lt;/mmi:mmi&gt;</pre></div>
	  <p>Lifecycle Event 26:</p>
	  <div><pre class="example sh_javascript">&lt;mmi:mmi version=&quot;1.0&quot; xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot;&gt;
  &lt;mmi:startResponse source=&quot;GUI&quot; requestID=&quot;im-req-07&quot; context=&quot;ctx-01&quot; status=&quot;success&quot; /&gt;
&lt;/mmi:mmi&gt;</pre></div>	  
	  <p>Lifecycle Event 27:</p>
	  <div><pre class="example sh_javascript">&lt;mmi:mmi version=&quot;1.0&quot; xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot;&gt;
  &lt;mmi:startRequest target=&quot;Voice&quot; requestID=&quot;im-req-v6&quot; context=&quot;ctx-01&quot;&gt;
    &lt;mmi:data&gt;&lt;voice cmd=&quot;play&quot;&gt;&lt;text&gt;What is 22 minus 4?&lt;/text&gt;&lt;/voice&gt;&lt;/mmi:data&gt;
  &lt;/mmi:startRequest&gt;
&lt;/mmi:mmi&gt;</pre></div>
	  <p>Lifecycle Event 28:</p>
	  <div><pre class="example sh_javascript">&lt;mmi:mmi version=&quot;1.0&quot; xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot;&gt;
  &lt;mmi:startResponse source=&quot;Voice&quot; requestID=&quot;im-req-v6&quot; context=&quot;ctx-01&quot; status=&quot;success&quot; /&gt;
&lt;/mmi:mmi&gt;</pre></div>	  
	  <p>Lifecycle Event 29:</p>
	  <div><pre class="example sh_javascript">&lt;mmi:mmi xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot; version=&quot;1.0&quot;&gt;
   &lt;mmi:doneNotification source=&quot;Voice&quot; context=&quot;ctx-01&quot; status=&quot;success&quot; requestID=&quot;im-req-v6&quot; &gt;
   &lt;/mmi:doneNotification&gt;
&lt;/mmi:mmi&gt;</pre></div>	  

	  <p>This time the user decides to use the voice modality to answer the question. To activate the speech recognition he clicks the microphone button at the GUI. Again, a generic lifecycle event is sent to the interaction manager, representing the click at the microphone HTML element. The interaction manager script sends a StartRequest lifecycle event to the voice modality to instruct it to open the microphone and start the speech recognition process.
	  </p>
	  <img src="./images/sequence-diagram-12.png" alt="sequence diagram 12" />
	  <p>Lifecycle Event 30:</p>
	  <div><pre class="example sh_javascript">&lt;mmi:mmi version=&quot;1.0&quot; xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot;&gt;
  &lt;mmi:extensionNotification name=&quot;click&quot; source=&quot;GUI&quot; requestID=&quot;gui-req-06&quot; context=&quot;ctx-01&quot;&gt;
    &lt;mmi:data&gt;
      &lt;emma:emma version=&quot;1.0&quot; xmlns:emma=&quot;http://www.w3.org/2003/04/emma&quot;&gt;
        &lt;emma:interpretation id=&quot;int-01&quot; emma:medium=&quot;tactile&quot; emma:mode=&quot;ink&quot;&gt;
          &lt;click id=&quot;voice_input_activation_button&quot; value=&quot;&quot; /&gt;
        &lt;/emma:interpretation&gt;
      &lt;/emma:emma&gt;
    &lt;/mmi:data&gt;
  &lt;/mmi:extensionNotification&gt;
&lt;/mmi:mmi&gt;</pre></div>
	  <p>Lifecycle Event 31:</p>
	  <div><pre class="example sh_javascript">&lt;mmi:mmi version=&quot;1.0&quot; xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot;&gt;
  &lt;mmi:startRequest target=&quot;Voice&quot; requestID=&quot;im-req-v7&quot; context=&quot;ctx-01&quot;&gt;
    &lt;mmi:data&gt;&lt;voice cmd=&quot;recognize&quot;/&gt;&lt;/mmi:data&gt;
  &lt;/mmi:startRequest&gt;
&lt;/mmi:mmi&gt;</pre></div>	  
	  <p>Lifecycle Event 32:</p>
	  <div><pre class="example sh_javascript">&lt;mmi:mmi version=&quot;1.0&quot; xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot;&gt;
  &lt;mmi:startResponse source=&quot;Voice&quot; requestID=&quot;im-req-v7&quot; context=&quot;ctx-01&quot; status=&quot;success&quot; /&gt;
&lt;/mmi:mmi&gt;</pre></div>
	  
	  <p>The user speaks <em>&quot;twenty&quot;</em> into the microphone. After automatic endpointing the voice modality component uses a DoneNotification lifecycle event to send the users input to the interaction manager. Note that this information is represented using an EMMA document.
	  </p>
	  <img src="./images/sequence-diagram-13.png" alt="sequence diagram 13" />
	  <p>Lifecycle Event 33:</p>
	  <div><pre class="example sh_javascript">&lt;mmi:mmi xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot; version=&quot;1.0&quot;&gt;
  &lt;mmi:doneNotification source=&quot;Voice&quot; context=&quot;ctx-01&quot; status=&quot;success&quot; requestID=&quot;im-req-v7&quot; &gt;
    &lt;mmi:data&gt;
      &lt;emma:emma version=&quot;1.0&quot; xmlns:emma=&quot;http://www.w3.org/2003/04/emma&quot;&gt;
        &lt;emma:interpretation id=&quot;int1&quot; emma:medium=&quot;acoustic&quot; emma:confidence=&quot;.75&quot;  emma:mode=&quot;voice&quot;&gt;
          &lt;answer&gt;20&lt;/answer&gt;
        &lt;/emma:interpretation&gt;
      &lt;/emma:emma&gt;
    &lt;/mmi:data&gt;
  &lt;/mmi:doneNotification&gt;
&lt;/mmi:mmi&gt;</pre></div>

	  <p>To display the result of the voice input at the GUI the interaction manager script sends an extensionNotification lifecycle event to instruct the graphical modality component to change the value of the HTML input field accordingly. </p>
	  <img src="./images/sequence-diagram-14.png" alt="sequence diagram 14" />
	  <p>Lifecycle Event 34:</p>
	  <div><pre class="example sh_javascript">&lt;mmi:mmi version=&quot;1.0&quot; xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot;&gt;
  &lt;mmi:extensionNotification name=&quot;setValue&quot; target=&quot;GUI&quot; requestID=&quot;im-req-10&quot; context=&quot;ctx-01&quot;&gt;
    &lt;mmi:data&gt;
      &lt;function name=&quot;setValue&quot; id=&quot;answer_field&quot; value=&quot;20&quot; /&gt;
    &lt;/mmi:data&gt;
  &lt;/mmi:extensionNotification&gt;
&lt;/mmi:mmi&gt;</pre></div>

	  <p>Again the user clicks the &quot;Check&quot; button at the GUI to check the input for correctness.</p>
	  <img src="./images/sequence-diagram-15.png" alt="sequence diagram 15" />
	  <p>Lifecycle Event 35:</p>
	  <div><pre class="example sh_javascript">&lt;mmi:mmi version=&quot;1.0&quot; xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot;&gt;
  &lt;mmi:extensionNotification name=&quot;click&quot; source=&quot;GUI&quot; requestID=&quot;gui-req-07&quot; context=&quot;ctx-01&quot;&gt;
    &lt;mmi:data&gt;
      &lt;emma:emma version=&quot;1.0&quot; xmlns:emma=&quot;http://www.w3.org/2003/04/emma&quot;&gt;
        &lt;emma:interpretation id=&quot;int-01&quot; emma:medium=&quot;tactile&quot; emma:mode=&quot;ink&quot;&gt;
          &lt;click id=&quot;check_button&quot; value=&quot;&quot; /&gt;
        &lt;/emma:interpretation&gt;
      &lt;/emma:emma&gt;
    &lt;/mmi:data&gt;
  &lt;/mmi:extensionNotification&gt;
&lt;/mmi:mmi&gt;</pre></div>

	  <p>Since this answer is not correct, the interaction manager instructs the voice modality component to play <em>&quot;This is not correct. Please try again.&quot;</em> Note that the voice modality component sends two lifecycle events in response to the StartRequest. A StartResponse immediately after it has started to play out the prompt and a DoneNotification once it has finished the prompt.</p>
	  <img src="./images/sequence-diagram-16.png" alt="sequence diagram 16" />
	  <p>Lifecycle Event 36:</p>
	  <div><pre class="example sh_javascript">&lt;mmi:mmi version=&quot;1.0&quot; xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot;&gt;
  &lt;mmi:startRequest target=&quot;Voice&quot; requestID=&quot;im-req-v8&quot; context=&quot;ctx-01&quot;&gt;
    &lt;mmi:data&gt;&lt;voice cmd=&quot;play&quot;&gt;&lt;text&gt;This is not correct. Please try again.&lt;/text&gt;&lt;/voice&gt;&lt;/mmi:data&gt;
  &lt;/mmi:startRequest&gt;
&lt;/mmi:mmi&gt;</pre></div>
	  <p>Lifecycle Event 37:</p>
	  <div><pre class="example sh_javascript">&lt;mmi:mmi version=&quot;1.0&quot; xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot;&gt;
  &lt;mmi:startResponse source=&quot;Voice&quot; requestID=&quot;im-req-v8&quot; context=&quot;ctx-01&quot; status=&quot;success&quot; /&gt;
&lt;/mmi:mmi&gt;</pre></div>
	  <p>Lifecycle Event 38:</p>
	  <div><pre class="example sh_javascript">&lt;mmi:mmi xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot; version=&quot;1.0&quot;&gt;
   &lt;mmi:doneNotification source=&quot;Voice&quot; context=&quot;ctx-01&quot; status=&quot;success&quot; requestID=&quot;im-req-v8&quot; &gt;
   &lt;/mmi:doneNotification&gt;
&lt;/mmi:mmi&gt;</pre></div>

	  <p>Again the user tries to answer the questions, this time using the keyboard. He types &quot;1&quot; and &quot;8&quot; on his keyboard.</p>
	  <p>The user hits the &quot;1&quot; on the keyboard:</p>
      <img src="./images/sequence-diagram-17.png" alt="sequence diagram 17" />
	  <p>The user hits the &quot;8&quot; on the keyboard:</p>
      <img src="./images/sequence-diagram-18.png" alt="sequence diagram 18" />
	  <p>The user clicks the &quot;check&quot; button, which leads to the &quot;change&quot; and &quot;click&quot; HTML DOM events, which are handled by the modality components scripts and wrapped into two lifecycle events:</p>
	  <img src="./images/sequence-diagram-19.png" alt="sequence diagram 19" />
	  <p>Again, since this is a generic behavior of the graphical modality component, two lifecycle events are sent to the interaction manager immediately after each other.</p>
	  <p>Lifecycle Event 39:</p>
	  <div><pre class="example sh_javascript">&lt;mmi:mmi version=&quot;1.0&quot; xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot;&gt;
  &lt;mmi:extensionNotification name=&quot;change&quot; source=&quot;GUI&quot; requestID=&quot;gui-req-08&quot; context=&quot;ctx-01&quot;&gt;
    &lt;mmi:data&gt;
      &lt;emma:emma version=&quot;1.0&quot; xmlns:emma=&quot;http://www.w3.org/2003/04/emma&quot;&gt;
        &lt;emma:interpretation id=&quot;int-01&quot; emma:medium=&quot;tactile&quot; emma:mode=&quot;ink&quot;&gt;
          &lt;change id=&quot;answer_field&quot; value=&quot;18&quot; /&gt;
        &lt;/emma:interpretation&gt;
      &lt;/emma:emma&gt;
    &lt;/mmi:data&gt;
  &lt;/mmi:extensionNotification&gt;
&lt;/mmi:mmi&gt;</pre></div>
	  <p>Lifecycle Event 40:</p>
	  <div><pre class="example sh_javascript">&lt;mmi:mmi version=&quot;1.0&quot; xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot;&gt;
  &lt;mmi:extensionNotification name=&quot;click&quot; source=&quot;GUI&quot; requestID=&quot;gui-req-09&quot; context=&quot;ctx-01&quot;&gt;
    &lt;mmi:data&gt;
      &lt;emma:emma version=&quot;1.0&quot; xmlns:emma=&quot;http://www.w3.org/2003/04/emma&quot;&gt;
        &lt;emma:interpretation id=&quot;int-01&quot; emma:medium=&quot;tactile&quot; emma:mode=&quot;ink&quot;&gt;
          &lt;click id=&quot;check_button&quot; value=&quot;&quot; /&gt;
        &lt;/emma:interpretation&gt;
      &lt;/emma:emma&gt;
    &lt;/mmi:data&gt;
  &lt;/mmi:extensionNotification&gt;
&lt;/mmi:mmi&gt;</pre></div>
	  
	  <p>This input is checked within the interaction manager script and since it is correct the interaction manager will send lifecycle events both modality components to change the visual indicator to green color and to play <em>&quot;This is correct. Please press 'Next' for another question or press 'Stop' to finish the application.&quot;</em>
	  </p>
	  <img src="./images/sequence-diagram-20.png" alt="sequence diagram 20" />
	  <p>Lifecycle Event 41:</p>
	  <div><pre class="example sh_javascript">&lt;mmi:mmi version=&quot;1.0&quot; xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot;&gt;
  &lt;mmi:extensionNotification name=&quot;setValue&quot; target=&quot;GUI&quot; requestID=&quot;im-req-13&quot; context=&quot;ctx-01&quot;&gt;
    &lt;mmi:data&gt;
      &lt;function name=&quot;setValue&quot; id=&quot;result_identifier&quot; value=&quot;on&quot; /&gt;
    &lt;/mmi:data&gt;
  &lt;/mmi:startRequest&gt;
&lt;/mmi:mmi&gt;</pre></div>
	  <p>Lifecycle Event 42:</p>
	  <div><pre class="example sh_javascript">&lt;mmi:mmi version=&quot;1.0&quot; xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot;&gt;
  &lt;mmi:startRequest target=&quot;Voice&quot; requestID=&quot;im-req-v9&quot; context=&quot;ctx-01&quot;&gt;
    &lt;mmi:data&gt;&lt;voice cmd=&quot;play&quot;&gt;&lt;text&gt;This is correct. Please press Next for another question or Stop to finish the application.&lt;/text&gt;&lt;/voice&gt;&lt;/mmi:data&gt;
  &lt;/mmi:startRequest&gt;
&lt;/mmi:mmi&gt;</pre></div>
	  <p>Lifecycle Event 43:</p>
	  <div><pre class="example sh_javascript">&lt;mmi:mmi version=&quot;1.0&quot; xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot;&gt;
  &lt;mmi:startResponse source=&quot;Voice&quot; requestID=&quot;im-req-v9&quot; context=&quot;ctx-01&quot; status=&quot;success&quot; /&gt;
&lt;/mmi:mmi&gt;</pre></div>
	  <p>Lifecycle Event 44:</p>
	  <div><pre class="example sh_javascript">&lt;mmi:mmi xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot; version=&quot;1.0&quot;&gt;
   &lt;mmi:doneNotification source=&quot;Voice&quot; context=&quot;ctx-01&quot; status=&quot;success&quot; requestID=&quot;im-req-v9&quot; &gt;
   &lt;/mmi:doneNotification&gt;
&lt;/mmi:mmi&gt;</pre></div>

	  <p>The user decides to stop the quiz at this point and clicks the &quot;Stop&quot; button at the GUI.</p>
	  <img src="./images/sequence-diagram-21.png" alt="sequence diagram 21" />
	  <p>Lifecycle Event 45:</p>
	  <div><pre class="example sh_javascript">&lt;mmi:mmi version=&quot;1.0&quot; xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot;&gt;
  &lt;mmi:extensionNotification name=&quot;click&quot; source=&quot;GUI&quot; requestID=&quot;gui-req-10&quot; context=&quot;ctx-01&quot;&gt;
    &lt;mmi:data&gt;
      &lt;emma:emma version=&quot;1.0&quot; xmlns:emma=&quot;http://www.w3.org/2003/04/emma&quot;&gt;
        &lt;emma:interpretation id=&quot;int-01&quot; emma:medium=&quot;tactile&quot; emma:mode=&quot;ink&quot;&gt;
          &lt;click id=&quot;stop_button&quot; value=&quot;&quot; /&gt;
        &lt;/emma:interpretation&gt;
      &lt;/emma:emma&gt;
    &lt;/mmi:data&gt;
  &lt;/mmi:extensionNotification&gt;
&lt;/mmi:mmi&gt;</pre></div>

	  <p>The interaction manager now sends StartRequests to both component to display a &quot;Goodbye&quot; page and play <em>&quot;Thank you and goodbye.&quot;</em>
	  </p>
	  <img src="./images/sequence-diagram-21.png" alt="sequence diagram 21" />
	  <p>Lifecycle Event 46:</p>
	  <div><pre class="example sh_javascript">&lt;mmi:mmi version=&quot;1.0&quot; xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot;&gt;
  &lt;mmi:startRequest target=&quot;GUI&quot; requestID=&quot;im-req-15&quot; context=&quot;ctx-01&quot;&gt;
    &lt;mmi:contentURL href=&quot;goodbye.html&quot; /&gt;
  &lt;/mmi:startRequest&gt;
&lt;/mmi:mmi&gt;</pre></div>
	  <p>Lifecycle Event 47:</p>
	  <div><pre class="example sh_javascript">&lt;mmi:mmi version=&quot;1.0&quot; xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot;&gt;
  &lt;mmi:startResponse source=&quot;GUI&quot; requestID=&quot;im-req-15&quot; context=&quot;ctx-01&quot; status=&quot;success&quot; /&gt;
&lt;/mmi:mmi&gt;</pre></div>
	  <p>Lifecycle Event 48:</p>
	  <div><pre class="example sh_javascript">&lt;mmi:mmi version=&quot;1.0&quot; xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot;&gt;
  &lt;mmi:startRequest target=&quot;Voice&quot; requestID=&quot;im-req-v10&quot; context=&quot;ctx-01&quot;&gt;
    &lt;mmi:data&gt;&lt;voice cmd=&quot;play&quot;&gt;&lt;text&gt;Thank you and goodbye.&lt;/text&gt;&lt;/voice&gt;&lt;/mmi:data&gt;
  &lt;/mmi:startRequest&gt;
&lt;/mmi:mmi&gt;</pre></div>
	  <p>Lifecycle Event 49:</p>
	  <div><pre class="example sh_javascript">&lt;mmi:mmi version=&quot;1.0&quot; xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot;&gt;
  &lt;mmi:startResponse source=&quot;Voice&quot; requestID=&quot;im-req-v10&quot; context=&quot;ctx-01&quot; status=&quot;success&quot; /&gt;
&lt;/mmi:mmi&gt;</pre></div>
	  <p>Lifecycle Event 50:</p>
	  <div><pre class="example sh_javascript">&lt;mmi:mmi xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot; version=&quot;1.0&quot;&gt;
   &lt;mmi:doneNotification source=&quot;Voice&quot; context=&quot;ctx-01&quot; status=&quot;success&quot; requestID=&quot;im-req-v10&quot; &gt;
   &lt;/mmi:doneNotification&gt;
&lt;/mmi:mmi&gt;</pre></div>
	  
 </div>

		
    <div class="appendix section" id="application_scripts">
      
<!-- OddPage -->
<h2><span class="secno">A. </span>Application scripts</h2>
      <p>
        The application consists of two components which use markup languages. The interaction 
		manager uses the state chart description language SCXML [<cite><a class="bibref" rel="biblioentry" href="#bib-SCXML">SCXML</a></cite>] to build the 
		application specific functionality, whereas the GUI modality component uses HTML 
		[<cite><a class="bibref" rel="biblioentry" href="#bib-HTML401">HTML401</a></cite>] for the application specific part.
      </p>
	  <h3 id="scxml">SCXML</h3>

	   <p>The following figure shows a visual representation of the interaction manager state machine.
	   </p>
	   <img src="./images/interop-scxml.png" alt="state machine" />
	   <ol>
	     <li>Send 'welcome' StartRequests to both Modality Components. Provide HTML page URL in the GUI-MC StartRequest, and text to synthesize in the Voice-MC StartRequest.
		 </li>
         <li>Process ExtensionNotification events from Modality Components. At this stage, we collect and register GUI events. Once a condition has been satisfied (a &quot;clicked&quot; event occurred on the &quot;start_button&quot; object), proceed to the next state.
		 </li>
         <li>Load a question. In a more complex setup, this could mean fetching data from a question database; here, we simply switch between two hardcoded question/answer pairs.
		 </li>
         <li>Send 'question' StartRequests to both Modality Components.
		 </li>
         <li>Process ExtensionNotification/DoneNotification events from Modality Components. Once a condition has been satisfied, perform an appropriate action:
		   <ul>
		     <li>if the GUI &quot;voice input activation button&quot; has been clicked, send a &quot;recognize&quot; command to the Voice MC</li>
             <li>if an answer has been provided by either of the Modality Components, evaluate the answer and send the result to both MCs</li>
             <li>if the GUI &quot;next&quot; button has been clicked, transition to next question</li>
             <li>if the GUI &quot;stop&quot; button has been clicked, transition to the &quot;goodbye&quot; state</li>
           </ul>
         </li><li>Send 'goodbye' StartRequests to both Modality Components.</li>
	   </ol>
	   <p>
	   The following markup code shows the SCXML which describes the application logic. 
	   The code is loaded by the interaction manager at application start.
	   </p>

	   <div><pre class="example sh_javascript">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;scxml xmlns=&quot;http://www.w3.org/2005/07/scxml&quot; 
	xmlns:commons=&quot;http://commons.apache.org/scxml&quot;
	xmlns:emma=&quot;http://www.w3.org/2003/04/emma&quot; 
	xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; 
	xmlns:mmi=&quot;http://www.w3.org/2008/04/mmi-arch&quot;
	xsi:schemaLocation=&quot;http://www.w3.org/2005/07/scxml scxml.xsd http://commons.apache.org/scxml commons.xsd http://www.w3.org/2008/04/mmi-arch mmi.xsd http://www.w3.org/2003/04/emma emma.xsd&quot; version=&quot;1.0&quot;
	initialstate=&quot;init&quot;&gt;

	&lt;!-- data model definition --&gt;
	&lt;datamodel&gt;

		&lt;!-- top-level variables --&gt;
		&lt;data name=&quot;contextId&quot; /&gt;
		&lt;data name=&quot;requestId&quot; /&gt;
		&lt;data name=&quot;sourceMC&quot; /&gt;
		&lt;data name=&quot;source&quot; expr=&quot;IM&quot; /&gt;

		&lt;data name=&quot;gui_events&quot;&gt;
			&lt;clicked xmlns=&quot;&quot; /&gt;
			&lt;changed xmlns=&quot;&quot; /&gt;
			&lt;value xmlns=&quot;&quot; /&gt;
		&lt;/data&gt;

		&lt;data name=&quot;ttsWelcome&quot;&gt;
			&lt;voice xmlns=&quot;&quot; cmd=&quot;play&quot;&gt;&lt;text&gt;&lt;![CDATA[Welcome to the math quiz. Please press start to continue.]]&gt;&lt;/text&gt;&lt;/voice&gt;
		&lt;/data&gt;
		
		&lt;data name=&quot;ttsQuestion&quot;&gt;
			&lt;voice xmlns=&quot;&quot; cmd=&quot;play&quot;&gt;&lt;text&gt;&lt;![CDATA[Question placeholder.]]&gt;&lt;/text&gt;&lt;/voice&gt;
		&lt;/data&gt;
		
		&lt;data name=&quot;ttsCorrect&quot;&gt;
			&lt;voice xmlns=&quot;&quot; cmd=&quot;play&quot;&gt;&lt;text&gt;&lt;![CDATA[This is correct. Please press Next for another question or press Stop to finish the application.]]&gt;&lt;/text&gt;&lt;/voice&gt;
		&lt;/data&gt;
		
		&lt;data name=&quot;ttsIncorrect&quot;&gt;
			&lt;voice xmlns=&quot;&quot; cmd=&quot;play&quot;&gt;&lt;text&gt;&lt;![CDATA[This is not correct. Please try again.]]&gt;&lt;/text&gt;&lt;/voice&gt;
		&lt;/data&gt;
		&lt;data name=&quot;ttsGoodbye&quot;&gt;
			&lt;voice xmlns=&quot;&quot; cmd=&quot;play&quot;&gt;&lt;text&gt;&lt;![CDATA[Thank you and goodbye.]]&gt;&lt;/text&gt;&lt;/voice&gt;
		&lt;/data&gt;
		
		&lt;data name=&quot;cmdRecognize&quot;&gt;
			&lt;voice xmlns=&quot;&quot; cmd=&quot;recognize&quot;&gt;&lt;/voice&gt;
		&lt;/data&gt;
		
		&lt;data name=&quot;initGrammar&quot;&gt;
			&lt;grammar xmlns=&quot;&quot; href=&quot;http://64.9.100.106/mmi/mathQuiz/gram/answer_options.gram&quot;/&gt;
		&lt;/data&gt;
		
		&lt;data name=&quot;url&quot; /&gt;
		
		&lt;data name=&quot;problem&quot;&gt;
			&lt;text xmlns=&quot;&quot; /&gt;
			&lt;answer xmlns=&quot;&quot; /&gt;
			&lt;id xmlns=&quot;&quot; /&gt;
			&lt;url xmlns=&quot;&quot; /&gt;
		&lt;/data&gt;

		&lt;data name=&quot;setCorrect&quot;&gt;
			&lt;function xmlns=&quot;&quot; name=&quot;setValue&quot; id=&quot;result_identifier&quot; value=&quot;on&quot; /&gt;
		&lt;/data&gt;
		
		&lt;data name=&quot;setIncorrect&quot;&gt;
			&lt;function xmlns=&quot;&quot; name=&quot;setValue&quot; id=&quot;result_identifier&quot; value=&quot;off&quot; /&gt;
		&lt;/data&gt;
		&lt;data name=&quot;setAnswer&quot;&gt;
			&lt;function xmlns=&quot;&quot; name=&quot;setValue&quot; id=&quot;answer_field&quot; value=&quot;&quot; /&gt;
		&lt;/data&gt;

	&lt;/datamodel&gt;

	&lt;state id=&quot;init&quot;&gt;
		&lt;onentry&gt;
			&lt;log label=&quot;[init]&quot; expr=&quot;Waiting for new context request...&quot; /&gt;
		&lt;/onentry&gt;
		&lt;transition event=&quot;mmi:newContextRequest&quot; target=&quot;welcome&quot;&gt;
			&lt;assign name=&quot;requestId&quot; expr=&quot;${Data(_eventdata, '//mmi:newContextRequest/@requestID')}&quot; /&gt;
			&lt;assign name=&quot;sourceMC&quot; expr=&quot;${Data(_eventdata, '//mmi:newContextRequest/@source')}&quot; /&gt;
			&lt;assign name=&quot;contextId&quot; expr=&quot;${mmi:newContextId()}&quot; /&gt;
			&lt;commons:var name=&quot;newContextResponse&quot; expr=&quot;${mmi:newContextResponse(contextId, source, sourceMC, requestId)}&quot; /&gt;
			&lt;send event=&quot;mmi:newContextResponse&quot; target=&quot;${sourceMC}&quot; targettype=&quot;MC&quot; namelist=&quot;newContextResponse&quot; /&gt;
		&lt;/transition&gt;
	&lt;/state&gt;

	&lt;state id=&quot;welcome&quot;&gt;
		&lt;onentry&gt;
			&lt;assign location=&quot;${Data(problem, 'id')}&quot; expr=&quot;1&quot; /&gt;
			&lt;commons:var name=&quot;extensionNotification&quot; expr=&quot;${mmi:newExtensionNotification(contextId, source, 'Voice', mmi:newRequestId(contextId), 'addGrammar', initGrammar)}&quot; /&gt;
			&lt;send event=&quot;mmi:extensionNotification&quot; target=&quot;Voice&quot; targettype=&quot;MC&quot; namelist=&quot;extensionNotification&quot; /&gt;
		&lt;/onentry&gt;
		&lt;initial&gt;
			&lt;transition target=&quot;welcome.send&quot;/&gt;
		&lt;/initial&gt;
		&lt;state id=&quot;welcome.send&quot;&gt;
			&lt;onentry&gt;
				&lt;commons:var name=&quot;startRequest&quot; expr=&quot;${mmi:newStartRequest(contextId, source, 'GUI', mmi:newRequestId(contextId), 'welcome.html', null)}&quot; /&gt;
				&lt;send event=&quot;mmi:startRequest&quot; target=&quot;GUI&quot; targettype=&quot;MC&quot; namelist=&quot;startRequest&quot; /&gt;
				&lt;commons:var name=&quot;startRequest&quot; expr=&quot;${mmi:newStartRequest(contextId, source, 'Voice', mmi:newRequestId(contextId), 'welcome.vxml', ttsWelcome)}&quot; /&gt;
				&lt;send event=&quot;mmi:startRequest&quot; target=&quot;Voice&quot; targettype=&quot;MC&quot; namelist=&quot;startRequest&quot; /&gt;
			&lt;/onentry&gt;
			&lt;transition event=&quot;mmi:startResponse&quot; target=&quot;welcome.wait&quot; /&gt;
		&lt;/state&gt;
		&lt;state id=&quot;welcome.wait&quot;&gt;
			&lt;transition event=&quot;mmi:extensionNotification&quot; target=&quot;welcome.wait&quot;&gt;
				&lt;if cond=&quot;${Data(_eventdata, '//click/@id') ne ''}&quot;&gt;
					&lt;assign location=&quot;${Data(gui_events, 'clicked')}&quot; expr=&quot;${Data(_eventdata, '//click/@id')}&quot; /&gt;
				&lt;/if&gt;
			&lt;/transition&gt;
			&lt;transition cond=&quot;${Data(gui_events, 'clicked') eq 'start_button'}&quot; target=&quot;question&quot; /&gt;
		&lt;/state&gt;
	&lt;/state&gt;

	&lt;state id=&quot;question&quot;&gt;
		&lt;initial&gt;
			&lt;transition target=&quot;question.load&quot;/&gt;
		&lt;/initial&gt;
		&lt;state id=&quot;question.send&quot;&gt;
			&lt;onentry&gt;
				&lt;assign name=&quot;url&quot; expr=&quot;${Data(problem, 'url')}&quot; /&gt;
				&lt;commons:var name=&quot;startRequestGUI&quot; expr=&quot;${mmi:newStartRequest(contextId, source, 'GUI', mmi:newRequestId(contextId), url, null)}&quot; /&gt;
				&lt;send event=&quot;mmi:startRequest&quot; target=&quot;GUI&quot; targettype=&quot;MC&quot; namelist=&quot;startRequestGUI&quot; /&gt;
				&lt;assign location=&quot;${Data(ttsQuestion, 'voice/text')}&quot; expr=&quot;${Data(problem, 'text')}&quot; /&gt;
				&lt;commons:var name=&quot;startRequestVoice&quot; expr=&quot;${mmi:newStartRequest(contextId, source, 'Voice', mmi:newRequestId(contextId), 'question.vxml', ttsQuestion)}&quot; /&gt;
				&lt;send event=&quot;mmi:startRequest&quot; target=&quot;Voice&quot; targettype=&quot;MC&quot; namelist=&quot;startRequestVoice&quot; /&gt;				
			&lt;/onentry&gt;
			&lt;transition event=&quot;mmi:startResponse&quot; target=&quot;question.wait&quot;/&gt;
		&lt;/state&gt;
		&lt;state id=&quot;question.wait&quot;&gt;
			&lt;transition event=&quot;mmi:extensionNotification&quot; target=&quot;question.wait&quot;&gt;
				&lt;if cond=&quot;${Data(_eventdata, '//click/@id') ne ''}&quot;&gt;
					&lt;assign location=&quot;${Data(gui_events, 'clicked')}&quot; expr=&quot;${Data(_eventdata, '//click/@id')}&quot; /&gt;
				&lt;/if&gt;
				&lt;if cond=&quot;${Data(_eventdata, '//change/@id') ne ''}&quot;&gt;
					&lt;assign location=&quot;${Data(gui_events, 'changed')}&quot; expr=&quot;${Data(_eventdata, '//change/@id')}&quot; /&gt;
					&lt;assign location=&quot;${Data(gui_events, 'value')}&quot; expr=&quot;${Data(_eventdata, '//change/@value')}&quot; /&gt;
				&lt;/if&gt;
			&lt;/transition&gt;
			&lt;transition event=&quot;mmi:doneNotification&quot; target=&quot;question.wait&quot;&gt;
				&lt;if cond=&quot;${Data(_eventdata, '//answer') ne ''}&quot;&gt;
					&lt;assign location=&quot;${Data(gui_events, 'value')}&quot; expr=&quot;${Data(_eventdata, '//answer')}&quot; /&gt;
					&lt;assign location=&quot;${Data(gui_events, 'clicked')}&quot; expr=&quot;check_button&quot; /&gt;
					&lt;assign location=&quot;${Data(setAnswer, 'function/@value')}&quot; expr=&quot;${Data(gui_events, 'value')}&quot; /&gt;
					&lt;commons:var name=&quot;extensionNotification&quot; expr=&quot;${mmi:newExtensionNotification(contextId, source, sourceMC, mmi:newRequestId(contextId), 'setValue', setAnswer)}&quot; /&gt;
					&lt;send event=&quot;mmi:extensionNotification&quot; target=&quot;GUI&quot; targettype=&quot;MC&quot; namelist=&quot;extensionNotification&quot; /&gt;
				&lt;/if&gt;
			&lt;/transition&gt;			
			&lt;transition cond=&quot;${Data(gui_events, 'clicked') eq 'voice_input_activation_button'}&quot; target=&quot;question.wait&quot;&gt;
				&lt;assign location=&quot;${Data(gui_events, 'clicked')}&quot; expr=&quot;&quot; /&gt;
				&lt;commons:var name=&quot;startRequestVoice&quot; expr=&quot;${mmi:newStartRequest(contextId, source, 'Voice', mmi:newRequestId(contextId), 'question.vxml', cmdRecognize)}&quot; /&gt;
				&lt;send event=&quot;mmi:startRequest&quot; target=&quot;Voice&quot; targettype=&quot;MC&quot; namelist=&quot;startRequestVoice&quot; /&gt;					
			&lt;/transition&gt;
			&lt;transition cond=&quot;${Data(gui_events, 'clicked') eq 'check_button'}&quot; target=&quot;question.wait&quot;&gt;
				&lt;assign location=&quot;${Data(gui_events, 'clicked')}&quot; expr=&quot;&quot; /&gt;
				&lt;if cond=&quot;${Data(gui_events, 'value') eq Data(problem, 'answer')}&quot;&gt;
					&lt;commons:var name=&quot;extensionNotification&quot; expr=&quot;${mmi:newExtensionNotification(contextId, source, sourceMC, mmi:newRequestId(contextId), 'setValue', setCorrect)}&quot; /&gt;
					&lt;send event=&quot;mmi:extensionNotification&quot; target=&quot;GUI&quot; targettype=&quot;MC&quot; namelist=&quot;extensionNotification&quot; /&gt;
					&lt;commons:var name=&quot;startRequestVoice&quot; expr=&quot;${mmi:newStartRequest(contextId, source, 'Voice', mmi:newRequestId(contextId), 'question.vxml', ttsCorrect)}&quot; /&gt;
					&lt;send event=&quot;mmi:startRequest&quot; target=&quot;Voice&quot; targettype=&quot;MC&quot; namelist=&quot;startRequestVoice&quot; /&gt;	
					&lt;else /&gt;
					&lt;commons:var name=&quot;extensionNotification&quot; expr=&quot;${mmi:newExtensionNotification(contextId, source, sourceMC, mmi:newRequestId(contextId), 'setValue', setIncorrect)}&quot; /&gt;
					&lt;send event=&quot;mmi:extensionNotification&quot; target=&quot;GUI&quot; targettype=&quot;MC&quot; namelist=&quot;extensionNotification&quot; /&gt;
					&lt;commons:var name=&quot;startRequestVoice&quot; expr=&quot;${mmi:newStartRequest(contextId, source, 'Voice', mmi:newRequestId(contextId), 'question.vxml', ttsIncorrect)}&quot; /&gt;
					&lt;send event=&quot;mmi:startRequest&quot; target=&quot;Voice&quot; targettype=&quot;MC&quot; namelist=&quot;startRequestVoice&quot; /&gt;				
					&lt;assign location=&quot;${Data(ttsQuestion, 'voice/text')}&quot; expr=&quot;${Data(problem, 'text')}&quot; /&gt;
					&lt;commons:var name=&quot;startRequestVoice&quot; expr=&quot;${mmi:newStartRequest(contextId, source, 'Voice', mmi:newRequestId(contextId), 'question.vxml', ttsQuestion)}&quot; /&gt;
					&lt;send event=&quot;mmi:startRequest&quot; target=&quot;Voice&quot; targettype=&quot;MC&quot; namelist=&quot;startRequestVoice&quot; /&gt;								
					&lt;commons:var name=&quot;startRequestVoice&quot; expr=&quot;${mmi:newStartRequest(contextId, source, 'Voice', mmi:newRequestId(contextId), 'question.vxml', cmdRecognize)}&quot; /&gt;
					&lt;send event=&quot;mmi:startRequest&quot; target=&quot;Voice&quot; targettype=&quot;MC&quot; namelist=&quot;startRequestVoice&quot; /&gt;						
				&lt;/if&gt;
			&lt;/transition&gt;
			&lt;transition cond=&quot;${Data(gui_events, 'clicked') eq 'stop_button'}&quot; target=&quot;goodbye&quot;&gt;
				&lt;assign location=&quot;${Data(gui_events, 'clicked')}&quot; expr=&quot;&quot; /&gt;
			&lt;/transition&gt;
			&lt;transition cond=&quot;${Data(gui_events, 'clicked') eq 'next_button'}&quot; target=&quot;question&quot;&gt;
				&lt;assign location=&quot;${Data(gui_events, 'clicked')}&quot; expr=&quot;&quot; /&gt;
			&lt;/transition&gt;
		&lt;/state&gt;

		&lt;state id=&quot;question.load&quot;&gt;
			&lt;onentry&gt;
				&lt;if cond=&quot;${(Data(problem, 'id') mod 2) eq 1}&quot;&gt;
					&lt;assign location=&quot;${Data(problem, 'text')}&quot; expr=&quot;What is 7 plus 9?&quot; /&gt;
					&lt;assign location=&quot;${Data(problem, 'answer')}&quot; expr=&quot;16&quot; /&gt;
					&lt;assign location=&quot;${Data(problem, 'url')}&quot; expr=&quot;question1.html&quot; /&gt;
				&lt;/if&gt;
				&lt;if cond=&quot;${(Data(problem, 'id') mod 2) eq 0}&quot;&gt;
					&lt;assign location=&quot;${Data(problem, 'text')}&quot; expr=&quot;What is 22 minus 4?&quot; /&gt;
					&lt;assign location=&quot;${Data(problem, 'answer')}&quot; expr=&quot;18&quot; /&gt;
					&lt;assign location=&quot;${Data(problem, 'url')}&quot; expr=&quot;question2.html&quot; /&gt;
				&lt;/if&gt;
				&lt;assign location=&quot;${Data(problem, 'id')}&quot; expr=&quot;${Data(problem, 'id') + 1}&quot; /&gt;
			&lt;/onentry&gt;
			&lt;transition target=&quot;question.send&quot;/&gt;
		&lt;/state&gt;

	&lt;/state&gt;

	&lt;state id=&quot;goodbye&quot;&gt;
		&lt;initial&gt;
			&lt;transition target=&quot;goodbye.send&quot;/&gt;
		&lt;/initial&gt;
		&lt;state id=&quot;goodbye.send&quot;&gt;
			&lt;onentry&gt;
				&lt;commons:var name=&quot;startRequest&quot; expr=&quot;${mmi:newStartRequest(contextId, source, sourceMC, mmi:newRequestId(contextId), 'goodbye.html')}&quot; /&gt;
				&lt;send event=&quot;mmi:startRequest&quot; target=&quot;${sourceMC}&quot; targettype=&quot;MC&quot; namelist=&quot;startRequest&quot; /&gt;
				&lt;commons:var name=&quot;startRequestVoice&quot; expr=&quot;${mmi:newStartRequest(contextId, source, 'Voice', mmi:newRequestId(contextId), 'question.vxml', ttsGoodbye)}&quot; /&gt;
				&lt;send event=&quot;mmi:startRequest&quot; target=&quot;Voice&quot; targettype=&quot;MC&quot; namelist=&quot;startRequestVoice&quot; /&gt;
			&lt;/onentry&gt;
			&lt;transition event=&quot;mmi:startResponse&quot; target=&quot;quit&quot; /&gt;
		&lt;/state&gt;
	&lt;/state&gt;

	&lt;state id=&quot;quit&quot;&gt;
	&lt;/state&gt;

&lt;/scxml&gt;</pre></div>

	  <h3 id="html">HTML</h3>
	   <p>
	   The following HTML code shows the welcome.html page, which represents the application 
	   specific markup and will be loaded from the graphical modality component as a reaction
	   to a mmi:StartRequest lifecycle event.
	   </p>
	   <div><pre class="example sh_javascript">&lt;!DOCTYPE html PUBLIC &quot;-//<acronym title="World Wide Web Consortium">W3C</acronym>//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;
&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot; xml:lang=&quot;de&quot; lang=&quot;de&quot;&gt;
&lt;head&gt;
&lt;title&gt;Welcome - MathQuiz&lt;/title&gt;
&lt;link href=&quot;css/layout.css&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot; /&gt;
&lt;script type=&quot;text/javascript&quot;&gt;
    var EVENTTYPES = new Array();
    var HTMLELEMENTS = new Array();
    var FORMELEMENTS = new Array();
    EVENTTYPES[0] = new Array(&quot;click&quot;);
    HTMLELEMENTS[0] = new Array(&quot;input&quot;);
    FORMELEMENTS[0] = new Array(&quot;button&quot;);
&lt;/script&gt;
&lt;/head&gt;

&lt;body class=&quot;col3_only&quot;&gt;
&lt;div class=&quot;page_margins&quot;&gt;
    &lt;div id=&quot;header&quot;&gt;
        Math-Quiz
    &lt;/div&gt;
    &lt;div id=&quot;main&quot;&gt;
        &lt;div id=&quot;col1&quot;&gt;
        &lt;/div&gt;
        &lt;div id=&quot;col2&quot;&gt;
        &lt;/div&gt;
        &lt;div id=&quot;col3&quot;&gt;
            &lt;div id=&quot;col3_content&quot;&gt;
                &lt;p class=&quot;center&quot;&gt;Welcome&lt;/p&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;
    &lt;div id=&quot;footer&quot;&gt;
	   &lt;input id=&quot;start_button&quot; type=&quot;button&quot; value=&quot;Start&quot; /&gt;
    &lt;/div&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</pre></div>

	   <p>
	   The application code above contains some ECMAScript varialbes (arrays such as EVENTTYPES). These variables give 
	   the application author control over which DOM elements are to be handled by the graphical modality component wrapper
	   and forwarded to the interaction manager. This functionality is used to optimize performance and to avoid flooding the
	   interaction manager with events like mouse movements or hover.
	   </p>
	   <p>
	   The following figure shows a graphical representation of the application dependent 'welcome' page:
	   </p>
	   <img src="./images/welcome.png" alt="welcome page" />
	   <p>There are similar HTML documents for other stages of the application which will be 
	   loaded in reaction to other mmi:StartRequest lifecycle events.
	   </p>
	  <h3 id="grammar">Grammar</h3>
	   <p>
	   This ABNF speech grammar [<cite><a class="bibref" rel="biblioentry" href="#bib-SPEECH-GRAMMAR">SPEECH-GRAMMAR</a></cite>] has been used by the voice modality component to 
	   recognize the math quiz results:
	   </p>
	   <div><pre class="example sh_javascript">#ABNF 1.0 iso-8859-1;
language en-US;

mode voice;
root $mathquizanswer;
tag-format &lt;semantics/1.0&gt;;

public $mathquizanswer =
	1|2|3|4|5|6|7|8|9|10|11|12|13|14|15|16|17|18|19|20;</pre></div>
	   <p>
	   The modality component loads this grammar in response to a ExtensionNotification lifecycle event (see description above). 
	   Recognition results are compiled into an EMMA [<cite><a class="bibref" rel="biblioentry" href="#bib-EMMA">EMMA</a></cite>] document and sent to the interaction manager using a DoneNotification
	   lifecycle event.
	   </p>
    </div>
	
    <div class="appendix section" id="acknowledgements">
      
<!-- OddPage -->
<h2><span class="secno">B. </span>Acknowledgements</h2>

      <p>
        The authors would like to recognize the contributions of the members of the <acronym title="World Wide Web Consortium">W3C</acronym> Multimodal Interaction Group.  
		Special thanks to Thomas Ziem (T-Systems) and Jakob Sachse for supporting the test activity.
      </p>
    </div>
  

<div id="references" class="appendix section">
<!-- OddPage -->
<h2><span class="secno">C. </span>References</h2><div id="normative-references" class="section"><h3><span class="secno">C.1 </span>Normative references</h3><dl class="bibliography"><dt id="bib-ECMA-262">[ECMA-262]</dt><dd><a href="http://www.ecma-international.org/publications/standards/Ecma-262.htm"><cite>ECMAScript Language Specification, Third Edition.</cite></a> December 1999. URL: <a href="http://www.ecma-international.org/publications/standards/Ecma-262.htm">http://www.ecma-international.org/publications/standards/Ecma-262.htm</a> 
</dd><dt id="bib-EMMA">[EMMA]</dt><dd>Michael Johnston. <a href="http://www.w3.org/TR/2009/REC-emma-20090210"><cite>EMMA: Extensible MultiModal Annotation markup language.</cite></a> 10 February 2009. W3C Recommendation. URL: <a href="http://www.w3.org/TR/2009/REC-emma-20090210">http://www.w3.org/TR/2009/REC-emma-20090210</a> 
</dd><dt id="bib-HTML401">[HTML401]</dt><dd>David Raggett; Ian Jacobs; Arnaud Le Hors. <a href="http://www.w3.org/TR/1999/REC-html401-19991224"><cite>HTML 4.01 Specification.</cite></a> 24 December 1999. W3C Recommendation. URL: <a href="http://www.w3.org/TR/1999/REC-html401-19991224">http://www.w3.org/TR/1999/REC-html401-19991224</a> 
</dd><dt id="bib-MMI-ARCH">[MMI-ARCH]</dt><dd>Jim Barnett. <a href="http://www.w3.org/TR/2012/CR-mmi-arch-20120112"><cite>Multimodal Architecture and Interfaces.</cite></a> 12 January 2012. W3C Candidate Recommendation. URL: <a href="http://www.w3.org/TR/2012/CR-mmi-arch-20120112">http://www.w3.org/TR/2012/CR-mmi-arch-20120112</a> 
</dd><dt id="bib-SCXML">[SCXML]</dt><dd>Jim Barnett; et al. <a href="http://www.w3.org/TR/2011/WD-scxml-20110426"><cite>State Chart XML (SCXML): State Machine Notation for Control Abstraction.</cite></a> 26 April 2011. W3C Working Draft. (Work in progress.) URL: <a href="http://www.w3.org/TR/2011/WD-scxml-20110426">http://www.w3.org/TR/2011/WD-scxml-20110426</a> 
</dd><dt id="bib-SPEECH-GRAMMAR">[SPEECH-GRAMMAR]</dt><dd>Andrew Hunt; Scott McGlashan. <a href="http://www.w3.org/TR/2004/REC-speech-grammar-20040316"><cite>Speech Recognition Grammar Specification Version 1.0.</cite></a> 16 March 2004. W3C Recommendation. URL: <a href="http://www.w3.org/TR/2004/REC-speech-grammar-20040316">http://www.w3.org/TR/2004/REC-speech-grammar-20040316</a> 
</dd><dt id="bib-XMLHTTPREQUEST">[XMLHTTPREQUEST]</dt><dd>Anne van Kesteren. <a href="http://www.w3.org/TR/2008/WD-XMLHttpRequest-20080415"><cite>The XMLHttpRequest Object.</cite></a> 03 August 2010. W3C Candidate Recommendation. (Work in progress.) URL: <a href="http://www.w3.org/TR/2010/CR-XMLHttpRequest-20100803">http://www.w3.org/TR/2010/CR-XMLHttpRequest-20100803</a> 
</dd></dl></div><div id="informative-references" class="section"><h3><span class="secno">C.2 </span>Informative references</h3><dl class="bibliography"><dt id="bib-MMI-AUTH">[MMI-AUTH]</dt><dd>Ingmar Kliche. <a href="http://www.w3.org/TR/2008/NOTE-mmi-auth-20080702"><cite>Authoring Applications for the Multimodal Architecture.</cite></a> 2 July 2008. W3C Note. URL: <a href="http://www.w3.org/TR/2008/NOTE-mmi-auth-20080702">http://www.w3.org/TR/2008/NOTE-mmi-auth-20080702</a> 
</dd><dt id="bib-MMI-MCBP">[MMI-MCBP]</dt><dd>Ingmar Kliche. <a href="http://www.w3.org/TR/2011/NOTE-mmi-mcbp-20110301"><cite>Best practices for creating MMI Modality Components.</cite></a> 1 March 2011. W3C Note. URL: <a href="http://www.w3.org/TR/2011/NOTE-mmi-mcbp-20110301">http://www.w3.org/TR/2011/NOTE-mmi-mcbp-20110301</a> 
</dd></dl></div></div></body></html>
