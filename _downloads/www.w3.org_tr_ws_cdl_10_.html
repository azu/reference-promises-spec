<!-- http://www.w3.org/TR/ws-cdl-10/ -->
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Web Services Choreography Description Language Version 1.0</title><style type="text/css">
code           { font-family: monospace; }

div.constraint,
div.issue,
div.note,
div.notice     { margin-left: 2em; }

ol.enumar      { list-style-type: decimal; }
ol.enumla      { list-style-type: lower-alpha; }
ol.enumlr      { list-style-type: lower-roman; }
ol.enumua      { list-style-type: upper-alpha; }
ol.enumur      { list-style-type: upper-roman; }


div.exampleInner pre { margin-left: 1em;
                       margin-top: 0em; margin-bottom: 0em}
div.exampleOuter {border: 4px double gray;
                  margin: 0em; padding: 0em}
div.exampleInner { background-color: #d5dee3;
                   border-top-width: 4px;
                   border-top-style: double;
                   border-top-color: #d3d3d3;
                   border-bottom-width: 4px;
                   border-bottom-style: double;
                   border-bottom-color: #d3d3d3;
                   padding: 4px; margin: 0em }
div.exampleWrapper { margin: 4px }
div.exampleHeader { font-weight: bold;
                    margin: 4px}

div.exampleOuter div.exampleInner {
        background-color: #FFFFE0;
}
  </style><link rel="stylesheet" type="text/css" href="http://www.w3.org/StyleSheets/TR/W3C-CR.css" /></head><body><div class="head"><p><a href="http://www.w3.org/"><img src="http://www.w3.org/Icons/w3c_home" alt="W3C" height="48" width="72" /></a></p>
<h1><a name="title" id="title"></a>Web Services Choreography Description Language Version 1.0</h1>
<h2><a name="w3c-doctype" id="w3c-doctype"></a>W3C Candidate Recommendation 9 November 2005</h2><dl><dt>This version:</dt><dd><a href="http://www.w3.org/TR/2005/CR-ws-cdl-10-20051109/">http://www.w3.org/TR/2005/CR-ws-cdl-10-20051109/</a></dd><dt>Latest version:</dt><dd><a href="http://www.w3.org/TR/ws-cdl-10/">http://www.w3.org/TR/ws-cdl-10/</a></dd><dt>Previous version:</dt><dd><a href="http://www.w3.org/TR/2004/WD-ws-cdl-10-20041217/">http://www.w3.org/TR/2004/WD-ws-cdl-10-20041217/</a></dd><dt>Editors:</dt><dd>Nickolas Kavantzas, Oracle</dd><dd>David Burdett, Commerce One</dd><dd>Gregory Ritzinger, Novell</dd><dd>Tony Fletcher, Choreology</dd><dd>Yves Lafon, W3C</dd><dd>Charlton Barreto, Adobe Systems Incorporated</dd></dl><p class="copyright"><a href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> © 2005 <a href="http://www.w3.org/"><acronym title="World Wide Web Consortium">W3C</acronym></a><sup>®</sup> (<a href="http://www.csail.mit.edu/"><acronym title="Massachusetts Institute of Technology">MIT</acronym></a>, <a href="http://www.ercim.org/"><acronym title="European Research Consortium for Informatics and Mathematics">ERCIM</acronym></a>, <a href="http://www.keio.ac.jp/">Keio</a>), All Rights Reserved. W3C <a href="http://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>, <a href="http://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and <a href="http://www.w3.org/Consortium/Legal/copyright-documents">document use</a> rules apply.</p></div><hr /><div>
<h2><a name="abstract" id="abstract"></a>Abstract</h2><p>The Web Services Choreography Description Language (WS-CDL) is an XML-based language that describes peer-to-peer collaborations of participants by defining, from a global viewpoint, their common and complementary observable behavior; where ordered message exchanges result in accomplishing a common business goal.</p><p>The Web Services specifications offer a communication bridge between the heterogeneous computational environments used to develop and host applications. The future of E-Business applications requires the ability to perform long-lived, peer-to-peer collaborations between the participating services, within or across the trusted domains of an organization.</p><p>The Web Services Choreography specification is targeted for composing interoperable, peer-to-peer collaborations between any type of participant regardless of the supporting platform or programming model used by the implementation of the hosting environment.</p></div><div>
<h2><a name="status" id="status"></a>Status of this Document</h2><p><em>This section describes the status of this document at the time of its publication. Other documents may supersede this document. A list of current W3C publications and the latest revision of this technical report can be found in the <a href="http://www.w3.org/TR/">W3C technical reports index</a> at http://www.w3.org/TR/.</em></p><p>This is the 9 November 2005 W3C Candidate Recommendation of "Web Services Choreography Description Language, Version 1.0". W3C publishes a technical report as a Candidate Recommendation to indicate that the document is believed to be stable and to encourage implementation by the developer community. Candidate Recommendation status is described in section 7.1.1 of the Process Document. Comments can be sent until 31 March 2006. Comments on this document should be sent to <a href="mailto:public-ws-chor-comments@w3.org">public-ws-chor-comments@w3.org</a> (<a href="http://lists.w3.org/Archives/Public/public-ws-chor-comments/">public archive</a>). It is inappropriate to send discussion emails to this address.</p><p>Discussion of this document takes place on the public <a href="mailto:public-ws-chor@w3.org">public-ws-chor@w3.org</a> mailing list (<a href="http://lists.w3.org/Archives/Public/public-ws-chor/">public archive</a>) per the email communication rules in the <a href="http://www.w3.org/2003/01/wscwg-charter">Web Services Choreography Working Group charter</a>.</p><p>It has been produced by the <a href="http://www.w3.org/2002/ws/chor/">Web Services Choreography Working Group</a>, which is part of the <a href="http://www.w3.org/2002/ws/Activity">Web Services Activity</a>.</p><p>This document is a chartered deliverable of the <a href="http://www.w3.org/2002/ws/chor/">Web Services Choreography Working Group</a>. Issues are recorded in the group's <a href="http://www.w3.org/2002/ws/chor/#issues">issue section</a>.</p><p> This document is based upon the <a href="http://www.w3.org/TR/2004/WD-ws-cdl-10-20041217/">Last Call Working Draft published on 17 December 2004</a>. Changes between these two versions are described in a <a href="diff.html">diff document</a>.</p><p>The specific entrance criteria to the Proposed Recommendation phase shall be as follows:<br />
There MUST be examples that exhibit all of the key features of WS-CDL 
such that the examples:
</p><ul><li>Can demonstrate that they are valid WS-CDL according to the 
specification.</li><li>Involve more than one role.</li><li>End points have been generated from two different implementations.</li><li>End points created from the examples run in at least two different 
platforms.</li><li>The end points created can be shown to interoperate correctly 
according to the WS-CDL description.</li></ul><p>Where "valid WS-CDL" means that it conforms to the specification both 
in terms of the schema and the operational semantics of WS-CDL.<br />
Where "implementations" mean tools that process WS-CDL documents and produce end-point(s). <br />
Where "end point" means a web service.<br />
Where "platform" means a software stack capable of supporting the 
execution of a web service.<br />
Where "interoperate" means two web services playing at least two 
distinct roles.<br />
Interoperability concerns such as alignment protocol, coordination protocol 
and adressing are implementation details.
</p><p>
Detailed implementation requirements and the invitation for participation in the Implementation 
Report are provided in the <a href="http://www.w3.org/2002/ws/chor/5/10/impl-report/Overview.html">Implementation Report Plan</a></p><p>This document has been produced under the 
<a href="http://www.w3.org/TR/2002/NOTE-patent-practice-20020124">24 January 2002 CPP</a> as amended 
by the <a href="http://www.w3.org/2004/02/05-pp-transition">W3C Patent Policy Transition Procedure</a>. 
An individual who has actual knowledge of a patent which the individual believes contains Essential Claim(s)
 with respect to this specification should disclose the information in accordance with section 6 of the 
<a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#sec-Disclosure">W3C Patent Policy</a>. 
Patent disclosures relevant to this specification may be found on the Working Group's 
<a href="http://www.w3.org/2002/ws/chor/3/01/17-IPR-statements.html">patent disclosure page</a>.</p><p>Publication as a Candidate Recommendation does not imply endorsement by the W3C Membership. This is a draft document and may be updated, replaced or obsoleted by other documents at any time. It is inappropriate to cite this document as other than work in progress.</p></div><div class="toc">
<h2><a name="contents" id="contents"></a>Table of Contents</h2><p class="toc">1 <a href="#Introduction">
Introduction</a><br />
    1.1 <a href="#Notational-Conventions">
Notational Conventions</a><br />
    1.2 <a href="#Purpose-of-WS-CDL">
Purpose of WS-CDL</a><br />
    1.3 <a href="#Goals">
Goals</a><br />
    1.4 <a href="#Relationship-with-XML-and-WSDL">
Relationship with XML and WSDL</a><br />
    1.5 <a href="#Relationship-with-Business-Process-Languages">
Relationship with Business Process Languages</a><br />
    1.6 <a href="#Time-Assumptions">
Time Assumptions</a><br />
    1.7 <a href="#Authoritative-Schema">
Authoritative Schema</a><br />
2 <a href="#WS-CDL-Model-Overview">
WS-CDL Model Overview</a><br />
3 <a href="#WS-CDL-Document-Structure">
WS-CDL Document Structure</a><br />
    3.1 <a href="#Choreography-Package">
Choreography Package</a><br />
    3.2 <a href="#Including-WS-CDL-Type-Definitions">
Including WS-CDL Type Definitions</a><br />
    3.3 <a href="#WS-CDL-document-Naming-and-Linking">
WS-CDL document Naming and Linking</a><br />
    3.4 <a href="#Language-Extensibility">
Language Extensibility</a><br />
    3.5 <a href="#Semantics">
Semantics</a><br />
4 <a href="#Collaborating-Participants">
Collaborating Participants</a><br />
    4.1 <a href="#RoleType">
RoleType</a><br />
    4.2 <a href="#RelationshipType">
RelationshipType</a><br />
    4.3 <a href="#ParticipantType">
ParticipantType</a><br />
    4.4 <a href="#ChannelType">
ChannelType</a><br />
5 <a href="#Information-Driven-Collaborations">
Information Driven Collaborations</a><br />
    5.1 <a href="#InformationType">
InformationType</a><br />
    5.2 <a href="#Variables">
Variables</a><br />
    5.3 <a href="#Expressions">
Expressions</a><br />
        5.3.1 <a href="#WS-CDL-Supplied-Functions">
WS-CDL Supplied Functions</a><br />
    5.4 <a href="#Token-and-TokenLocator">
Token and TokenLocator</a><br />
    5.5 <a href="#Choreography">
Choreography</a><br />
    5.6 <a href="#WorkUnit">
WorkUnit</a><br />
    5.7 <a href="#Choreography-Life-line">
Choreography Life-line</a><br />
    5.8 <a href="#Choreography-Exception-Handling">
Choreography Exception Handling</a><br />
    5.9 <a href="#Choreography-Finalization">
Choreography Finalization</a><br />
    5.10 <a href="#Choreography-Coordination">
Choreography Coordination</a><br />
6 <a href="#Activities">
Activities</a><br />
    6.1 <a href="#Ordering-Structures">
Ordering Structures</a><br />
        6.1.1 <a href="#Sequence">
Sequence</a><br />
        6.1.2 <a href="#Parallel">
Parallel</a><br />
        6.1.3 <a href="#Choice">
Choice</a><br />
    6.2 <a href="#Interacting">
Interacting</a><br />
        6.2.1 <a href="#Interaction-Based-Information-Alignment">
Interaction Based Information Alignment</a><br />
        6.2.2 <a href="#Interaction-Life-line">
Interaction Life-line</a><br />
        6.2.3 <a href="#Interaction-Syntax">
Interaction Syntax</a><br />
    6.3 <a href="#Composing-Choreographies">
Composing Choreographies</a><br />
    6.4 <a href="#Assigning-Variables">
Assigning Variables</a><br />
    6.5 <a href="#Marking-Silent-Actions">
Marking Silent Actions</a><br />
    6.6 <a href="#Marking-the-Absence-of-Actions">
Marking the Absence of Actions</a><br />
    6.7 <a href="#Finalizing-a-Choreography">
Finalizing a Choreography</a><br />
7 <a href="#Interoperability-with-other-Specifications">
Interoperability with other Specifications</a><br />
    7.1 <a href="#Interoperability-with-Security-frameworks">
Interoperability with Security frameworks</a><br />
    7.2 <a href="#Interoperability-with-Reliable-Messaging-frameworks">
Interoperability with Reliable Messaging frameworks</a><br />
    7.3 <a href="#Interoperability-with-Coordination-frameworks">
Interoperability with Coordination frameworks</a><br />
    7.4 <a href="#Interoperability-with-Addressing-frameworks">
Interoperability with Addressing frameworks</a><br />
8 <a href="#Conformance">
Conformance</a><br />
    8.1 <a href="#Conforming-WS-CDL-documents">
Conforming WS-CDL documents</a><br />
    8.2 <a href="#Endpoint-conformance">
Endpoint conformance</a><br />
9 <a href="#Acknowledgments">
Acknowledgments</a><br />
10 <a href="#References">
References</a><br />
    10.1 <a href="#refs-norm">Normative References</a><br />
    10.2 <a href="#refs-inform">Informative References</a><br />
</p>
<h3><a name="appendices" id="appendices"></a>Appendices</h3><p class="toc">A <a href="#Mime-Type-definition">
Mime Type definition</a><br />
B <a href="#WS-CDL-XSD-Schemas">
WS-CDL XSD Schemas</a><br />
</p></div><hr /><div class="body"><div class="div1">
<h2><a name="Introduction" id="Introduction"></a>1 
Introduction</h2><p>For many years, organizations have been developing solutions for automating their peer-to-peer collaborations, within or across their trusted domain, in an effort to improve productivity and reduce operating costs.</p><p>The past few years have seen the Extensible Markup Language (XML) and the Web Services framework developing as the de facto choices for describing interoperable data and platform neutral business interfaces, enabling more open business transactions to be developed.</p><p>Web Services are a key component of the emerging, loosely coupled, Web-based computing architecture. A Web Service is an autonomous, standards-based component whose public interfaces are defined and described using XML. Other systems may interact with a Web Service in a manner prescribed by its definition, using XML based messages conveyed by Internet protocols.</p><p>The Web Services specifications offer a communication bridge between the heterogeneous computational environments used to develop and host applications. The future of E-Business applications requires the ability to perform long-lived, peer-to-peer collaborations between the participating services, within or across the trusted domains of an organization.</p><p>The Web Service architecture stack targeted for integrating interacting applications consists of the following components:</p><ul><li><p><em>SOAP</em>: defines the basic formatting of a message and the basic delivery options independent of programming language, operating system, or platform. A SOAP compliant Web Service knows how to send and receive SOAP-based messages</p>
</li><li><p><em>Web Services Description Language (WSDL)</em>: describes the static interface of a Web Service. It defines the message set and the message characteristics of end points. Data types are defined by XML Schema specification, which supports rich type definitions and allows expressing any kind of XML type requirement for the application data (Note: WSDL 2.0 also supports types defined in other systems such as DTD, RelaxNG and RDF)</p>
</li><li><p><em>Registry</em>: allows publishing the availability of a Web Service and its discovery from service requesters using sophisticated searching mechanisms</p>
</li><li><p><em>Security layer</em>: ensures that exchanged information are not modified or forged in a verifiable manner and that participants can be authenticated</p>
</li><li><p><em>Reliable Messaging layer</em>: provides exactly-once and guaranteed delivery of information exchanged between participants</p>
</li><li><p><em>Context, Coordination and Transaction layer</em>: defines interoperable mechanisms for propagating context of long-lived business transactions and enables participants to meet correctness requirements by following a global agreement protocol</p>
</li><li><p><em>Business Process Languages layer</em>: describes the execution logic of Web Services based applications by defining their control flows (such as conditional, sequential, parallel and exceptional execution) and prescribing the rules for consistently managing their non-observable data</p>
</li><li><p><em>Choreography layer</em>: describes collaborations of participants by defining from a global viewpoint their common and complementary observable behavior, where information exchanges occur, when the jointly agreed ordering rules are satisfied</p>
</li></ul><p>The Web Services Choreography specification is aimed at the composition of interoperable collaborations between any type of participant regardless of the supporting platform or programming model used by the implementation of the hosting environment.  A choreography description is the multi-participant contract that describes this composition from a global perspective. The Web Services Choreography Description Language (WS-CDL) is the means by which this technical contract is described.</p><div class="div2">
<h3><a name="Notational-Conventions" id="Notational-Conventions"></a>1.1 
Notational Conventions</h3><p>The keywords "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in RFC-2119 [<a href="#RFC2119">RFC2119</a>].</p><p>The following namespace prefixes are used throughout this document:</p><table border="1"><caption>Prefixes and Namespaces used in this specification</caption><tbody><tr><th>Prefix
</th><th>Namespace URI 
</th><th>Definition
</th></tr><tr><td>wsdl
</td><td>http://www.w3.org/2005/08/wsdl
</td><td>WSDL 2.0 namespace for WSDL framework.
</td></tr><tr><td>cdl
</td><td>http://www.w3.org/2005/10/cdl
</td><td>WSCDL namespace for Choreography Description Language.
</td></tr><tr><td>xsi
</td><td>http://www.w3.org/2001/XMLSchema-instance
</td><td>Instance namespace as defined by XSD [<a href="#XMLSchemaP1">XMLSchemaP1</a>].
</td></tr><tr><td>xsd
</td><td>http://www.w3.org/2001/XMLSchema
</td><td>Schema namespace as defined by XSD [<a href="#XMLSchemaP2">XMLSchemaP2</a>].
</td></tr><tr><td>tns
</td><td>(various)
</td><td>The "this namespace" (tns) prefix is used as a convention to refer to the current document.
</td></tr><tr><td>rns
</td><td>(various)
</td><td>A namespace prefix used to refer to an (example and fictitious) WSDL interface specification.
</td></tr><tr><td>(other)
</td><td>(various)
</td><td>All other namespace prefixes are examples only. In particular, URIs starting with "http://www.example.com" represent some application-dependent or context-dependent URIs [<a href="#RFC2396">RFC2396</a>].
</td></tr></tbody></table><p>This specification uses an <em>informal syntax</em> to describe the XML grammar of a WS-CDL document:</p><ul><li><p>The syntax appears as an XML instance, but the values indicate the data types instead of values. </p>
</li><li><p>Characters are appended to elements and attributes as follows: "?" (0 or 1), "*" (0 or more), "+" (1 or more). </p>
</li><li><p>Elements names ending in ". . ." (such as "&lt;element. . ./&gt;" or "&lt;element. . .&gt;") indicate that elements/attributes irrelevant to the context are being omitted. </p>
</li><li><p>Grammar in bold has not been introduced earlier in the document, or is of particular interest in an example. </p>
</li><li><p>"&lt;-- extensibility element --&gt;" is a placeholder for elements from some "other" namespace (like ##other in XSD). </p>
</li><li><p>The XML namespace prefixes (defined above) are used to indicate the namespace of the element being defined. </p>
</li><li><p>Examples starting with "&lt;?xml" contain enough information to conform to this specification; other examples are fragments and require additional information to be specified in order to conform. </p>
</li></ul><p>An XSD is provided as a formal definition of WS-CDL grammar (see Section 11).</p><p>Where there is any discrepancy between the text of this specification, the fragments of informal schema and the full formal schema in the appendix then it is an error in the specification. Should such an error come to light please notify W3C. While awaiting resolution, the text takes priority over the formal schema in the appendix, which takes priority over the informal schema fragments.</p></div><div class="div2">
<h3><a name="Purpose-of-WS-CDL" id="Purpose-of-WS-CDL"></a>1.2 
Purpose of WS-CDL</h3><p>Business or other activities that involve different organizations or independent processes are engaged in a collaborative fashion to achieve a common business goal, such as <em>Order Fulfillment</em>.</p><p>For the collaboration to work successfully, the rules of engagement between all the interacting participants must be provided. Whereas today these rules are frequently written in English, a standardized way for precisely defining these interactions, leaving unambiguous documentation of the participants and responsibilities of each, is missing.</p><p>The WS-CDL specification is aimed at being able to precisely describe collaborations between any type of participant regardless of the supporting platform or programming model used by the implementation of the hosting environment.</p><p>Using the WS-CDL specification, a contract containing a "global" definition of the common ordering conditions and constraints under which messages are exchanged, is produced that describes, from a global viewpoint, the common and complementary observable behavior of all the participants involved. Each participant can then use the global definition to build and test solutions that conform to it. The global specification is in turn realized by combination of the resulting local systems, on the basis of appropriate infrastructure support.</p><p>The advantage of a contract based on a global viewpoint as opposed to any one endpoint is that it separates the overall "global" process being followed by an individual business or system within a "domain of control" (an endpoint) from the definition of the sequences in which each business or system exchanges information with others. This means that, as long as the "observable" sequences do not change, the rules and logic followed within a domain of control (endpoint) can change at will and interoperability is therefore guaranteed.</p><p>In real-world scenarios, corporate entities are often unwilling to delegate control of their business processes to their integration partners. Choreography offers a means by which the rules of participation within a collaboration can be clearly defined and agreed to, jointly. Each entity may then implement its portion of the choreography as determined by the common or global view. It is the intent of WS-CDL that the conformance of each implementation to the common view expressed therein is easy to determine.</p><p>The figure below demonstrates a possible usage of WS-CDL.</p><p></p><p> </p><img src="figure1.png" alt="Integrating Web Services based applications using WS-CDL" /><p>In Figure 1, Company A and Company B wish to integrate their Web Services based applications. The respective business analysts at both companies agree upon the services involved in the collaboration, their interactions, and their common ordering and constraint rules under which the interactions occur. They then generate a WS-CDL based representation. In this example, a choreography specifies the interactions between services across business entities ensuring interoperability, while leaving actual implementation decisions in the hands of each individual company:</p><ul><li><p>Company "A" relies on a WS-BPEL [<a href="#WSBPEL">WSBPEL</a>] solution to implement its own part of the choreography</p>
</li><li><p>Company "B", having greater legacy driven integration needs, relies on a J2EE [<a href="#J2EE">J2EE</a>] solution incorporating Java and Enterprise Java Bean Components or a .NET [<a href="#ECMA334">C#S</a>] solution incorporating C# to implement its own part of the choreography</p>
</li></ul><p>Similarly, a choreography can specify the interoperability and interactions between services within one business entity.</p></div><div class="div2">
<h3><a name="Goals" id="Goals"></a>1.3 
Goals</h3><p>The primary goal of the WS-CDL specification is to specify a declarative, XML based language that defines from a global viewpoint the common and complementary observable behavior specifically, the information exchanges that occur and the jointly agreed ordering rules that need to be satisfied.</p><p>More specifically, the goals of the WS-CDL specification are to permit: </p><ul><li><p><em>Reusability</em>. The same choreography definition is usable by different participants operating in different contexts (industry, locale, etc.) with different software (e.g. application software) </p>
</li><li><p><em>Cooperation</em>. Choreographies define the sequence of exchanging messages between two (or more) independent participants or processes by describing how they should cooperate</p>
</li><li><p><em>Multi-Party Collaboration</em>. Choreographies can be defined involving any number of participants or processes</p>
</li><li><p><em>Semantics</em>. Choreographies can include human-readable documentation and semantics for all the components in the choreography</p>
</li><li><p><em>Composability</em>. Existing choreographies can be combined to form new choreographies that may be reused in different contexts</p>
</li><li><p><em>Modularity</em>. Choreographies can be defined using an "inclusion" facility that allows a choreography to be created from parts contained in several different choreographies</p>
</li><li><p><em>Information Driven Collaboration</em>. Choreographies describe how participants make progress within a collaboration, through the recording of exchanged information and changes to observable information that cause ordering constraints to be fulfilled and progress to be made</p>
</li><li><p><em>Information Alignment</em>. Choreographies allow the participants that take part in choreographies to communicate and synchronize their observable information</p>
</li><li><p><em>Exception Handling</em>. Choreographies can define how exceptional or unusual conditions that occur while the choreography is performed are handled</p>
</li><li><p><em>Transactionality</em>. The processes or participants that take part in a choreography can work in a "transactional" way with the ability to coordinate the outcome of the long-lived collaborations, which include multiple participants, each with their own, non-observable business rules and goals</p>
</li><li><p><em>Specification Composability</em>. This specification is intended to work alongside and/or complement other specifications such as the WS-Reliability [<a href="#WSRM">WSRM</a>], WS-Composite Application Framework (WS-CAF) [<a href="#WSCAF">WSCAF</a>], WS-Security [<a href="#WSS">WSS</a>], Business Process Execution Language for WS (WS-BPEL) [<a href="#WSBPEL">WSBPEL</a>], ebXML Business Process Specification Schema [<a href="#ebBP20">ebBP20</a>], [<a href="#BPSS11">BPSS11</a>], etc.</p>
</li></ul></div><div class="div2">
<h3><a name="Relationship-with-XML-and-WSDL" id="Relationship-with-XML-and-WSDL"></a>1.4 
Relationship with XML and WSDL</h3><p>The WS-CDL specification depends on the following specifications: XML 1.0 [<a href="#XML">XML</a>], XML-Namespaces [<a href="#XMLNS">XMLNS</a>], XML-Schema 1.0 [<a href="#XMLSchemaP1">XMLSchemaP1</a>], [<a href="#XMLSchemaP2">XMLSchemaP2</a>] and XPath 1.0 [<a href="#XPTRF">XPTRF</a>]. Support for including and referencing service definitions given in WSDL 2.0 [<a href="#wsdl20">WSDL20</a>] is a normative part of the WS-CDL specification. In addition, support for including and referencing service definitions given in WSDL 1.1 as constrained by WS-I Basic Profile [<a href="#BP11">BP11</a>] is a normative part of the WS-CDL specification.</p></div><div class="div2">
<h3><a name="Relationship-with-Business-Process-Languages" id="Relationship-with-Business-Process-Languages"></a>1.5 
Relationship with Business Process Languages</h3><p>WS-CDL is not an "executable business process description language" or an implementation language. The role of specifying the execution logic of an application will be covered by these [<a href="#XLANG">XLANG</a>], [<a href="#WSFL">WSFL</a>], [<a href="#WSBPEL">WSBPEL</a>], [<a href="#BPML">BPML</a>], [<a href="#XPDL">XPDL</a>], [<a href="#JavaLS">JLS</a>], [<a href="#ECMA334">C#S</a>] and other specifications.</p><p>WS-CDL does not depend on a specific business process implementation language. Thus, it can be used to specify truly interoperable, collaborations between any type of participant regardless of the supporting platform or programming model used by the implementation of the hosting environment. WS-CDL may couple with other languages such as those that add further computable semantic definitions.</p><p>Each participant, adhering to a WS-CDL collaboration representation, could be implemented using completely different mechanisms such as:</p><ul><li><p>Applications, whose implementation is based on executable business process languages [<a href="#XLANG">XLANG</a>], [<a href="#WSFL">WSFL</a>], [<a href="#WSBPEL">WSBPEL</a>], [<a href="#BPML">BPML</a>], [<a href="#XPDL">XPDL</a>] </p>
</li><li><p>Applications, whose implementation is based on general purpose programming languages [<a href="#JavaLS">JLS</a>], [<a href="#ECMA334">C#S</a>] </p>
</li><li><p>Or human controlled software agents</p>
</li></ul><p></p></div><div class="div2">
<h3><a name="Time-Assumptions" id="Time-Assumptions"></a>1.6 
Time Assumptions</h3><p>Clock synchronization is unspecified in the WS-CDL technical specification and is considered design-specific. In specific environments between involved participants, it can be assumed that all participants are reasonably well synchronized on second time boundaries. However, finer grained time synchronization within or across participants, or additional support or control are undefined and outside the scope of the WS-CDL specification.</p></div><div class="div2">
<h3><a name="Authoritative-Schema" id="Authoritative-Schema"></a>1.7 
Authoritative Schema</h3><p>In the event of any ambiguity or differentiation between the WS-CDL fragments and the appendix with the full schema, the full schema takes precedence.</p></div></div><div class="div1">
<h2><a name="WS-CDL-Model-Overview" id="WS-CDL-Model-Overview"></a>2 
WS-CDL Model Overview</h2><p>WS-CDL describes interoperable, peer-to-peer collaborations between participants. In order to facilitate these collaborations, services commit to mutual responsibilities by establishing formal relationships. Their collaboration takes place in a jointly agreed set of ordering and constraint rules, whereby information is exchanged between the participants.</p><p>The WS-CDL model consists of the following entities:</p><ul><li><p><em>roleType, relationshipType and participantType</em> - Within a choreography, information is always exchanged between participants within or across trust boundaries. All interactions occur between roles being exhibited by participants, and are constrained by a relationship. Within WS-CDL, a participant is abstractly modeled by a participantType, a role by a roleType, and a relationship by a relationshipType:</p>
<ul><li>A participantType groups together those parts of the observable behavior that must be implemented by the same logical entity or abstract organization</li><li>A roleType enumerates potential observable behavior a participantType can exhibit in order to interact</li><li>A relationshipType identifies the mutual commitments that must be made for collaborations to be successful</li></ul></li><li><p><em>informationType, variable and token</em> - A variable contains information about commonly observable objects in a collaboration, such as the information exchanged or the observable information of the roleTypes involved. A token is an alias that can be used to reference parts of a variable. Information exchange variables, state capturing variables and tokens have informationTypes that define the type of information the variable contains or the token references</p>
</li><li><p><em>choreography</em> - A choreography defines collaborations between interacting participantTypes:</p>
<ul><li><em>choreography life-line</em>
 - The choreography life-line expresses the progression of a collaboration. Initially, the collaboration is established between participants, then work is performed within it and finally it completes either normally or abnormally</li><li><em>choreography exception blocks</em> - An exception block specifies what additional actions should occur when a choreography behaves in an abnormal way</li><li><em>choreography finalizer blocks</em> - A finalizer block specifies additional actions that should occur to modify the effect of an earlier successfully completed choreography, for example to confirm or undo the effect</li></ul></li><li><p><em>channelType</em> - A channel realizes a point of collaboration between participantTypes by specifying where and how information is exchanged. Within WS-CDL, channels are abstractly modeled as channelTypes</p>
</li><li><p><em>workunit</em> - A workunit prescribes the constraints that must be fulfilled for making progress, and thus performing work, within a choreography</p>
</li><li><p><em>activities and ordering structures</em> - Activities describe the actions performed within a choreography. Ordering structures combine activities with other ordering structures in a nested structure to express the ordering rules of actions performed within a choreography</p>
</li><li><p><em>interaction activity</em> - An interaction is the basic building block of a choreography. It results in an exchange of information between participants and possible synchronization of their observable information changes</p>
</li><li><p><em>semantics</em> - Semantics allow the creation of descriptions that can record the semantic definitions of every component in the model</p>
</li></ul></div><div class="div1">
<h2><a name="WS-CDL-Document-Structure" id="WS-CDL-Document-Structure"></a>3 
WS-CDL Document Structure</h2><p>A WS-CDL document is simply a set of definitions. Each definition is a named construct that can be referenced. There is a <em>package</em> element at the root, and the individual choreography type definitions inside.</p><div class="div2">
<h3><a name="Choreography-Package" id="Choreography-Package"></a>3.1 
Choreography Package</h3><p>A <em>choreography package</em> aggregates a set of WS-CDL type definitions, provides a namespace for the definitions and through the use of XInclude [<a href="#xinclude">XInclude</a>], MAY syntactically include WS-CDL type definitions that are defined in other choreography packages.</p><p>The syntax of the <em>package</em> construct is: </p><div class="exampleInner"><pre>&lt;package  
   name="NCName" 
   author="xsd:string"?
   version="xsd:string"?
   targetNamespace="uri"
   xmlns="http://www.w3.org/2005/10/cdl"&gt;

   &lt;informationType/&gt;*
   &lt;token/&gt;*
   &lt;tokenLocator/&gt;*
   &lt;roleType/&gt;*
   &lt;relationshipType/&gt;*
   &lt;participantType/&gt;*
   &lt;channelType/&gt;*

   Choreography-Notation*
&lt;/package&gt;
</pre></div><p>The choreography package contains the following WS-CDL type definitions:</p><ul><li><p>Zero or more informationTypes</p>
</li><li><p>Zero or more tokens and token locators</p>
</li><li><p>Zero or more roleTypes</p>
</li><li><p>Zero or more relationshipTypes</p>
</li><li><p>Zero or more participantTypes</p>
</li><li><p>Zero or more channelTypes</p>
</li><li><p>Zero or more package-level choreographies</p>
</li></ul><p>The top-level attributes <code>name</code>
, <code>author</code>
, and <code>version</code>
 define authoring properties of the choreography document.</p><p>The <code> targetNamespace</code>
 attribute provides the namespace associated with all WS-CDL type definitions contained in this choreography package. WS-CDL type definitions included in this package, using the inclusion mechanism, MAY be associated with other namespaces.</p><p>The elements <code>informationType</code>
, <code>token</code>
, <code>tokenLocator</code>
, <code>roleType</code>
, <code>relationshipType</code>
, <code>participantType</code>
 and <code>channelType</code>
 MAY be used as elements by all the choreographies defined within this choreography package.</p></div><div class="div2">
<h3><a name="Including-WS-CDL-Type-Definitions" id="Including-WS-CDL-Type-Definitions"></a>3.2 
Including WS-CDL Type Definitions</h3><p>WS-CDL type definitions or fragments of WS-CDL type definitions can be syntactically reused in any WS-CDL type definition by using XInclude [<a href="#xinclude">XInclude</a>]. The assembly of large WS-CDL type definitions from multiple smaller, well-formed WS-CDL type definitions or WS-CDL type definitions fragments is enabled using this mechanism.</p><p>Inclusion of fragments of other WS-CDL type definitions should be done carefully in order to avoid duplicate definitions (variables, blocks, etc.). A WS-CDL processor MUST ensure that the document is a conforming WS-CDL document [<a href="#Conforming-WS-CDL-documents">Conforming Document</a>]. It MAY verify that the document conforms to the provided schema [<a href="#WS-CDL-XSD-Schemas">WS-CDL Schema</a>].</p><p>The example below shows some possible syntactic reuses of WS-CDL type definitions. </p><div class="exampleOuter"><div class="exampleInner"><pre>&lt;choreography name="newChoreography" root="true"&gt;
...
   &lt;variable name="newVariable" informationType="someType"
             roleType="randomRoleType"/&gt;
   &lt;xi:include href="genericVariableDefinitions.xml"/&gt;
   &lt;xi:include href="otherChoreography.xml"
               xpointer="xpointer(//choreography/variable[1])"/&gt;
... 
&lt;/choreography&gt;
</pre></div></div></div><div class="div2">
<h3><a name="WS-CDL-document-Naming-and-Linking" id="WS-CDL-document-Naming-and-Linking"></a>3.3 
WS-CDL document Naming and Linking</h3><p>WS-CDL documents MUST be assigned a name attribute of type NCNAME that serves as a lightweight form of documentation.</p><p>The <code>targetNamespace</code>
 attribute of type URI MUST be specified.</p><p>The URI MUST NOT be a relative URI.</p><p>A reference to a definition MUST be made using a "QName".</p><p>Each WS-CDL type definition has its own name scope.</p><p>Names within a name scope MUST be unique within the WS-CDL document.</p><p>The resolution of a "QName" in WS-CDL is similar to the resolution of a "QName" as described by the XML Schemas specification [<a href="#XMLSchemaP1">XMLSchemaP1</a>].</p></div><div class="div2">
<h3><a name="Language-Extensibility" id="Language-Extensibility"></a>3.4 
Language Extensibility</h3><p>To support extending the WS-CDL language, this specification allows the use of extensibility elements and/or attributes defined in other XML namespaces inside any WS-CDL language element. </p><p>Extensibility elements and/or attributes MUST use an XML namespace different from that of WS-CDL. </p><p>All extension namespaces used in a WS-CDL document MUST be declared.</p><p>Extensions MUST NOT contradict the semantics of any element or attribute from the WS-CDL namespace.</p></div><div class="div2">
<h3><a name="Semantics" id="Semantics"></a>3.5 
Semantics</h3><p>Within a WS-CDL document, descriptions may reference semantic definitions and other documentation. The OPTIONAL <code>description</code>
 sub-element is allowed inside any WS-CDL language element. Descriptions MAY be text or document references defined in multiple different human readable languages. Where machine processable, WS-CDL parsers are not required to parse the contents of the <code>description</code>
 sub-element.</p><p>The information provided by the <code>description</code>
 sub-element will reference the descriptions in any or all of the following areas:</p><ul><li><p><em>Text</em>. Plain text, HTML or other non-encoded text formats may apply (e.g. text/plain, text/html, text/sgml,  text/xml, etc.).</p>
</li><li><p><em>Document Reference</em>. This MAY contain a URI to a document that more fully describes the component.</p>
</li><li><p><em>Machine Oriented Semantic Descriptions</em>. This MAY contain machine processable definitions in languages such as RDF [<a href="#RDF">RDF</a>] or OWL [<a href="#OWL">OWL</a>]. This description MAY contain a URI.</p>
</li></ul><p>The semantics of any element or attribute from the WS-CDL namespace SHOULD remain unchanged and MUST NOT be contradicted.</p></div></div><div class="div1">
<h2><a name="Collaborating-Participants" id="Collaborating-Participants"></a>4 
Collaborating Participants</h2><p>The WSDL specification [<a href="#wsdl20">WSDL20</a>] describes the functionality of a service provided by a participant based on a stateless, client-server model. The emerging Web Based applications require the ability to exchange information in a peer-to-peer environment. In these types of environments a participant represents a requester of services provided by another participant and is at the same time a provider of services requested from other participants, thus creating mutual multi-participant service dependencies.</p><p>A WS-CDL document describes how a participant is capable of engaging in collaborations with the same participant or with different participants.</p><p>The <em>roleTypes</em>, <em><em>relationshipTypes</em>
, participantTypes</em>, and <em>channelTypes</em>
 define collaborating participants and their coupling.</p><p>The <em>typeRef</em> complex type definitions used in <em>participantTypes</em>
, <em>relationshipTypes</em>, and <em>channelTypes</em>
 are different for each. They are type definitions for different local elements even though they have the same tag name. The text in the following sections describes the different attributes and child elements of each.</p><div class="div2">
<h3><a name="RoleType" id="RoleType"></a>4.1 
RoleType</h3><p>A <em>roleType</em> enumerates potential observable behavior a participant can exhibit in order to interact. For example, the "Buyer" roleType is associated with the purchasing of goods or services and the "Supplier" roleType is associated with providing those goods or services for a fee.</p><p>The syntax of the <em>roleType</em> construct is: </p><div class="exampleInner"><pre>&lt;roleType name="NCName"&gt;
   &lt;behavior name="NCName" interface="QName"? /&gt;+
&lt;/roleType&gt;
</pre></div><p>The attribute <code>name</code>
 is used to specify a distinct name for each <code>roleType</code>
 element declared within a choreography package.</p><p>Within the <code>roleType</code>
 element, a <code>behavior</code>
 element specifies a subset of the observable behavior a participant exhibits. A roleType MUST contain one or more <code>behavior</code>
 elements. The attribute <code>name</code>
 within the <code>behavior</code>
 element is used to specify a distinct name for each <code>behavior</code>
 element declared within a <code>roleType</code>
 element.</p><p>The <code>behavior</code>
 element defines an OPTIONAL <code>interface</code>
 attribute, which identifies a WSDL interface type. A <code>behavior</code>
 without an <code>interface</code>
 describes a roleType that is not required to support a specific Web Service interface.</p></div><div class="div2">
<h3><a name="RelationshipType" id="RelationshipType"></a>4.2 
RelationshipType</h3><p>A <em>relationshipType</em> identifies the roleTypes and behaviors, where mutual commitments MUST be made for collaborations to be successful. For example, the relationshipTypes between a "Buyer" and a "Seller" could include:</p><ul><li><p>A "Purchasing" relationshipType, for the initial procurement of goods or services, and</p>
</li><li><p>A "Customer Management" relationshipType to allow the "Supplier" to provide service and support after the goods have been purchased or the service provided</p>
</li></ul><p>Although relationshipTypes are always between two roleTypes, choreographies involving more than two roleTypes are possible. For example, if the purchase of goods involved a third-party "Shipper" contracted by the "Supplier" to deliver the "Supplier's" goods, then, in addition to the "Purchasing" and "Customer Management" relationshipTypes described above, the following relationshipTypes might exist:</p><ul><li><p>A "Logistics Provider" relationshipType between the "Supplier" and the "Shipper", and</p>
</li><li><p>A "Goods Delivery" relationshipType between the "Buyer" and the "Shipper"</p>
</li></ul><p>The syntax of the <em>relationshipType</em> construct is: </p><div class="exampleInner"><pre>&lt;relationshipType name="NCName"&gt;
   &lt;roleType typeRef="QName" behavior="list of NCName"? /&gt;
   &lt;roleType typeRef="QName" behavior="list of NCName"? /&gt;
&lt;/relationshipType&gt;
</pre></div><p>The attribute <code>name</code>
 is used to specify a distinct name for each <code>relationshipType</code>
 element declared within a choreography package.</p><p>A <code>relationshipType</code>
 element MUST have exactly two roleTypes defined. Each roleType is specified by the <code>typeRef</code>
 attribute within the <code>roleType</code>
 element. The "QName" value of the <code>typeRef</code>
 attribute of the <code>roleType</code>
 element MUST reference the name of a roleType.</p><p>Within each <code>roleType</code>
 element, the OPTIONAL attribute <code>behavior</code>
 identifies the commitment of a participant as an XML-Schema list of behavior types belonging to this roleType. If the <code>behavior</code>
 attribute is missing then all the behaviors belonging to this roleType are identified as the commitment of a participant. If the <code>behavior</code>
 attribute is present then the behaviors listed MUST be a proper subset of those belonging to this roleType.</p></div><div class="div2">
<h3><a name="ParticipantType" id="ParticipantType"></a>4.3 
ParticipantType</h3><p>A <em>participantType</em> groups together those parts of the observable behavior that MUST be implemented by a <em>participant</em>
 . A logical entity or organization MAY be represented by more than one participantType within a choreography.</p><p>The syntax of the <em>participantType</em> construct is: </p><div class="exampleInner"><pre>&lt;participantType name="NCName"&gt;
   &lt;roleType typeRef="QName" /&gt;+
&lt;/participantType&gt;
</pre></div><p>The attribute <code>name</code>
 is used to specify a distinct name for each <code>participantType</code>
 element declared within a choreography package.</p><p>Within the <code>participantType</code>
 element, one or more <code>roleType</code>
 elements identify the roleTypes that MUST be implemented by this participantType. Each roleType is specified by the <code>typeRef</code>
 attribute of the <code>roleType</code>
 element. The "QName" value of the <code>typeRef</code>
 attribute of the <code>roleType</code>
 element MUST reference the name of a roleType. A specific roleType MUST NOT be specified in more than one <code>participantType</code>
 element.</p><p>An example is shown below where the "SellerForBuyer" roleType belonging to a "Buyer-Seller" relationshipType is implemented by the participantType "Broker" which also implements the "SellerForShipper" roleType belonging to a "Seller-Shipper" relationshipType. </p><div class="exampleOuter"><div class="exampleInner"><pre>&lt;roleType name="Buyer"&gt;
   . . .
&lt;/roleType&gt;
&lt;roleType name="SellerForBuyer"&gt;
    &lt;behavior name="sellerForBuyer" interface="rns:sellerForBuyerPT"/&gt;
&lt;/roleType&gt;
&lt;roleType name="SellerForShipper"&gt;
    &lt;behavior name="sellerForShipper" interface="rns:sellerForShipperPT"/&gt;
&lt;/roleType&gt;
&lt;roleType name="Shipper"&gt;
   . . .
&lt;/roleType&gt;

&lt;relationshipType name="Buyer-Seller"&gt;
    &lt;roleType typeRef="tns:Buyer" /&gt;
    &lt;roleType typeRef="tns:SellerForBuyer" /&gt;
&lt;/relationshipType&gt;
&lt;relationshipType name="Seller-Shipper"&gt;
    &lt;roleType typeRef="tns:SellerForShipper" /&gt;
    &lt;roleType typeRef="tns:Shipper" /&gt;
&lt;/relationshipType&gt;

&lt;participantType name="Broker"&gt;
   &lt;roleType typeRef="tns:SellerForBuyer" /&gt;
   &lt;roleType typeRef="tns:SellerForShipper" /&gt;
&lt;/participantType&gt;
</pre></div></div></div><div class="div2">
<h3><a name="ChannelType" id="ChannelType"></a>4.4 
ChannelType</h3><p>A <em>channelType</em> realizes a point of collaboration between participantTypes by specifying where and how information is exchanged. Additionally, channelType instance information, captured within channel variables, can be passed among participants in information exchanges. The channelType instances exchanged MAY be used in subsequent interaction activities. This allows the modeling of both static and dynamic message destinations when collaborating within a choreography. For example, a "Buyer" could specify channelType instance information to be used for sending delivery information. The "Buyer" could then send this channelType instance information to the "Seller" who then forwards it to the "Shipper". The "Shipper" could then send delivery information directly to the "Buyer" using the channelType instance information originally supplied by the "Buyer".</p><p>A channelType MUST describe the roleType and the type of a participant reference, conveying the information needed to address the participant being the target of an information exchange, either a receiver of a request action or a sender of a reply action, which is used for determining where and how to send or receive information to or from the participant.</p><p>A channelType MAY describe the type of the instance identity of one or more logical conversations between participants, where each conversation groups a set of related information exchanges. The channelType instance identity can be used to correlate multiple conversations (channel instances) within the same choreography instance.</p><p>One or more channelType instances MAY be passed around from one participant to another in an information exchange. A channelType MAY be used to:</p><ul><li><p>Restrict the number of times an instance of this channelType can be used</p>
</li><li><p>Restrict the type of information exchange that can be performed when using an instance of this channelType</p>
</li><li><p>Restrict the channelTypes that will be passed through an instance of this channelType</p>
</li><li><p>Enforce that a passed channel instance is unique</p>
</li></ul><p>The syntax of the <em>channelType</em> construct is: </p><div class="exampleInner"><pre>&lt;channelType  name="NCName"
              usage="once"|"distinct"|"shared"?
              action="request-respond"|"request"|"respond"? &gt;

   &lt;passing  channel="QName"
             action="request-respond"|"request"|"respond"?
             new="true"|"false"? /&gt;*

   &lt;roleType typeRef="QName"  behavior="NCName"? /&gt;

   &lt;reference&gt;
      &lt;token name="QName"/&gt;
   &lt;/reference&gt;

   &lt;identity usage="primary"|"alternate"|"derived"|"association"&gt;
      &lt;token name="QName"/&gt;+
   &lt;identity&gt;*
&lt;/channelType&gt;
</pre></div><p>The attribute <code>name</code>
 is used to specify a distinct name for each <code>channelType</code>
 element declared within a choreography package.</p><p>The OPTIONAL attribute <code>usage</code>
 is used to constrain the way in which an instance of this channelType, can be used. The values that can be used for this attribute are:</p><ol><li><p>"once" - Once means that a channel instance of this channelType can be used for one interaction, or can be passed to another roleType. When a channel instance of this channelType is passed, the passer of the channel instance MUST relinquish control, for outputting only, of that instance and passes control to the receiver. A channel instance of this channelType MUST NOT be passed to more than one receiver at any one time.</p></li><li><p>"distinct" (default usage mode) - Distinct means that a channel instance of this channelType can be used multiple times by a participantType within multiple interactions. When a channel instance of this channelType is passed, the passer of the channel instance MUST relinquish control, for outputting only, of that instance and passes control to the receiver. A channel instance of this channelType MUST NOT be passed by a participantType to more than one receiver. In this mode, a participantType MUST NOT specify two or more concurrent interactions for the same channel instance with the same operation name.</p></li><li><p>"shared" - Shared means that a channel instance of this channelType can be used multiple times by multiple participantTypes within multiple interactions. When a channel instance of this channelType is passed, the participantType passing the channel instance MUST NOT relinquish control. In this mode, a participantType MUST NOT specify two or more concurrent interactions for the same channel instance with the same operation name.</p></li></ol><p>The OPTIONAL attribute <code>action</code>
 is used to restrict the type of information exchange that can be performed when using a channel instance of this channelType. The type of information exchange performed could either be a request-respond exchange, a request exchange, or a respond exchange. The default value for this attribute is "request".</p><p>The OPTIONAL element <code>passing</code>
 describes the channelTypes of the channel instances that are passed from one participant to another when using an information exchange on a channel instance of this channelType. The OPTIONAL attribute <code>action</code>
 within the <code>passing</code>
 element, defines when a channel instance MUST be passed, either during a request exchange, during a response exchange or both. The default value for this attribute is "request". The OPTIONAL attribute new within the <code>passing</code>
 element, when set to "true", enforces a passed channel instance to be always unique. If the element <code>passing</code>
 is missing, then this channelType MAY be used for exchanging information, but MUST NOT be used for passing channel instances of any channelType.</p><p>The element <code>roleType</code>
 is used to identify the roleType of a participant, being the type of the target of an information exchange, which is then used for statically determining where and how to send or receive information to or from the participant. Each roleType is specified by the <code>typeRef</code>
 attribute of the <code>roleType</code>
 element. The "QName" value of the <code>typeRef</code>
 attribute of the <code>roleType</code>
 element MUST reference the name of a roleType defined in the choreography package. Within the <code>roleType</code>
 element, the OPTIONAL attribute <code>behavior</code>
 identifies a specific observable behavior, belonging to the roleType that is the target of an information exchange. If the <code>behavior</code>
 attribute is missing, then any one of the behavior types belonging to this roleType MAY be the target of an information exchange. </p><p>The element <code>reference</code>
 is used to specify the type of a participant reference, conveying the information needed to address the participant being the target of an information exchange, which is used for dynamically determining where and how to send or receive information to or from the participant. The type of a participant reference is distinguished by a token, as specified by the <code>name</code>
 attribute of the <code>token</code>
 element within the <code>reference</code>
 element.</p><p>The OPTIONAL list of <code>identity</code>
 elements MAY be used to associate a unique identity for each instance of the channelType. The identity is defined by a set of tokens specified by the <code>name</code>
 attribute of the<code> token</code>
 element within the <code>identity</code>
 element. If two <code>identity</code>
 elements are specified within the same or different <code>channelType</code>
 elements, and they have the same set of named tokens in the same order, then they are considered to represent the same identity type.</p><p>The <code>identity</code>
 element has a mandatory <code>usage</code>
 attribute, which defines the purpose of the identity in the context of the channelType. The values for this attribute are:</p><ol><li><p>"primary" - The 'primary' usage classification means that the identity is created by the initial message on an instance of this channelType. A channelType must have only one 'primary' identity field.</p>
<p>An example for using this attribute is shown below.</p>
<p></p>

	<div class="exampleOuter"><div class="exampleInner"><pre>&lt;channelType name="OrderChannel"&gt;
  …
  &lt;identity usage="primary"&gt;
    &lt;token name="OrderId" /&gt;
  &lt;/identity&gt;
&lt;/channelType&gt;
</pre></div></div>
	<p>This means that all messages (requests and responses) exchanged on this "OrderChannel" must contain the 'OrderId' field.</p></li><li><p>"alternate" - The 'alternate' usage classification means that an alternative identity for a channelType instance can be established. The alternate identity can be initialized based on any message within the channel instance's conversation (i.e. it does not have to be the first). If it is not the first message, then the message must also contain either the channel instance's primary key, or another previously initialized alternate identity, to bind the identity to the channel instance. Once the alternate identity has been bound to the channel instance, subsequent messages that only contain that alternate identity will be correlated to the channel instance.</p>
<p>An example for using this attribute is shown below. </p>

	<div class="exampleOuter"><div class="exampleInner"><pre>&lt;channelType name="OrderChannel"&gt;
  …
  &lt;identity usage="primary"&gt;
    &lt;token name="OrderId" /&gt; 
  &lt;/identity&gt; 
  &lt;identity usage="alternate"&gt; 
    &lt;token name="TxnId" /&gt;
  &lt;/identity&gt;
&lt;/channelType&gt;
</pre></div></div>
	<p>In this example, an "OrderChannel" channel instance will be identified initially by the value of the 'OrderId' field. However, at some point in the conversation, a message will be exchanged containing the 'TxnId' field. Once this message has occurred, subsequent messages on this channel instance can be correlated based on either the primary 'OrderId' field, or the alternate 'TxnId' field.</p></li><li><p>"derived" - The 'derived' usage classification means that the identity will be derived from a message sent on the current channel instance (conversation), but it does not directly determine the identity of that current channel instance. Subsequently another channel instance (of the same or different channelType) will reference this identity value in its 'primary' identity field, and that will cause the referencing channel instance to become correlated with the current channel instance in the same choreography instance.</p>
<p>An example for using this attribute is shown below. </p>

	<div class="exampleOuter"><div class="exampleInner"><pre>&lt;channelType name="OrderChannel"&gt;
  …
  &lt;identity usage="primary"&gt;
    &lt;token name="OrderId" /&gt;
  &lt;/identity&gt;
  &lt;identity usage="derived"&gt;
    &lt;token name="DeliveryId" /&gt;
  &lt;/identity&gt;
&lt;/channelType&gt;

&lt;channelType name="DeliveryChannel"&gt;
  …
  &lt;identity usage="primary"&gt;
    &lt;token name="DeliveryId" /&gt;
  &lt;/identity&gt;
&lt;/channelType&gt;
</pre></div></div>
	<p>In this example, the 'OrderId' identifies the "OrderChannel" channel instance, and at some point during its conversation it will exchange a message that contains the 'DeliveryId' information. Although this identity is not relevant from the perspective of the "OrderChannel", it can subsequently be used to determine the identity of the "DeliveryChannel" channel instance, and consequently bind the "DeliveryChannel" instance to the same choreography instance as the original "OrderChannel" channel instance.</p></li><li><p>"association" - The 'association' usage classification means that this channel instance is correlated to a previous channel instance identity, and therefore is associated with the same choreography instance as the previous channel instance. An identity with this classification is not used to determine the identity of the current channel instance, only to establish the association with a previous channel instance within the same choreography instance. The identity can either relate to another identity definition (in another channelType) that has a usage classification of 'primary'/'alternate', or that has the 'derived' classification. The initial message in the channel instance MUST contain the information to resolve this identity field.</p>
<p>An example for using this attribute is shown below. </p>

	<div class="exampleOuter"><div class="exampleInner"><pre>&lt;channelType name="OrderChannel"&gt;
  …
  &lt;identity usage="primary"&gt;
    &lt;token name="OrderId" /&gt;
  &lt;/identity&gt;
&lt;/channelType&gt;

&lt;channelType name="SupplierChannel"&gt;
  …
  &lt;identity usage="association"&gt;
    &lt;token name="OrderId" /&gt;
  &lt;/identity&gt;

  &lt;identity usage="primary"&gt;
    &lt;token name="SupplierName" /&gt;
    &lt;token name="OrderId" /&gt;
  &lt;/identity&gt;
&lt;/channelType&gt;
</pre></div></div>
	<p>This example shows how a choreography can contain a single "OrderChannel" channel instance, and zero or more "SupplierChannel" channel instances correlated with it based on an 'association' to the identity established for the "OrderChannel" channel instance.</p></li></ol></div></div><div class="div1">
<h2><a name="Information-Driven-Collaborations" id="Information-Driven-Collaborations"></a>5 
Information Driven Collaborations</h2><p>Participants make progress within a collaboration when recordings of exchanged information are made, and changes to observable information occur, that then cause ordering constraints to be fulfilled. A WS-CDL document allows defining information within a choreography that can influence the observable behavior of the collaborating participants.</p><p><em>Variables</em> capture information about objects in the choreography, such as the information exchanged or the observable information of the roleTypes involved. <em>Tokens</em>
 are aliases that can be used to reference parts of a variable. Both variables and tokens have <em>informationTypes</em> that define the type of information the variable contains or the token references.</p><div class="div2">
<h3><a name="InformationType" id="InformationType"></a>5.1 
InformationType</h3><p>InformationTypes describe the type of information used within a choreography. By introducing this abstraction, a choreography definition avoids directly referencing the data types, as defined within a WSDL document or an XML Schema document.</p><p>The syntax of the <em>informationType</em> construct is: </p><div class="exampleInner"><pre>&lt;informationType name="NCName"
                 type="QName"?|element="QName"? /&gt;
</pre></div><p>The attribute <code>name</code>
 is used to specify a distinct name for each informationType element declared within a choreography package.</p><p>The OPTIONAL attributes <code>type</code>
 and <code>element</code>
 describe the type of information used within a choreography as a WSDL 1.1 Message Type, an XML Schema type, a WSDL 2.0 Schema element or an XML Schema element. The attributes <code>type</code>
 and <code>element</code>
 MUST be mutually exclusive.</p><p>The examples below show some possible usages of the informationType construct. </p><div class="exampleOuter"><div class="exampleInner"><pre>Example 1: The informationType "purchaseOrder" refers to the WSDL 1.1 Message type "pns:purchaseOrderMessage"

   &lt;informationType name="purchaseOrder" type="pns:purchaseOrderMessage"/&gt;

</pre></div></div><p><em></em>
</p><div class="exampleOuter"><div class="exampleInner"><pre>Example 2: The informationType "customerAddress" refers to the WSDL 2.0 Schema element "cns:CustomerAddress"

   &lt;informationType name="customerAddress" element="cns:CustomerAddress"/&gt;

</pre></div></div><p><em></em>
</p><div class="exampleOuter"><div class="exampleInner"><pre>Example 3: The informationType "intType" refers to the XML Schema type "xsd:int"

   &lt;informationType name="intType" type="xsd:int"/&gt;

</pre></div></div></div><div class="div2">
<h3><a name="Variables" id="Variables"></a>5.2 
Variables</h3><p>Variables capture information about objects in a choreography as defined by their usage:</p><ul><li><p><em>Information exchange capturing variables</em> contain information, such as an "Order", that are: </p>
<ul><li>Used to populate the content of a message to be sent, before or at the occurrence of message-has-been-sent-event or</li><li>Populated as a result of a message-received-event occurrence</li></ul></li><li><p><em>State capturing variables</em> contain information about the observable changes at a roleType as a result of information being exchanged. For example, when a "Buyer" sends an "Order" to a "Seller", the "Buyer" could have a variable called "OrderState" set to a value of 'OrderSent' and once the "Seller" received the message, the "Seller" could have a variable called "OrderState" set to a value of 'OrderReceived'. The "OrderState" at the "Buyer" is not the same variable as the "OrderState" at the "Seller"</p>
</li><li><p><em>Channel capturing variables</em> contain information such as: the "URL" to which the message could be sent, the policies that are to be applied (e.g. security), whether or not reliable messaging is to be used, etc. How and where such information is expressed is outside the scope of this specification</p>
</li><li><p><em>Exception capturing variables</em> contain information about a caused exception</p>
</li></ul><p></p><p>The value of a variable:</p><ul><li><p>Is available to roleTypes within a choreography, as specified in the variable Definition, and when the variable contains information that is common knowledge. For example, the variable "OrderResponseTime" which specifies the time in hours in which a response to an "Create Order" request must be sent is initialized prior to the initiation of a choreography and can be used by all roleTypes within the choreography, if the variable is defined for all roleTypes</p>
</li><li><p>Can be made available as a result of an interaction</p>
<ul><li>An information exchange capturing variable is populated and becomes available at the specified roleTypes at the ends of an interaction</li><li>State capturing variables, that contain information about the observable information changes of a roleType as a result of information being exchanged and recorded, which become available at the ends of an interaction</li></ul></li><li><p>Can be created or changed and made available locally at a roleType by assigning data from other information. It can be an information exchange, state or channel capturing variable. For example, "Maximum Order Amount" could be data created by a "Seller" that is used together with an actual "Order amount" from a "Create Order" request received at the "Seller" to control the ordering of the choreography. In this case how "Maximum Order Amount" is calculated and its value would not be known by the other roleTypes</p>
</li><li><p>Can be used to determine the decisions and actions to be taken within a choreography</p>
</li><li><p>That is defined at different roleTypes that are part of the same participantType is shared between these roleTypes when the variables have the same name</p>
</li></ul><p>If an uninitialized variable is used in any action, except for a blocking workunit or if used in the WS-CDL function <code>isVariableAvailable</code>
, then the result of the action is undefined.</p><p></p><p>The <em>variableDefinitions</em> construct is used for defining one or more variables within a choreography.</p><p>The syntax of the <em>variableDefinitions</em> construct is: </p><div class="exampleInner"><pre>&lt;variableDefinitions&gt;
   &lt;variable   name="NCName"
       informationType="QName"?|channelType="QName"?
       mutable="true|false"?
       free="true|false"?
       silent="true|false"?
       roleTypes="list of QName"? /&gt;+
&lt;/variableDefinitions&gt;
</pre></div><p>A variable defined using the attribute <code>informationType</code>
 specifies either information exchange capturing variables or state capturing variables. A variable defined using the attribute <code>channelType</code>
 specifies channel capturing variables. The attributes <code>informationType</code>
 and <code>channelType</code>
 MUST be mutually exclusive.</p><p>The OPTIONAL attribute <code>mutable</code>
, when set to "false", specifies that the variable information MUST NOT change once initialized. The default value for this attribute is "true".</p><p>The OPTIONAL attribute <code>silent</code>
, when set to "true" specifies that there SHOULD NOT be any activity used for creating or changing this variable in the choreography. A silent variable is used to represent the result of actions within a participant that are either not observable or are of no interest from the WS-CDL perspective. The default value for this attribute is "false".</p><p>The OPTIONAL attribute <code>free</code>
, when set to "true" specifies that a variable defined in an enclosing choreography is also used in this choreography, thus sharing the variable's information. The following rules apply in this case:</p><ul><li><p>The type (as specified by the <code>informationType</code>
 or the <code>channelType</code>
 attributes) of a free variable MUST match the type of the variable defined in an enclosing choreography</p>
</li><li><p>The attributes <code>silent</code>
 and <code>mutable</code>
 of a free variable MUST match the attributes <code>silent</code>
 and <code>mutable</code>
 of the variable defined in an enclosing choreography</p>
</li><li><p>A perform activity MUST bind a free variable defined in a performed choreography with a variable defined in a performing choreography</p>
</li></ul><p>The OPTIONAL attribute <code>free</code>
, when set to "false" specifies that the variable is defined in this choreography. The default value for the <code>free</code>
 attribute is "false".</p><p>The OPTIONAL attribute <code>roleTypes</code>
 is used to specify an XML-Schema list of one or more roleTypes of a participant at which the variable information will reside. A variable defined without a roleType is equivalent to a variable that is defined at all the roleTypes that are part of the relationshipTypes of the choreography where the variable is defined. For example, if choreography "choreo1" has relationshipType "rel" that has roleTypes "roleType1" and "roleType2", then a variable "var" defined in choreography "choreo1" without a <code>roleTypes</code>
 attribute means it is defined at both "roleType1" and "roleType2".</p><p>The attribute <code>name</code>
 is used to specify a distinct name for each variable declared within the <code>variableDefinitions</code>
 element. In those cases where the visibility of a variable is wholly within a single roleType, then that roleType needs to be named in the definition of the variable as the roleType using the attribute <code>roleTypes</code>
. In those cases where the variable is shared amongst a subset of roleTypes within a choreography, those roleTypes need to be listed within the definition of the variable as the roleTypes using the attribute <code>roleTypes</code>
.</p></div><div class="div2">
<h3><a name="Expressions" id="Expressions"></a>5.3 
Expressions</h3><p>Expressions can be used within WS-CDL to create new information, and to obtain or change existing information.</p><p>Generic expressions and literals can be used to populate variables. Predicate expressions can be used within WS-CDL to specify conditions. Query expressions are used within WS-CDL to specify queries.</p><p>The language used in WS-CDL for specifying expressions and queries or conditional predicates MUST be XPath 1.0.</p><p>WS-CDL defines a set of XPath 1.0 extension functions that implementers MUST support. The functions are defined in the standard WS-CDL namespace http://www.w3.org/2005/10/cdl. The prefix "cdl:" is associated with this namespace.</p><div class="div3">
<h4><a name="WS-CDL-Supplied-Functions" id="WS-CDL-Supplied-Functions"></a>5.3.1 
WS-CDL Supplied Functions</h4><p>There are several functions that the WS-CDL specification supplies as XPath 1.0 extension functions. These functions can be used in any XPath 1.0 expression as long as the types are compatible:</p><ul><li><p><em><em>xsd:time  getCurrentTime(xsd:QName  roleTypeName?)</em></em>
  Returns the current time at the caller. The caller is specified by the <em>roleTypeName</em> parameter (i.e. a roleType can ask only about it's own time). The <em>roleTypeName</em>
 parameter is OPTIONAL. When this parameter is used, the current time information MUST be available at the roleType specified by <em>roleTypeName</em>. If this parameter is not used then the roleType is inferred from the context that this function is used.</p>
</li><li><p><em><em>xsd:date  getCurrentDate(xsd:QName  roleTypeName?)</em></em>
  Returns the current date at the caller. The caller is specified by the <em>roleTypeName </em>parameter (i.e. a roleType can ask only about its own date). The <em>roleTypeName</em>
 parameter is OPTIONAL. When this parameter is used, the current date information MUST be available at the roleType specified by <em>roleTypeName</em>. If this parameter is not used then the roleType is inferred from the context that this function is used.</p>
</li><li><p><em><em>xsd:dateTime  getCurrentDateTime(xsd:QName  roleTypeName?)</em></em>
  Returns the current date and time at the caller. The caller is specified by the <em>roleTypeName </em> parameter (i.e. a roleType can ask only about its own date/time). The <em>roleTypeName</em>
 parameter is OPTIONAL. When this parameter is used, the current date and time information MUST be available at the roleType specified by <em>roleTypeName</em>. If this parameter is not used then the roleType is inferred from the context that this function is used.</p>
</li><li><p><em>xsd:Boolean  hasDurationPassed(xsd:duration  elapsedTime,  xsd:QName  roleTypeName?)</em>  Returns "true" if (a) used in a guard or repetition condition of a workunit with the <code>block</code>
 attribute set to "true" or in a complete condition of a choreography and (b) the duration specified by <em>elapsedTime</em> at the caller, specified by <em>roleTypeName</em>
 parameter, has elapsed from the time either the guard or the repetition condition were enabled for matching or the choreography was enabled. Otherwise it returns "false". The <em>roleTypeName</em> parameter is OPTIONAL. If this parameter is not used then the roleType is inferred from the context that this function is used. </p>
</li><li><p><em><em>xsd:Boolean  hasDeadlinePassed(xsd:dateTime  deadlineTime,  xsd:QName  roleTypeName?)</em></em>
  Returns "true" if (a) used in a guard or repetition condition of a workunit with the <code>block</code>
 attribute set to "true" or in a complete condition of a choreography and (b) the time specified by <em>deadlineTime</em> at the roleType, specified by the <em>roleTypeName</em>
 parameter, has elapsed given that either the guard or the repetition condition was enabled for matching or the choreography was enabled. Otherwise it returns "false". The roleTypeName parameter is OPTIONAL. If this parameter is not used then the roleType is inferred from the context that this function is used.</p>
</li><li><p><em><em>xsd:any  getVariable(xsd:string  varName,  xsd:string  part,  xsd:string  documentPath,  xsd:QName  roleTypeName?)</em></em>
  Returns the information of the variable with name <em>varName</em> as a node set containing a single node. The second parameter, <em>part</em>
, specifies the message part of a WSDL1.1 document. For a WSDL 2.0 document it MUST be empty. When the third parameter <em>documentPath</em> is empty, then this function retrieves the entire document from the variable information. When it is non-empty, then this function retrieves from the variable information, the fragment of the document at the provided absolute location path. The fourth parameter is OPTIONAL. When the fourth parameter is used, the variable information MUST be available at the roleType specified by <em>roleTypeName</em>
. If this parameter is not used then the roleType is inferred from the context that this function is used.</p>
</li><li><p><em><em>xsd:Boolean  isVariableAvailable(xsd:string  varName,  xsd:QName  roleTypeName?)</em></em>
  Returns "true" if the information of the variable with name <em>varName</em> is available at the roleType specified by <em>roleTypeName</em>
. Otherwise, returns "false". The <em>roleTypeName</em> parameter is OPTIONAL. When this parameter is used, the variable information MUST be available at the roleType specified by <em>roleTypeName</em>
. If this parameter is not used then the roleType is inferred from the context that this function is used.</p>
</li><li><p><em><em>xsd:boolean  variablesAligned(xsd:string  varName,  xsd:string  withVarName,  xsd:QName  relationshipTypeName)</em></em>
  Returns "true" if within a relationshipType specified by <em>relationshipTypeName</em> the variable with name <em>varName</em>
 residing at the first roleType of the relationshipType has aligned its information with the variable named <em>withVarName</em> residing at the second roleType of the relationshipType.</p>
</li><li><p><em><em>xsd:any  getChannelReference(xsd:string  varName)</em></em>
  Returns the reference information of the variable with name <em>varName</em>. The variable MUST be of channelType.</p>
</li><li><p><em><em>xsd:any  getChannelIdentity(xsd:string  varName)</em></em>
  Returns the identity information of the variable with name <em>varName</em>. The variable MUST be of channelType.</p>
</li><li><p><em><em>xsd:Boolean  globalizedTrigger(xsd:string  expression1,  xsd:string  roleTypeName1,  xsd:string  expression2,  xsd:string  roleTypeName2,  . . .)</em></em>
  Combines expressions that are defined at different roleTypes. Thus expression1 is defined in terms of variables at role1, expression2 is defined in terms of variables at role2, and so on. The globalizedTrigger function is evaluated at each roleType and becomes "true" at a roleType if, and only if, the expression evaluated at that roleType evaluates to "true".</p>
</li><li><p><em><em>xsd:boolean  hasExceptionOccurred(xsd:QName  exceptionType)</em></em>
  Returns "true" if an exception of the type identified by the parameter <em>exceptionType</em> has occurred. Otherwise it returns "false".</p>
</li><li><p><em>xsd:boolean hasChoreographyCompleted(xsd:string choreoName, xsd:string choreoInstanceId?)</em>  Returns true if the performed choreography associated with the parameter 'choreoName' and OPTIONAL <em>choreoInstanceId</em>
 has a status of completed (whether successfully or not). If choreoInstanceId is not specified, the function will evaluate whether all performed choreographies, with the supplied name, have completed. If the named choreography has not been performed, prior to this function being called, it will return false.</p>
</li><li><p><em>xsd:string getChoreographyStatus(xsd:string choreoName, xsd:string choreoInstanceId?)</em>  Returns the current status associated with the identified choreography and OPTIONAL <em>choreoInstanceId</em>
. If choreoInstanceId is not specified, then there MUST only be a single instance of that performed choreography in the scope of the current choreography that is checking the status, otherwise a status of 'ambiguous' MUST be returned. The values of the status can be 'enabled', 'completed-successfully', 'completed-unsuccessfully', 'closed', 'ambiguous', or 'instance-unknown'. The 'instance-unknown' status is encountered when this function is invoked and when the choreography has not been enabled. The other valid transitions of the choreography status are outlined in Section 5.7, Choreography Life-line. </p>
</li></ul></div></div><div class="div2">
<h3><a name="Token-and-TokenLocator" id="Token-and-TokenLocator"></a>5.4 
Token and TokenLocator</h3><p>A <em>token</em> is an alias for a piece of data in a variable or message that needs to be used by a choreography. Tokens differ from variables in that variables contain values which MAY be populated as the result of actions or events within a choreography life-line whereas tokens contain information that define the piece of the data that is relevant.</p><p>All tokens MUST have an informationType, for example, an "Order Id" could be of type 'alphanumeric' and a "Counter" could be of type 'integer'.</p><p>Tokens reference a document fragment within a choreography definition. Token locators provide a query mechanism to select tokens. By introducing these abstractions, a choreography definition avoids depending on specific message types as described by WSDL, or a specific query string as specified by XPath 1.0. Instead, the document part and the query string can change without affecting the choreography definition.</p><p>The syntax of the <em>token</em> construct is: </p><div class="exampleInner"><pre>
&lt;token  name="NCName"  informationType="QName" /&gt;

</pre></div><p>The attribute <code>name</code>
 is used to specify a distinct name for each <code>token</code>
 element declared within a choreography package.</p><p>The attribute <code>informationType</code>
 identifies the type of the document fragment. </p><p>The syntax of the <em>tokenLocator</em> construct is: </p><div class="exampleInner"><pre>&lt;tokenLocator  tokenName="QName" 
               informationType="QName" 
               part="NCName"?
               query="XPath-expression" /&gt;
</pre></div><p>The attribute <code>tokenName</code>
 identifies the name of the token that the document fragment locator is associated.</p><p>The attribute <code>informationType</code>
 identifies the type of the document on which the query is performed to locate the token.</p><p>The OPTIONAL attribute <code>part</code>
 defines the document part on which the query is performed to locate the token. This attribute SHOULD NOT be defined for a WSDL 2.0 document.</p><p>The attribute <code>query</code>
 defines the query string that is used to select a document fragment within a document or a document part.</p><p>The example below shows that the token "purchaseOrderID" is of XML-Schema type 'int'. The two token locators show how to access this token in the "purchaseOrder" and "purchaseOrderAck" messages. </p><div class="exampleOuter"><div class="exampleInner"><pre>&lt;token name="purchaseOrderID" informationType="xsd:int"/&gt;

&lt;tokenLocator tokenName="tns:purchaseOrderID" informationType="purchaseOrder"       
                query="/PO/OrderId"/&gt;
&lt;tokenLocator tokenName="tns:purchaseOrderID" informationType="purchaseOrderAck" 
                query="/POAck/OrderId"/&gt;
</pre></div></div></div><div class="div2">
<h3><a name="Choreography" id="Choreography"></a>5.5 
Choreography</h3><p>A <em>choreography</em> defines re-usable common rules that govern the ordering of exchanged messages, and the provisioning patterns of collaborative behavior, as agreed upon between two or more interacting participants.</p><p>A choreography defined at the choreography package level is called a <em>top-level choreography</em>, and does not share its context with other top-level choreographies. A choreography package MUST contain zero or one top-level choreography, marked explicitly as the <em>root</em>
 choreography. </p><p>The re-usable behavior encapsulated within a choreography MAY be performed within an isolated <em>enclosed</em> choreography, thus facilitating composition. The performed choreography is then called an <em>enclosed</em>
 choreography and MAY be defined:</p><ul><li><p><em>locally</em> - its definition is contained within the enclosing choreography</p>
</li><li><p><em>globally</em> - a separate top-level, non-root choreography definition is specified in the same or in a different choreography package that can be used by other choreographies and hence the contract described becomes reusable</p>
</li></ul><p>The root choreography is the only choreography that is enabled by default, whereas a non-root choreography is enabled only when performed.</p><p>A choreography MUST contain at least one relationshipType, enumerating the observable behavior this choreography requires its participants to exhibit. One or more relationshipTypes MAY be defined within a choreography, modeling multi-participant collaborations.</p><p>A choreography acts as a lexical name scoping context for variables. A variable defined in a choreography is visible for use in this choreography and all its enclosed choreographies up to the point that the variable is redefined as a non-free variable, thus forming a <em>choreography visibility horizon</em> for this variable.</p><p>A choreography MAY contain one or more choreography definitions that MAY be performed only locally within this choreography.</p><p>A choreography MUST contain an <em>Activity-Notation</em>. The Activity-Notation specifies the actions of the choreography that perform work. These actions are enabled when the choreography they belong to is enabled.</p><p>A choreography MAY define an exceptionBlock to recover from unusual conditions that can occur.</p><p>An enclosed choreography that has successfully completed MAY need to provide finalization actions that confirm, cancel or otherwise modify the effects of its completed actions. To handle these modifications, one or more separate finalizerBlocks MAY be defined for an enclosed choreography.</p><p>A choreography can also be coordinated. <em>Choreography coordination</em> guarantees that all involved roleTypes agree on how the choreography ended. That is, if the choreography completed successfully or suffered an exception, and if the choreography completed successfully and finalizerBlocks were installed, all roleTypes have the same finalizerBlock enabled.</p><p>The <em>Choreography-Notation</em> is used to define a choreography as follows: </p><div class="exampleInner"><pre>&lt;choreography  name="NCName"
      complete="xsd:boolean XPath-expression"?
      isolation="true"|"false"?
      root="true"|"false"?
      coordination="true"|"false"? &gt;

   &lt;relationship  type="QName" /&gt;+

   variableDefinitions?

   Choreography-Notation*

      Activity-Notation 

   &lt;exceptionBlock  name="NCName"&gt;
      WorkUnit-Notation+
   &lt;/exceptionBlock&gt;?

   &lt;finalizerBlock  name="NCName"&gt;
      Activity-Notation
   &lt;/finalizerBlock&gt;*
&lt;/choreography&gt;
</pre></div><p>The attribute <code>name</code>
 is used to specify a distinct name for each <code>choreography</code>
 element declared within a choreography package.</p><p>The OPTIONAL <code>complete</code>
 attribute makes it possible to explicitly complete a choreography as described below in the choreography life-line section.  This Boolean conditional expression MUST use short circuit evaluation according to the XPath 1.0 lexical rules.</p><p>The OPTIONAL <code>isolation</code>
 attribute specifies when a variable defined in an enclosing choreography, and changed within an enclosed choreography, is available to its sibling choreographies. The default value for this attribute is "false". The following rules apply:</p><ul><li><p>When <code>isolation</code>
 is set to "false", the variable information MAY be immediately overwritten by actions in its sibling choreographies.</p>
</li><li><p>When <code>isolation</code>
 is set to "true", changes to the variable information MUST be visible for read or for write to its sibling choreographies only after this choreography has completed.</p>
</li></ul><p>An isolated choreography MUST NOT directly or indirectly perform another isolated choreography.</p><p>If a choreography has its <code>isolation</code>
 attribute set to "true", then any and all enclosed choreographies MUST assume this isolation value.</p><p>The OPTIONAL <code>coordination</code>
 attribute specifies whether choreography coordination is required. The default value for this attribute is "false". The following rules apply:</p><ul><li><p>When the <code>coordination</code>
 attribute is set to "true", choreography coordination is required and a coordination protocol MUST ensure that all the roleTypes agree on how the choreography ended.</p>
</li><li><p>When the <code>coordination</code>
 attribute is set to "false", the choreography is not bound to a coordination protocol. Since none of the above guarantees of agreement on the outcome apply, any required coordination SHOULD be performed using explicitly modeled interactions.</p>
</li></ul><p>The <code>relationship</code>
 element within the <code>choreography</code>
 element enumerates the relationships this choreography MAY participate in.</p><p>The OPTIONAL <code>variableDefinitions</code>
 element enumerates the variables defined in this choreography.</p><p>The OPTIONAL <code>root</code>
 element marks a top-level choreography as the root choreography of a choreography package. The default value for this attribute is "false".</p><p>The OPTIONAL Choreography-Notation within the <code>choreography</code>
 element defines the locally defined choreographies that MAY be performed only within this choreography.</p><p>The OPTIONAL <code>exceptionBlock</code>
 element defines the exceptionBlock of a choreography by specifying one or more exception workunits using a <em>WorkUnit-Notation</em>. Within this element, the attribute <code>name</code>
 is used to specify a name for this exceptionBlock element.</p><p>The OPTIONAL <code>finalizerBlock</code>
 element defines a finalizerBlock for a choreography. A choreography MAY have more than one finalizerBlock. Each finalizerBlock specifies one finalizer activity using an <em>Activity-Notation</em>. If a choreography defines more than one finalizerBlock, then each MUST be differentiated by a distinct name as specified with the <code>name</code>
 attribute within the <code>finalizerBlock</code>
 element.</p></div><div class="div2">
<h3><a name="WorkUnit" id="WorkUnit"></a>5.6 
WorkUnit</h3><p>A <em>workunit</em> prescribes the constraints that have to be fulfilled for making progress and thus performing work within a choreography. A workunit can also prescribe the constraints that preserve the consistency of the collaborations commonly performed between the participants. Using a workunit, an application can recover from errors that are the result of abnormal actions and can also finalize successfully completed choreographies that need further action. For example, to confirm or logically roll back effects, or to close the choreography so that any defined "rollback" workunit will not be enabled. Examples of a workunit include:</p><ul><li><p>A "Change Order" workunit that can be performed whenever an order acknowledgement message has been received and an order rejection has not been received.</p>
</li><li><p>An "Order Delivery Error" workunit that is performed whenever the "Place Order" workunit did not reach a 'normal' conclusion. This would have a constraint that identifies the error.</p>
</li></ul><p>The guard condition of a workunit, if specified, expresses the interest on one or more variable's information (that already exist or will become available in the future) being available under certain prescribed constraints. The workunit's expressed interest MUST be matched for its enclosed actions to be enabled.</p><p>A workunit MUST complete successfully when all its enclosed actions complete successfully.</p><p>A workunit that completes successfully MUST be considered again for matching (based on its guard condition), if its repetition condition evaluates to "true".</p><p>The <em>WorkUnit-Notation</em> is used to define a workunit as follows: </p><div class="exampleInner"><pre>&lt;workunit  name="NCName"
      guard="xsd:boolean XPath-expression"? 
      repeat="xsd:boolean XPath-expression"? 
      block="true|false"? &gt;

      Activity-Notation 
&lt;/workunit&gt;
</pre></div><p>The attribute <code>name</code>
 is used to specify a name for each workunit element declared within a choreography package.</p><p>The Activity-Notation specifies the enclosed actions within a workunit.</p><p>The OPTIONAL attribute <code>guard</code>
 specifies the guard condition of a workunit.  This Boolean conditional expression MUST use short circuit evaluation according to the XPath 1.0 lexical rules.</p><p>The OPTIONAL attribute <code>repeat</code>
 specifies the repetition condition of a workunit.  This Boolean conditional expression MUST use short circuit evaluation according to the XPath 1.0 lexical rules.</p><p>The OPTIONAL attribute <code>block</code>
 specifies whether the workunit has to block waiting for referenced variables within the guard condition to become available (if they are not already) and the guard condition to evaluate to "true". This attribute MUST always be set to "false" in exception workunits. The default value for this attribute is "false".</p><p>As detailed above, the following rules apply:</p><ul><li><p>When a guard condition is not specified then the workunit always matches</p>
</li><li><p>One or more workunits MAY be matched concurrently if their respective expressed interests are matched</p>
</li><li><p>When a repetition condition is not specified then the workunit is not considered again for matching after the workunit was matched once</p>
</li><li><p>One or more variables can be specified in a guard condition or repetition condition, using XPath 1.0 and the WS-CDL functions, as described in Section 5.3.1</p>
</li><li><p>The WS-CDL function <code>getVariable</code>
 is used in the guard or repetition condition to obtain the value of a variable at the specific roleType (i.e. it can not be used to perform a remote value fetch)</p>
</li><li><p>When the WS-CDL function <code>isVariableAvailable</code>
 is used in the guard or repetition condition, it means that the workunit that specifies the guard or repetition condition is checking if a variable is already available at a specific roleType or is waiting for a variable to become available at a specific roleType, based on the <code>block</code>
 attribute being "false" or "true" respectively</p>
</li><li><p>When the WS-CDL function <code>variablesAligned</code>
 is used in the guard or repetition condition, it means that the workunit that specifies the guard or repetition condition is checking or waiting for an appropriate alignment interaction to happen between the two roleTypes, based on the <code>block</code>
 attribute being "false" or "true" respectively. The variables checked or waited for alignment are the sending and receiving ones in an alignment interaction or the ones used in the recordings at the two roleTypes at the ends of an alignment interaction. When the <code>variablesAligned</code>
 WS-CDL function is used in a guard or repetition condition, then the relationshipType within the <code>variablesAligned</code>
 MUST be the subset of the relationshipType that the immediate enclosing choreography defines</p>
</li><li><p>Variables defined at different roleTypes MAY be used in a guard condition or repetition condition to form a <em>globalized</em> view, thus combining constraints prescribed for each roleType but without requiring that all these constraints have to be fulfilled for progress to be made. The <code>globalizedTrigger</code>
 WS-CDL function MUST be used in a guard condition or repetition condition in this case. Variables defined at the same roleType MAY be combined together in a guard condition or repetition condition using all available XPath 1.0 operators and all the WS-CDL functions</p>
</li><li><p>If the attribute <code>block</code>
 is set to "true" and one or more required variables are not available or the guard condition evaluates to "false", then the workunit MUST block. When the required variable information specified by the guard condition become available and the guard condition evaluates to "true", then the workunit is matched. If the repetition condition is specified, then it is evaluated when the workunit completes successfully. Then, if the required variable information specified by the repetition condition is available and the repetition condition evaluates to "true", the workunit is considered again for matching. Otherwise, the workunit is not considered again for matching</p>
</li><li><p>If the attribute <code>block</code>
 is set to "false", then the guard condition or repetition condition assumes that the variable information is currently available. If either the variable information is not available or the guard condition evaluates to "false", then the workunit matching fails and the Activity-Notation enclosed within the workunit is skipped and the repetition condition is not evaluated even if specified. Otherwise, if the workunit matching succeeds, then the repetition condition, if specified, is evaluated when the workunit completes successfully. Then, if the required variable information specified by the repetition condition is available and the repetition condition evaluates to "true", the workunit is considered again for matching. Otherwise, the workunit is not considered again for matching</p>
</li></ul><p>The examples below demonstrate some usages of a workunit:</p><p><em>a. Example of a workunit with block equals to "true":</em></p><p>In the following workunit, the guard condition waits on the availability of "POAcknowledgement" at "Customer" roleType and if it is already available, the activity happens, otherwise, the activity blocks until the variable "POAcknowledgement" becomes available at the "Customer" roleType. </p><div class="exampleOuter"><div class="exampleInner"><pre>&lt;workunit  name="POProcess" 
           guard="cdl:isVariableAvailable('POAcknowledgement','','','tns:Customer')"
      block="true"&gt;
   ... &lt;!--some activity --&gt;
&lt;/workunit&gt;
</pre></div></div><p><em>b. Example of a workunit with block equals to "false":</em></p><p>In the following workunit, the guard condition checks if the variable "StockQuantity" at the "Retailer" roleType is available and is greater than 10 and if so, the activity happens. If either the variable is not available or its value is less than '10', then the matching condition is "false" and the activity is skipped. </p><div class="exampleOuter"><div class="exampleInner"><pre>&lt;workunit  name="StockCheck" 
    guard="cdl:getVariable('StockQuantity','','/Product/Qty', 'tns:Retailer') &gt; 10)"
    block="false" &gt;
   ... &lt;!--some activity --&gt;
&lt;/workunit&gt;
</pre></div></div><p><em>c. Example of a workunit waiting for alignment to happen:</em></p><p>In this example the workunit waits until the "purchase order" information at the "Customer" and the "Retailer" roleTypes have been aligned based on a previous interaction. Alignment means that both roleTypes have agreement on the values of their respective "purchase order" variables: </p><div class="exampleOuter"><div class="exampleInner"><pre>&lt;roleType name="Customer"&gt;
   . . .
&lt;/roleType&gt;
&lt;roleType name="Retailer"&gt;
   . . .
&lt;/roleType&gt;
&lt;relationshipType name="Customer-Retailer-Relationship"&gt;
    &lt;roleType typeRef="tns:Customer" /&gt;
    &lt;roleType typeRef="tns:Retailer" /&gt;
&lt;/relationshipType&gt;

&lt;workunit  name="WaitForAlignment" 
       guard="cdl:variablesAligned('
                    PurchaseOrderAtBuyer','PurchaseOrderAtSeller',
                    'tns:Customer-Retailer-Relationship')"
       block="true" &gt;
   ... &lt;!--some activity --&gt;
&lt;/workunit&gt;
</pre></div></div></div><div class="div2">
<h3><a name="Choreography-Life-line" id="Choreography-Life-line"></a>5.7 
Choreography Life-line</h3><p>A choreography life-line expresses the progression of a collaboration through enabled activities and enclosed choreographies. Initially, the collaboration is established between participants, then work is performed within it and finally it ends.</p><p>Distinct instances of a top-level or enclosed choreography, if they are ever performed in a temporarily overlapped fashion, MUST NOT interfere with each other in their involved communication actions. In other words, given a choreography description, interactions belonging to one of its instances MUST be logically, and hence operationally, distinguishable from those in another.</p><p>A choreography is initiated, establishing a collaboration when an interaction, explicitly marked as an <em>choreography initiator</em>, is performed. This causes the exceptionBlock to be installed and the choreography enters the <em>Enabled State</em>
. Before this point there is no observable association between any of the participants. </p><p>Two or more interactions MAY be marked as choreography initiators, indicating alternatives for establishing a collaboration. In this case, the first performed interaction will establish the collaboration and the other interactions will enlist with the already established collaboration.</p><p>A choreography initiator interaction MAY be defined within a root choreography or within an enclosed choreography. In either case the collaboration is established when the first choreography initiator interaction is performed.</p><p>A choreography in an Enabled State MUST complete unsuccessfully when an exception is caused in the choreography and its exceptionBlock, if present, MUST be enabled. This MUST cause the choreography to enter the <em>Unsuccessfully Completed State</em>. </p><p>The unsuccessfully completed choreography MUST enter the <em>Closed State</em> once the exceptionBlock, if present, is completed. If the exceptionBlock is not present, the choreography implicitly enters the Closed State and the exception occurred MUST be propagated to the enclosing choreography, if an enclosing choreography exists.</p><p>A choreography in an Enabled State MUST complete successfully when there are no more enabled activities within its body. This causes its exceptionBlock, where present, to be deinstalled, finalizerBlocks to be installed if specified, and the choreography enters the <em>Successfully Completed State</em>. </p><p>Alternatively, a choreography MUST complete successfully if its complete condition, is matched by evaluating to "true". A complete condition is considered for matching while the choreography is in Enabled State. The complete condition MUST be possible to be matched in all roleTypes that participate in the choreography. When the complete condition of a choreography is matched then all activities in the choreography MUST be disabled, except for any finalizerBlocks, and the choreography completes as if there were no more enabled activities within it. When a choreography completes, all uncompleted enclosed choreographies MUST automatically become successfully completed. Messages that were sent as part of a choreography that has since completed MUST be ignored.  If a finalizerBlock has been entered when the complete condition evaluates to "true", then it is unaffected and its messages MUST NOT be ignored.</p><p>A choreography, in a Successfully Completed State enters the Closed State if no finalizerBlocks were specified in that choreography. </p><p>A choreography in a Successfully Completed State with finalizerBlocks specified enters the Closed State when one of its installed finalizerBlocks is enabled and completed. The finalizerBlock of a choreography is enabled by a finalize activity in the immediately enclosing choreography. Alternatively, a choreography in a Successfully Completed State with finalizerBlocks specified implicitly enters the Closed State when its enclosing choreography enters the Closed State without enabling the finalizerBlocks of its enclosed choreography. In other words, when a choreography enters the Closed State, all its enclosed successfully completed choreographies are implicitly entering the Closed State even if none of their finalizerBlocks has been enabled.</p></div><div class="div2">
<h3><a name="Choreography-Exception-Handling" id="Choreography-Exception-Handling"></a>5.8 
Choreography Exception Handling</h3><p>A choreography can sometimes fail as a result of an exceptional circumstance or an "error" that occurred during its performance. Different types of <em>exceptions</em> are possible including this non-exhaustive list:</p><ul><li><p><em>Interaction failures</em> - for example, the sending of a message did not succeed </p>
</li><li><p><em>Protocol based exchange failures</em> - for example, no acknowledgement was received as part of a reliable messaging protocol</p>
</li><li><p><em>Security failures</em> - for example, a message was rejected by a recipient because the digital signature was not valid</p>
</li><li><p><em>Timeout errors</em> - for example, an interaction did not complete within the required time</p>
</li><li><p><em>Validation errors</em> - for example, an XML "Order" document was not well formed or did not conform to its XML-Schema definition</p>
</li><li><p><em>Application failures</em> - for example, the "Goods Ordered" were 'Out of stock'</p>
</li></ul><p></p><p>Within WS-CDL, one or more <em>exception workunits</em> MAY be defined within the exceptionBlock of a choreography for each exception that needs to be handled. At least one exception workunit MUST be defined as part of the exceptionBlock of a choreography. </p><p>An exception workunit MAY express interest on the occurrence of a particular type of exception using its guard condition with the hasExceptionOccurred WS-CDL function. If no guard condition is specified, then the exception workunit is called the <em>default exception workunit</em> and expresses interest on any type of exception. Within the exceptionBlock of a choreography there MUST NOT be more than one default exception workunit. An exception workunit MUST always set its <code>block</code>
 attribute to "false" and MUST NOT define a repetition condition.</p><p>Exception workunits MUST be enabled when the exceptionBlock of the choreography they belong to is enabled. Enabled exception workunits in a choreography MAY behave as the mechanism to recover from exceptions occurring in this and its enclosed choreographies.</p><p>Within the exceptionBlock of a choreography only one exception workunit MAY be matched.</p><p>The rules for matching an exception are:</p><ul><li><p>When an exception workunit has a guard condition using the hasExceptionOccurred(exceptionType) WS-CDL function, then it MUST be matched when the "QName" value of a caused exception matches the exceptionType parameter specified</p>
</li><li><p>If an exception is matched by the guard condition of an exception workunit, then the actions of the matched workunit are enabled. When two or more exception workunits are defined then the order of evaluating their guard conditions is based on the order that the workunits have been defined within the exceptionBlock</p>
</li><li><p>If none of the guard conditions match, then if there is a default exception workunit without a guard condition defined then its actions are enabled</p>
</li><li><p>If an exception is not matched by an exception workunit defined within the choreography in which the exception occurs, the exception will be recursively propagated to the exception workunit of the immediate enclosing choreography until a match is successful</p>
</li><li><p>If an exception occurs within a choreography, then the choreography completes unsuccessfully. In this case its finalizerBlocks MUST NOT be installed. The actions within this choreography, including enclosed choreographies that have not completed, are completed abnormally before an exception workunit can be matched</p>
</li></ul><p>The actions within the exception workunit MAY use variable information visible in the visibility horizon of the choreography it belongs to as they stand at the current time.</p><p>The actions of an exception workunit MAY also cause an exception. The semantics for matching the exception and acting on it are the same as described in this section.</p></div><div class="div2">
<h3><a name="Choreography-Finalization" id="Choreography-Finalization"></a>5.9 
Choreography Finalization</h3><p>After a choreography instance has successfully completed, it MAY need to provide finalization actions that confirm, cancel or otherwise modify the effects of its completed actions. To handle these modifications, one or more separate finalizerBlocks MAY be defined for an enclosed choreography. When its choreography body completes successfully, and associated finalizerBlocks are specified, the finalizerBlocks MUST be installed.</p><p>If more than one finalizerBlock is defined for the same choreography, each of them MUST be differentiated by their <code>name</code>
 attributes. However, at most one finalizerBlock MAY be enabled for any given choreography instance during the subsequent progress, including exception handling and finalization, of the enclosing choreography.</p><p>FinalizerBlocks MAY implement whatever actions are appropriate for the particular choreography. Common patterns might include:</p><ul><li><p>A single finalizerBlock to semantically "rollback" the choreography</p>
</li><li><p>Two finalizerBlocks, for example one with name "confirm" and one with name "cancel", to implement a two-phase outcome protocol</p>
</li><li><p>One "undo" finalizerBlock and one "close" finalizerBlock. If the "close" finalizer is enabled, then the choreography will be closed and the "undo" finalizerBlock can no longer be enabled</p>
</li></ul><p>The actions within the finalizer activity MAY use variable information visible in the visibility horizon of the choreography it belongs to as they were at the time the choreography completed for the variables belonging to this choreography and as they stand at the current time for the variables belonging to the enclosing choreography.</p><p>The actions of a finalizer activity MAY fault. The semantics for matching the fault and acting on it are the same as described in Section 5.8.</p></div><div class="div2">
<h3><a name="Choreography-Coordination" id="Choreography-Coordination"></a>5.10 
Choreography Coordination</h3><p>Choreography coordination guarantees that all involved roleTypes will agree on how the choreography ended. That is, all roleTypes will agree on whether the choreography completed successfully or suffered an exception, and if the choreography completed successfully and finalizerBlocks were installed, all roleTypes will agree on which finalizerBlock was enabled. Such agreement differs from interaction based alignment in that the coordinated choreography as a whole is aligned, regardless of whether each interaction in the coordinated choreography is aligned. In contrast to alignment interactions, a coordinated choreography provides a larger unit of coordination - a set of interactions that end with shared knowledge among all the participantTypes that their collaboration is in a defined state. Such a unit need not be aligned at each step - it is only required that clear alignment points are made to guarantee that all involved roleTypes will agree on how the choreography ended. </p><p>Choreographies defined as requiring coordination must be bound to a coordination protocol. When choreography coordination is not required, then the choreography is not bound to a coordination protocol and, since none of the above guarantees of agreement on the outcome apply, any required coordination should be performed using explicitly modeled interactions.</p><p>The implications of choreography coordination differ for root choreographies versus enclosed choreographies:</p><ul><li><p>An enclosed choreography MAY have one or more finalizerBlocks. In this case, coordination means that all roleTypes agree on whether the choreography completed successfully or suffered an exception. If the choreography completed successfully and finalizerBlocks were installed, all roleTypes agree on which finalizerBlock was enabled</p>
</li><li><p>A root choreography can also be coordinated, but it MUST NOT have any finalizerBlocks. In this case, coordination means that all roleTypes agree on whether the choreography completed successfully or suffered an exception</p>
</li><li><p>In both cases, all roleTypes MUST agree on whether the choreography completed successfully, or if an exception occurs, all roleTypes MUST experience an exception rather than successful completion. When an exception occurs within a choreography, the coordination protocol will throw an exception to roleTypes which have not otherwise detected the exception that occurred</p>
</li></ul><p>An exception MUST be propagated to all participants in the choreography using explicitly modeled, <em>exception causing interactions</em> when the choreography is not coordinated. This MUST cause the choreography to enter the exception state, and its exceptionBlock, if specified, MUST be enabled.</p><p></p><p>The two examples below show two usages of coordinated choreographies. </p><div class="exampleOuter"><div class="exampleInner"><pre>Example 1: Coordinated credit authorization without finalizerBlocks:

&lt;informationType name="creditDeniedType" /&gt;

&lt;!-- Coordinated CreditAuthorization Choreography without finalizerBlocks--&gt;
&lt;choreography name="CreditAuthorization" root="false" coordination="true"&gt;
   &lt;relationship type="tns:CreditReqCreditResp"/&gt;
   &lt;variableDefinitions&gt;
      &lt;variable name="CreditExtended" informationType="xsd:int" silent="true"       
                roleTypes="tns:CreditResponder"/&gt;
      &lt;variable name="creditRequest"/&gt;
      &lt;variable name="creditAuthorized"/&gt;
      &lt;variable name="creditDenied" informationType = "tns:creditDeniedType"/&gt;
   &lt;/variableDefinitions&gt;
   
   &lt;!-- the normal work - receive the request and decide whether to approve --&gt;
   &lt;interaction name="creditAuthorization" channelVariable="tns:CreditRequestor" 
                operation="authorize"&gt;
      &lt;participate relationshipType="SuperiorInferior"
                   fromRoleTypeRef="tns:Superior" 
                   toRoleTypeRef="tns:Inferior"/&gt;
      &lt;exchange name="creditRequest" informationType="creditRequest" 
                action="request"&gt;
         &lt;send variable="getVariable('tns:creditRequest','','')"/&gt;
         &lt;receive variable="getVariable('tns:creditRequest','','')"/&gt;
      &lt;/exchange&gt;
      &lt;exchange name="creditAuthorized" informationType="creditAuthorizedType"   
                action="respond"&gt;
         &lt;send variable="getVariable('tns:creditAuthorized','','')"/&gt;
         &lt;receive variable="getVariable('tns:creditAuthorized','','')"/&gt;
      &lt;/exchange&gt;
      &lt;exchange name="creditDenied" informationType="creditDeniedType" 
                action="respond"&gt;
         &lt;send variable="getVariable('tns:creditDenied','','')"
                         causeException="tns:creditDenied"/&gt;
         &lt;receive variable="getVariable('tns:creditDenied','','')"
                         causeException="tns:creditDenied"/&gt;
      &lt;/exchange&gt;
   &lt;/interaction&gt;

   &lt;!-- catch the (application) exception - as an exception it will abort the 
        choreography --&gt;
   &lt;exceptionBlock name="handleBadCreditException"&gt;
     &lt;workunit  name="handleBadCredit" &gt;
                &lt;interaction name="badCreditInteraction" 
                             channelVariable="tns:CreditResponder"
                             operation="creditDenied"&gt;
                    &lt;participate relationshipType="CreditReqCreditResp"
                         fromRoleTypeRef="tns:Responder"
                         toRoleTypeRef="tns:CreditRequestor"/&gt;
      &lt;/interaction&gt;
     &lt;/workunit&gt;
  &lt;/exceptionBlock&gt;
&lt;/choreography&gt;
</pre></div></div><p><em></em>
</p><div class="exampleOuter"><div class="exampleInner"><pre>Example 2: Coordinated credit authorization with finalizerBlocks

&lt;informationType name="creditDeniedType" /&gt;

&lt;!-- Coordinated CreditAuthorization Choreography with finalizerBlocks --&gt;
&lt;choreography name="CreditAuthorization" root="false" coordination="true"&gt;
   &lt;relationship type="tns:CreditReqCreditResp"/&gt;
   &lt;variableDefinitions&gt;
      &lt;variable name="CreditExtended" informationType="xsd:int" silent="true"  
                roleTypes="tns:CreditResponder"/&gt;
      &lt;variable name="creditRequest"/&gt;
      &lt;variable name="creditAuthorized"/&gt;
      &lt;variable name="creditDenied" informationType = "creditDeniedType"/&gt;
   &lt;/variableDefinitions&gt;

   &lt;!-- the normal work -receive the request and decide whether to approve --&gt;
   &lt;interaction name="creditAuthorization" channelVariable="tns:CreditRequestor"  
                operation="authorize"&gt;
      &lt;participate relationshipType="SuperiorInferior"
                   fromRoleTypeRef="tns:Superior" 
                   toRoleTypeRef="tns:Inferior"/&gt;
      &lt;exchange name="creditRequest" informationType="creditRequest"  
             action="request"&gt;
         &lt;send variable="tns:creditRequest"/&gt;
         &lt;receive variable="tns:creditRequest"/&gt;
      &lt;/exchange&gt;
      &lt;exchange name="creditAuthorized" informationType="creditAuthorizedType" 
                action="respond"&gt;
         &lt;send variable="tns:creditAuthorized"/&gt;
         &lt;receive variable="tns:creditAuthorized"/&gt;
      &lt;/exchange&gt;
      &lt;exchange name="creditDenied" informationType="creditDeniedType" 
                action="respond"&gt;
         &lt;send variable="tns:creditDenied" causeException="tns:creditDenied"/&gt;
         &lt;receive variable="tns:creditDenied" causeException="tns:creditDenied"/&gt;
      &lt;/exchange&gt;
   &lt;/interaction&gt;

   &lt;!-- catch the (application) exception - as an exception it will abort the 
        choreography and the finalizerBlocks are not accessible --&gt;
   &lt;exceptionBlock name="handleBadCreditException"&gt;
       &lt;workunit  name="handleBadCredit" &gt;
          &lt;interaction name="badCreditInteraction" 
                channelVariable="tns:CreditResponder"
                operation="creditDenied"&gt;
                &lt;participate relationshipType="CreditReqCreditResp"
                      fromRoleTypeRef="tns:Responder"
                      toRoleTypeRef="tns:CreditRequestor"/&gt;
          &lt;/interaction&gt;
       &lt;/workunit&gt;
   &lt;/exceptionBlock&gt;

   &lt;!-- finalizerBlocks --&gt;
   &lt;!-- what to do if the credit is drawn down --&gt;
   &lt;finalizerBlock name="drawDown"&gt;
      &lt;!-- if there is no application content to send, this could just be an 
           assignment to the statecapturevariable creditExtended --&gt;
       &lt;workunit  name="drawdown" &gt;
            &lt;interaction name="drawdownInteraction" 
                         channelVariable="tns:CreditRequestor"
                         operation="drawDown"&gt;
                  &lt;participate relationshipType="CreditReqCreditResp"
                      fromRoleTypeRef="tns:CreditRequestor"
                      toRoleTypeRef="tns:CreditResponder"/&gt;
                  &lt;exchange name="dummy" action="request"&gt;
                      &lt;send&gt;&lt;/send&gt;
                      &lt;receive recordReference="drawdownRecord"/&gt;
                  &lt;/exchange&gt;  
                 &lt;record name="drawdownRecord" when="before"&gt;
                      &lt;source expression="drawnDown"/&gt;
                      &lt;target variable="CreditExtended"/&gt;
                  &lt;/record&gt;               
            &lt;/interaction&gt;
           &lt;/workunit&gt;
   &lt;/finalizerBlock&gt;

   &lt;!-- what to do if the credit is not used --&gt;
   &lt;finalizerBlock name="replenish"&gt;      
   &lt;!-- if there is no application content to send, this could just be an  
           assignment to the state capturing variable creditExtended --&gt;
       &lt;workunit name="replenishWU"&gt;
            &lt;interaction name="replenishInteraction" 
                         channelVariable="tns:CreditRequestor"
                         operation="replenish"&gt;
                &lt;participate relationshipType="CreditReqCreditResp"
                      fromRoleTypeRef="tns:CreditRequestor"
                      toRoleTypeRef="tns:CreditResponder"/&gt;
                &lt;exchange name="dummy" action="request"&gt;
                     &lt;send&gt;&lt;/send&gt;
                       &lt;receive recordReference="replenishRecord"/&gt;
                &lt;/exchange&gt;                
                &lt;record name="replenishRecord" when="before"&gt;
                       &lt;source expression="released"/&gt;
                       &lt;target variable="CreditExtended"/&gt;
                &lt;/record&gt;
             &lt;/interaction&gt;
        &lt;/workunit&gt;
   &lt;/finalizerBlock&gt;
&lt;/choreography&gt;        
</pre></div></div></div></div><div class="div1">
<h2><a name="Activities" id="Activities"></a>6 
Activities</h2><p><em>Activities</em> describe the actions performed within a choreography. The <em>Activity-Notation</em>
 is used to define activities as either:</p><ul><li><p>An <em>ordering structure</em> - which combines activities with other ordering structures in a nested way to express the ordering rules of actions performed within a choreography</p>
</li><li><p>A <em>WorkUnit-Notation - which is used to guard and/or provide a means of repetition of those activities enclosed within the workunit</em></p>
</li><li><p>A <em>basic activity - which is used to describe the lowest level </em>actions performed within a choreography. A basic activity is then either:</p>
<ul><li>An <em>interaction activity</em>
, which results in an exchange of information between participants and possible synchronization of their observable information changes and the actual values of the exchanged information</li><li>A <em>perform activity</em>, which means that a complete, separately defined choreography is performed</li><li>An <em>assign activity</em>, which assigns, within one roleType, the value of one variable to another variable</li><li>A <em>silentAction activity</em>, which provides an explicit designator used for specifying the point where participant specific actions with non-observable operational details are performed</li><li>A <em>noAction activity</em>, which provides an explicit designator used for specifying the point where a participant does not perform any action</li><li>A <em>finalize activity</em>, which enables a particular finalizerBlock in a particular instance of an immediately enclosed choreography and thus brings that choreography to a defined conclusion</li></ul></li></ul><div class="div2">
<h3><a name="Ordering-Structures" id="Ordering-Structures"></a>6.1 
Ordering Structures</h3><p>Ordering structures combine activities with other ordering structures in a nested structure to express the ordering rules of actions performed within a choreography. An <em>ordering structure</em> is one of the following:</p><ul><li><p><em>sequence</em></p>
</li><li><p><em>parallel</em></p>
</li><li><p><em>choice</em></p>
</li></ul><div class="div3">
<h4><a name="Sequence" id="Sequence"></a>6.1.1 
Sequence</h4><p>The <em>sequence</em> ordering structure contains one or more Activity-Notations. When the sequence activity is enabled, the sequence element MUST restrict the series of enclosed activities (as defined by one or more Activity-Notations) to be enabled sequentially, in the same order that they are defined.</p><p>The syntax of this construct is: </p><div class="exampleInner"><pre>&lt;sequence&gt;
    Activity-Notation+
&lt;/sequence&gt;
</pre></div></div><div class="div3">
<h4><a name="Parallel" id="Parallel"></a>6.1.2 
Parallel</h4><p>The <em>parallel</em> ordering structure contains one or more Activity-Notations that are enabled concurrently when the parallel activity is enabled. The parallel activity MUST complete successfully when all activities (as defined by one or more Activity-Notations) performing work within it complete successfully.</p><p>The syntax of this construct is: </p><div class="exampleInner"><pre>&lt;parallel&gt;
    Activity-Notation+
&lt;/parallel&gt;
</pre></div></div><div class="div3">
<h4><a name="Choice" id="Choice"></a>6.1.3 
Choice</h4><p>The <em>choice</em> ordering structure enables specifying that only one of two or more activities (as defined by two or more Activity-Notations) SHOULD be performed. </p><p>When two or more activities are specified in a <code>choice</code>
 element, only one activity is selected and the other activities are disabled. If the <code>choice</code>
 has workunits with guard conditions, the first workunit that matches the guard condition is selected and the other workunits are disabled. Where there is more than one match, lexical ordering is used to select a match. If the choice has other activities, it is assumed that the selection criteria for those activities are non-observable.</p><p>The syntax of this construct is: </p><div class="exampleInner"><pre>&lt;choice&gt;
    Activity-Notation+
&lt;/choice&gt;
</pre></div><p>In the example below, choice element has two interactions, "processGoodCredit" and "processBadCredit". The interactions have the same directionality, participate within the same relationshipType and have the same fromRoleTypeRef and toRoleTypeRef names. If one interaction happens, then the other one is disabled. </p><div class="exampleOuter"><div class="exampleInner"><pre>&lt;choice&gt;
  &lt;interaction name=""processGoodCredit"
       channelVariable="goodCredit-channel" operation="doCredit"&gt;
      ...
  &lt;/interaction&gt;

  &lt;interaction name=""processBadCredit"
       channelVariable="badCredit-channel" operation="doBadCredit"&gt;
      ...
  &lt;/interaction&gt;
&lt;choice&gt;
</pre></div></div></div></div><div class="div2">
<h3><a name="Interacting" id="Interacting"></a>6.2 
Interacting</h3><p>An <em>interaction</em> is the basic building block of a choreography. It results in information exchanged between collaborating participants and possibly the synchronization of their observable information changes and the values of the exchanged information.</p><p>An interaction forms the base atom of the choreography composition. Multiple interactions are combined to form a choreography, which can then be used in different business contexts.</p><p>An interaction is initiated when one of the roleTypes participating in the interaction sends a message through a common channel to another roleType that is participating in the interaction. If the initial message is a request, then the accepting roleType can optionally respond with a normal response message or a fault message, which will be received by the initiating roleType.</p><p>An interaction also contains "references" to:</p><ul><li><p><em>The channel capturing variable</em> that describes where and how the message is to be sent to and received into the accepting roleType</p>
</li><li><p>The <em>operation</em> that specifies what the recipient of the message should do with the message when it is received</p>
</li><li><p>The 'f<em>rom' roleType</em> and '<em>to' roleType</em>
 that are involved</p>
</li><li><p>The <em>informationType</em> or <em>channelType</em>
 that is being exchanged</p>
</li><li><p>The <em>information exchange capturing variables</em> at the 'from' roleType and 'to' roleType that are the source and destination for the message content</p>
</li><li><p>A list of potential state capturing variable recordings that capture observable information changes that can occur as a result of carrying out the interaction</p>
</li></ul><div class="div3">
<h4><a name="Interaction-Based-Information-Alignment" id="Interaction-Based-Information-Alignment"></a>6.2.1 
Interaction Based Information Alignment</h4><p>In some choreographies there may be a requirement that when the interaction is performed, the roleTypes in the choreography have agreement on the outcome. More specifically within an interaction, a roleType may need to have a common understanding of the observable information creations or changes of one or more <em>state capturing variables</em> that are complementary to one or more <em>state capturing variables</em>
 of its partner roleType. Additionally, within an interaction a roleType may need to have a common understanding of the values of the information exchange capturing variables at the partner roleType.</p><p>For example, after an interaction happens, both the "Buyer" and the "Seller" want to have a common understanding that:</p><ul><li><p>State capturing variables, such as "Order State", that contain observable information at the "Buyer" and "Seller", have values that are complementary to each other, e.g. 'Sent' at the "Buyer" and 'Received' at the "Seller", and</p>
</li><li><p>Information exchange capturing variables have the same types with the same content, e.g. The "Order" variables at the "Buyer" and "Seller" have the same informationTypes and hold the same order information</p>
</li></ul><p>In WS-CDL, an <em>alignment interaction</em> MUST be explicitly used in the cases where two interacting participants require the alignment of their observable information changes and the values of their exchanged information. After the alignment interaction completes, both participants progress at the same time in a lock-step fashion, and the variable information in both participants is aligned. Their variable alignment comes from the fact that the requesting participant has to be assured that the accepting participant has received the message, and the accepting participant has to be assured that the requesting participant has sent the message before both of them progress. There is no intermediate state, where one participant sends a message and then it proceeds independently, or the other participant receives a message and then it proceeds independently. In other words, after each alignment interaction both participants act on the basis of their shared understanding for the messages exchanged and the information recorded.</p></div><div class="div3">
<h4><a name="Interaction-Life-line" id="Interaction-Life-line"></a>6.2.2 
Interaction Life-line</h4><p>An interaction MUST complete normally when its message exchanges complete successfully.</p><p>An interaction MUST complete abnormally when:</p><ul><li><p>An application signals an error condition during the management of a request or within a participant when processing the request</p>
</li><li><p>Its <em>time-to-complete</em> timeout occurs after the interaction was initiated but before it completed</p>
</li><li><p>Some other type of error occurs, such as protocol based exchange failures, security failures, document validation errors, etc. </p>
</li></ul></div><div class="div3">
<h4><a name="Interaction-Syntax" id="Interaction-Syntax"></a>6.2.3 
Interaction Syntax</h4><p>The syntax of the <em>interaction</em> construct is: </p><div class="exampleInner"><pre>&lt;interaction  name="NCName"
              channelVariable="QName"
              operation="NCName"
              align="true"|"false"?
              initiate="true"|"false"? &gt;

   &lt;participate  relationshipType="QName"
                 fromRoleTypeRef="QName" toRoleTypeRef="QName" /&gt;

   &lt;exchange  name="NCName"
              faultName="QName"?
              informationType="QName"?|channelType="QName"?
              action="request"|"respond" &gt;
     &lt;send      variable="XPath-expression"? 
                recordReference="list of NCName"?   
                causeException="QName"? /&gt;
     &lt;receive   variable="XPath-expression"? 
                recordReference="list of NCName"? 
                causeException="QName"? /&gt;
   &lt;/exchange&gt;*

   &lt;timeout  time-to-complete="XPath-expression"
             fromRoleTypeRecordRef="list of NCName"?
             toRoleTypeRecordRef="list of NCName"? /&gt;?

   &lt;record  name="NCName"
            when="before"|"after"|"timeout"
            causeException="QName"? &gt;
     &lt;source  variable="XPath-expression"? | expression="XPath-expression"? /&gt;
     &lt;target  variable="XPath-expression" /&gt;
   &lt;/record&gt;*
&lt;/interaction&gt;

</pre></div><p>The attribute <code>name</code>
 is used to specify a name for each interaction element declared within a choreography.</p><p>The <code>channelVariable</code>
 attribute specifies the channel capturing variable used for communicating during this interaction. The channel variable contains information about the participant that is the target of the interaction. The information is used for determining where and how to send and receive information to and from the participant. The channel variable used in an interaction MUST be available at the two roleTypes before the interaction MAY occur. At runtime, information about a channel variable is expanded further. This requires that the messages exchanged in the choreography also contain reference and correlation information, for example by:</p><ul><li><p>Including a protocol header, such as a SOAP header or</p>
</li><li><p>Using the actual value of data within a message, for example the "Order Number" of the "Order" that is common to all the messages sent over the channel</p>
</li></ul><p>The <code>operation</code>
 attribute specifies the name of the operation that is associated with this interaction. The specified operation belongs to the interface, as identified by the <code>roleType</code>
 and <code>behavior</code>
 elements of the channelType specified in the channel variable used in this interaction.</p><p>The OPTIONAL <code>align</code>
 attribute, when set to "true", means that this alignment interaction results in the common understanding of both the information exchanged and the resulting observable information creations or changes at the ends of the interaction, as specified in the <code>fromRoleTypeRef</code>
 and the <code>toRoleTypeRef</code>
 elements. In other words, after each alignment interaction both participants act on the basis of their shared understanding for the messages exchanged and the information recorded. The default value for this attribute is "false".</p><p>When the OPTIONAL <code>initiate</code>
 attribute is set to "true", an interaction activity MUST be marked as a choreography initiator. The default value for this attribute is "false".</p><p>Within the <code>participate</code>
 element, the <code>relationshipType</code>
 attribute specifies the relationshipType this interaction participates in, and the <code>fromRoleTypeRef</code>
 and <code>toRoleTypeRef</code>
 attributes specify the requesting and the accepting roleTypes respectively. The type of the roleType identified by the <code>toRoleTypeRef</code>
 attribute MUST be the same as the roleType identified by the <code>roleType</code>
 element of the channelType specified in the channel variable used in the interaction.</p><p>The OPTIONAL <code>exchange</code>
 element allows information to be exchanged during an interaction. The attribute <code>name</code>
 is used to specify a name for this exchange element. </p><p>Within the exchange element, the OPTIONAL <code>faultName</code>
 attribute is used to identify this exchange element as a fault exchange with the specified name. If the <code>faultName</code>
 attribute is specified, then it will be used to identify the specific fault within the context of the operation. If the operation is defined using WSDL, this MUST occur in the following way:</p><ul><li><p>For WSDL1.1, the LocalPart of the "QName" will be used to match the name of a fault declared within the operation. If a prefix is specified, it must match the namespace associated with the operation. If a WSDL1.1 operation has more than one fault reference with the same LocalPart as the name specified in the faultName attribute, this will be considered an error</p>
</li><li><p>For WSDL2, the fully qualified "QName" will be used to match the fault declaration. If only the LocalPart of the "QName" is specified, then the match will initially be performed using the targetNamespace to qualify the LocalPart. If a fault declaration is still not found, then the LocalPart will be matched against the LocalPart of the 'ref' attribute of each fault reference defined for the operation. If a WSDL2 operation has more than one fault reference with the same LocalPart as the name specified in the faultName attribute, this will be considered an error</p>
</li></ul><p>Within the <code>exchange</code>
 element, the OPTIONAL attributes <code>informationType</code>
 and <code>channelType</code>
 identify the informationType or the channelType of the information that is exchanged between the two roleTypes in an interaction. The attributes <code>informationType</code>
 and <code>channelType</code>
 MUST be mutually exclusive. If none of these attributes are specified, then it is assumed that either no actual information is exchanged or the type of information being exchanged is of no interest to the choreography definition.</p><p>Within the <code>exchange</code>
 element, the attribute <code>action</code>
 specifies the direction of the information exchanged in the interaction:</p><ul><li><p>When the <code>action</code>
 attribute is set to "request", then the information exchange happens from the 'from' roleType to the 'to' roleType</p>
</li><li><p>When the <code>action</code>
 attribute is set to "respond", then the information exchange happens from the 'to' roleType to the 'from' roleType</p>
</li></ul><p>Within the <code>exchange</code>
 element, the <code>send</code>
 element shows that information is sent from a roleType and the <code>receive</code>
 element shows that information is received at a roleType respectively in the interaction:</p><ul><li><p>The <code>send</code>
 and the <code>receive</code>
 elements MUST only use the WS-CDL function <code>getVariable</code>
 within the <code>variable</code>
 attribute</p>
</li><li><p>The OPTIONAL variables specified within the <code>send</code>
 and <code>receive</code>
 elements MUST be of type as described in the <code>informationType</code>
 or <code>channelType</code>
 attributes</p>
</li><li><p>When the <code>action</code>
 element is set to "request", then the variable specified within the <code>send</code>
 element using the <code>variable</code>
 attribute MUST be defined at the 'from' roleType and the variable specified within the <code>receive</code>
 element using the <code>variable</code>
 attribute MUST be defined at the 'to' roleType. A variable is associated with a specific roleType as described in Section 5.2</p>
</li><li><p>When the <code>action</code>
 element is set to "respond", then the variable specified within the <code>send</code>
 element using the <code>variable</code>
 attribute MUST be defined at the 'to' roleType and the variable specified within the <code>receive</code>
 element using the <code>variable</code>
 attribute MUST be defined at 'from' roleType. A variable is associated with a specific roleType as described in Section 5.2</p>
</li><li><p>The variable specified within the <code>receive</code>
 element MUST NOT be defined with the attribute <code>silent</code>
 set to "true"</p>
</li><li><p>Within the <code>send</code>
 or the <code>receive</code>
 elements of an <code>exchange</code>
 element, the <code>recordReference</code>
 attribute contains an XML-Schema list of references to <code>record</code>
 elements in the same interaction. The same <code>record</code>
 element MAY be referenced from different <code>send</code>
 or the <code>receive</code>
 elements within the same interaction thus enabling re-use</p>
</li><li><p>Within the <code>send</code>
 or the <code>receive</code>
 elements of an exchange element, if the OPTIONAL <code>causeException</code>
 attribute is set, it specifies that an exception MUST be caused at the respective roleTypes. In this case, the "QName" value of this attribute will identify the exception that MUST be caused</p>
</li><li><p>The request exchange MUST NOT have the <code>faultName</code>
 or <code>causeException</code>
 attributes specified</p>
</li><li><p>When two or more respond exchanges are specified there MUST be an implicit choice between two or more respond exchanges</p>
</li><li><p>If the <code>align</code>
 attribute is set to "false" for the interaction, then it means that the:</p>
<ul><li>Request exchange completes successfully for the requesting roleType once it has successfully sent the information of the variable specified within the <code>send</code>
 element and the Request exchange completes successfully for the accepting roleType once it has successfully received the information of the variable specified within the <code>receive</code>
 element</li><li>Response exchange completes successfully for the accepting roleType once it has successfully sent the information of the variable specified within the <code>send</code>
 element and the Response exchange completes successfully for the requesting roleType once it has successfully received the information of the variable specified within the <code>receive</code>
 element</li></ul></li><li><p>If the <code>align</code>
 attribute is set to "true" for the interaction, then it means that the interaction MUST complete successfully if its Request and Response exchanges complete successfully, and all referenced records complete successfully: </p>
<ul><li>A Request exchange completes successfully once both the requesting roleType has successfully sent the information of the variable specified within the send element and the accepting roleType has successfully received the information of the variable specified within the <code>receive</code>
 element</li><li>A Response exchange completes successfully once both the accepting roleType has successfully sent the information of the variable specified within the send element and the requesting roleType has successfully received the information of the variable specified within the <code>receive</code>
 element</li></ul></li></ul><p>Within the OPTIONAL <code>timeout</code>
 element, the <code>time-to-complete</code>
 attribute identifies the timeframe within which an interaction MUST complete after it was initiated, or the deadline before which an interaction MUST complete. When the <code>time-to-complete</code>
 has been exceeded, a <code>time-to-complete</code>
 timeout occurs after the interaction was initiated, but before it completed. The <code>time-to-complete</code>
 SHOULD be of XML-Schema duration type when conveying the timeframe and SHOULD be of XML-Schema dateTime type when conveying the deadline. When used, the OPTIONAL <code>fromRoleTypeRecordRef</code>
 attribute contains an XML-Schema list of references to <code>record</code>
 elements in the same interaction that SHOULD take effect at the 'from' roleType when a timeout occurs. When used, the OPTIONAL <code>toRoleTypeRecordRef</code>
 attribute contains an XML-Schema list of references to <code>record</code>
 elements in the same interaction that SHOULD take effect at the 'to' roleType when a timeout occurs.</p><p>The OPTIONAL <code>record</code>
 element is used to create or change and then make available within one roleType, the value of one or more variables using another variable or an expression. The attribute <code>name</code>
 is used to specify a distinct name for a <code>record</code>
 element within an interaction. Within the <code>record</code>
 element, the <code>source</code>
 and <code>target</code>
 elements specify these recordings of information happening at the send and receive ends of the interaction:</p><ul><li><p>When the <code>action</code>
 element is set to "request", then the recordings specified within the <code>source</code>
 and the <code>target</code>
 elements MUST occur at the 'from' roleType for the send and at the 'to' roleType for the receive</p>
</li><li><p>When the <code>action</code>
 element is set to "response", then the recordings specified within the <code>source</code>
 and the <code>target</code>
 elements MUST occur at the 'to' roleType for the send and at the 'from' roleType for the receive</p>
</li></ul><p>Within the <code>record</code>
 element, the <code>when</code>
 attribute specifies if a recording happens before or after the send, or before or after the receive of a message at a roleType in a Request or a Response exchange or when a timeout has expired. When the <code>when</code>
 attribute is set to "timeout", the <code>record</code>
 element specifies the recording to be performed when a timeout occurs. If two or more <code>record</code>
 elements have the same value in their <code>when</code>
 attribute and are referenced within the <code>recordReference</code>
 attribute of a <code>send</code>
 or a <code>receive</code>
 element, then they are performed in the order in which they are specified.</p><p>The following rules apply for the information recordings when using the <code>record</code>
 element:</p><ul><li><p>The source MUST define either a <code>variable</code>
 attribute or an <code>expression</code>
 attribute</p>
<ul><li>When the source defines an <code>expression</code>
 attribute, it MUST contain expressions, as defined in Section 5.3. The resulting type of the defined expression MUST be compatible with the target variable type</li><li>When the source defines a variable, then the source and the target variable MUST be of compatible type</li></ul></li><li><p>When the source defines a variable, then the source and the target variable MUST be defined at the same roleType. When the attribute <code>variable</code>
 is defined it MUST use only the WS-CDL function <code>getVariable</code>
. The variable specified within this function is associated with a specific roleType as described in Section 5.2</p>
</li><li><p>The target variable MUST NOT be defined with the attribute <code>silent</code>
 set to "true"</p>
</li><li><p>One or more <code>record</code>
 elements MAY be specified and performed at one or both the roleTypes within an interaction</p>
</li><li><p>A <code>record</code>
 element MUST NOT be specified in the absence of an exchange element or a <code>timeout</code>
 element that reference it</p>
</li><li><p>When the OPTIONAL attribute <code>causeException</code>
 is specified in a <code>record</code>
 element, then an exception MAY be caused at the corresponding roleType. In this case, the "QName" value of this attribute will identify the exception that MAY be caused</p>
</li><li><p>When two or more <code>record</code>
 elements are specified for the same roleType in an interaction, with their <code>causeException</code>
 attributes set to indicate that an exception should be caused, then one of the exception types MAY be caused. The throwing of an exception has a non-observable predicate condition associated implicitly with it, that decides if an exception is caused</p>
</li><li><p>If the <code>align</code>
 attribute is set to "false" for the interaction, then it means that the roleType specified within the <code>record</code>
 element makes available the creation or change of the information specified within the <code>record</code>
 element immediately after the successful completion of each record</p>
</li><li><p>If the <code>align</code>
 attribute is set to "true" for the interaction, then it means that</p>
<ul><li>Both roleTypes SHOULD be assured of the availability of the creation or change of the information specified within the <code>record</code>
 element only at the successful completion of the interaction</li><li>If there are two or more <code>record</code>
 elements specified within an interaction, then all record operations MUST complete successfully for the interaction to complete successfully. Otherwise, none of the variables specified in the <code>target</code>
 attribute will be affected</li></ul></li></ul><p></p><p>The example below shows a complete choreography that involves one interaction performed from a roleType "Consumer" to a roleType "Retailer" on the channel "retailer-channel" as a request/response exchange:</p><ul><li><p>The message "purchaseOrder" is sent from the "Consumer" to the "Retailer" as a request message</p>
</li><li><p>The message "purchaseOrderAck" is sent from the "Retailer" to the "Consumer" as a response message</p>
</li><li><p>The variable "consumer-channel" is made available at the "Retailer" using the record element</p>
</li><li><p>The interaction happens on the "retailer-channel", which has a token "purchaseOrderID" used within the <code>identity</code>
 element of the channel. This <code>identity</code>
 element is used to identify the business process of the "Retailer" </p>
</li><li><p>The request message "purchaseOrder" contains the identity of the "Retailer" business process as specified in the tokenLocator for  "purchaseOrder" message</p>
</li><li><p>The response message "purchaseOrderAck" contains the identity of the "Consumer" business process as specified in the tokenLocator for "purchaseOrderAck" message</p>
</li><li><p>The "consumer-channel" is sent as a part of "purchaseOrder" interaction from the "Consumer" to the "Retailer" on "retailer-channel" during the request. Here the record element makes available the "Consumer-channel" at the "Retailer" roleType. If the <code>align</code>
 attribute was set to "true" for this interaction, then it also means that the "Consumer" knows that the "Retailer" now has the contact information of the "Consumer". In another example, the "Consumer" could set its variable "OrderSent" to "true" and the "Retailer" would set its variable "OrderReceived" to "true" using the <code>record</code>
 element</p>
</li><li><p>The exchange "badPurchaseOrderAckException" specifies that an exception type of "badPOAck" could occur at both participants </p>
</li></ul><div class="exampleOuter"><div class="exampleInner"><pre>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;package xmlns="http://www.w3.org/2005/10/cdl"
     xmlns:cdl="http://www.w3.org/2005/10/cdl"
     xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
     xmlns:xsd="http://www.w3.org/2001/XMLSchema"
     xmlns:rns="http://www.example.com/ConsumerRetailerChoreographyIFsample"
     xmlns:tns="http://www.example.com/ConsumerRetailerChoreographysample"
     targetNamespace="http://www.example.com/ConsumerRetailerChoreographysample"
     name="ConsumerRetailerChoreography"
     version="1.0"&gt;
 
  &lt;informationType name="purchaseOrderType" type="tns:PurchaseOrderMsg"/&gt;
  &lt;informationType name="purchaseOrderAckType" type="tns:PurchaseOrderAckMsg"/&gt;
  &lt;informationType name="badPOAckType"  type="xsd:QName" /&gt;
  &lt;informationType name="uriType"  type="xsd:string" /&gt;
  &lt;informationType name="intType"  type="xsd:integer" /&gt;
 
  &lt;token name="purchaseOrderID" informationType="tns:intType"/&gt;
  &lt;token name="retailerRef" informationType="tns:uriType"/&gt;
  &lt;token name="consumerRef" informationType="tns:uriType"/&gt;
  &lt;tokenLocator tokenName="tns:purchaseOrderID"
                informationType="tns:purchaseOrderType" query="/PO/orderId"/&gt;
  &lt;tokenLocator tokenName="tns:purchaseOrderID"
                informationType="tns:purchaseOrderAckType" query="/PO/orderId"/&gt;
  &lt;roleType name="Consumer"&gt;
    &lt;behavior name="consumerForRetailer" interface="rns:ConsumerRetailerPT"/&gt;
    &lt;behavior name="consumerForWarehouse" interface="rns:ConsumerWarehousePT"/&gt;
  &lt;/roleType&gt;
  &lt;roleType name="Retailer"&gt;
    &lt;behavior name="retailerForConsumer" interface="rns:RetailerConsumerPT"/&gt;
  &lt;/roleType&gt;

  &lt;relationshipType name="ConsumerRetailerRelationship"&gt;
    &lt;roleType typeRef="tns:Consumer" behavior="consumerForRetailer"/&gt;
    &lt;roleType typeRef="tns:Retailer" behavior="retailerForConsumer"/&gt;
  &lt;/relationshipType&gt;

  &lt;channelType name="ConsumerChannel"&gt;
    &lt;roleType typeRef="tns:Consumer"/&gt;
    &lt;reference&gt;
      &lt;token name="tns:consumerRef"/&gt;
    &lt;/reference&gt;
    &lt;identity&gt;
      &lt;token name="tns:purchaseOrderID"/&gt;
    &lt;/identity&gt;
  &lt;/channelType&gt;
  &lt;channelType name="RetailerChannel"&gt;
    &lt;passing channel="ConsumerChannel" action="request" /&gt;
    &lt;roleType typeRef="tns:Retailer" behavior="retailerForConsumer"/&gt;
    &lt;reference&gt;
      &lt;token name="tns:retailerRef"/&gt;
    &lt;/reference&gt;
    &lt;identity&gt;
      &lt;token name="tns:purchaseOrderID"/&gt;
    &lt;/identity&gt;
  &lt;/channelType&gt;
 
  &lt;choreography name="ConsumerRetailerChoreography"&gt;
    &lt;relationship type="tns:ConsumerRetailerRelationship"/&gt;
    &lt;variableDefinitions&gt;
      &lt;variable name="purchaseOrder" informationType="tns:purchaseOrderType" 
                silent="false" /&gt;
      &lt;variable name="purchaseOrderAck" 
                informationType="tns:purchaseOrderAckType" /&gt;
      &lt;variable name="retailer-channel" channelType="tns:RetailerChannel"/&gt;
      &lt;variable name="consumer-channel" channelType="tns:ConsumerChannel"/&gt;
      &lt;variable name="badPurchaseOrderAck"   
                informationType="tns:badPOAckType" /&gt;
    &lt;/variableDefinitions&gt;
 
    &lt;interaction name="createPO"
                 channelVariable="tns:retailer-channel" 
                 operation="handlePurchaseOrder" &gt;
      &lt;participate relationshipType="tns:ConsumerRetailerRelationship" 
                   fromRoleTypeRef="tns:Consumer" toRoleTypeRef="tns:Retailer"/&gt;
      &lt;exchange name="request" 
                informationType="tns:purchaseOrderType" action="request"&gt;
        &lt;send variable="cdl:getVariable('tns:purchaseOrder','','')" /&gt;
        &lt;receive variable="cdl:getVariable('tns:purchaseOrder','','')"
                 recordReference="record-the-channel-info" /&gt;
      &lt;/exchange&gt;
      &lt;exchange name="response"
                informationType="purchaseOrderAckType" action="respond"&gt;
        &lt;send variable="cdl:getVariable('tns:purchaseOrderAck','','')" /&gt;
        &lt;receive variable="cdl:getVariable('tns:purchaseOrderAck','','')" /&gt;
      &lt;/exchange&gt;
      &lt;exchange name="badPurchaseOrderAckException" faultName="badPurchaseOrderAckException"
                informationType="badPOAckType" action="respond"&gt;
        &lt;send variable="cdl:getVariable('tns:badPurchaseOrderAck','','')"
                causeException="tns:badPOAck" /&gt;
        &lt;receive variable="cdl:getVariable('tns:badPurchaseOrderAck','','')"
                causeException="tns:badPOAck" /&gt;                 
      &lt;/exchange&gt;
      &lt;record name="record-the-channel-info" when="after"&gt;
        &lt;source variable="cdl:getVariable('tns:purchaseOrder','', 
                                          '/PO/CustomerRef')"/&gt;
        &lt;target variable="cdl:getVariable('tns:consumer-channel','','')"/&gt;
      &lt;/record&gt;
    &lt;/interaction&gt;
 &lt;/choreography&gt;    
&lt;/package&gt;
</pre></div></div></div></div><div class="div2">
<h3><a name="Composing-Choreographies" id="Composing-Choreographies"></a>6.3 
Composing Choreographies</h3><p>The <em>perform</em> activity realizes the composition of choreographies by combining existing choreographies to create new ones. For example, if two separate choreographies were defined as follows:</p><ul><li><p>A "Request for Quote" ("RFQ") choreography that involves a "Buyer" roleType sending a request for a quotation for goods and services to a "Supplier" roleType to which the "Supplier" roleType responds with either a "Quotation" or a "Decline to Quote" message, and</p>
</li><li><p>An "Order Placement" choreography, where the "Buyer" roleType places an order for goods or services and the "Supplier" roleType either accepts the order or rejects it</p>
</li></ul><p>One could then create a new "Quote and Order" choreography by reusing the two, where the "RFQ" choreography was performed first, and then, depending on the outcome of the "RFQ" choreography, the order is placed using the "Order Placement" choreography. In this case the new choreography is "composed" using the two previously defined choreographies. Using this approach, choreographies can be combined to support choreographies of any required complexity, allowing more flexibility as choreographies defined elsewhere can be reused.</p><p>The perform activity enables a choreography to specify that another choreography is performed at this point in its definition, as an enclosed choreography. The performed choreography, even when defined in a different choreography package, is conceptually treated as an enclosed choreography.</p><p>The syntax of the <em>perform</em> construct is: </p><div class="exampleInner"><pre>&lt;perform  choreographyName="QName" 
          choreographyInstanceId="XPath-expression"? 
          block="true|false"? &gt;
   &lt;bind  name="NCName"&gt;
     &lt;this variable="XPath-expression" roleType="QName"/&gt;
     &lt;free variable="XPath-expression" roleType="QName"/&gt;
   &lt;/bind&gt;*
   Choreography-Notation?
&lt;/perform&gt;
</pre></div><p>Within the <code>perform</code>
 element, the <code>choreographyName</code>
 attribute references the name of the choreography to be performed.</p><p>The OPTIONAL <code>choreographyInstanceId</code>
 attribute defines an identifier for this performance of the choreography identified by the <code>choreographyName</code>
 attribute. If the performed choreography can only be performed once within the enclosing choreography, the <code>choreographyInstanceId</code>
 attribute is OPTIONAL. Otherwise it MUST be specified and the value MUST be different for each performance. This is a dynamic requirement. For example, if a single <code>perform</code>
 element appears in a workunit that can repeat, then each use of perform must assign a different <code>choreographyInstanceId</code>
 identifier.</p><p>The OPTIONAL <code>block</code>
 attribute is used to indicate whether the performing choreography should wait for the performed choreography to complete before the perform activity completes:</p><p>If the <code>block</code>
 attribute is set to "true", then the perform activity MUST wait for the performed choreography to complete</p><p>If the block attribute is set to "false", then the perform activity MUST complete immediately following the enablement of the performed choreography, which may cause the performed choreography to be active concurrently with other activities following the perform activity</p><p>The default value for the <code>block</code>
 attribute is "true". For the purpose of clarity, any non-blocking performed enclosed choreographies that have not completed prior to the end of the performing choreography, are considered to be successfully completed upon the completion of the performing choreography.</p><p>The OPTIONAL Choreography-Notation within the <code>perform</code>
 element defines a locally defined choreography that is performed only by this perform activity. If specified, the <code>choreographyName</code>
 attribute within the <code>perform</code>
 element MUST match the attribute <code>name</code>
 within the <code>choreography</code>
 element of the Choreography-Notation.</p><p>The OPTIONAL <code>bind</code>
 element within the perform element enables information in the performing choreography to be shared with the performed choreography and vice versa. Within the <code>bind</code>
 element, the attribute <code>name</code>
 is used to specify a name for each <code>bind</code>
 element declared within this perform activity. Within the <code>bind</code>
 element, the <code>roleType</code>
 attribute aliases the roleTypes from the performing choreography to the performed choreography.</p><p>The <code>variable</code>
 attribute within the <code>this</code>
 element specifies that a variable in the performing choreography is bound with the variable identified by the variable attribute within the <code>free</code>
 element in the performed choreography.</p><p>The following rules apply:</p><ul><li><p>The choreography to be performed MUST be either a locally defined choreography that is immediately contained within the performing choreography or a globally defined choreography. Performed choreographies that are declared in a different choreography package MUST be included first before they can be performed</p>
</li><li><p>The roleTypes within a single <code>bind</code>
 element MUST be carried out by the same participant, hence they MUST belong to the same participantType</p>
</li><li><p>The <code>variable</code>
 attribute within <code>this</code>
 element and <code>free</code>
 element MUST define only the WS-CDL function <code>getVariable</code>
</p>
</li><li><p>The free variables specified within the <code>free</code>
 element MUST have the attribute <code>free</code>
 set to "true" in their definition within the performed choreography</p>
</li><li><p>There MUST NOT be a cyclic dependency on the choreographies performed. For example, choreography "C1" is performing choreography "C2" which is performing choreography "C1" again is disallowed</p>
</li></ul><p>The example below shows a choreography composition, where a choreography "PurchaseChoreography" is performing the globally defined choreography "RetailerWarehouseChoreography" and aliases the variable "purchaseOrderAtRetailer" to the variable "purchaseOrder" defined at the performed choreography "RetailerWarehouseChoreography". Once aliased, the variable "purchaseOrderAtRetailer" extends to the enclosed choreography and thus these variables can be used interchangeably for sharing their information. </p><div class="exampleOuter"><div class="exampleInner"><pre>&lt;choreography name="PurchaseChoreography"&gt;
   ...
   &lt;variableDefinitions&gt;
      &lt;variable name="purchaseOrderAtRetailer"
             informationType="purchaseOrder" roleTypes="tns:Retailer"/&gt;
   &lt;/variableDefinitions&gt;
   ...
   &lt;perform choreographyName="RetailerWarehouseChoreography"&gt;
      &lt;bind name="aliasRetailer"&gt;
        &lt;this variable="cdl:getVariable('tns:purchaseOrderAtRetailer','','')"
             roleType="tns:Retailer"/&gt;
        &lt;free variable="cdl:getVariable('tns:purchaseOrder','','')"
             roleType="tns:Retailer"/&gt;
      &lt;/bind&gt;
   &lt;/perform&gt;
    ...
&lt;/choreography&gt;

&lt;choreography name="RetailerWarehouseChoreography"&gt;
    &lt;variableDefinitions&gt;
       &lt;variable name="purchaseOrder"
          informationType="purchaseOrder" roleTypes="tns:Retailer" free="true"/&gt;
    &lt;/variableDefinitions&gt;
     ...
&lt;/choreography&gt;
</pre></div></div></div><div class="div2">
<h3><a name="Assigning-Variables" id="Assigning-Variables"></a>6.4 
Assigning Variables</h3><p>The<em> Assign</em> activity is used to create or change, and then make available within one roleType, the value of one or more variables using the value of another variable or expression.</p><p>The assign activity MAY also be used to cause an exception at a roleType.</p><p>The syntax of the <em>assign</em> construct is: </p><div class="exampleInner"><pre>&lt;assign  roleType="QName"&gt;
   &lt;copy  name="NCName" causeException="QName"? &gt;
      &lt;source  variable="XPath-expression"?|expression="XPath-expression"? /&gt;
      &lt;target  variable="XPath-expression" /&gt;
   &lt;/copy&gt;+
&lt;/assign&gt;
</pre></div><p>The <code>copy</code>
 element within the <code>assign</code>
 element creates or changes, at the roleType specified by the <code>roleType</code>
 attribute, the variable defined by the <code>target</code>
 element using the variable or expression defined by the <code>source</code>
 element at the same roleType. Within the <code>copy</code>
 element, the attribute <code>name</code>
 is used to specify a name for each <code>copy</code>
 element declared within this assign activity.</p><p>The following rules apply to assignment:</p><ul><li><p>The source MUST define either a <code>variable</code>
 attribute or an <code>expression</code>
 attribute</p>
<ul><li>When the source defines an <code>expression</code>
 attribute, it MUST contain an expression, as defined in Section 5.3. The resulting type of the defined expression MUST be compatible with the target variable type</li><li>When the source defines a variable, then the source and the target variable MUST be of compatible type</li><li>When the source defines a variable, then the source and the target variable MUST be defined at the same roleType</li></ul></li><li><p>When the attribute <code>variable</code>
 is defined it MUST use only the WS-CDL function <code>getVariable</code>
</p>
</li><li><p>The target variable MUST NOT be defined with the attribute <code>silent</code>
 set to "true" </p>
</li><li><p>When two or more <code>copy</code>
 elements belong to the same <code>assign</code>
 element, then they are performed in the order in which they are defined</p>
</li><li><p>If there are two or more <code>copy</code>
 elements specified within an assign, then all copy operations MUST complete successfully for the assign to complete successfully. Otherwise, none of the variables specified in the <code>target</code>
 attribute will be affected</p>
</li><li><p>At most one <code>copy</code>
 element MAY have the OPTIONAL attribute <code>causeException</code>
 specified</p>
</li><li><p>When the attribute <code>causeException</code>
 is specified in a <code>copy</code>
 element, then an exception SHOULD be caused at the roleType specified by the attribute <code>roleType</code>
 after the assign activity has completed. In this case, the "QName" value of the <code>causeException</code>
 attribute will identify the exception that SHOULD be caused</p>
</li></ul><p>The examples below show some possible usages of the assign construct. </p><div class="exampleOuter"><div class="exampleInner"><pre>Example 1:

&lt;assign roleType="tns:Retailer"&gt;
  &lt;copy name="copyAddressInfo"&gt;
    &lt;source variable="cdl:getVariable('PurchaseOrderMsg','',
                                      '/PO/CustomerAddress')" /&gt;
    &lt;target variable="cdl:getVariable('CustomerAddress','','')" /&gt;
  &lt;/copy&gt;
&lt;/assign&gt;

</pre></div></div><p><em></em>
</p><div class="exampleOuter"><div class="exampleInner"><pre>Example 2:

&lt;assign roleType="tns:Retailer"&gt;
  &lt;copy name="copyPriceInfo"&gt;
    &lt;source expression="(10+237)/34" /&gt;
    &lt;target variable="cdl:getVariable('ProductPrice','','','tns:Retailer')" /&gt;
  &lt;/copy&gt;
&lt;/assign&gt;

</pre></div></div><p><em></em>
</p><div class="exampleOuter"><div class="exampleInner"><pre>Example 3:

&lt;assign roleType="tns:Customer"&gt;
  &lt;copy name="copyLiteral"&gt;
    &lt;source expression="'Hello World'" /&gt;
    &lt;target variable="cdl:getVariable('VarName','','','tns:Customer')" /&gt;
  &lt;/copy&gt;
&lt;/assign&gt;
</pre></div></div></div><div class="div2">
<h3><a name="Marking-Silent-Actions" id="Marking-Silent-Actions"></a>6.5 
Marking Silent Actions</h3><p>The <em>silentAction</em> activity is an explicit designator used for marking the point where participant specific actions with non-observable operational details MUST be performed. For example, the mechanism a "Buyer" is using for checking the inventory of a warehouse should not be observable to other participants, but the fact that the inventory level does influence the global observable behavior with a "Buyer" needs to be specified in the choreography definition.</p><p>The syntax of the <em>silentAction</em> construct is: </p><div class="exampleInner"><pre>
&lt;silentAction roleType="QName"? /&gt;

</pre></div><p>The OPTIONAL attribute <code>roleType</code>
 is used to specify the participant at which the silentAction will be performed. If a silent action is defined without a roleType, it is implied that the action is performed at all the roleTypes that are part of the relationships of the choreography this activity is enclosed within.</p></div><div class="div2">
<h3><a name="Marking-the-Absence-of-Actions" id="Marking-the-Absence-of-Actions"></a>6.6 
Marking the Absence of Actions</h3><p>The <em>noAction</em> activity is an explicit designator used for marking the point where a participant does not perform any action. The <em>noAction</em>
 activity can be used in scenarios where an activity is syntactically required but no activity is applicable, in an exceptionBlock as demonstrated in the example below. </p><div class="exampleOuter"><div class="exampleInner"><pre>   &lt;exceptionBlock name="handleTimeoutException"&gt;
     &lt;workunit  name="handleTimeoutException" &gt;
                &lt;noAction&gt;
     &lt;/workunit&gt;
  &lt;/exceptionBlock&gt;
</pre></div></div><p></p><p>The syntax of the <em>noAction</em> construct is: </p><div class="exampleInner"><pre>
&lt;noAction roleType="QName? /&gt;

</pre></div><p>The OPTIONAL attribute <code>roleType</code>
 is used to specify the participant at which no action will be performed. If a noAction is defined without a roleType, it is implied that no action will be performed at any of the roleTypes that are part of the relationships of the choreography this activity is enclosed within.</p></div><div class="div2">
<h3><a name="Finalizing-a-Choreography" id="Finalizing-a-Choreography"></a>6.7 
Finalizing a Choreography</h3><p>The <em>finalize</em> activity is used to enable a specific finalizerBlock in successfully completed instances of immediately enclosed choreographies, and thus bring those choreographies to defined conclusions.</p><p>A choreography that does not perform any choreographies that have finalizerBlocks defined MUST NOT have any finalize activities specified within it. A finalize activity MAY be present within a choreography that has performed a choreography with one or more defined finalizerBlocks - that is a finalize activity can be specified within the choreography body, within an exceptionBlock and within finalizerBlocks.</p><p>For a single performed choreography instance, at most one of its finalizerBlocks SHOULD be enabled by a finalize activity during the subsequent progress, including exception handling and finalization, of the enclosing choreography. A finalize activity performed on uninstalled finalizerBlocks will have no effect.</p><p>The syntax of the <em>finalize</em> construct is: </p><div class="exampleInner"><pre>&lt;finalize  name="NCName"? choreographyName="NCName"
            choreographyInstanceId="XPath-expression"?
            finalizerName="NCName"? /&gt;
</pre></div><p>The OPTIONAL attribute <code>name</code>
 is used to specify a distinct name for each <code>finalize</code>
 element declared within a choreography package.</p><p>The finalize activity enables a finalizerBlock in a performed instance of an immediately enclosed choreography.</p><p>The <code>choreographyName</code>
 attribute identifies the choreography referenced by the <code>choreographyName</code>
 attribute of the perform construct.</p><p>The OPTIONAL <code>choreographyInstanceId</code>
 attribute identifies the performed choreography instance to be finalized, using the value defined by the <code>choreographyInstanceId</code>
 attribute of the perform construct. The <code>choreographyInstanceId</code>
 attribute MAY be omitted if the contract logic of the performing choreography is such that only one instance of the choreography identified by the <code>choreographyName</code>
 attribute could have been performed when the finalize activity is enabled. If more than one instance of the choreography identified by the <code>choregraphyName</code>
 attribute could have been performed, then the <code>choreographyInstanceId</code>
 attribute MUST be present.</p><p>The attribute <code>finalizerName</code>
 indicates which finalizerBlock is to be enabled in the performed instance. If the targeted, immediately enclosed, choreography has more than one defined finalizerBlock, then the <code>finalizerName</code>
 attribute MUST be present.</p><p>In the example below, choreography "CreditDecider" gets credit authorizations for two bidders, "A" and "B", at most one of which can be selected. The "CreditDecider" performs a "CoordinatedCreditAuthorization" choreography for each bidder, and then finalizes each performed choreography depending on whether "A", "B" or neither was selected. </p><div class="exampleOuter"><div class="exampleInner"><pre>&lt;choreography name="CreditDecider"&gt;
 
    &lt;!-- only a snippet is shown here --&gt;

    &lt;parallel&gt;
        &lt;perform name="creditForA"
            choreographyName="CoordinatedCreditAuthorization" 
            choreographyInstanceId="'creditForA'"&gt;
            &lt;!-- bind such that this does the business for A --&gt;
        &lt;/perform&gt;
        &lt;perform name="creditForB"
            choreographyName="CoordinatedCreditAuthorization" 
            choreographyInstanceId="'creditForB'"&gt;
            &lt;!-- bind such that this does the business for B --&gt;
        &lt;/perform&gt;
    &lt;/parallel&gt;
        
    &lt;!--  other stuff here --&gt;
    
    &lt;workunit name="chooseA"
        guard="cdl:getVariable('Chosen','','','Broker')='A'" &gt;
        &lt;finalize choreographyName="CoordinatedCreditAuthorization"
                choreographyInstanceId="'creditForA'"
                finalizerName="drawDown"/&gt;
        &lt;finalize choreographyName="CoordinatedCreditAuthorization"
                choreographyInstanceId="'creditForB'"
                finalizerName="replenish"/&gt;
    &lt;/workunit&gt;            

    &lt;workunit name="chooseB"
        guard="cdl:getVariable('Chosen','','','Broker')='B'" &gt;
        &lt;finalize choreographyName="CoordinatedCreditAuthorization"
                choreographyInstanceId="'creditForB'"
                finalizerName="drawDown"/&gt;
        &lt;finalize choreographyName="CoordinatedCreditAuthorization"
                choreographyInstanceId="'creditForA'"
                finalizerName="replenish"/&gt;
    &lt;/workunit&gt;            

    &lt;workunit name="chooseNeither"
        guard="cdl:getVariable('Chosen','','','Broker')='0'" &gt;
        &lt;finalize choreographyName="CoordinatedCreditAuthorization"
                choreographyInstanceId="'creditForA'"
                finalizerName="replenish"/&gt;
        &lt;finalize choreographyName="CoordinatedCreditAuthorization"
                choreographyInstanceId="'creditForB'"
                finalizerName="replenish"/&gt;
     &lt;/workunit&gt; 


&lt;/choreography&gt;
</pre></div></div></div></div><div class="div1">
<h2><a name="Interoperability-with-other-Specifications" id="Interoperability-with-other-Specifications"></a>7 
Interoperability with other Specifications</h2><div class="div2">
<h3><a name="Interoperability-with-Security-frameworks" id="Interoperability-with-Security-frameworks"></a>7.1 
Interoperability with Security frameworks</h3><p>Security specifications, such as WS-Security [<a href="#WSS">WSS</a>], provide enhancements to SOAP messaging to provide quality of protection through message integrity, message confidentiality, and single message authentication, including a general-purpose mechanism for associating security tokens with messages, and a description of how to encode binary security tokens.</p><p>As messages can have consequences in the real world, collaboration participants will impose security requirements on their information exchanges. WS-Security and other security specifications can be used satisfy many of these requirements.</p><p>A violation of any of the security consistency guarantees provided by the security specifications results in "errors" which MAY be reflected in the choreography as exceptions, identified by different "QNames".</p></div><div class="div2">
<h3><a name="Interoperability-with-Reliable-Messaging-frameworks" id="Interoperability-with-Reliable-Messaging-frameworks"></a>7.2 
Interoperability with Reliable Messaging frameworks</h3><p>Reliability specifications, such as WS-Reliability [<a href="#WSRM">WSRM</a>] and WS-ReliableMessaging [<a href="#WSRM">WSRM</a>], provide a reliable mechanism to exchange information among collaborating participants. These specifications prescribe the formats for all information exchanged without placing any restrictions on the content of the encapsulated business documents. These specifications support message exchange patterns over various transport protocols (examples are HTTP/S, FTP, SMTP, etc.). These specifications support sequencing of messages and guaranteed, exactly once delivery.</p><p>A violation of any of these consistency guarantees results in "errors" which MAY be reflected in the choreography as exceptions, identified by different "QNames".</p></div><div class="div2">
<h3><a name="Interoperability-with-Coordination-frameworks" id="Interoperability-with-Coordination-frameworks"></a>7.3 
Interoperability with Coordination frameworks</h3><p>In WS-CDL, <em>alignment interactions</em> and <em>coordinated choreographies</em>
 require support from a coordination protocol, where agreement on the outcome among participants can be reached even in the case of failures and loss of messages. In this case, the alignment interactions and the coordinated choreographies MUST be bound to a coordination protocol.</p></div><div class="div2">
<h3><a name="Interoperability-with-Addressing-frameworks" id="Interoperability-with-Addressing-frameworks"></a>7.4 
Interoperability with Addressing frameworks</h3><p>Web Services Addressing [<a href="#WSAD">WSAD</a>] provides transport-neutral mechanisms to address Web services and messages. Web Services Addressing 1.0 - Core defines a set of abstract properties and an XML Infoset [<a href="#XML">XML</a>], [<a href="#XMLNS">XMLNS</a>] representation thereof to identify Web service endpoints and to facilitate end-to-end identification of endpoints in messages. The specification enables messaging systems to support message transmission through networks that include processing nodes such as endpoint managers, firewalls, and gateways in a transport-neutral manner.</p><p>WS-Addressing can be used to convey the reference and correlation information for normalizing expanded channel variable information into a uniform format that can be processed independently of transport or application.</p><p>The WS-Addressing specification is in progress and the WS-Choreography Working Group will review and comment on developments of this effort on an ongoing basis.</p></div></div><div class="div1">
<h2><a name="Conformance" id="Conformance"></a>8 
Conformance</h2><div class="div2">
<h3><a name="Conforming-WS-CDL-documents" id="Conforming-WS-CDL-documents"></a>8.1 
Conforming WS-CDL documents</h3><p>A WS-CDL document conforms to the schema in Appendix B (Section 12) plus the additional syntactic and semantic constraints defined in the specification text in sections 2 through 6.  The root element MUST be <code>&lt;package&gt;</code>
 and it MUST belong to the WS-CDL namespace.</p></div><div class="div2">
<h3><a name="Endpoint-conformance" id="Endpoint-conformance"></a>8.2 
Endpoint conformance</h3><p>A conformant WS-CDL endpoint is an entity that correctly implements the observable behavior of a roleType defined within a WS-CDL choreography.</p></div></div><div class="div1">
<h2><a name="Acknowledgments" id="Acknowledgments"></a>9 
Acknowledgments</h2><p>This document has been produced by the members of the Web Services Choreography Working Group. The chairs of this Working Group are Martin Chapman (Oracle Corporation) and Steve Ross-Talbot (Pi4 Technologies Ltd). The editors would like to thank the Working Group members for their contributions. Members of the Working Group are (at the time of writing):   Daniel Austin (Sun Microsystems, Inc.), Abbie Barbir (Nortel Networks), Charlton Barreto (Adobe Systems, Inc), Carine Bournez (W3C), Gary Brown (Pi4 Technologies Ltd), Ugo Corda (SeeBeyond Technology Corporation), Anthony Fletcher (Choreology Ltd), Peter Furniss (Choreology Ltd), Kohei Honda (Queen Mary and Westerfield College), Duncan Johnston-Watt (Enigmatec Corporation), Nickolas Kavantzas (Oracle Corporation), Yves Lafon (W3C), Monica Martin (Sun Microsystems, Inc.), Robin Milner (Cambridge University), Jeff Mischkinsky (Oracle Corporation), Greg Ritzinger (Novell), Nobuko Yoshida (Imperial College London).  Previous members of the Working Group were: Assaf Arkin (Intalio Inc.), Alistair Barros (DSTC Pty Ltd (CITEC)), Richard Bonneau (IONA), Allen Brown (Microsoft Corporation), Mike Brumbelow (Apple), David Burdett (Commerce One), Ravi Byakod (Intalio Inc.), Michael Champion (Software AG), David Chapell (Sonic Software), Fred Cummins (EDS), Jon Dart (TIBCO Software), Jean-Jacques Dubray (Attachmate), William Eidson (TIBCO Software), Colleen Evans (Sonic Software), Keith Evans (Hewlett-Packard), Yaron Goland (BEA Systems), Leonard Greski (W. W. Grainger, Inc.), Jim Hendler (University of Maryland (Mind Lab)), Ricky Ho (Cisco Systems Inc.), Andre Huertas (Uniform Code Council), Eunju Kim (National Computerization Agency), Mayilraj Krishnan (Cisco Systems Inc.), Melanie Kudela (Uniform Code Council), Yutaka Kudou (Hitachi, Ltd.), Bruno Kurtic (webMethods, Inc.),  Paul Lipton (Computer Associates), Kevin Liu (SAP AG), Francis McCabe (Fujitsu Ltd.),  Carol McDonald (Sun Microsystems, Inc.), Greg Meredith (Microsoft Corporation), Eric Newcomer (IONA), Bijan Parsia (University of Maryland (Mind Lab)), Sanjay Patil (IONA), Ed Peters (webMethods, Inc.), Steve Pruitt (Novell), Yoko Seki (Hitachi, Ltd.), Dinesh Shahane (TIBCO Software), Evren Sirin (University of Maryland (Mind Lab)), Ivana Trickovic (SAP AG), William Vambenepe (Hewlett-Packard), Jim Webber (Arjuna Technologies Ltd.), Stuart Wheater (Arjuna Technologies Ltd.), Steven White (SeeBeyond Technology Corporation), Prasad Yendluri (webMethods, Inc.), Hadrian Zbarcea (IONA).</p></div><div class="div1">
<h2><a name="References" id="References"></a>10 
References</h2><div class="div2">
<h3><a name="refs-norm" id="refs-norm"></a>10.1 Normative References</h3><dl><dt class="label"><a name="RFC3023" id="RFC3023"></a>RFC 3023</dt><dd>
	<a href="http://www.ietf.org/rfc/rfc3023.txt"><cite>
	XML Media Types</cite></a>, M. Murata, S. St.Laurent and D. Kohn, 
	Editors.
        IETF, January 2001. 
	This RFC is available at http://www.ietf.org/rfc/rfc3023.txt.</dd><dt class="label"><a name="RFC2119" id="RFC2119"></a>RFC 2119</dt><dd>
	<a href="http://www.ietf.org/rfc/rfc2119.txt"><cite>Key words for 
	use in RFCs to Indicate Requirement Levels</cite></a>, S. Bradner, 
	Editor.
        IETF, March 1997. 
	This RFC is available at http://www.ietf.org/rfc/rfc2119.txt.</dd><dt class="label"><a name="RFC3986" id="RFC3986"></a>RFC 3986</dt><dd>
	<a href="http://www.ietf.org/rfc/rfc3986.txt"><cite>Uniform Resource 
	Identifiers (URI): Generic Syntax</cite></a>, T. Berners-Lee, 
	R. Fielding and L. Masinter, Editors.
	IETF, January 2005. 
	<em>Obsoletes: <span><a name="RFC2396" id="RFC2396"></a>RFC 2396</span>, <span><a name="RFC2732" id="RFC2732"></a>RFC 2732</span></em>.
	This RFC is available at http://www.ietf.org/rfc/rfc3986.txt.</dd><dt class="label"><a name="XML" id="XML"></a>Extensible Markup Language (XML) 1.0 (Third Edition)</dt><dd>
	<a href="http://www.w3.org/TR/2004/REC-xml-20040204"><cite>Extensible Markup
	Language (XML) 1.0 (Third Edition)</cite></a>, Jean Paoli, Eve Maler,
	Tim Bray, <em>et. al.</em>, Editors. 
	World Wide Web Consortium, 04 February 2004. 
	This version is http://www.w3.org/TR/2004/REC-xml-20040204. 
	The <a href="http://www.w3.org/TR/REC-xml">latest version</a> is
	available at http://www.w3.org/TR/REC-xml.</dd><dt class="label"><a name="xml11" id="xml11"></a>Extensible Markup Language (XML) 1.1</dt><dd>
      <a href="http://www.w3.org/TR/2004/REC-xml11-20040204/"><cite>
	Extensible Markup Language (XML) 1.1</cite></a>, 
	François Yergeau, John Cowan, Tim Bray, <em>et. al.</em>, Editors.
	World Wide Web Consortium, 04 February 2004.
	This version is http://www.w3.org/TR/2004/REC-xml11-20040204/. 
	The <a href="http://www.w3.org/TR/xml11/">latest version</a> is 
	available at http://www.w3.org/TR/xml11/.</dd><dt class="label"><a name="XMLNS" id="XMLNS"></a>Namespaces in XML</dt><dd>
	<a href="http://www.w3.org/TR/1999/REC-xml-names-19990114"><cite>Namespaces in
	XML</cite></a>, Andrew Layman, Dave Hollander, and Tim Bray, Editors. 
	World Wide Web Consortium, 14 January 1999. 
	This version is http://www.w3.org/TR/1999/REC-xml-names-19990114. 
	The <a href="http://www.w3.org/TR/REC-xml-names">latest version</a> is
	available at http://www.w3.org/TR/REC-xml-names.</dd><dt class="label"><a name="XMLSchemaP1" id="XMLSchemaP1"></a>XML Schema Part 1: Structures Second Edition</dt><dd>
        <a href="http://www.w3.org/TR/2004/REC-xmlschema-1-20041028/"><cite>XML Schema Part 1: 
	Structures Second Edition</cite></a>, David Beech, Murray Maloney, Henry S. Thompson,
	and Noah Mendelsohn, Editors. 
	World Wide Web Consortium, 28 October 2004. 
	This version is http://www.w3.org/TR/2004/REC-xmlschema-1-20041028/. 
	The <a href="http://www.w3.org/TR/xmlschema-1/">latest version</a> is
	available at http://www.w3.org/TR/xmlschema-1/.</dd><dt class="label"><a name="XMLSchemaP2" id="XMLSchemaP2"></a>XML Schema Part 2: Datatypes Second Edition</dt><dd>
	<a href="http://www.w3.org/TR/2004/REC-xmlschema-2-20041028/"><cite>XML Schema Part 2:
	Datatypes Second Edition</cite></a>, Ashok Malhotra and Paul V. Biron, Editors. 
	World Wide Web Consortium, 28 October 2004. 
	This version is http://www.w3.org/TR/2004/REC-xmlschema-2-20041028/. 
	The <a href="http://www.w3.org/TR/xmlschema-2/">latest version</a> is
	available at http://www.w3.org/TR/xmlschema-2/.</dd><dt class="label"><a name="XPTRF" id="XPTRF"></a>XPointer Framework</dt><dd>
        <a href="http://www.w3.org/TR/2003/REC-xptr-framework-20030325/"><cite>XPointer 
	Framework</cite></a>, 
        Paul Grosso, Eve Maler, Jonathan Marsh, and Norman Walsh, Editors. 
	World Wide Web Consortium, 25 March 2003. 
	This version is http://www.w3.org/TR/2003/REC-xptr-framework-20030325/. 
	The <a href="http://www.w3.org/TR/xptr-framework/">latest version</a> is available
	at http://www.w3.org/TR/xptr-framework/.</dd><dt class="label"><a name="xinclude" id="xinclude"></a>XML Inclusions (XInclude) Version 1.0</dt><dd>
      	<a href="http://www.w3.org/TR/2004/REC-xinclude-20041220/"><cite>XML Inclusions 
	(XInclude) Version 1.0</cite></a>, 
	Jonathan Marsh and David Orchard, Editors. 
	World Wide Web Consortium, 20 December 2004.
	This version is http://www.w3.org/TR/2004/REC-xinclude-20041220/. 
	The <a href="http://www.w3.org/TR/xinclude/">latest version</a> is 
	available at http://www.w3.org/TR/xinclude/.</dd><dt class="label"><a name="wsdl20" id="wsdl20"></a>Web Services Description Language (WSDL) Version 2.0 Part 1: Core Language</dt><dd>
        <a href="http://www.w3.org/TR/2005/WD-wsdl20-20050803"><cite>Web Services
	Description Language (WSDL) Version 2.0 Part 1: Core Language</cite></a>, 
	Sanjiva Weerawarana, Roberto Chinnici, Martin Gudgin, <em>et. al.</em>, Editors.
	World Wide Web Consortium, 03 August 2005. 
        This version is http://www.w3.org/TR/2005/WD-wsdl20-20050803. 
	The <a href="http://www.w3.org/TR/wsdl20">latest version</a> is available 
	at http://www.w3.org/TR/wsdl20.</dd><dt class="label"><a name="BP11" id="BP11"></a>Basic Profile</dt><dd>
      	<a href="http://www.ws-i.org/Profiles/BasicProfile-1.1-2004-08-24.html"><cite>
	Basic Profile Version 1.1</cite></a>, 
        Keith Ballinger, David Ehnebuske, Christopher Ferris 
        <em>et. al.</em>, Editors.
        The Web Services-Interoperability Organization, 24 September 2004.
        This version is http://www.ws-i.org/Profiles/BasicProfile-1.1-2004-08-24.html.
	The <a href="http://www.ws-i.org/Profiles/BasicProfile-1.1.html">latest version</a> is 
	available at http://www.ws-i.org/Profiles/BasicProfile-1.1.html.</dd></dl></div><div class="div2">
<h3><a name="refs-inform" id="refs-inform"></a>10.2 Informative References</h3><dl><dt class="label"><a name="W3C.soap-part1" id="W3C.soap-part1"></a>SOAP Version 1.2 Part 1: Messaging Framework</dt><dd>
     	<a href="http://www.w3.org/TR/2003/REC-soap12-part1-20030624/"><cite>SOAP 
	Version 1.2 Part 1: Messaging Framework</cite></a>, Marc Hadley, 
	Noah Mendelsohn, Jean-Jacques Moreau, <em>et. al.</em>, Editors. 
	World Wide Web Consortium, 24 June 2003. 
	This version is http://www.w3.org/TR/2003/REC-soap12-part1-20030624/. 
	The <a href="http://www.w3.org/TR/soap12-part1/">latest version</a> is
	available at http://www.w3.org/TR/soap12-part1/.</dd><dt class="label"><a name="xml11schema10" id="xml11schema10"></a>Processing XML 1.1 documents with XML Schema 1.0 processors</dt><dd>
     	<a href="http://www.w3.org/TR/2005/NOTE-xml11schema10-20050511/"><cite>Processing 
	XML 1.1 documents with XML Schema 1.0 processors</cite></a>, Henry S. Thompson
	, Editor. 
	World Wide Web Consortium, 11 May 2005. 
	This version is http://www.w3.org/TR/2005/NOTE-xml11schema10-20050511/. 
	The <a href="http://www.w3.org/TR/xml11schema10">latest version</a> is
	available at http://www.w3.org/TR/xml11schema10.</dd><dt class="label"><a name="uddi301" id="uddi301"></a>UDDI v3</dt><dd>
	<a href="http://uddi.org/pubs/uddi-v3.0.2-20041019.htm"><cite>UDDI 
	Version 3.0.2</cite></a>,
	Luc Clement, Andrew Hately, Claus von Riegen, Tony Rogers, Editors.
	OASIS Open, 19 October 2004.
	This version is http://uddi.org/pubs/uddi-v3.0.2-20041019.htm.
        The <a href="http://uddi.org/pubs/uddi_v3.htm">latest version</a> is available
	at http://uddi.org/pubs/uddi_v3.htm</dd><dt class="label"><a name="WSCI" id="WSCI"></a>Web Service Choreography Interface (WSCI) 1.0</dt><dd>
        <a href="http://www.w3.org/TR/2002/NOTE-wsci-20020808"><cite>Web Service 
	Choreography Interface (WSCI) 1.0</cite></a>, 
        Assaf Arkin, Sid Askary, Scott Fordin, <em>et. al.</em>, Editors. 
	W3C Note. This version is <a href="http://www.w3.org/TR/2002/NOTE-wsci-20020808">http://www.w3.org/TR/2002/NOTE-wsci-20020808</a>. 
	The <a href="http://www.w3.org/TR/wsci">latest version</a>
	is available at <a href="http://www.w3.org/TR/wsci">http://www.w3.org/TR/wsci</a>.</dd><dt class="label"><a name="XLANG" id="XLANG"></a>XLANG</dt><dd>
	<a href="http://www.gotdotnet.com/team/xml_wsspecs/xlang-c/default.htm"><cite>
	XLANG</cite></a>, 
	Satish Thatte, Author.
	Microsoft Corporation, 2001. 
	This document is available at 
	http://www.gotdotnet.com/team/xml_wsspecs/xlang-c/default.htm.</dd><dt class="label"><a name="WSFL" id="WSFL"></a>WSFL 1.0</dt><dd>
	<a href="http://www-3.ibm.com/software/solutions/webservices/pdf/WSFL.pdf"><cite>
	Web Services Flow Language (WSFL) Version 1.0</cite></a>, 
	Frank Leymann, Editor.
	IBM, May 2001. 
	This PDF document is available at 
	http://www-3.ibm.com/software/solutions/webservices/pdf/WSFL.pdf.</dd><dt class="label"><a name="WSBPEL" id="WSBPEL"></a>WS-BPEL 2.0</dt><dd>
	<a href="http://www.oasis-open.org/committees/download.php/10347/wsbpel-specification-draft-120204.htm"><cite>
	Web Services Business Process Execution Language Version 2.0</cite></a>, 
	Assaf Arkin, Sid Askary, Ben Bloch, <em>et. al.</em>, Editors.
	OASIS Open, December 2004. 
	This document is available at 
	http://www.oasis-open.org/committees/download.php/10347/wsbpel-specification-draft-120204.htm.</dd><dt class="label"><a name="BPML" id="BPML"></a>BPML 1.0</dt><dd>
	<a href="http://www.bpmi.org/downloads/BPML1.0.zip"><cite>
	Business Process Modeling Language</cite></a>,
	Assaf Arkin, Editor.
	BPMI.org, November 2002. 
	This document is available at 
	http://www.bpmi.org/downloads/BPML1.0.zip.</dd><dt class="label"><a name="XPDL" id="XPDL"></a>WPDI XML PDL</dt><dd>
	<a href="http://www.wfmc.org/standards/docs/TC-1025_10_xpdl_102502.pdf"><cite>
	Workflow Process Definition Interface -- XML Process Definition Language</cite></a>,
	Roberta Norin, Editor.
	The Workflow Management Coalition, October 2002. 
	This pdf document is available at 
	http://www.wfmc.org/standards/docs/TC-1025_10_xpdl_102502.pdf.</dd><dt class="label"><a name="WSCAF" id="WSCAF"></a>WS-CAF 1.0</dt><dd>
	<a href="http://www.oasis-open.org/committees/tc_home.php?wg_abbrev=ws-caf"><cite>
	 OASIS Web Services Composite Application Framework (WS-CAF) TC</cite></a>,
	This TC page is available at
	http://www.oasis-open.org/committees/tc_home.php?wg_abbrev=ws-caf.</dd><dt class="label"><a name="WSRM" id="WSRM"></a>WS-Reliability 1.1</dt><dd>
	<a href="http://docs.oasis-open.org/wsrm/ws-reliability/v1.1/wsrm-ws_reliability-1.1-spec-os.pdf"><cite>WS-Reliability 1.1
	</cite></a>,
	Kazunori Iwasa, Jacques Durant, Tom Rutt, <em>et. al.</em>, Editors.
	OASIS Open, August 2004. 
	This document is available at 
	http://www.oasis-open.org/committees/download.php/9330/WS-Reliability-CD1.086.zip.</dd><dt class="label"><a name="JavaLS" id="JavaLS"></a>Java Language Specification</dt><dd>
	<a href="http://java.sun.com/docs/books/jls/second_edition/html/j.title.doc.html"><cite>Java Language Specification
	</cite></a>,
	James Gosling, Bill Joy, Guy Steele, Gilad Bracha, Editors.
	Sun Microsystems, Inc., 2000. 
	This document is available at 
	http://java.sun.com/docs/books/jls/second_edition/html/j.title.doc.html.</dd><dt class="label"><a name="WSS" id="WSS"></a>WS-Security TC</dt><dd>
	<a href="http://www.oasis-open.org/committees/tc_home.php?wg_abbrev=wss"><cite>
	OASIS Web Services Security (WSS) TC </cite></a>,
	This TC page is available at
	http://www.oasis-open.org/committees/tc_home.php?wg_abbrev=wss.</dd><dt class="label"><a name="J2EE" id="J2EE"></a>Java 2 Entreprise Edition</dt><dd>
	<a href="http://java.sun.com/j2ee/"><cite>
	Java 2 Platform, Enterprise Edition (J2EE)</cite></a>,
	See 
	http://java.sun.com/j2ee/.</dd><dt class="label"><a name="ECMA334" id="ECMA334"></a>C# Language Specification</dt><dd>
	<a href="http://www.ecma-international.org/publications/standards/Ecma-334.htm"><cite>
	C# Language Specification</cite></a>,
	ECMA..
	This document is available at 
	http://www.ecma-international.org/publications/standards/Ecma-334.htm.</dd><dt class="label"><a name="WSAD" id="WSAD"></a>Web Services Addressing - Core</dt><dd>
      	<a href="http://www.w3.org/TR/2005/CR-ws-addr-core-20050817"><cite>
	Web Services Addressing - Core</cite></a>, 
	Martin Gudgin, Marc Hadley, Editors.
	World Wide Web Consortium, 17 August 2005.
	This version is http://www.w3.org/TR/2005/CR-ws-addr-core-20050817.
	The <a href="http://www.w3.org/TR/ws-addr-core">latest version</a> is 
	available at http://www.w3.org/TR/ws-addr-core.</dd><dt class="label"><a name="RDF" id="RDF"></a>Resource Description Framework (RDF): Concepts and Abstract Syntax</dt><dd>
      	<a href="http://www.w3.org/TR/2004/REC-rdf-concepts-20040210/"><cite>
	Resource Description Framework (RDF): Concepts and Abstract Syntax</cite></a>, 
	Graham Klyne, Jeremy J. Carroll, Editors.
	World Wide Web Consortium, 10 February 2004.
	This version is http://www.w3.org/TR/2004/REC-rdf-concepts-20040210/. 
	The <a href="http://www.w3.org/TR/rdf-concepts/">latest version</a> is 
	available at http://www.w3.org/TR/rdf-concepts/.</dd><dt class="label"><a name="OWL" id="OWL"></a>OWL Web Ontology Language Overview</dt><dd>
      	<a href="http://www.w3.org/TR/2004/REC-owl-features-20040210/"><cite>
	OWL Web Ontology Language Overview</cite></a>, 
	Deborah L. McGuinness, Frank van Harmelen, Editors.
	World Wide Web Consortium, 10 February 2004.
	This version is http://www.w3.org/TR/2004/REC-owl-features-20040210/. 
	The <a href="http://www.w3.org/TR/owl-features/">latest version</a> is 
	available at http://www.w3.org/TR/owl-features/.</dd><dt class="label"><a name="UMM" id="UMM"></a>UN/CEFACT Modelling Methodology</dt><dd>
      	<a href="http://www.unece.org/cefact/umm/ch1_intro.pdf"><cite>
	UN/CEFACT Modelling Methodology - Introduction</cite></a>, 
	United Nations Economic Commission for Europe, 10 January 2005.
	This document is available at 
        http://www.unece.org/cefact/umm/ch1_intro.pdf
   </dd><dt class="label"><a name="ebBP20" id="ebBP20"></a>ebBP 2.0</dt><dd>
	<a href="http://www.oasis-open.org/committees/tc_home.php?wg_abbrev=ebxml-bp"><cite>
	OASIS ebXML Business Process TC</cite></a>,
        This TC page is available at
        http://www.oasis-open.org/committees/tc_home.php?wg_abbrev=ebxml-bp.</dd><dt class="label"><a name="BPSS11" id="BPSS11"></a>BPSS 1.1</dt><dd>
	<a href="http://www.ebxml.org/specs/ebBPSS.pdf"><cite>
	Business Process Specification Schema v1.01</cite></a>,
	Business Process Project Team,
	UN/CEFACT and OASIS, 11 May 2001.
	This version is http://www.ebxml.org/specs/ebBPSS.pdf.</dd></dl></div></div></div><div class="back"><div class="div1">
<h2><a name="Mime-Type-definition" id="Mime-Type-definition"></a>A 
Mime Type definition</h2><dl><dt class="label">MIME media type name:</dt><dd><p>application</p></dd><dt class="label">MIME subtype name:</dt><dd><p>cdl+xml</p></dd><dt class="label">Required parameters:</dt><dd><p>none</p></dd><dt class="label">Optional parameters:</dt><dd><dl><dt class="label">charset</dt><dd><p>This parameter has identical semantics to the charset parameter
	    of the "application/xml" media type as specified in
	    RFC 3023 <a href="#RFC3023">[RFC 3023]</a>.</p></dd></dl></dd><dt class="label">Encoding considerations:</dt><dd><p>Identical to those of "application/xml"
      as described in RFC 3023 <a href="#RFC3023">[RFC 3023]</a>,
      section 3.2.</p></dd><dt class="label">Security considerations:</dt><dd><p>WS-CDL has the same security considerations described in 
	RFC3023 <a href="#RFC3023">[RFC 3023]</a>, section 10.</p></dd><dt class="label">Interoperability considerations:</dt><dd><p>There are no known interoperability issues.</p></dd><dt class="label">Published specification:</dt><dd><p>This document</p></dd><dt class="label">Applications which use this media type:</dt><dd><p>No known applications currently use this media type.</p></dd><dt class="label">Additional information:</dt><dd><dl><dt class="label">File extension:</dt><dd><p>CDL</p></dd><dt class="label">Fragment identifiers:</dt><dd><p>Identical to that of "application/xml" as described in
	     RFC 3023 <a href="#RFC3023">[RFC 3023]</a>,
             section 5.</p></dd><dt class="label">Base URI:</dt><dd><p>As specified in RFC 3023 <a href="#RFC3023">[RFC 3023]</a>, section 6.</p></dd><dt class="label">Macintosh File Type code:</dt><dd><p>TEXT</p></dd></dl></dd><dt class="label">Person and email address to contact for further information:</dt><dd><p>Yves Lafon &lt;ylafon@w3.org&gt;</p></dd><dt class="label">Intended usage:</dt><dd><p>COMMON</p></dd><dt class="label">Author/Change controller:</dt><dd><p>The WS-CDL 1.0 specification is a work product of the World Wide Web Consortium's <a href="http://www.w3.org/2002/ws/chor/">http://www.w3.org/2002/ws/chor/</a>. The W3C has change control over this specification.</p></dd></dl><p> </p></div><div class="div1">
<h2><a name="WS-CDL-XSD-Schemas" id="WS-CDL-XSD-Schemas"></a>B 
WS-CDL XSD Schemas</h2><div class="exampleInner"><pre>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;schema xmlns="http://www.w3.org/2001/XMLSchema"
    xmlns:cdl="http://www.w3.org/2005/10/cdl"
    targetNamespace="http://www.w3.org/2005/10/cdl"
    elementFormDefault="qualified"&gt;

  &lt;complexType name="tExtensibleElements"&gt;
    &lt;annotation&gt;
      &lt;documentation&gt;
        This type is extended by other WS-CDL component types to allow 
          elements and attributes from other namespaces to be added. 
        This type also contains the optional description element that 
        is applied to all WS-CDL constructs.
       &lt;/documentation&gt;
    &lt;/annotation&gt;
    &lt;sequence&gt;
      &lt;element name="description" minOccurs="0"&gt;
        &lt;complexType mixed="true"&gt;
          &lt;sequence minOccurs="0" maxOccurs="unbounded"&gt;
            &lt;any processContents="lax"/&gt;
          &lt;/sequence&gt;
          &lt;attribute name="type" type="cdl:tDescriptionType" use="optional" 
                 default="documentation"/&gt;
        &lt;/complexType&gt;
      &lt;/element&gt;
      &lt;element name="CDLExtension" minOccurs="0" maxOccurs="unbounded"&gt;
        &lt;complexType&gt;
          &lt;sequence minOccurs="0" maxOccurs="unbounded"&gt;
            &lt;any processContents="lax"/&gt;
          &lt;/sequence&gt;
        &lt;/complexType&gt;
      &lt;/element&gt;
    &lt;/sequence&gt;
    &lt;anyAttribute namespace="##other" processContents="lax"/&gt;
  &lt;/complexType&gt;

    &lt;element name="package" type="cdl:tPackage"/&gt;
    
  &lt;complexType name="tPackage"&gt;
    &lt;complexContent&gt;
      &lt;extension base="cdl:tExtensibleElements"&gt;
        &lt;sequence&gt;
          &lt;element name="informationType" type="cdl:tInformationType" 
                  minOccurs="0" maxOccurs="unbounded"/&gt;
          &lt;element name="token" type="cdl:tToken" minOccurs="0"
                  maxOccurs="unbounded"/&gt;
          &lt;element name="tokenLocator" type="cdl:tTokenLocator" 
                  minOccurs="0" maxOccurs="unbounded"/&gt;
          &lt;element name="roleType" type="cdl:tRoleType" minOccurs="0"
                  maxOccurs="unbounded"/&gt;
          &lt;element name="relationshipType" type="cdl:tRelationshipType" 
                  minOccurs="0" maxOccurs="unbounded"/&gt;
          &lt;element name="participantType" type="cdl:tParticipantType" 
                  minOccurs="0" maxOccurs="unbounded"/&gt;
          &lt;element name="channelType" type="cdl:tChannelType"
                  minOccurs="0" maxOccurs="unbounded"/&gt;
          &lt;element name="choreography" type="cdl:tChoreography" 
                  minOccurs="0" maxOccurs="unbounded"/&gt;
        &lt;/sequence&gt;
        &lt;attribute name="name" type="NCName" use="required"/&gt;
        &lt;attribute name="author" type="string" use="optional"/&gt;
        &lt;attribute name="version" type="string" use="optional"/&gt;
        &lt;attribute name="targetNamespace" type="anyURI" 
                 use="required"/&gt;
      &lt;/extension&gt;
    &lt;/complexContent&gt;
  &lt;/complexType&gt;
    
  &lt;complexType name="tInformationType"&gt;
    &lt;complexContent&gt;
      &lt;extension base="cdl:tExtensibleElements"&gt;
        &lt;attribute name="name" type="NCName" use="required"/&gt;
        &lt;attribute name="type" type="QName" use="optional"/&gt;
        &lt;attribute name="element" type="QName" use="optional"/&gt;
      &lt;/extension&gt;
    &lt;/complexContent&gt;
  &lt;/complexType&gt;

  &lt;complexType name="tToken"&gt;
    &lt;complexContent&gt;
      &lt;extension base="cdl:tExtensibleElements"&gt;
        &lt;attribute name="name" type="NCName" use="required"/&gt;
        &lt;attribute name="informationType" type="QName"
                 use="required"/&gt;
      &lt;/extension&gt;
    &lt;/complexContent&gt;
  &lt;/complexType&gt;

  &lt;complexType name="tTokenLocator"&gt;
    &lt;complexContent&gt;
      &lt;extension base="cdl:tExtensibleElements"&gt;
        &lt;attribute name="tokenName" type="QName" use="required"/&gt;
        &lt;attribute name="informationType" type="QName"
                 use="required"/&gt;
        &lt;attribute name="part" type="NCName" use="optional" /&gt;
        &lt;attribute name="query" type="cdl:tXPath-expr" 
                 use="required"/&gt;
      &lt;/extension&gt;
    &lt;/complexContent&gt;
  &lt;/complexType&gt;

  &lt;complexType name="tRoleType"&gt;
    &lt;complexContent&gt;
      &lt;extension base="cdl:tExtensibleElements"&gt;
        &lt;sequence&gt;
          &lt;element name="behavior" type="cdl:tBehavior"
                  maxOccurs="unbounded"/&gt;
        &lt;/sequence&gt;
        &lt;attribute name="name" type="NCName" use="required"/&gt;
      &lt;/extension&gt;
    &lt;/complexContent&gt;
  &lt;/complexType&gt;

  &lt;complexType name="tBehavior"&gt;
    &lt;complexContent&gt;
      &lt;extension base="cdl:tExtensibleElements"&gt;
        &lt;attribute name="name" type="NCName" use="required"/&gt;
        &lt;attribute name="interface" type="QName" use="optional"/&gt;
      &lt;/extension&gt;
    &lt;/complexContent&gt;
  &lt;/complexType&gt;

  &lt;complexType name="tRelationshipType"&gt;
    &lt;complexContent&gt;
      &lt;extension base="cdl:tExtensibleElements"&gt;
        &lt;sequence&gt;
          &lt;element name="roleType" type="cdl:tRoleRef" minOccurs="2"
                  maxOccurs="2"/&gt;
        &lt;/sequence&gt;
        &lt;attribute name="name" type="NCName" use="required"/&gt;
      &lt;/extension&gt;
    &lt;/complexContent&gt;
  &lt;/complexType&gt;

  &lt;complexType name="tRoleRef"&gt;
    &lt;complexContent&gt;
      &lt;extension base="cdl:tExtensibleElements"&gt;
        &lt;attribute name="typeRef" type="QName" use="required"/&gt;
        &lt;attribute name="behavior" use="optional"&gt;
          &lt;simpleType&gt;
             &lt;list itemType="NCName"/&gt;
          &lt;/simpleType&gt;
        &lt;/attribute&gt;
      &lt;/extension&gt;
    &lt;/complexContent&gt;
  &lt;/complexType&gt;

  &lt;complexType name="tParticipantType"&gt;
    &lt;complexContent&gt;
      &lt;extension base="cdl:tExtensibleElements"&gt;
        &lt;sequence&gt;
          &lt;element name="roleType" type="cdl:tRoleRef2" 
                  maxOccurs="unbounded"/&gt;
        &lt;/sequence&gt;
        &lt;attribute name="name" type="NCName" use="required"/&gt;
      &lt;/extension&gt;
    &lt;/complexContent&gt;
  &lt;/complexType&gt;

  &lt;complexType name="tRoleRef2"&gt;
    &lt;complexContent&gt;
      &lt;extension base="cdl:tExtensibleElements"&gt;
        &lt;attribute name="typeRef" type="QName" use="required"/&gt;
      &lt;/extension&gt;
    &lt;/complexContent&gt;
  &lt;/complexType&gt;

  &lt;complexType name="tChannelType"&gt;
    &lt;complexContent&gt;
      &lt;extension base="cdl:tExtensibleElements"&gt;
        &lt;sequence&gt;
          &lt;element name="passing" type="cdl:tPassing" minOccurs="0"
                  maxOccurs="unbounded"/&gt;
          &lt;element name="roleType" type="cdl:tRoleRef3"/&gt;
          &lt;element name="reference" type="cdl:tReference"/&gt;
          &lt;element name="identity" type="cdl:tIdentity" minOccurs="0" 
                  maxOccurs="unbounded"/&gt;
        &lt;/sequence&gt;
        &lt;attribute name="name" type="NCName" use="required"/&gt;
        &lt;attribute name="usage" type="cdl:tUsage" use="optional" 
                     default="distinct"/&gt;
        &lt;attribute name="action" type="cdl:tAction" use="optional"
                     default="request"/&gt;
      &lt;/extension&gt;
    &lt;/complexContent&gt;
  &lt;/complexType&gt;

  &lt;complexType name="tRoleRef3"&gt;
    &lt;complexContent&gt;
      &lt;extension base="cdl:tExtensibleElements"&gt;
        &lt;attribute name="typeRef" type="QName" use="required"/&gt;
        &lt;attribute name="behavior" type="NCName" use="optional"/&gt;
      &lt;/extension&gt;
    &lt;/complexContent&gt;
  &lt;/complexType&gt;

  &lt;complexType name="tPassing"&gt;
    &lt;complexContent&gt;
      &lt;extension base="cdl:tExtensibleElements"&gt;
        &lt;attribute name="channel" type="QName" use="required"/&gt;
        &lt;attribute name="action" type="cdl:tAction" use="optional" 
                 default="request"/&gt;
        &lt;attribute name="new" type="boolean" use="optional"
                 default="false"/&gt;
      &lt;/extension&gt;
    &lt;/complexContent&gt;
  &lt;/complexType&gt;

  &lt;complexType name="tReference"&gt;
    &lt;complexContent&gt;
      &lt;extension base="cdl:tExtensibleElements"&gt;
        &lt;sequence&gt;
          &lt;element name="token" type="cdl:tTokenReference"
                      minOccurs="1" maxOccurs="1"/&gt;
        &lt;/sequence&gt;
      &lt;/extension&gt;
    &lt;/complexContent&gt;
  &lt;/complexType&gt;

  &lt;complexType name="tTokenReference"&gt;
    &lt;complexContent&gt;
      &lt;extension base="cdl:tExtensibleElements"&gt;
        &lt;attribute name="name" type="QName" use="required"/&gt;
      &lt;/extension&gt;
    &lt;/complexContent&gt;
  &lt;/complexType&gt;

  &lt;complexType name="tIdentity"&gt;
    &lt;complexContent&gt;
      &lt;extension base="cdl:tExtensibleElements"&gt;
        &lt;sequence&gt;
          &lt;element name="token" type="cdl:tTokenReference" 
                  minOccurs="1" maxOccurs="unbounded"/&gt;
        &lt;/sequence&gt;
        &lt;attribute name="usage" type="cdl:tUsageI" use="optional" 
                     default="primary"/&gt;
      &lt;/extension&gt;
    &lt;/complexContent&gt;
  &lt;/complexType&gt;


  &lt;complexType name="tChoreography"&gt;
    &lt;complexContent&gt;
      &lt;extension base="cdl:tExtensibleElements"&gt;
        &lt;sequence&gt;
          &lt;element name="relationship" type="cdl:tRelationshipRef" 
                  maxOccurs="unbounded"/&gt;
          &lt;element name="variableDefinitions"
                  type="cdl:tVariableDefinitions" minOccurs="0"/&gt;
          &lt;element name="choreography" type="cdl:tChoreography"
                   minOccurs="0" maxOccurs="unbounded"/&gt;
          &lt;group ref="cdl:activity"/&gt;
          &lt;element name="exceptionBlock" type="cdl:tException"
                  minOccurs="0"/&gt;
          &lt;element name="finalizerBlock" type="cdl:tFinalizer"
                      minOccurs="0" maxOccurs="unbounded"/&gt;
        &lt;/sequence&gt;
        &lt;attribute name="name" type="NCName" use="required"/&gt;
        &lt;attribute name="complete" type="cdl:tBoolean-expr" 
                     use="optional"/&gt;
        &lt;attribute name="isolation" type="boolean" 
                     use="optional" default="false"/&gt;
        &lt;attribute name="root" type="boolean" use="optional" 
                     default="false"/&gt;
        &lt;attribute name="coordination" type="boolean" use="optional" 
                     default="false"/&gt;
      &lt;/extension&gt;
    &lt;/complexContent&gt;
  &lt;/complexType&gt;

  &lt;complexType name="tRelationshipRef"&gt;
    &lt;complexContent&gt;
      &lt;extension base="cdl:tExtensibleElements"&gt;
        &lt;attribute name="type" type="QName" use="required"/&gt;
      &lt;/extension&gt;
    &lt;/complexContent&gt;
  &lt;/complexType&gt;

  &lt;complexType name="tVariableDefinitions"&gt;
    &lt;complexContent&gt;
      &lt;extension base="cdl:tExtensibleElements"&gt;
        &lt;sequence&gt;
          &lt;element name="variable" type="cdl:tVariable"
                  maxOccurs="unbounded"/&gt;
        &lt;/sequence&gt;
      &lt;/extension&gt;
    &lt;/complexContent&gt;
  &lt;/complexType&gt;

  &lt;complexType name="tVariable"&gt;
    &lt;complexContent&gt;
      &lt;extension base="cdl:tExtensibleElements"&gt;
        &lt;attribute name="name" type="NCName" use="required"/&gt;
        &lt;attribute name="informationType" type="QName" 
                 use="optional"/&gt;
        &lt;attribute name="channelType" type="QName" use="optional"/&gt;
        &lt;attribute name="mutable" type="boolean" use="optional"
                 default="true"/&gt;
        &lt;attribute name="free" type="boolean" use="optional" 
                 default="false"/&gt;
        &lt;attribute name="silent" type="boolean" use="optional"
                 default="false"/&gt;
        &lt;attribute name="roleTypes" use="optional"&gt;
           &lt;simpleType&gt;
              &lt;list itemType="QName"/&gt;
           &lt;/simpleType&gt;
        &lt;/attribute&gt;
      &lt;/extension&gt;
    &lt;/complexContent&gt;
  &lt;/complexType&gt;

  &lt;group name="activity"&gt;
    &lt;choice&gt;
      &lt;element name="sequence" type="cdl:tSequence"/&gt;
      &lt;element name="parallel" type="cdl:tParallel"/&gt;
      &lt;element name="choice" type="cdl:tChoice"/&gt;
      &lt;element name="workunit" type="cdl:tWorkunit"/&gt;
      &lt;element name="interaction" type="cdl:tInteraction"/&gt;
      &lt;element name="perform" type="cdl:tPerform"/&gt;
      &lt;element name="assign" type="cdl:tAssign"/&gt;
      &lt;element name="silentAction" type="cdl:tSilentAction"/&gt;
      &lt;element name="noAction" type="cdl:tNoAction"/&gt;
      &lt;element name="finalize" type="cdl:tFinalize"/&gt;
      &lt;any namespace="##other" processContents="lax"/&gt;
    &lt;/choice&gt;
  &lt;/group&gt;

  &lt;complexType name="tSequence"&gt;
    &lt;complexContent&gt;
      &lt;extension base="cdl:tExtensibleElements"&gt;
        &lt;sequence&gt;
          &lt;group ref="cdl:activity" maxOccurs="unbounded"/&gt;
        &lt;/sequence&gt;
      &lt;/extension&gt;
    &lt;/complexContent&gt;
  &lt;/complexType&gt;

  &lt;complexType name="tParallel"&gt;
    &lt;complexContent&gt;
      &lt;extension base="cdl:tExtensibleElements"&gt;
        &lt;sequence&gt;
          &lt;group ref="cdl:activity" maxOccurs="unbounded"/&gt;
        &lt;/sequence&gt;
      &lt;/extension&gt;
    &lt;/complexContent&gt;
  &lt;/complexType&gt;

  &lt;complexType name="tChoice"&gt;
    &lt;complexContent&gt;
      &lt;extension base="cdl:tExtensibleElements"&gt;
        &lt;sequence&gt;
          &lt;group ref="cdl:activity" maxOccurs="unbounded"/&gt;
        &lt;/sequence&gt;
      &lt;/extension&gt;
    &lt;/complexContent&gt;
  &lt;/complexType&gt;

  &lt;complexType name="tWorkunit"&gt;
    &lt;complexContent&gt;
      &lt;extension base="cdl:tExtensibleElements"&gt;
        &lt;sequence&gt;
          &lt;group ref="cdl:activity"/&gt;
        &lt;/sequence&gt;
        &lt;attribute name="name" type="NCName" use="required"/&gt;
        &lt;attribute name="guard" type="cdl:tBoolean-expr" 
                 use="optional"/&gt;
        &lt;attribute name="repeat" type="cdl:tBoolean-expr" 
                 use="optional"/&gt;
        &lt;attribute name="block" type="boolean" 
                 use="optional" default="false"/&gt;
      &lt;/extension&gt;
    &lt;/complexContent&gt;
  &lt;/complexType&gt;

  &lt;complexType name="tPerform"&gt;
    &lt;complexContent&gt;
      &lt;extension base="cdl:tExtensibleElements"&gt;
        &lt;sequence&gt;
          &lt;element name="bind" type="cdl:tBind" 
                  minOccurs="0" maxOccurs="unbounded"/&gt;
          &lt;element name="choreography" type="cdl:tChoreography"
                   minOccurs="0" maxOccurs="1"/&gt;
        &lt;/sequence&gt;
        &lt;attribute name="choreographyName" type="QName" use="required"/&gt;
        &lt;attribute name="choreographyInstanceId" type="cdl:tXPath-expr" use="optional"/&gt;
        &lt;attribute name="block" type="boolean" 
                 use="optional" default="true"/&gt;
      &lt;/extension&gt;
    &lt;/complexContent&gt;
  &lt;/complexType&gt;

  &lt;complexType name="tBind"&gt;
    &lt;complexContent&gt;
      &lt;extension base="cdl:tExtensibleElements"&gt;
        &lt;sequence&gt;
          &lt;element name="this" type="cdl:tBindVariable"/&gt;
          &lt;element name="free" type="cdl:tBindVariable"/&gt;
        &lt;/sequence&gt;
         &lt;attribute name="name" type="NCName" use="required"/&gt;
      &lt;/extension&gt;
    &lt;/complexContent&gt;
  &lt;/complexType&gt;

  &lt;complexType name="tBindVariable"&gt;
    &lt;complexContent&gt;
      &lt;extension base="cdl:tExtensibleElements"&gt;
        &lt;attribute name="variable" type="cdl:tXPath-expr" 
                 use="required"/&gt;
        &lt;attribute name="roleType" type="QName" use="required"/&gt;
      &lt;/extension&gt;
    &lt;/complexContent&gt;
  &lt;/complexType&gt;

  &lt;complexType name="tInteraction"&gt;
    &lt;complexContent&gt;
      &lt;extension base="cdl:tExtensibleElements"&gt;
        &lt;sequence&gt;
          &lt;element name="participate" type="cdl:tParticipate"/&gt;
          &lt;element name="exchange" type="cdl:tExchange" minOccurs="0"
                  maxOccurs="unbounded"/&gt;
          &lt;element name="timeout" type="cdl:tTimeout" minOccurs="0"
                  maxOccurs="1"/&gt;
          &lt;element name="record" type="cdl:tRecord" minOccurs="0" 
                  maxOccurs="unbounded"/&gt;
        &lt;/sequence&gt;
        &lt;attribute name="name" type="NCName" use="required"/&gt;
        &lt;attribute name="channelVariable" type="QName" 
                 use="required"/&gt;
        &lt;attribute name="operation" type="NCName" use="required"/&gt;
        &lt;attribute name="align" type="boolean" use="optional" 
                 default="false"/&gt;
        &lt;attribute name="initiate" type="boolean" 
                 use="optional" default="false"/&gt;
      &lt;/extension&gt;
    &lt;/complexContent&gt;
  &lt;/complexType&gt;

  &lt;complexType name="tTimeout"&gt;
    &lt;complexContent&gt;
      &lt;extension base="cdl:tExtensibleElements"&gt;
        &lt;attribute name="time-to-complete" type="cdl:tXPath-expr" use="required"/&gt;
        &lt;attribute name="fromRoleTypeRecordRef" use="optional"&gt;
          &lt;simpleType&gt;
             &lt;list itemType="NCName"/&gt;
          &lt;/simpleType&gt;
        &lt;/attribute&gt;
        &lt;attribute name="toRoleTypeRecordRef" use="optional"&gt;
          &lt;simpleType&gt;
             &lt;list itemType="NCName"/&gt;
          &lt;/simpleType&gt;
        &lt;/attribute&gt;
      &lt;/extension&gt;
    &lt;/complexContent&gt;
  &lt;/complexType&gt;

  &lt;complexType name="tParticipate"&gt;
    &lt;complexContent&gt;
      &lt;extension base="cdl:tExtensibleElements"&gt;
        &lt;attribute name="relationshipType" type="QName" use="required"/&gt;
        &lt;attribute name="fromRoleTypeRef" type="QName" use="required"/&gt;
        &lt;attribute name="toRoleTypeRef" type="QName" use="required"/&gt;
      &lt;/extension&gt;
    &lt;/complexContent&gt;
  &lt;/complexType&gt;

  &lt;complexType name="tExchange"&gt;
    &lt;complexContent&gt;
      &lt;extension base="cdl:tExtensibleElements"&gt;
        &lt;sequence&gt;
          &lt;element name="send" type="cdl:tVariableRecordRef"/&gt;
          &lt;element name="receive" type="cdl:tVariableRecordRef"/&gt;
        &lt;/sequence&gt;
        &lt;attribute name="name" type="NCName" use="required"/&gt;
        &lt;attribute name="faultName" type="QName" 
                 use="optional"/&gt;
        &lt;attribute name="informationType" type="QName" 
                 use="optional"/&gt;
        &lt;attribute name="channelType" type="QName" 
                 use="optional"/&gt;
        &lt;attribute name="action" type="cdl:tAction2" use="required"/&gt;
      &lt;/extension&gt;
    &lt;/complexContent&gt;
  &lt;/complexType&gt;

  &lt;complexType name="tVariableRecordRef"&gt;
    &lt;complexContent&gt;
      &lt;extension base="cdl:tExtensibleElements"&gt;
        &lt;attribute name="variable" type="cdl:tXPath-expr" 
                use="optional"/&gt;
        &lt;attribute name="recordReference" use="optional"&gt;
          &lt;simpleType&gt;
             &lt;list itemType="NCName"/&gt;
          &lt;/simpleType&gt;
        &lt;/attribute&gt;
        &lt;attribute name="causeException" type="QName" 
                use="optional" /&gt;
      &lt;/extension&gt;
    &lt;/complexContent&gt;
  &lt;/complexType&gt;

  &lt;complexType name="tRecord"&gt;
    &lt;complexContent&gt;
      &lt;extension base="cdl:tExtensibleElements"&gt;
        &lt;sequence&gt;
          &lt;element name="source" type="cdl:tSourceVariableRef"/&gt;
          &lt;element name="target" type="cdl:tVariableRef"/&gt;
        &lt;/sequence&gt;
        &lt;attribute name="name" type="NCName" use="required"/&gt;
        &lt;attribute name="causeException" type="QName" use="optional" /&gt;
        &lt;attribute name="when" type="cdl:tWhenType" use="required"/&gt;
      &lt;/extension&gt;
    &lt;/complexContent&gt;
  &lt;/complexType&gt;

   &lt;complexType name="tSourceVariableRef"&gt;
    &lt;complexContent&gt;
      &lt;extension base="cdl:tExtensibleElements"&gt;
        &lt;attribute name="variable" type="cdl:tXPath-expr" 
                use="optional"/&gt;
        &lt;attribute name="expression" type="cdl:tXPath-expr" 
                use="optional"/&gt;
      &lt;/extension&gt;
    &lt;/complexContent&gt;
  &lt;/complexType&gt;

  &lt;complexType name="tVariableRef"&gt;
    &lt;complexContent&gt;
      &lt;extension base="cdl:tExtensibleElements"&gt;
        &lt;attribute name="variable" type="cdl:tXPath-expr" 
                use="required"/&gt;
      &lt;/extension&gt;
    &lt;/complexContent&gt;
  &lt;/complexType&gt;

  &lt;complexType name="tAssign"&gt;
    &lt;complexContent&gt;
      &lt;extension base="cdl:tExtensibleElements"&gt;
        &lt;sequence&gt;
      &lt;element name="copy" type="cdl:tCopy"
               maxOccurs="unbounded"/&gt;
        &lt;/sequence&gt;
        &lt;attribute name="roleType" type="QName" use="required"/&gt;
      &lt;/extension&gt;
    &lt;/complexContent&gt;
  &lt;/complexType&gt;

  &lt;complexType name="tCopy"&gt;
    &lt;complexContent&gt;
      &lt;extension base="cdl:tExtensibleElements"&gt;
        &lt;sequence&gt;
          &lt;element name="source" type="cdl:tSourceVariableRef"/&gt;
          &lt;element name="target" type="cdl:tVariableRef"/&gt;
        &lt;/sequence&gt;
        &lt;attribute name="name" type="NCName" use="required"/&gt;
        &lt;attribute name="causeException" type="QName" 
                use="optional" /&gt;
      &lt;/extension&gt;
    &lt;/complexContent&gt;
  &lt;/complexType&gt;

  &lt;complexType name="tSilentAction"&gt;
    &lt;complexContent&gt;
      &lt;extension base="cdl:tExtensibleElements"&gt;
        &lt;attribute name="roleType" type="QName" use="optional"/&gt;
      &lt;/extension&gt;
    &lt;/complexContent&gt;
  &lt;/complexType&gt;

  &lt;complexType name="tNoAction"&gt;
    &lt;complexContent&gt;
      &lt;extension base="cdl:tExtensibleElements"&gt;
        &lt;attribute name="roleType" type="QName" use="optional"/&gt;
      &lt;/extension&gt;
    &lt;/complexContent&gt;
  &lt;/complexType&gt;

  &lt;complexType name="tFinalize"&gt;
    &lt;complexContent&gt;
      &lt;extension base="cdl:tExtensibleElements"&gt;
        &lt;attribute name="name" type="NCName" use="required"/&gt;
        &lt;attribute name="choreographyName" type="NCName" use="required"/&gt;
        &lt;attribute name="choreographyInstanceId" type="cdl:tXPath-expr"
                                                      use="optional"/&gt;
        &lt;attribute name="finalizerName" type="NCName" use="optional"/&gt;
      &lt;/extension&gt;
    &lt;/complexContent&gt;
  &lt;/complexType&gt;

  &lt;complexType name="tException"&gt;
    &lt;complexContent&gt;
      &lt;extension base="cdl:tExtensibleElements"&gt;
        &lt;sequence&gt;
          &lt;element name="workunit" type="cdl:tWorkunit"
                  maxOccurs="unbounded"/&gt;
        &lt;/sequence&gt;
        &lt;attribute name="name" type="NCName" use="required"/&gt;
      &lt;/extension&gt;
    &lt;/complexContent&gt;
  &lt;/complexType&gt;

  &lt;complexType name="tFinalizer"&gt;
    &lt;complexContent&gt;
      &lt;extension base="cdl:tExtensibleElements"&gt;
        &lt;sequence&gt;
          &lt;group ref="cdl:activity"/&gt;
        &lt;/sequence&gt;
        &lt;attribute name="name" type="NCName" use="required"/&gt;
      &lt;/extension&gt;
    &lt;/complexContent&gt;
  &lt;/complexType&gt;

  &lt;simpleType name="tAction"&gt;
    &lt;restriction base="string"&gt;
      &lt;enumeration value="request-respond"/&gt;
      &lt;enumeration value="request"/&gt;
      &lt;enumeration value="respond"/&gt;
    &lt;/restriction&gt;
  &lt;/simpleType&gt;

  &lt;simpleType name="tAction2"&gt;
    &lt;restriction base="string"&gt;
      &lt;enumeration value="request"/&gt;
      &lt;enumeration value="respond"/&gt;
    &lt;/restriction&gt;
  &lt;/simpleType&gt;

  &lt;simpleType name="tUsage"&gt;
    &lt;restriction base="string"&gt;
      &lt;enumeration value="once"/&gt;
      &lt;enumeration value="distinct"/&gt;
      &lt;enumeration value="shared"/&gt;
    &lt;/restriction&gt;
  &lt;/simpleType&gt;

  &lt;simpleType name="tUsageI"&gt;
    &lt;restriction base="string"&gt;
      &lt;enumeration value="primary"/&gt;
      &lt;enumeration value="alternate"/&gt;
      &lt;enumeration value="derived"/&gt;
      &lt;enumeration value="association"/&gt;
    &lt;/restriction&gt;
  &lt;/simpleType&gt;

  &lt;simpleType name="tWhenType"&gt;
    &lt;restriction base="string"&gt;
      &lt;enumeration value="before"/&gt;
      &lt;enumeration value="after"/&gt;
      &lt;enumeration value="timeout"/&gt;
    &lt;/restriction&gt;
  &lt;/simpleType&gt;


  &lt;simpleType name="tBoolean-expr"&gt;
    &lt;restriction base="string"/&gt;
  &lt;/simpleType&gt;

  &lt;simpleType name="tXPath-expr"&gt;
    &lt;restriction base="string"/&gt;
  &lt;/simpleType&gt;

  &lt;simpleType name="tDescriptionType"&gt;
    &lt;restriction base="string"&gt;
      &lt;enumeration value="documentation"/&gt;
      &lt;enumeration value="reference"/&gt;
      &lt;enumeration value="semantics"/&gt;
    &lt;/restriction&gt;
  &lt;/simpleType&gt;

&lt;/schema&gt;
</pre></div></div></div></body></html>
